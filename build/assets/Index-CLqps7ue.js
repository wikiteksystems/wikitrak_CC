import{i as _,j as e,a as z,u as A,t as m,T as S,x as ee,y as te,r as a,B as E,z as se,A as W,n as oe,o as ae}from"./index-Tb90R2_b.js";import{L as re}from"./Close-BOsQMh6z.js";import{L as ie}from"./LiveMapTopBar-DZzlFNVh.js";import{V as le}from"./VehicleMenu-C6Wdfeu7.js";import{u as ne,G as ce,M as X}from"./esm-mwoWbJw9.js";import pe from"./Loader-CnTKJNrn.js";import{r as y}from"./createSvgIcon-Cw0CjRpW.js";import{B as l}from"./CircularProgress-Dx35-Vjt.js";import{P as he}from"./Parameters-BwBSof8a.js";import{s as I}from"./Socket-0N_gnJcr.js";import"./index-DvSUm9pq.js";import"./OutlinedInput-DbTc8EPS.js";import"./createSvgIcon-_WZAYDUJ.js";import"./IconButton-DFxBhuCq.js";import"./index-VUr9tUh2.js";import"./Card-An9EKSDM.js";import"./Paper-DX5oR_-7.js";var q={},ue=_;Object.defineProperty(q,"__esModule",{value:!0});var U=q.default=void 0,de=ue(y()),xe=e;U=q.default=(0,de.default)((0,xe.jsx)("path",{d:"M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4"}),"Restaurant");var B={},ve=_;Object.defineProperty(B,"__esModule",{value:!0});var J=B.default=void 0,fe=ve(y()),me=e;J=B.default=(0,fe.default)((0,me.jsx)("path",{d:"M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3m12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4"}),"Hotel");var F={},ge=_;Object.defineProperty(F,"__esModule",{value:!0});var K=F.default=void 0,je=ge(y()),be=e;K=F.default=(0,je.default)((0,be.jsx)("path",{d:"m19.77 7.23.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77M12 10H6V5h6zm6 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"LocalGasStation");var G={},Se=_;Object.defineProperty(G,"__esModule",{value:!0});var Q=G.default=void 0,_e=Se(y()),ye=e;Q=G.default=(0,_e.default)((0,ye.jsx)("path",{d:"M16.22 12c.68 0 1.22-.54 1.22-1.22 0-.67-.54-1.22-1.22-1.22S15 10.11 15 10.78c0 .68.55 1.22 1.22 1.22m-9.66-1.22c0 .67.54 1.22 1.22 1.22S9 11.46 9 10.78c0-.67-.54-1.22-1.22-1.22s-1.22.55-1.22 1.22M7.61 4 6.28 8h11.43l-1.33-4zm8.67-1s.54.01.92.54c.02.02.03.04.05.07.07.11.14.24.19.4.22.65 1.56 4.68 1.56 4.68v6.5c0 .45-.35.81-.78.81h-.44c-.43 0-.78-.36-.78-.81V14H7v1.19c0 .45-.35.81-.78.81h-.44c-.43 0-.78-.36-.78-.81v-6.5S6.34 4.67 6.55 4c.05-.16.12-.28.19-.4.03-.02.04-.04.06-.06.38-.53.92-.54.92-.54zM4 17.01h16V19h-7v3h-2v-3H4z"}),"CarRepair");var N={},we=_;Object.defineProperty(N,"__esModule",{value:!0});var Y=N.default=void 0,Ve=we(y()),Me=e;Y=N.default=(0,Ve.default)((0,Me.jsx)("path",{d:"M21 5h-2.64l1.14-3.14L17.15 1l-1.46 4H3v2l2 6-2 6v2h18v-2l-2-6 2-6zm-3.9 8.63L18.89 19H5.11l1.79-5.37.21-.63-.21-.63L5.11 7h13.78l-1.79 5.37-.21.63zM13 9h-2v3H8v2h3v3h2v-3h3v-2h-3z"}),"LocalPharmacyOutlined");var T={},Le=_;Object.defineProperty(T,"__esModule",{value:!0});var Z=T.default=void 0,$e=Le(y()),He=e;Z=T.default=(0,$e.default)((0,He.jsx)("path",{d:"M8 9v1.5h2.25V15h1.5v-4.5H14V9zM6 9H3c-.55 0-1 .45-1 1v5h1.5v-1.5h2V15H7v-5c0-.55-.45-1-1-1m-.5 3h-2v-1.5h2zM21 9h-4.5c-.55 0-1 .45-1 1v5H17v-4.5h1V14h1.5v-3.51h1V15H22v-5c0-.55-.45-1-1-1"}),"AtmOutlined");const Ce=({setPlace:n,place:o})=>{const{center:c}=z(d=>d.liveMap),x=A(),u=async d=>{o===d?(x(ee([])),n("")):(n(d),x(te({center:c,clickedPlace:d})))};return e.jsxs(l,{sx:{position:"relative",top:"1vh",left:"5%",display:"flex",justifyContent:"center"},children:[e.jsx(l,{sx:{bgcolor:o==="restaurants"?m.bgColor:"white",color:o==="restaurants"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{u("restaurants")},children:e.jsxs(S,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(U,{style:{height:"17px",position:"relative",top:"1px"}}),"Restaurants"]})}),e.jsx(l,{sx:{bgcolor:o==="hotels"?m.bgColor:"white",color:o==="hotels"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{u("hotels")},children:e.jsxs(S,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(J,{style:{height:"17px",position:"relative",top:"1px"}}),"Hotels"]})}),e.jsx(l,{sx:{bgcolor:o==="hospitals"?m.bgColor:"white",color:o==="hospitals"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{u("hospitals")},children:e.jsxs(S,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(Y,{style:{height:"17px",position:"relative",top:"1px"}}),"Hospitals"]})}),e.jsx(l,{sx:{bgcolor:o==="atm"?m.bgColor:"white",color:o==="atm"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{u("atm")},children:e.jsxs(S,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(Z,{style:{height:"17px",position:"relative",top:"1px"}}),"ATMs"]})}),e.jsx(l,{sx:{bgcolor:o==="car_repair"?m.bgColor:"white",color:o==="car_repair"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{u("car_repair")},children:e.jsxs(S,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(Q,{style:{height:"17px",position:"relative",top:"1px"}}),"Service center"]})}),e.jsx(l,{sx:{bgcolor:o==="gasstation"?m.bgColor:"white",color:o==="gasstation"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{u("gasstation")},children:e.jsxs(S,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(K,{style:{height:"17px",position:"relative",top:"1px"}}),"Gas Stations"]})})]})},De=Ce;function Re({showCard:n}){const{center:o,selectedParameterList:c,selectedVehicle:x,vehicleList:u,icons:d,locationData:v,placesData:g,imeiNumbers:D,onlineVehicle:w}=z(t=>t.liveMap),[V,O]=a.useState(null),[b,M]=a.useState(""),[L,R]=a.useState([]),[f,P]=a.useState([]);A();const{isLoaded:$,loadError:s}=ne({googleMapsApiKey:"AIzaSyA_S7GfAh6rJYWQ5X4n4X-3poo3vymuspU",loadingElement:e.jsx(pe,{})});if(a.useEffect(()=>{$&&O(window.google.maps)},[$]),a.useEffect(()=>{if(v.length>0&&w.length>0){const t=[],r=[];v.forEach(i=>{w.some(H=>String(H)===String(i._id))?t.push(i):r.push(i)}),R(t),P(r)}else R([]),P([])},[v,w]),a.useEffect(()=>{console.log("onVehicles",L),console.log("offVehicles",f)},[L]),s)return"Error loading maps";if(!$)return"Loading maps";if(!V)return null;const p={height:n?"87vh":"95vh",width:"100%"};return e.jsxs(e.Fragment,{children:[n&&e.jsx(l,{sx:{bgcolor:m.bgColor,position:"relative",color:"white",display:"flex",alignItems:"center",justifyContent:"space-around",overflowX:"hidden",flexWrap:"wrap",border:"1px solid white"},children:c[0].params.length>0?e.jsxs(e.Fragment,{children:[c[0].params.length>0&&e.jsxs(E,{variant:"outlined",sx:{color:"white",border:"1px solid white",fontSize:"12px","&:hover":{border:"1px solid black",background:"white",color:"black"}},children:["Registration Id : ",c[0].reg_id]}),c.length>0&&c[0].params.map((t,r)=>(console.log("item",t),e.jsx(E,{variant:"outlined",sx:{color:"white",border:"1px solid white",mx:"5px",my:"15px",fontSize:"12px","&:hover":{border:"1px solid black",background:"white",color:"black"}},children:t.label==="speed"?`${t.label} : ${t.value} km/h`:t.label==="mainInputVoltage"?`${t.label} : ${t.value} voltage`:t.label==="ignition"?`${t.label} : ${t.value===!0?"On":"Off"}`:`${t.label} : ${t.value}`},r)))]}):e.jsx(e.Fragment,{children:e.jsx(E,{variant:"outlined",sx:{color:"white",border:"1px solid white",mx:"5px",my:"15px"},children:"No Parameters Selected"})})}),e.jsxs(ce,{mapContainerStyle:p,zoom:10,center:o,children:[Object.keys(x).length>0&&e.jsx(De,{setPlace:M,place:b}),g&&g.length>0&&g.map((t,r)=>{var i,h;return e.jsx(X,{position:{lat:parseFloat((i=t==null?void 0:t.location)==null?void 0:i.lat),lng:parseFloat((h=t==null?void 0:t.location)==null?void 0:h.lng)},animation:"BOUNCE",icon:{path:d[`${b}`],fillOpacity:2,strokeWeight:1,scale:1,fillColor:"orange"}},r)}),v&&v.length>0&&v.map((t,r)=>e.jsx(X,{position:{lat:t.latestDocument.lat,lng:t.latestDocument.lng},icon:{path:Pe.path1,fillColor:Object.keys(x).length>0&&x.imei===t.latestDocument.imei?"green":m.bgColor,fillOpacity:2,strokeWeight:1,scale:2}},r))]})]})}const Pe={path1:"M20 11c-.18 0-.36.03-.53.05L17.41 9H20V6l-3.72 1.86L13.41 5H9v2h3.59l2 2H11l-4 2-2-2H0v2h4c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4l2 2h3l3.49-6.1 1.01 1.01c-.91.73-1.5 1.84-1.5 3.09 0 2.21 1.79 4 4 4s4-1.79 4-4-1.79-4-4-4M4 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m16 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"};function Ye(){const{locationData:n,selectedVehicle:o,selectedParameterList:c}=z(s=>s.liveMap),[x,u]=a.useState([]),{w_customer_id:d}=z(s=>s.auth),[v,g]=a.useState(),[D,w]=a.useState(!1),[V,O]=a.useState(!1),[b,M]=a.useState([]),[L,R]=a.useState(!1);let f=A();a.useEffect(()=>{P()},[]),a.useEffect(()=>{M([])},[o]),a.useEffect(()=>(I.on("locationinfo",s=>{console.log("locationinfo",s);const p=n==null?void 0:n.map(t=>String(t.latestDocument.imei)===String(s==null?void 0:s.imei)?(console.log("live changes data",s),{id:s==null?void 0:s.imei,latestDocument:s}):t);if(f(se(p)),String(s==null?void 0:s.imei)===String(c[0].imei)){const t=c[0].params.map(r=>{let i=r.label;return{...r,value:s[i]}});f(W([{...c[0],params:t}]))}}),()=>{I.off("locationinfo")}),[I,n,f]);const P=async()=>{let s=[],p=[];(await f(oe({w_customer_id:d}))).payload.map(h=>{s.push({id:h.id,label:h.registration_id,value:h.imei[0].mac_id}),p.push(h.imei[0].mac_id)});const r="one",i=p;p.length>0&&f(ae({type:r,imei:i})),u(s)},$=async s=>{const{label:p,imei:t,_id:r,reg_id:i,checked:h}=s;g(j=>j.map(C=>C._id===r?{...C,checked:!h}:C));let H=[...b],k=[...b];if(!h)n.forEach(j=>{j.latestDocument.imei===t&&(H.push({label:p,value:j.latestDocument[p]}),k=H,M(H))});else{let j=b.filter(C=>C.label!==p);k=j,M(j)}console.log("tempParamList",k),f(W([{reg_id:i,imei:t,params:k}]))};return e.jsxs("div",{className:"app",children:[e.jsx(re,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(ie,{title:"Live Map",setShowVehicles:w,showVehicles:D,showParameters:V,setShowParameters:O,setShowCard:R,showCard:L}),e.jsxs(l,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(l,{style:{width:D||V?"80%":"100%"},children:e.jsx(Re,{showCard:L})}),D&&e.jsx(l,{style:{width:"20%"},children:e.jsx(le,{vehicleData:x,title:"Live Map",setParameterData:g})}),V&&e.jsx(l,{style:{width:"20%"},children:e.jsx(he,{parametersData:v,setParameterData:g,handleParameterChange:$})})]})]})]})}export{Ye as default};
