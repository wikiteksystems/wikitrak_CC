import{o as Be,p as Ve,q as M,w as ye,x as re,y as ze,z as Ge,A as He,r as x,B as qe,C as G,j as e,D as Y,E as Ue,F as be,H as Z,I as ee,J as We,K as de,L as H,M as pe,N as ke,T as E,a as L,G as Q,b as z,u as X,s as ve,_ as J,O as U,t as Te,P as Ye,Q as Je,R as Xe,S as je,i as ue,U as Ke,V as le,W as Qe,X as Ze,Y as we,Z as ne,$ as et,h as tt,k as ot,l as st,m as rt,n as lt,v as nt}from"./index-BzV_zUQW.js";import{d as at,a as it,b as ct,c as dt,L as pt}from"./LightModeOutlined-BioNP8gg.js";import{s as ae}from"./Socket-0N_gnJcr.js";import{p as ut,R as ht,L as gt,X as xt,Y as mt,a as ft,b as yt,T as bt}from"./LineChart-DPnIO4r5.js";import{u as Pe,f as De,t as q,F as vt,I as jt,O as wt,a as St}from"./theme-CRjQBU0N.js";import{B as f,C as Ie}from"./CircularProgress-woJxG7UZ.js";import{P as Ct}from"./Paper-BZz2lZ3w.js";import{c as kt,S as Tt}from"./Switch-DWF3z-Qz.js";import{c as Pt,I as Me}from"./IconButton-ZxMV7Jyu.js";import{r as Dt,m as It,a as Mt}from"./mergeSlotProps-DfZ227cB.js";import{C as Ae}from"./index-ip99LzKO.js";import{u as At,G as Lt,M as Ft}from"./esm-BERO0GS8.js";import{d as Rt}from"./Search-D564Q4l9.js";import{d as Se}from"./index-HM1-FgXG.js";import{D as _t}from"./DateTimePicker-BgogkEZ2.js";import{r as he}from"./createSvgIcon-CPsng49f.js";import{T as $t,a as Nt,d as Et,b as Ot,c as ie}from"./TableRow-DzlKGUtu.js";import{d as Bt,G as Vt}from"./GeofencAlert-CaRKClJL.js";import"./index-BS-74zSO.js";import"./roundedArrow-D5D8HQmm.js";import"./button-CFoUml1W.js";const zt=["component","direction","spacing","divider","children","className","useFlexGap"],Gt=Be(),Ht=Ve("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,o)=>o.root});function qt(t){return Ue({props:t,name:"MuiStack",defaultTheme:Gt})}function Ut(t,o){const s=x.Children.toArray(t).filter(Boolean);return s.reduce((l,m,a)=>(l.push(m),a<s.length-1&&l.push(x.cloneElement(o,{key:`separator-${a}`})),l),[])}const Wt=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],Yt=({ownerState:t,theme:o})=>{let s=M({display:"flex",flexDirection:"column"},ye({theme:o},re({values:t.direction,breakpoints:o.breakpoints.values}),l=>({flexDirection:l})));if(t.spacing){const l=ze(o),m=Object.keys(o.breakpoints.values).reduce((y,c)=>((typeof t.spacing=="object"&&t.spacing[c]!=null||typeof t.direction=="object"&&t.direction[c]!=null)&&(y[c]=!0),y),{}),a=re({values:t.direction,base:m}),p=re({values:t.spacing,base:m});typeof a=="object"&&Object.keys(a).forEach((y,c,u)=>{if(!a[y]){const v=c>0?a[u[c-1]]:"column";a[y]=v}}),s=Ge(s,ye({theme:o},p,(y,c)=>t.useFlexGap?{gap:be(l,y)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${Wt(c?a[c]:t.direction)}`]:be(l,y)}}))}return s=He(o.breakpoints,s),s};function Jt(t={}){const{createStyledComponent:o=Ht,useThemeProps:s=qt,componentName:l="MuiStack"}=t,m=()=>Z({root:["root"]},y=>ee(l,y),{}),a=o(Yt);return x.forwardRef(function(y,c){const u=s(y),h=qe(u),{component:v="div",direction:d="column",spacing:n=0,divider:w,children:C,className:T,useFlexGap:g=!1}=h,j=G(h,zt),P={direction:d,spacing:n,useFlexGap:g},S=m();return e.jsx(a,M({as:v,ownerState:P,ref:c,className:Y(S.root,T)},j,{children:w?Ut(C,w):C}))})}const Xt=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Kt=["component","slots","slotProps"],Qt=["component"];function Zt(t,o){const{className:s,elementType:l,ownerState:m,externalForwardedProps:a,getSlotOwnerState:p,internalForwardedProps:i}=o,y=G(o,Xt),{component:c,slots:u={[t]:void 0},slotProps:h={[t]:void 0}}=a,v=G(a,Kt),d=u[t]||l,n=Dt(h[t],m),w=It(M({className:s},y,{externalForwardedProps:t==="root"?v:void 0,externalSlotProps:n})),{props:{component:C},internalRef:T}=w,g=G(w.props,Qt),j=We(T,n==null?void 0:n.ref,o.ref),P=p?p(g):{},S=M({},m,P),R=t==="root"?C||c:C,F=Mt(d,M({},t==="root"&&!c&&!u[t]&&i,t!=="root"&&!u[t]&&i,g,R&&{as:R},{ref:j}),S);return Object.keys(P).forEach(I=>{delete F[I]}),[d,F]}const eo=Pt(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function to(t){return ee("MuiAvatar",t)}de("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const oo=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],so=kt(),ro=t=>{const{classes:o,variant:s,colorDefault:l}=t;return Z({root:["root",s,l&&"colorDefault"],img:["img"],fallback:["fallback"]},to,o)},lo=H("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,o[s.variant],s.colorDefault&&o.colorDefault]}})(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:M({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:M({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]})),no=H("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,o)=>o.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),ao=H(eo,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,o)=>o.fallback})({width:"75%",height:"75%"});function io({crossOrigin:t,referrerPolicy:o,src:s,srcSet:l}){const[m,a]=x.useState(!1);return x.useEffect(()=>{if(!s&&!l)return;a(!1);let p=!0;const i=new Image;return i.onload=()=>{p&&a("loaded")},i.onerror=()=>{p&&a("error")},i.crossOrigin=t,i.referrerPolicy=o,i.src=s,l&&(i.srcset=l),()=>{p=!1}},[t,o,s,l]),m}const co=x.forwardRef(function(o,s){const l=so({props:o,name:"MuiAvatar"}),{alt:m,children:a,className:p,component:i="div",slots:y={},slotProps:c={},imgProps:u,sizes:h,src:v,srcSet:d,variant:n="circular"}=l,w=G(l,oo);let C=null;const T=io(M({},u,{src:v,srcSet:d})),g=v||d,j=g&&T!=="error",P=M({},l,{colorDefault:!j,component:i,variant:n}),S=ro(P),[R,F]=Zt("img",{className:S.img,elementType:no,externalForwardedProps:{slots:y,slotProps:{img:M({},u,c.img)}},additionalProps:{alt:m,src:v,srcSet:d,sizes:h},ownerState:P});return j?C=e.jsx(R,M({},F)):a||a===0?C=a:g&&m?C=m[0]:C=e.jsx(ao,{ownerState:P,className:S.fallback}),e.jsx(lo,M({as:i,ownerState:P,className:Y(S.root,p),ref:s},w,{children:C}))}),po=co,uo=Jt({createStyledComponent:H("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,o)=>o.root}),useThemeProps:t=>pe({props:t,name:"MuiStack"})}),ho=uo;function go(t){return ee("MuiFormControlLabel",t)}const xo=de("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),W=xo,mo=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],fo=t=>{const{classes:o,disabled:s,labelPlacement:l,error:m,required:a}=t,p={root:["root",s&&"disabled",`labelPlacement${ke(l)}`,m&&"error",a&&"required"],label:["label",s&&"disabled"],asterisk:["asterisk",m&&"error"]};return Z(p,go,o)},yo=H("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[{[`& .${W.label}`]:o.label},o.root,o[`labelPlacement${ke(s.labelPlacement)}`]]}})(({theme:t,ownerState:o})=>M({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${W.disabled}`]:{cursor:"default"}},o.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},o.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},o.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${W.label}`]:{[`&.${W.disabled}`]:{color:(t.vars||t).palette.text.disabled}}})),bo=H("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(t,o)=>o.asterisk})(({theme:t})=>({[`&.${W.error}`]:{color:(t.vars||t).palette.error.main}})),vo=x.forwardRef(function(o,s){var l,m;const a=pe({props:o,name:"MuiFormControlLabel"}),{className:p,componentsProps:i={},control:y,disabled:c,disableTypography:u,label:h,labelPlacement:v="end",required:d,slotProps:n={}}=a,w=G(a,mo),C=Pe(),T=(l=c??y.props.disabled)!=null?l:C==null?void 0:C.disabled,g=d??y.props.required,j={disabled:T,required:g};["checked","name","onChange","value","inputRef"].forEach(D=>{typeof y.props[D]>"u"&&typeof a[D]<"u"&&(j[D]=a[D])});const P=De({props:a,muiFormControl:C,states:["error"]}),S=M({},a,{disabled:T,labelPlacement:v,required:g,error:P.error}),R=fo(S),F=(m=n.typography)!=null?m:i.typography;let I=h;return I!=null&&I.type!==E&&!u&&(I=e.jsx(E,M({component:"span"},F,{className:Y(R.label,F==null?void 0:F.className),children:I}))),e.jsxs(yo,M({className:Y(R.root,p),ownerState:S,ref:s},w,{children:[x.cloneElement(y,j),g?e.jsxs(ho,{display:"block",children:[I,e.jsxs(bo,{ownerState:S,"aria-hidden":!0,className:R.asterisk,children:["â€‰","*"]})]}):I]}))}),jo=vo;function wo(t){return ee("MuiFormGroup",t)}de("MuiFormGroup",["root","row","error"]);const So=["className","row"],Co=t=>{const{classes:o,row:s,error:l}=t;return Z({root:["root",s&&"row",l&&"error"]},wo,o)},ko=H("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,s.row&&o.row]}})(({ownerState:t})=>M({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})),To=x.forwardRef(function(o,s){const l=pe({props:o,name:"MuiFormGroup"}),{className:m,row:a=!1}=l,p=G(l,So),i=Pe(),y=De({props:l,muiFormControl:i,states:["error"]}),c=M({},l,{row:a,error:y.error}),u=Co(c);return e.jsx(ko,M({className:Y(u.root,m),ownerState:c,ref:s},p))}),Po=To,Do=({imeiNo:t})=>{const{selectedVehicle:o,parameterData:s,ivnPid:l,locationData:m,vehicleList:a,onlineVehicle:p}=L(g=>g.liveMap),{ivnParameters:i,mode:y}=L(g=>g.dashboard),c=q(y),[u,h]=x.useState(),[v,d]=x.useState(!1),[n,w]=x.useState();x.useState({mainInputVoltage:0,ignition:0,speed:0}),x.useEffect(()=>{C()},[o]);const C=()=>{var g,j,P;if(m.length>0){let S=m.find(R=>R.latestDocument.imei===o.imei);S?(h((g=S==null?void 0:S.latestDocument)==null?void 0:g.speed),d((j=S==null?void 0:S.latestDocument)==null?void 0:j.ignition),w((P=S==null?void 0:S.latestDocument)==null?void 0:P.mainInputVoltage)):(h(0),d(0),w(0))}else h(0),d(0),w(0)},T=()=>{console.log("onlineVehicle",p),console.log("imeiNo",t);let g=0;return p.length>0&&p.forEach(j=>{t!=null&&t.includes(String(j))&&g++}),console.log("count",g),g};return e.jsxs(e.Fragment,{children:[e.jsx(f,{sx:{mx:"10px",pt:"10px",color:c.grey[400]},children:e.jsx("b",{children:o==null?void 0:o.reg_id})}),e.jsx(f,{sx:{backgroundColor:c.grey[200],height:"12vh",borderRadius:"8px",p:"5px"},children:e.jsx(f,{sx:{},children:e.jsx(Q,{container:!0,spacing:3,mt:"2.5px",children:e.jsx(Q,{item:!0,xs:12,children:e.jsx(Q,{container:!0,justifyContent:"space-around",spacing:3,children:[{label:"Online/Offline Vehicles",value:`${T()} / ${a.length-T()}`},{label:"Speed",value:u,unit:"km/h"},{label:"Main Input Voltage",value:parseFloat(n).toFixed(2),unit:"voltage"},{label:"Ignition",value:v?"on":"off"}].map((g,j)=>e.jsx(Q,{item:!0,children:e.jsxs(Ct,{sx:{height:70,width:250,backgroundColor:c.grey[100],color:c.grey[400],display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 10px"},children:[e.jsxs(f,{children:[e.jsx(E,{variant:"h6",sx:{fontSize:"12px"},children:g.label}),e.jsxs(E,{variant:"h6",sx:{fontSize:"18px",fontWeight:"bold"},children:[g.value," ",g==null?void 0:g.unit]})]}),e.jsx(po,{src:ut,sx:{width:20,height:20}})]})},j))})})})})})]})},ce=({title:t,selectedTripData:o})=>{const{mode:s,loading:l}=L(c=>c.dashboard),{selectedVehicle:m}=L(c=>c.liveMap),[a,p]=x.useState([]);x.useEffect(()=>{let c=o.map(h=>{let v={...h};return v.ignition=v.ignition?1:0,v});const u=y(c);p(u)},[o]);const i=q(s),y=c=>{let u=null;return c.forEach(h=>{const v=new Date(h.createdAt);u&&u.toDateString()===v.toDateString()?(h.date=z(h.createdAt).format("HH:mm:ss"),h.ignition=h.ignition?1:0):(h.date=z(h.createdAt).format("DD-MM-YYYY"),h.ignition=h.ignition?1:0),u=v}),c};return e.jsx(f,{sx:{ml:"2rem",border:i.grey[300],fontSize:"13px",height:"24vh",color:i.grey[400],backgroundColor:i.grey[100],borderRadius:"5px"},children:a&&a.length>0?e.jsx(ht,{children:e.jsxs(gt,{data:a,margin:{top:15,right:10,left:-25,bottom:0},children:[e.jsx(xt,{dataKey:"date",stroke:i.grey[400]}),e.jsx(mt,{stroke:i.grey[400]}),e.jsx(ft,{type:"monotone",dataKey:t,dot:!1,stroke:"#EF5B05",strokeWidth:2}),e.jsx(yt,{layout:"horizontal",verticalAlign:"top",align:"center"}),e.jsx(bt,{})]})}):e.jsx(Ae,{style:{background:i.grey[100],width:"400px",height:"100px",margin:"auto",marginTop:"10px"},children:Object.keys(m).length===0?e.jsx(E,{textAlign:"center",align:"center",mt:"20px",color:i.grey[600],children:"Please Select a Vehicle"}):l?e.jsx(Ie,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(E,{textAlign:"center",color:i.grey[600],children:"Sorry! No Trips Available"})})})},Io=()=>{const t=X(),{center:o,selectedParameterList:s,selectedVehicle:l,vehicleList:m,tractorIcon:a,icons:p,locationData:i,ivnPid:y,placesData:c}=L(D=>D.liveMap),{mode:u}=L(D=>D.dashboard),{isLoaded:h,loadError:v}=At({googleMapsApiKey:"AIzaSyA_S7GfAh6rJYWQ5X4n4X-3poo3vymuspU"}),[d,n]=x.useState(null),[w,C]=x.useState(!0),[T,g]=x.useState(5),[j,P]=x.useState(),S=q(u);x.useEffect(()=>{if(w)P(i);else{let D=i==null?void 0:i.filter(_=>(_==null?void 0:_._id)===(l==null?void 0:l.imei));P(D)}},[i,l,w]);const R=()=>{if(!w)t(ve({lat:21,lng:78})),g(4),C(_=>!_);else{const D=i.find(_=>_.latestDocument.imei===l.imei);if(D){console.log(D.latestDocument,"getCenter");const{lat:_,lng:te}=D.latestDocument;t(ve({lat:_,lng:te})),g(12),C(oe=>!oe)}else J.error("Data is not available for selected vehicle")}};if(x.useEffect(()=>{h&&n(window.google.maps)},[h,i]),v)return"Error loading maps";if(!h)return"Loading maps";const F={height:"41.5vh",width:"99%",marginTop:"0px",marginLeft:"10px"},I=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}];return d?e.jsxs("div",{children:[e.jsxs(f,{sx:{ml:"10px",fontSize:"20px",display:"flex",justifyContent:"space-between",color:S.grey[400]},children:[e.jsx("b",{children:"Live Map"}),e.jsx(Po,{sx:{marginLeft:0,paddingTop:0,color:S.grey[400]},children:e.jsx(jo,{control:e.jsx(Tt,{checked:w,onChange:R}),label:w?"Group":"Individual"})})]}),e.jsx(Lt,{mapContainerStyle:F,zoom:T,center:o,options:{mapTypeControl:!1,styles:u?I:""},children:j&&j.length>0&&j.map((D,_)=>e.jsx(Ft,{position:{lat:D.latestDocument.lat,lng:D.latestDocument.lng},icon:{fillColor:"red",fillOpacity:2,strokeWeight:1,scale:2}},_))})]}):null},Mo=({vehicleData:t})=>{const o=["Engine RPM","Engine coolant temperature","Battery Potential"],s=X(),{selectedVehicle:l}=L(d=>d.liveMap),{startDate:m,endDate:a,mode:p}=L(d=>d.dashboard),[i,y]=x.useState(""),c=q(p),u=t.length>0&&t.filter(d=>d.label.toLowerCase().includes(i.toLowerCase())),h=d=>{y(d.target.value)},v=async d=>{var g;s(Ye({imei:d.value,reg_id:d.label}));let n={imei:d.value,startDate:Se().subtract(5,"day"),endDate:Se()};s(Je(n));let w=d.label;const C=await s(Xe({registration_id:w}));let T=[];if(C&&C.payload.length>0&&((g=C.payload)==null||g.map(j=>{j.ivn_parameter.length>0&&T.push(j.ivn_parameter[0])})),T.length>0){let j=T.filter(P=>o.includes(P.pid_description));s(je(j))}else s(je([]))};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(f,{sx:{align:"center",my:"15px",ml:"20px"},children:e.jsxs(vt,{sx:{width:"90%",backgroundColor:"white",borderRadius:"5px"},variant:"outlined",children:[e.jsx(jt,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px"},children:"Search"}),e.jsx(wt,{onChange:d=>h(d),inputProps:{style:{padding:7}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(St,{position:"end",children:e.jsx(Me,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Rt,{})})}),label:"Search"})]})}),u.length>0&&u.map((d,n)=>e.jsx(f,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(U,{variant:"outlined",onClick:()=>{v(d)},sx:{width:"90%",bgcolor:d.label===l.reg_id?Te.bgColor:"undefined",color:d.label===l.reg_id?"#DAE0EE":c.grey[400]},children:d.label})},n))]})})};var ge={},Ao=ue;Object.defineProperty(ge,"__esModule",{value:!0});var Le=ge.default=void 0,Lo=Ao(he()),Fo=e;Le=ge.default=(0,Lo.default)((0,Fo.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined");var xe={},Ro=ue;Object.defineProperty(xe,"__esModule",{value:!0});var Fe=xe.default=void 0,_o=Ro(he()),$o=e;Fe=xe.default=(0,_o.default)((0,$o.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined");var me={},No=ue;Object.defineProperty(me,"__esModule",{value:!0});var Re=me.default=void 0,Eo=No(he()),Ce=e;Re=me.default=(0,Eo.default)([(0,Ce.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,Ce.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");const Oo=()=>{const t=X(),o=Ke(),{tripList:s,selectedTripData:l,loading:m,trips:a,activeIndex:p,searchText:i,mode:y}=L(r=>r.dashboard),{selectedVehicle:c}=L(r=>r.liveMap),[u,h]=x.useState(0),[v,d]=x.useState(0),[n,w]=x.useState(0),[C,T]=x.useState(0),[g,j]=x.useState("0"),[P,S]=x.useState(0),[R,F]=x.useState(!1),I=q(y),D=()=>{h(r=>r+3)},_=()=>{h(r=>Math.max(r-5,0))};x.useEffect(()=>{const r=te(s);if(r.length>0){t(le(r[0]));const b=s&&s.length>0&&s.filter(k=>k.formatedDate.toLowerCase().includes(i.toLowerCase()));b.length>0&&se(0,b[0])}t(Qe(r))},[s]),x.useEffect(()=>{if(l.length>0){const r=l.map(k=>({lat:parseFloat(k.lat),lng:parseFloat(k.lng)})),b=new window.google.maps.Polygon({paths:r});fe(b)}},[l]);const te=r=>{const b=new Set,k=[];return r.forEach(A=>{b.has(A.formatedDate)||(b.add(A.formatedDate),k.push(A.formatedDate))}),k},O=s&&s.length>0&&s.filter(r=>r.formatedDate.toLowerCase().includes(i.toLowerCase())),oe=r=>{if(O&&O.length>0){const b=s&&s.length>0&&s.filter(k=>k.formatedDate.toLowerCase().includes(r.toLowerCase()));t(ne(0)),t(le(r)),se(0,b[0])}else t(ne(null)),t(le(r))},se=async(r,b)=>{var $;console.log("item",b);let k={imei:c.imei,startDate:b.startDate,endDate:b.endDate};F(!0);const A=await Ze(k);(($=A==null?void 0:A.data)==null?void 0:$.documents.length)>0?(t(we(A.data.documents[0].data)),_e(A.data.documents[0].data),F(!1)):(T(0),w(0),S(0),d(0),j("0"),t(we([])),F(!1)),t(ne(r))},_e=r=>{let b=0,k=0;r.map((N,K)=>{N.packetType==="HB"&&b++,N.packetType==="HA"&&k++}),d(b),w(k);let A=$e(new Date(r[0].createdAt).toISOString(),new Date(r[r.length-1].createdAt).toISOString());console.log("hours: ",A),j(A);const $=Ne(r);S($);const B=r.map(N=>({lat:parseFloat(N.lat),lng:parseFloat(N.lng)})),V=new window.google.maps.Polygon({paths:B});fe(V)};function $e(r,b){var k=z(r),A=z(b);console.log("startDate-------->",r,b);let $=z.duration(A.diff(k)),B=$.hours(),V=$.minutes(),N=$.seconds(),K=`${B}h ${V}m ${N}s`;return console.log("string",K),K}function Ne(r){let b=0;for(let k=0;k<r.length-1;k++){const A=r[k].lat,$=r[k].lng,B=r[k+1].lat,V=r[k+1].lng;b+=Ee(A,$,B,V)}return b}function Ee(r,b,k,A){const B=(k-r)*Math.PI/180,V=(A-b)*Math.PI/180,N=Math.sin(B/2)*Math.sin(B/2)+Math.cos(r*Math.PI/180)*Math.cos(k*Math.PI/180)*Math.sin(V/2)*Math.sin(V/2);return 6371*(2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N)))}const fe=r=>{if(!window.google||!window.google.maps.geometry){console.log("not loaded");return}const k=window.google.maps.geometry.spherical.computeArea(r.getPath())/4046.86;T(k)},Oe=r=>{p!==null?r===p?o("/trip-monitor"):J.error("Trip not selected"):J.error("Please select the trip")};return e.jsxs(e.Fragment,{children:[e.jsxs(f,{sx:{width:"95%",display:"flex",overflow:"auto",mx:"10px"},children:[e.jsx("div",{style:{display:"flex"},children:a&&a.length>0&&a.slice(u,u+5).map((r,b)=>e.jsx(f,{sx:{backgroundColor:i===r?"#EF5B05":"white",color:i===r?"white":"#EF5B05",mx:"5px",p:"5px",borderRadius:"5px",width:"90px",height:"25px",textAlign:"center",cursor:"pointer"},onClick:()=>{oe(r)},children:r},b))}),u!==0&&e.jsx("button",{onClick:_,style:{marginLeft:"5px",backgroundColor:"white",color:"black"},disabled:u===0,children:e.jsx(Fe,{})}),!(u+5>=a.length)&&e.jsx("button",{onClick:D,style:{marginLeft:"5px",backgroundColor:"white",color:"black"},disabled:u+5>=a.length,children:e.jsx(Le,{})})]}),e.jsx(f,{children:O&&O.length>0?e.jsx($t,{sx:{maxHeight:210,height:210,width:"98%",ml:"10px",mt:"10px",borderRadius:"5px",border:"1px solid #dbdad5"},children:e.jsx(Nt,{stickyHeader:!0,"aria-label":"sticky table",children:e.jsx(Et,{children:O&&O.length>0&&O.map((r,b)=>e.jsxs(Ot,{sx:{backgroundColor:p===b?"#DAE0EE":I.grey[100]},children:[e.jsxs(ie,{align:"left",style:{fontSize:"12px",padding:10,color:p===b?"black":I.grey[400],cursor:"pointer"},onClick:()=>{se(b,r)},children:[b+1,". ",r.startLocation," to ",r.endLocation]}),e.jsxs(ie,{align:"right",style:{fontSize:"12px",padding:10,color:p===b?"black":I.grey[400]},children:[r!=null&&r.startDate?z(new Date(r.startDate).toISOString()).format("LT"):""," ","to"," ",r!=null&&r.endDate?z(new Date(r.endDate).toISOString()).format("LT"):"----"]}),e.jsx(ie,{align:"right",style:{fontSize:"12px",padding:10,color:p===b?"black":I.grey[400]},children:e.jsx("span",{title:"Navigate to map",style:{cursor:"pointer"},onClick:()=>{Oe(b)},children:e.jsx(Re,{})})})]}))})})}):e.jsx(f,{sx:{height:210,display:"flex",justifyContent:"center",alignItems:"center",color:I.grey[400],margin:"auto"},children:e.jsx(Ae,{style:{background:I.grey[100],width:"400px",height:"100px"},children:Object.keys(c).length===0?e.jsx(E,{textAlign:"center",align:"center",mt:"20px",color:I.grey[600],children:"Please Select a Vehicle"}):m?e.jsx(Ie,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(E,{textAlign:"center",color:I.grey[600],children:"Sorry! No Trips Available"})})})}),l.length>0&&e.jsx(f,{sx:{my:"0px"},children:e.jsxs(f,{sx:{display:"flex",mx:"5px",mt:"5px"},children:[e.jsxs(f,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Braking"}),e.jsx("div",{children:"0"})]}),e.jsxs(f,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Acceleration"}),e.jsx("div",{children:"0"})]}),e.jsxs(f,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Running Hrs"}),e.jsx("div",{children:g})]}),e.jsxs(f,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Distance"}),e.jsx("div",{children:parseFloat(parseFloat(P).toFixed(2))})]})]})})]})},Bo=()=>{const{mode:t}=L(s=>s.dashboard),o=q(t);return e.jsxs(f,{children:[e.jsxs(f,{sx:{display:"flex",ml:"5px"},children:[e.jsx(f,{sx:{m:"5px",fontSize:"20px",width:"60%",color:o.grey[400]},children:e.jsx("b",{children:"Trip History"})}),e.jsx(f,{children:e.jsx(_t,{})})]}),e.jsx(f,{sx:{my:"5px"},children:e.jsx(Oo,{})})]})},Vo=({title:t,setShowVehicles:o,showVehicles:s,setShowNotification:l,showNotification:m})=>{JSON.parse(localStorage.getItem("w_userDetails"));const a=X(),{collapsed:p}=L(v=>v.auth),{selectedVehicle:i,tractorIcon:y}=L(v=>v.liveMap),{mode:c}=L(v=>v.dashboard),u=()=>{console.log("clicked"),a(tt(!p))},h={fontSize:"26px",fontWeight:500,lineHeight:"18.38px",color:"#fff",textAlign:"center",paddingTop:"11px"};return e.jsxs(f,{style:{display:"flex",justifyContent:"space-between",paddingRight:"20px",backgroundColor:Te.bgColor,alignItems:"center",textAlign:"center",height:"60px",color:"white"},children:[e.jsxs(f,{style:{display:"flex",justifyContent:"space-between",gap:"10px"},children:[p?e.jsx(U,{onClick:u,sx:{color:"white"},children:e.jsx(at,{style:{width:"30px",height:"30px"}})}):e.jsx(U,{onClick:u,sx:{color:"white"},children:e.jsx(it,{style:{width:"30px",height:"30px"}})}),e.jsx(E,{style:h,children:t})]}),e.jsxs(f,{style:{display:"flex",gap:"5px",alignItems:"center"},children:[e.jsxs(U,{variant:"outlined",size:"small",sx:{color:s?"white":"black",backgroundColor:s?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{o(!s),t==="Live Map"&&setShowParameters(!1),t==="Trip Monitor"&&setSideBarTrip(!1),t==="Parameter Monitor"&&setShowParameters(!1),t==="Dashboard"&&l(!1)},children:[e.jsx("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",style:{marginRight:"5px"},children:e.jsx("path",{d:y.path1})}),Object.keys(i).length>0?i.reg_id:"Vehicles"]}),e.jsx(f,{children:e.jsx(U,{onClick:()=>{console.log("clicked"),o(!1),l(!m)},children:e.jsx(Bt,{sx:{cursor:"pointer",color:"white"}})})}),e.jsx(Me,{onClick:()=>{a(et(!c))},sx:{color:"white"},children:c?e.jsx(ct,{}):e.jsx(dt,{})})]})]})},ds=()=>{const{w_customer_id:t}=L(n=>n.auth),{mode:o,selectedTripData:s}=L(n=>n.dashboard),[l,m]=x.useState(()=>{const n=sessionStorage.getItem("imeiNo");return n?JSON.parse(n):[]}),a=X(),p=q(o),[i,y]=x.useState([]),[c,u]=x.useState(!1),[h,v]=x.useState(!1);x.useEffect(()=>{d()},[]),x.useEffect(()=>{sessionStorage.setItem("imeiNo",JSON.stringify(l))},[l]),x.useEffect(()=>{ae.on("geofenceAlert",n=>{(n==null?void 0:n.imei)!==null&&l.find(T=>parseInt(T)===(n==null?void 0:n.imei))&&(console.log("geofence"),J.error(`Type: ${n==null?void 0:n.type} ${n==null?void 0:n.msg} ${n==null?void 0:n.imei}`,{id:"geofence",autoClose:5e3}))}),ae.on("speedAlert",n=>{(n==null?void 0:n.imei)!==null&&l.find(T=>parseInt(T)===(n==null?void 0:n.imei))&&J.error(`${n==null?void 0:n.msg} ${n==null?void 0:n.imei}`,{id:"speed",autoClose:5e3})})},[ae]);const d=async()=>{let n=[],w=[];(await a(ot({w_customer_id:t}))).payload.map(j=>{var P,S;n.push({id:j.id,label:j.registration_id,value:(P=j.imei[0])==null?void 0:P.mac_id}),w.push((S=j.imei[0])==null?void 0:S.mac_id)}),m(w);const T="one",g=w;w.length>0&&(a(st({type:T,imei:g})),a(rt(g))),y(n),a(lt({w_customer_id:t})),a(nt({}))};return e.jsxs("div",{className:"app",children:[e.jsx(pt,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(Vo,{title:"Dashboard",showVehicles:c,setShowVehicles:u,setShowNotification:v,showNotification:h}),e.jsxs("div",{style:{height:"92vh",backgroundColor:p.grey[100],padding:"10px"},children:[c&&e.jsx(f,{sx:{position:"fixed",width:"250px",right:"0px",height:"90vh",zIndex:9999,backgroundColor:p.grey[100]},children:e.jsx(Mo,{vehicleData:i})}),h&&e.jsx(f,{sx:{position:"fixed",width:"300px",right:"0px",height:"90vh",zIndex:9999,backgroundColor:p.grey[100]},children:e.jsx(Vt,{})}),e.jsx(f,{sx:{height:"21%"},children:e.jsx(Do,{imeiNo:l})}),e.jsxs(f,{sx:{display:"flex",height:"50%"},children:[e.jsx(f,{sx:{width:"50%",border:"1px solid #E8E8E8",padding:"2px",borderRadius:"5px"},children:e.jsx(Bo,{})}),e.jsx(f,{sx:{width:"50%"},children:e.jsx(Io,{})})]}),e.jsxs(f,{sx:{display:"flex",height:"30%",mt:"5px",pt:"10px"},children:[e.jsx(f,{style:{width:"33%"},children:e.jsx(ce,{title:"speed",selectedTripData:s})}),e.jsx(f,{style:{width:"33%"},children:e.jsx(ce,{title:"mainInputVoltage",selectedTripData:s})}),e.jsx(f,{style:{width:"33%"},children:e.jsx(ce,{title:"ignition",selectedTripData:s})})]})]})]})]})};export{ds as default};
