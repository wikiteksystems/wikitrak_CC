import{o as Oe,p as Ve,q as R,w as fe,x as Q,y as Ge,z as He,A as qe,r as m,B as We,C as ne,j as e,D as Y,E as Ue,F as ye,H as ae,I as ie,J,K as ce,L as ke,M as Te,T as A,a as L,G,b as O,u as W,s as be,_ as q,N as De,t as Pe,O as Ye,P as Je,Q as Xe,R as je,i as de,S as Ke,U as Z,V as Qe,W as Ze,X as ve,Y as ee,Z as et,h as tt,k as st,l as ot,m as rt,n as lt,v as nt}from"./index-yugurC9t.js";import{d as at,a as it,L as ct}from"./Close-DrXt86Pf.js";import{s as te}from"./Socket-0N_gnJcr.js";import{p as se,R as dt,L as pt,X as ht,Y as ut,a as xt,b as gt,T as mt}from"./LineChart-Ca3kKcLD.js";import{u as Le,f as Me,t as V,F as ft,I as yt,O as bt,a as jt}from"./theme-cmKXW1hM.js";import{B as n,C as we}from"./CircularProgress-WSXXCLok.js";import{P as oe}from"./Paper-D1mpFTxs.js";import{u as vt,G as wt,M as Ct}from"./esm-CMR_PjuD.js";import{S as St}from"./Switch-B65KS5zr.js";import{d as kt,j as Tt,a as Dt,b as Pt}from"./DarkModeOutlined-CbmsTPc4.js";import{d as Ce}from"./index-DYQOJyvn.js";import{I as Ie}from"./IconButton-CU2xPpj8.js";import{D as Lt}from"./DateTimePicker-Cd7ijIpQ.js";import{r as pe}from"./createSvgIcon-DLvEd_Av.js";import{T as Mt,a as It,d as Ft,b as _t,c as re}from"./TableRow-DiLmpdH5.js";import"./index-ChsJDlFP.js";import"./createSvgIcon-F-AoYie0.js";import"./roundedArrow-BUXjTHqW.js";import"./button-Rukvm4cj.js";const At=["component","direction","spacing","divider","children","className","useFlexGap"],Rt=Oe(),$t=Ve("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,l)=>l.root});function Nt(t){return Ue({props:t,name:"MuiStack",defaultTheme:Rt})}function Et(t,l){const o=m.Children.toArray(t).filter(Boolean);return o.reduce((i,b,a)=>(i.push(b),a<o.length-1&&i.push(m.cloneElement(l,{key:`separator-${a}`})),i),[])}const Bt=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],zt=({ownerState:t,theme:l})=>{let o=R({display:"flex",flexDirection:"column"},fe({theme:l},Q({values:t.direction,breakpoints:l.breakpoints.values}),i=>({flexDirection:i})));if(t.spacing){const i=Ge(l),b=Object.keys(l.breakpoints.values).reduce((d,c)=>((typeof t.spacing=="object"&&t.spacing[c]!=null||typeof t.direction=="object"&&t.direction[c]!=null)&&(d[c]=!0),d),{}),a=Q({values:t.direction,base:b}),h=Q({values:t.spacing,base:b});typeof a=="object"&&Object.keys(a).forEach((d,c,g)=>{if(!a[d]){const r=c>0?a[g[c-1]]:"column";a[d]=r}}),o=He(o,fe({theme:l},h,(d,c)=>t.useFlexGap?{gap:ye(i,d)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${Bt(c?a[c]:t.direction)}`]:ye(i,d)}}))}return o=qe(l.breakpoints,o),o};function Ot(t={}){const{createStyledComponent:l=$t,useThemeProps:o=Nt,componentName:i="MuiStack"}=t,b=()=>ae({root:["root"]},d=>ie(i,d),{}),a=l(zt);return m.forwardRef(function(d,c){const g=o(d),k=We(g),{component:r="div",direction:p="column",spacing:v=0,divider:j,children:w,className:f,useFlexGap:T=!1}=k,D=ne(k,At),_={direction:p,spacing:v,useFlexGap:T},I=b();return e.jsx(a,R({as:r,ownerState:_,ref:c,className:Y(I.root,f)},D,{children:j?Et(w,j):w}))})}const Vt=Ot({createStyledComponent:J("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,l)=>l.root}),useThemeProps:t=>ce({props:t,name:"MuiStack"})}),Gt=Vt;function Ht(t){return ie("MuiFormControlLabel",t)}const qt=ke("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),H=qt,Wt=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],Ut=t=>{const{classes:l,disabled:o,labelPlacement:i,error:b,required:a}=t,h={root:["root",o&&"disabled",`labelPlacement${Te(i)}`,b&&"error",a&&"required"],label:["label",o&&"disabled"],asterisk:["asterisk",b&&"error"]};return ae(h,Ht,l)},Yt=J("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,l)=>{const{ownerState:o}=t;return[{[`& .${H.label}`]:l.label},l.root,l[`labelPlacement${Te(o.labelPlacement)}`]]}})(({theme:t,ownerState:l})=>R({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${H.disabled}`]:{cursor:"default"}},l.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},l.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},l.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${H.label}`]:{[`&.${H.disabled}`]:{color:(t.vars||t).palette.text.disabled}}})),Jt=J("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(t,l)=>l.asterisk})(({theme:t})=>({[`&.${H.error}`]:{color:(t.vars||t).palette.error.main}})),Xt=m.forwardRef(function(l,o){var i,b;const a=ce({props:l,name:"MuiFormControlLabel"}),{className:h,componentsProps:x={},control:d,disabled:c,disableTypography:g,label:k,labelPlacement:r="end",required:p,slotProps:v={}}=a,j=ne(a,Wt),w=Le(),f=(i=c??d.props.disabled)!=null?i:w==null?void 0:w.disabled,T=p??d.props.required,D={disabled:f,required:T};["checked","name","onChange","value","inputRef"].forEach($=>{typeof d.props[$]>"u"&&typeof a[$]<"u"&&(D[$]=a[$])});const _=Me({props:a,muiFormControl:w,states:["error"]}),I=R({},a,{disabled:f,labelPlacement:r,required:T,error:_.error}),B=Ut(I),S=(b=v.typography)!=null?b:x.typography;let C=k;return C!=null&&C.type!==A&&!g&&(C=e.jsx(A,R({component:"span"},S,{className:Y(B.label,S==null?void 0:S.className),children:C}))),e.jsxs(Yt,R({className:Y(B.root,h),ownerState:I,ref:o},j,{children:[m.cloneElement(d,D),T?e.jsxs(Gt,{display:"block",children:[C,e.jsxs(Jt,{ownerState:I,"aria-hidden":!0,className:B.asterisk,children:["â€‰","*"]})]}):C]}))}),Kt=Xt;function Qt(t){return ie("MuiFormGroup",t)}ke("MuiFormGroup",["root","row","error"]);const Zt=["className","row"],es=t=>{const{classes:l,row:o,error:i}=t;return ae({root:["root",o&&"row",i&&"error"]},Qt,l)},ts=J("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,l)=>{const{ownerState:o}=t;return[l.root,o.row&&l.row]}})(({ownerState:t})=>R({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})),ss=m.forwardRef(function(l,o){const i=ce({props:l,name:"MuiFormGroup"}),{className:b,row:a=!1}=i,h=ne(i,Zt),x=Le(),d=Me({props:i,muiFormControl:x,states:["error"]}),c=R({},i,{row:a,error:d.error}),g=es(c);return e.jsx(ts,R({className:Y(g.root,b),ownerState:c,ref:o},h))}),os=ss,rs=()=>{const{selectedVehicle:t,parameterData:l,ivnPid:o,locationData:i}=L(v=>v.liveMap),{ivnParameters:b,mode:a}=L(v=>v.dashboard),h=V(a),[x,d]=m.useState(),[c,g]=m.useState(!1),[k,r]=m.useState();m.useState({mainInputVoltage:0,ignition:0,speed:0}),m.useEffect(()=>{p()},[t]);const p=()=>{var v,j,w;if(i.length>0){let f=i.find(T=>T.latestDocument.imei===t.imei);f?(d((v=f==null?void 0:f.latestDocument)==null?void 0:v.speed),g((j=f==null?void 0:f.latestDocument)==null?void 0:j.ignition),r((w=f==null?void 0:f.latestDocument)==null?void 0:w.mainInputVoltage)):(d(0),g(0),r(0))}else d(0),g(0),r(0)};return e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{mx:"10px",pt:"10px",color:h.grey[400]},children:e.jsx("b",{children:t==null?void 0:t.reg_id})}),e.jsx(n,{sx:{backgroundColor:h.grey[200],height:"12vh",borderRadius:"8px",m:"10px",width:"100%",p:"5px"},children:e.jsxs(n,{children:[e.jsx(n,{}),e.jsx(G,{sx:{flexGrow:1},container:!0,spacing:0,children:e.jsx(G,{item:!0,xs:12,children:e.jsxs(G,{container:!0,justifyContent:"left",spacing:9,children:[e.jsx(G,{item:!0,children:e.jsx(oe,{sx:{height:70,width:250,top:12,position:"relative",backgroundColor:h.grey[100],color:h.grey[400]},children:e.jsx(n,{children:e.jsxs(n,{sx:{display:"flex"},children:[e.jsxs(n,{sx:{ml:"1rem",mt:"1rem",width:"70%"},children:[e.jsx(A,{variant:"h6",sx:{fontSize:"12px"},children:"Speed"}),e.jsx(A,{variant:"h6",sx:{fontSize:"18px",fontWeight:"bold"},children:parseFloat(parseFloat(x).toFixed(2))})]}),e.jsx(n,{sx:{m:1},children:e.jsx("img",{src:se})})]})})})}),e.jsx(G,{item:!0,children:e.jsx(oe,{sx:{height:70,width:250,top:12,position:"relative",backgroundColor:h.grey[100],color:h.grey[400]},children:e.jsx(n,{children:e.jsxs(n,{sx:{display:"flex"},children:[e.jsxs(n,{sx:{ml:"1rem",mt:"1rem",width:"70%"},children:[e.jsx(A,{variant:"h6",sx:{fontSize:"12px"},children:"Main Input Voltage"}),e.jsx(A,{variant:"h6",sx:{fontSize:"18px",fontWeight:"bold"},children:parseFloat(parseFloat(k).toFixed(2))})]}),e.jsx(n,{sx:{m:1},children:e.jsx("img",{src:se})})]})})})}),e.jsx(G,{item:!0,children:e.jsx(oe,{sx:{height:70,width:250,top:12,position:"relative",backgroundColor:h.grey[100],color:h.grey[400]},children:e.jsx(n,{children:e.jsxs(n,{sx:{display:"flex"},children:[e.jsxs(n,{sx:{ml:"1rem",mt:"1rem",width:"70%"},children:[e.jsx(A,{variant:"h6",sx:{fontSize:"12px"},children:"Ignition"}),e.jsx(A,{variant:"h6",sx:{fontSize:"18px",fontWeight:"bold"},children:c?"on":"off"})]}),e.jsx(n,{sx:{m:1},children:e.jsx("img",{src:se})})]})})})})]})})})]})})]})},le=({title:t,selectedTripData:l})=>{const{mode:o}=L(x=>x.dashboard),[i,b]=m.useState([]);m.useEffect(()=>{let x=l.map(c=>{let g={...c};return g.ignition=g.ignition?1:0,g});const d=h(x);b(d)},[l]);const a=V(o),h=x=>{let d=null;return x.forEach(c=>{const g=new Date(c.createdAt);d&&d.toDateString()===g.toDateString()?(c.date=O(c.createdAt).format("HH:mm:ss"),c.ignition=c.ignition?1:0):(c.date=O(c.createdAt).format("DD-MM-YYYY"),c.ignition=c.ignition?1:0),d=g}),x};return e.jsx(n,{sx:{ml:"2rem",border:a.grey[300],fontSize:"13px",height:"24vh",color:a.grey[400],backgroundColor:a.grey[100],borderRadius:"5px"},children:i&&i.length>0?e.jsx(dt,{children:e.jsxs(pt,{data:i,margin:{top:15,right:10,left:-25,bottom:0},children:[e.jsx(ht,{dataKey:"date",stroke:a.grey[400]}),e.jsx(ut,{stroke:a.grey[400]}),e.jsx(xt,{type:"monotone",dataKey:t,dot:!1,stroke:"#EF5B05",strokeWidth:2}),e.jsx(gt,{layout:"horizontal",verticalAlign:"top",align:"center"}),e.jsx(mt,{})]})}):e.jsx("h2",{style:{color:a.grey[400],textAlign:"center",position:"relative",top:"30%"},children:" No data available "})})},ls=()=>{const t=W(),{center:l,selectedParameterList:o,selectedVehicle:i,vehicleList:b,tractorIcon:a,icons:h,locationData:x,ivnPid:d,placesData:c}=L(S=>S.liveMap),{mode:g}=L(S=>S.dashboard),{isLoaded:k,loadError:r}=vt({googleMapsApiKey:"AIzaSyA_S7GfAh6rJYWQ5X4n4X-3poo3vymuspU"}),[p,v]=m.useState(null),[j,w]=m.useState(!0),[f,T]=m.useState(5),D=V(g),_=()=>{if(!j)t(be({lat:21,lng:78})),T(4),w(C=>!C);else{const S=x.find(C=>C.latestDocument.imei===i.imei);if(S){console.log(S.latestDocument,"getCenter");const{lat:C,lng:$}=S.latestDocument;t(be({lat:C,lng:$})),T(12),w(X=>!X)}else q.error("Data is not available for selected vehicle")}};if(m.useEffect(()=>{k&&v(window.google.maps)},[k,x]),r)return"Error loading maps";if(!k)return"Loading maps";const I={height:"40vh",width:"95%",marginTop:"0px",marginLeft:"10px"},B=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}];return p?e.jsxs("div",{children:[e.jsxs(n,{sx:{ml:"10px",fontSize:"20px",display:"flex",justifyContent:"space-between",color:D.grey[400]},children:[e.jsx("b",{children:"Live Map"}),e.jsx(os,{sx:{marginLeft:0,paddingTop:0,color:D.grey[400]},children:e.jsx(Kt,{control:e.jsx(St,{checked:j,onChange:_}),label:j?"Group":"Individual"})})]}),e.jsx(wt,{mapContainerStyle:I,zoom:f,center:l,options:{mapTypeControl:!1,styles:g?B:""},children:x&&x.length>0&&x.map((S,C)=>e.jsx(Ct,{position:{lat:S.latestDocument.lat,lng:S.latestDocument.lng},icon:{fillColor:"red",fillOpacity:2,strokeWeight:1,scale:2}},C))})]}):null},ns=({vehicleData:t})=>{const l=["Engine RPM","Engine coolant temperature","Battery Potential"],o=W(),{selectedVehicle:i}=L(p=>p.liveMap),{startDate:b,endDate:a,mode:h}=L(p=>p.dashboard),[x,d]=m.useState(""),c=V(h),g=t.length>0&&t.filter(p=>p.label.toLowerCase().includes(x.toLowerCase())),k=p=>{d(p.target.value)},r=async p=>{var T;o(Ye({imei:p.value,reg_id:p.label}));let v={imei:p.value,startDate:Ce().subtract(5,"day"),endDate:Ce()};o(Je(v));let j=p.label;const w=await o(Xe({registration_id:j}));let f=[];if(w&&w.payload.length>0&&((T=w.payload)==null||T.map(D=>{D.ivn_parameter.length>0&&f.push(D.ivn_parameter[0])})),f.length>0){let D=f.filter(_=>l.includes(_.pid_description));o(je(D))}else o(je([]))};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(n,{sx:{align:"center",my:"15px",ml:"20px"},children:e.jsxs(ft,{sx:{width:"90%",backgroundColor:"white",borderRadius:"5px"},variant:"outlined",children:[e.jsx(yt,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px"},children:"Search"}),e.jsx(bt,{onChange:p=>k(p),inputProps:{style:{padding:7}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(jt,{position:"end",children:e.jsx(Ie,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(kt,{})})}),label:"Search"})]})}),g.length>0&&g.map((p,v)=>e.jsx(n,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(De,{variant:"outlined",onClick:()=>{r(p)},sx:{width:"90%",bgcolor:p.label===i.reg_id?Pe.bgColor:"undefined",color:p.label===i.reg_id?"#DAE0EE":c.grey[400]},children:p.label})},v))]})})};var he={},as=de;Object.defineProperty(he,"__esModule",{value:!0});var Fe=he.default=void 0,is=as(pe()),cs=e;Fe=he.default=(0,is.default)((0,cs.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined");var ue={},ds=de;Object.defineProperty(ue,"__esModule",{value:!0});var _e=ue.default=void 0,ps=ds(pe()),hs=e;_e=ue.default=(0,ps.default)((0,hs.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined");var xe={},us=de;Object.defineProperty(xe,"__esModule",{value:!0});var Ae=xe.default=void 0,xs=us(pe()),Se=e;Ae=xe.default=(0,xs.default)([(0,Se.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,Se.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");const gs=()=>{const t=W(),l=Ke(),{tripList:o,selectedTripData:i,loading:b,trips:a,activeIndex:h,searchText:x,mode:d}=L(s=>s.dashboard),{selectedVehicle:c}=L(s=>s.liveMap),[g,k]=m.useState(0),[r,p]=m.useState(0),[v,j]=m.useState(0),[w,f]=m.useState(0),[T,D]=m.useState("0"),[_,I]=m.useState(0),[B,S]=m.useState(!1),C=V(d),$=()=>{k(s=>s+3)},ge=()=>{k(s=>Math.max(s-5,0))};m.useEffect(()=>{const s=X(o);if(s.length>0){t(Z(s[0]));const u=o&&o.length>0&&o.filter(y=>y.formatedDate.toLowerCase().includes(x.toLowerCase()));u.length>0&&K(0,u[0])}t(Qe(s))},[o]),m.useEffect(()=>{if(i.length>0){const s=i.map(y=>({lat:parseFloat(y.lat),lng:parseFloat(y.lng)})),u=new window.google.maps.Polygon({paths:s});me(u)}},[i]);const X=s=>{const u=new Set,y=[];return s.forEach(P=>{u.has(P.formatedDate)||(u.add(P.formatedDate),y.push(P.formatedDate))}),y},z=o&&o.length>0&&o.filter(s=>s.formatedDate.toLowerCase().includes(x.toLowerCase())),Re=s=>{if(z&&z.length>0){const u=o&&o.length>0&&o.filter(y=>y.formatedDate.toLowerCase().includes(s.toLowerCase()));t(ee(0)),t(Z(s)),K(0,u[0])}else t(ee(null)),t(Z(s))},K=async(s,u)=>{var M;console.log("item",u);let y={imei:c.imei,startDate:u.startDate,endDate:u.endDate};S(!0);const P=await Ze(y);((M=P==null?void 0:P.data)==null?void 0:M.documents.length)>0?(t(ve(P.data.documents[0].data)),$e(P.data.documents[0].data),S(!1)):(f(0),j(0),I(0),p(0),D("0"),t(ve([])),S(!1)),t(ee(s))},$e=s=>{let u=0,y=0;s.map((F,U)=>{F.packetType==="HB"&&u++,F.packetType==="HA"&&y++}),p(u),j(y);let P=Ne(new Date(s[0].createdAt).toISOString(),new Date(s[s.length-1].createdAt).toISOString());console.log("hours: ",P),D(P);const M=Ee(s);I(M);const N=s.map(F=>({lat:parseFloat(F.lat),lng:parseFloat(F.lng)})),E=new window.google.maps.Polygon({paths:N});me(E)};function Ne(s,u){var y=O(s),P=O(u);console.log("startDate-------->",s,u);let M=O.duration(P.diff(y)),N=M.hours(),E=M.minutes(),F=M.seconds(),U=`${N}h ${E}m ${F}s`;return console.log("string",U),U}function Ee(s){let u=0;for(let y=0;y<s.length-1;y++){const P=s[y].lat,M=s[y].lng,N=s[y+1].lat,E=s[y+1].lng;u+=Be(P,M,N,E)}return u}function Be(s,u,y,P){const N=(y-s)*Math.PI/180,E=(P-u)*Math.PI/180,F=Math.sin(N/2)*Math.sin(N/2)+Math.cos(s*Math.PI/180)*Math.cos(y*Math.PI/180)*Math.sin(E/2)*Math.sin(E/2);return 6371*(2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F)))}const me=s=>{if(!window.google||!window.google.maps.geometry){console.log("not loaded");return}const y=window.google.maps.geometry.spherical.computeArea(s.getPath())/4046.86;f(y)},ze=s=>{h!==null?s===h?l("/trip-monitor"):q.error("Trip not selected"):q.error("Please select the trip")};return e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{width:"95%",display:"flex",overflow:"auto",mx:"10px"},children:[b&&e.jsx(we,{style:{position:"absolute",left:"30%",top:"50%",zIndex:9999}}),B&&e.jsx(we,{style:{position:"absolute",left:"50%",top:"82%",zIndex:9999}}),e.jsx("div",{style:{display:"flex"},children:a&&a.length>0&&a.slice(g,g+5).map((s,u)=>e.jsx(n,{sx:{backgroundColor:x===s?"#EF5B05":"white",color:x===s?"white":"#EF5B05",mx:"5px",p:"5px",borderRadius:"5px",width:"90px",height:"25px",textAlign:"center",cursor:"pointer"},onClick:()=>{Re(s)},children:s},u))}),g!==0&&e.jsx("button",{onClick:ge,style:{marginLeft:"5px",backgroundColor:"white",color:"black"},disabled:g===0,children:e.jsx(_e,{})}),!(g+5>=a.length)&&e.jsx("button",{onClick:$,style:{marginLeft:"5px",backgroundColor:"white",color:"black"},disabled:g+5>=a.length,children:e.jsx(Fe,{})})]}),e.jsx(n,{children:z&&z.length>0?e.jsx(Mt,{sx:{maxHeight:210,height:210,width:"98%",ml:"10px",mt:"10px",borderRadius:"5px",border:"1px solid #dbdad5"},children:e.jsx(It,{stickyHeader:!0,"aria-label":"sticky table",children:e.jsx(Ft,{children:z&&z.length>0&&z.map((s,u)=>e.jsxs(_t,{sx:{backgroundColor:h===u?"#DAE0EE":C.grey[100]},children:[e.jsxs(re,{align:"left",style:{fontSize:"12px",padding:10,color:h===u?"black":C.grey[400],cursor:"pointer"},onClick:()=>{K(u,s)},children:[u+1,". ",s.startLocation," to ",s.endLocation]}),e.jsxs(re,{align:"right",style:{fontSize:"12px",padding:10,color:h===u?"black":C.grey[400]},children:[s!=null&&s.startDate?O(new Date(s.startDate).toISOString()).format("LT"):""," ","to"," ",s!=null&&s.endDate?O(new Date(s.endDate).toISOString()).format("LT"):"----"]}),e.jsx(re,{align:"right",style:{fontSize:"12px",padding:10,color:h===u?"black":C.grey[400]},children:e.jsx("span",{title:"Navigate to map",style:{cursor:"pointer"},onClick:()=>{ze(u)},children:e.jsx(Ae,{})})})]}))})})}):e.jsx(n,{sx:{height:210,display:"flex",justifyContent:"center",alignItems:"center",color:C.grey[400]},children:e.jsx(n,{children:e.jsx("b",{children:"Data Not Available"})})})}),i.length>0&&e.jsx(n,{sx:{my:"0px"},children:e.jsxs(n,{sx:{display:"flex",mx:"5px",mt:"5px"},children:[e.jsxs(n,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Braking"}),e.jsx("div",{children:"0"})]}),e.jsxs(n,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Acceleration"}),e.jsx("div",{children:"0"})]}),e.jsxs(n,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Running Hrs"}),e.jsx("div",{children:T})]}),e.jsxs(n,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Distance"}),e.jsx("div",{children:parseFloat(parseFloat(_).toFixed(2))})]})]})})]})},ms=()=>{const{mode:t}=L(o=>o.dashboard),l=V(t);return e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",ml:"5px"},children:[e.jsx(n,{sx:{m:"5px",fontSize:"20px",width:"60%",color:l.grey[400]},children:e.jsx("b",{children:"Trip History"})}),e.jsx(n,{children:e.jsx(Lt,{})})]}),e.jsx(n,{sx:{my:"5px"},children:e.jsx(gs,{})})]})},fs=({title:t,setShowVehicles:l,showVehicles:o})=>{JSON.parse(localStorage.getItem("w_userDetails"));const i=W(),{collapsed:b}=L(c=>c.auth),{selectedVehicle:a}=L(c=>c.liveMap),{mode:h}=L(c=>c.dashboard),x=()=>{i(tt(!b))},d={fontSize:"26px",fontWeight:500,lineHeight:"18.38px",color:"#fff",textAlign:"center",paddingTop:"5px"};return e.jsxs(n,{style:{display:"flex",justifyContent:"space-between",paddingRight:"20px",backgroundColor:Pe.bgColor,alignItems:"center",textAlign:"center",height:"60px",color:"white"},children:[e.jsxs(n,{style:{display:"flex",justifyContent:"space-between",gap:"10px"},children:[e.jsx(n,{children:b?e.jsx(at,{style:{cursor:"pointer",width:"30px",height:"30px"},onClick:x}):e.jsx(it,{style:{cursor:"pointer",width:"30px",height:"30px"},onClick:x})}),e.jsx(A,{style:d,children:t})]}),e.jsxs(n,{style:{display:"flex",gap:"5px"},children:[e.jsxs(De,{variant:"outlined",size:"small",sx:{color:o?"white":"black",backgroundColor:o?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{l(!o),t==="Live Map"&&setShowParameters(!1),t==="Trip Monitor"&&setSideBarTrip(!1),t==="Parameter Monitor"&&setShowParameters(!1)},children:[e.jsx("img",{src:Tt,style:{marginRight:"5px"}}),Object.keys(a).length>0?a.reg_id:"Vehicles"]}),e.jsx(Ie,{onClick:()=>{i(et(!h))},sx:{color:"white"},children:h?e.jsx(Dt,{}):e.jsx(Pt,{})})]})]})},Es=()=>{const{w_customer_id:t}=L(r=>r.auth),{mode:l,selectedTripData:o}=L(r=>r.dashboard),[i,b]=m.useState(()=>{const r=sessionStorage.getItem("imeiNo");return r?JSON.parse(r):[]}),a=W(),h=V(l),[x,d]=m.useState([]),[c,g]=m.useState(!1);m.useEffect(()=>{k()},[]),m.useEffect(()=>{sessionStorage.setItem("imeiNo",JSON.stringify(i))},[i]),m.useEffect(()=>{te.on("geofenceAlert",r=>{(r==null?void 0:r.imei)!==null&&i.find(j=>parseInt(j)===(r==null?void 0:r.imei))&&(console.log("geofence"),q.error(`Type: ${r==null?void 0:r.type} ${r==null?void 0:r.msg} ${r==null?void 0:r.imei}`,{id:"geofence",autoClose:5e3}))}),te.on("speedAlert",r=>{(r==null?void 0:r.imei)!==null&&i.find(j=>parseInt(j)===(r==null?void 0:r.imei))&&q.error(`${r==null?void 0:r.msg} ${r==null?void 0:r.imei}`,{id:"speed",autoClose:5e3})})},[te]);const k=async()=>{let r=[],p=[];(await a(st({w_customer_id:t}))).payload.map(f=>{var T,D;r.push({id:f.id,label:f.registration_id,value:(T=f.imei[0])==null?void 0:T.mac_id}),p.push((D=f.imei[0])==null?void 0:D.mac_id)}),b(p);const j="one",w=p;p.length>0&&(a(ot({type:j,imei:w})),a(rt(w))),d(r),a(lt({w_customer_id:t})),a(nt({}))};return e.jsxs("div",{className:"app",children:[e.jsx(ct,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(fs,{title:"Dashboard",showVehicles:c,setShowVehicles:g}),e.jsxs("div",{style:{height:"90vh",backgroundColor:h.grey[100]},children:[c&&e.jsx(n,{sx:{position:"fixed",width:"250px",right:"0px",height:"90vh",zIndex:9999,backgroundColor:h.grey[100]},children:e.jsx(ns,{vehicleData:x})}),e.jsx(n,{sx:{height:"21%"},children:e.jsx(rs,{})}),e.jsxs(n,{sx:{display:"flex",height:"50%"},children:[e.jsx(n,{sx:{width:"50%"},children:e.jsx(ms,{})}),e.jsx(n,{sx:{width:"50%"},children:e.jsx(ls,{})})]}),e.jsxs(n,{sx:{display:"flex",height:"30%",mt:"5px",ml:"5px"},children:[e.jsx(n,{style:{width:"33%"},children:e.jsx(le,{title:"speed",selectedTripData:o})}),e.jsx(n,{style:{width:"33%"},children:e.jsx(le,{title:"mainInputVoltage",selectedTripData:o})}),e.jsx(n,{style:{width:"33%"},children:e.jsx(le,{title:"ignition",selectedTripData:o})})]})]})]})]})};export{Es as default};
