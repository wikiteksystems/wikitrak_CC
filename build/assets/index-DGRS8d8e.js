import{p as je,q as Se,w as F,x as re,y as H,z as Ce,A as we,B as Te,r as g,C as ke,D as N,j as e,E as O,F as De,H as oe,I as B,J as G,K as Pe,L as X,M as _,N as Z,O as de,T as M,a as A,G as z,c as L,u as V,b as se,_ as R,P as Y,t as Ie,Q as Fe,R as Ae,S as le,i as pe,U as Re,V as K,W as ue,X as Me,Y as Ee,Z as Le,$ as ne,a0 as ae,l as Ne,m as _e,n as $e,a1 as Oe,o as Ve,v as ze}from"./index-Df49Wuj5.js";import{L as Ye}from"./LightModeOutlined-Uktosini.js";import{s as U}from"./Socket-0N_gnJcr.js";import{p as Be,R as Ge,L as qe,X as He,Y as Ue,a as We,b as Je,T as Ke}from"./LineChart-Bbznn_oF.js";import{t as E,d as Xe,R as Ze}from"./RegionSelector-CioWQAvq.js";import{B as v,C as Q}from"./CircularProgress-DF5t95eu.js";import{P as Qe}from"./Paper-DeeinfJ6.js";import{c as et,S as tt}from"./Switch-s1Oc-t9t.js";import{c as rt,I as ot}from"./IconButton-CaCHrN1x.js";import{r as st,m as lt,a as nt}from"./Modal-BNRJWbpB.js";import{C as at}from"./index-CsJ6wtEE.js";import{u as it,G as ct,M as dt}from"./esm-BpQt63IN.js";import{u as he,f as ge,F as xe,I as fe,O as pt,a as ut}from"./OutlinedInput-qdLl67vo.js";import{d as ie}from"./index-DmBPiT7y.js";import{T as ht}from"./index-C6tkFgBk.js";import{d as gt,a as xt,D as ft}from"./ArrowForwardIos-3dRIOurn.js";import{r as me}from"./createSvgIcon-DAjcSmbg.js";import{T as mt}from"./TableContainer-D5dOJNDl.js";import{T as yt,c as bt,a as vt,b as W}from"./TableRow-CuzSLSId.js";import{C as jt}from"./Card-DazE0H6e.js";import{S as St,M as Ct}from"./Select-Di3oj_01.js";import{T as wt}from"./TopBar-BJHBWpu2.js";import{G as Tt}from"./GeofencAlert-B5UggBMB.js";import"./proj-XQwXs9DQ.js";import"./index-BOXzVY4A.js";import"./index-CcFujeRu.js";import"./NotificationsNone-D6hGs_Xx.js";const kt=["component","direction","spacing","divider","children","className","useFlexGap"],Dt=je(),Pt=Se("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,r)=>r.root});function It(t){return De({props:t,name:"MuiStack",defaultTheme:Dt})}function Ft(t,r){const i=g.Children.toArray(t).filter(Boolean);return i.reduce((n,h,c)=>(n.push(h),c<i.length-1&&n.push(g.cloneElement(r,{key:`separator-${c}`})),n),[])}const At=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],Rt=({ownerState:t,theme:r})=>{let i=F({display:"flex",flexDirection:"column"},re({theme:r},H({values:t.direction,breakpoints:r.breakpoints.values}),n=>({flexDirection:n})));if(t.spacing){const n=Ce(r),h=Object.keys(r.breakpoints.values).reduce((p,u)=>((typeof t.spacing=="object"&&t.spacing[u]!=null||typeof t.direction=="object"&&t.direction[u]!=null)&&(p[u]=!0),p),{}),c=H({values:t.direction,base:h}),x=H({values:t.spacing,base:h});typeof c=="object"&&Object.keys(c).forEach((p,u,j)=>{if(!c[p]){const C=u>0?c[j[u-1]]:"column";c[p]=C}}),i=we(i,re({theme:r},x,(p,u)=>t.useFlexGap?{gap:oe(n,p)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${At(u?c[u]:t.direction)}`]:oe(n,p)}}))}return i=Te(r.breakpoints,i),i};function Mt(t={}){const{createStyledComponent:r=Pt,useThemeProps:i=It,componentName:n="MuiStack"}=t,h=()=>B({root:["root"]},p=>G(n,p),{}),c=r(Rt);return g.forwardRef(function(p,u){const j=i(p),f=ke(j),{component:C="div",direction:S="column",spacing:l=0,divider:a,children:m,className:w,useFlexGap:D=!1}=f,o=N(f,kt),s={direction:S,spacing:l,useFlexGap:D},y=h();return e.jsx(c,F({as:C,ownerState:s,ref:u,className:O(y.root,w)},o,{children:a?Ft(m,a):m}))})}const Et=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Lt=["component","slots","slotProps"],Nt=["component"];function _t(t,r){const{className:i,elementType:n,ownerState:h,externalForwardedProps:c,getSlotOwnerState:x,internalForwardedProps:d}=r,p=N(r,Et),{component:u,slots:j={[t]:void 0},slotProps:f={[t]:void 0}}=c,C=N(c,Lt),S=j[t]||n,l=st(f[t],h),a=lt(F({className:i},p,{externalForwardedProps:t==="root"?C:void 0,externalSlotProps:l})),{props:{component:m},internalRef:w}=a,D=N(a.props,Nt),o=Pe(w,l==null?void 0:l.ref,r.ref),s=x?x(D):{},y=F({},h,s),b=t==="root"?m||u:m,T=nt(S,F({},t==="root"&&!u&&!j[t]&&d,t!=="root"&&!j[t]&&d,D,b&&{as:b},{ref:o}),y);return Object.keys(s).forEach(P=>{delete T[P]}),[S,T]}const $t=rt(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function Ot(t){return G("MuiAvatar",t)}X("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Vt=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],zt=et(),Yt=t=>{const{classes:r,variant:i,colorDefault:n}=t;return B({root:["root",i,n&&"colorDefault"],img:["img"],fallback:["fallback"]},Ot,r)},Bt=_("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:i}=t;return[r.root,r[i.variant],i.colorDefault&&r.colorDefault]}})(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:F({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:F({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]})),Gt=_("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,r)=>r.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),qt=_($t,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,r)=>r.fallback})({width:"75%",height:"75%"});function Ht({crossOrigin:t,referrerPolicy:r,src:i,srcSet:n}){const[h,c]=g.useState(!1);return g.useEffect(()=>{if(!i&&!n)return;c(!1);let x=!0;const d=new Image;return d.onload=()=>{x&&c("loaded")},d.onerror=()=>{x&&c("error")},d.crossOrigin=t,d.referrerPolicy=r,d.src=i,n&&(d.srcset=n),()=>{x=!1}},[t,r,i,n]),h}const Ut=g.forwardRef(function(r,i){const n=zt({props:r,name:"MuiAvatar"}),{alt:h,children:c,className:x,component:d="div",slots:p={},slotProps:u={},imgProps:j,sizes:f,src:C,srcSet:S,variant:l="circular"}=n,a=N(n,Vt);let m=null;const w=Ht(F({},j,{src:C,srcSet:S})),D=C||S,o=D&&w!=="error",s=F({},n,{colorDefault:!o,component:d,variant:l}),y=Yt(s),[b,T]=_t("img",{className:y.img,elementType:Gt,externalForwardedProps:{slots:p,slotProps:{img:F({},j,u.img)}},additionalProps:{alt:h,src:C,srcSet:S,sizes:f},ownerState:s});return o?m=e.jsx(b,F({},T)):c||c===0?m=c:D&&h?m=h[0]:m=e.jsx(qt,{ownerState:s,className:y.fallback}),e.jsx(Bt,F({as:d,ownerState:s,className:O(y.root,x),ref:i},a,{children:m}))}),Wt=Ut,Jt=Mt({createStyledComponent:_("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,r)=>r.root}),useThemeProps:t=>Z({props:t,name:"MuiStack"})}),Kt=Jt;function Xt(t){return G("MuiFormControlLabel",t)}const Zt=X("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),$=Zt,Qt=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],er=t=>{const{classes:r,disabled:i,labelPlacement:n,error:h,required:c}=t,x={root:["root",i&&"disabled",`labelPlacement${de(n)}`,h&&"error",c&&"required"],label:["label",i&&"disabled"],asterisk:["asterisk",h&&"error"]};return B(x,Xt,r)},tr=_("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:i}=t;return[{[`& .${$.label}`]:r.label},r.root,r[`labelPlacement${de(i.labelPlacement)}`]]}})(({theme:t,ownerState:r})=>F({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${$.disabled}`]:{cursor:"default"}},r.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},r.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},r.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${$.label}`]:{[`&.${$.disabled}`]:{color:(t.vars||t).palette.text.disabled}}})),rr=_("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(t,r)=>r.asterisk})(({theme:t})=>({[`&.${$.error}`]:{color:(t.vars||t).palette.error.main}})),or=g.forwardRef(function(r,i){var n,h;const c=Z({props:r,name:"MuiFormControlLabel"}),{className:x,componentsProps:d={},control:p,disabled:u,disableTypography:j,label:f,labelPlacement:C="end",required:S,slotProps:l={}}=c,a=N(c,Qt),m=he(),w=(n=u??p.props.disabled)!=null?n:m==null?void 0:m.disabled,D=S??p.props.required,o={disabled:w,required:D};["checked","name","onChange","value","inputRef"].forEach(k=>{typeof p.props[k]>"u"&&typeof c[k]<"u"&&(o[k]=c[k])});const s=ge({props:c,muiFormControl:m,states:["error"]}),y=F({},c,{disabled:w,labelPlacement:C,required:D,error:s.error}),b=er(y),T=(h=l.typography)!=null?h:d.typography;let P=f;return P!=null&&P.type!==M&&!j&&(P=e.jsx(M,F({component:"span"},T,{className:O(b.label,T==null?void 0:T.className),children:P}))),e.jsxs(tr,F({className:O(b.root,x),ownerState:y,ref:i},a,{children:[g.cloneElement(p,o),D?e.jsxs(Kt,{display:"block",children:[P,e.jsxs(rr,{ownerState:y,"aria-hidden":!0,className:b.asterisk,children:["â€‰","*"]})]}):P]}))}),sr=or;function lr(t){return G("MuiFormGroup",t)}X("MuiFormGroup",["root","row","error"]);const nr=["className","row"],ar=t=>{const{classes:r,row:i,error:n}=t;return B({root:["root",i&&"row",n&&"error"]},lr,r)},ir=_("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:i}=t;return[r.root,i.row&&r.row]}})(({ownerState:t})=>F({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})),cr=g.forwardRef(function(r,i){const n=Z({props:r,name:"MuiFormGroup"}),{className:h,row:c=!1}=n,x=N(n,nr),d=he(),p=ge({props:n,muiFormControl:d,states:["error"]}),u=F({},n,{row:c,error:p.error}),j=ar(u);return e.jsx(ir,F({className:O(j.root,h),ownerState:u,ref:i},x))}),dr=cr,pr=({imeiNo:t})=>{const{selectedVehicle:r,parameterData:i,ivnPid:n,locationData:h,vehicleList:c,onlineVehicle:x}=A(b=>b.liveMap),{ivnParameters:d,mode:p}=A(b=>b.dashboard),u=E(p),[j,f]=g.useState(),[C,S]=g.useState(!1),[l,a]=g.useState();g.useState({mainInputVoltage:0,ignition:0,speed:0});const[m,w]=g.useState("Not Available"),[D,o]=g.useState("Offline");g.useEffect(()=>{s()},[r]);const s=()=>{var b,T,P,k;if((h==null?void 0:h.length)>0){console.log("locationData",h);let I=h==null?void 0:h.find(q=>q.latestDocument.imei===r.imei);I?(f((b=I==null?void 0:I.latestDocument)==null?void 0:b.speed),S((T=I==null?void 0:I.latestDocument)==null?void 0:T.ignition),a((P=I==null?void 0:I.latestDocument)==null?void 0:P.mainInputVoltage),w((k=I==null?void 0:I.latestDocument)==null?void 0:k.venderId)):(f(0),S(0),a(0),w("Not Available"))}else f(0),S(0),a(0),w("Not Available")};g.useEffect(()=>{Object.keys(r).length>0&&y()},[r]);const y=()=>{if(Object.keys(r).length>0)if(x&&x.length>0){const b=x.some(T=>parseInt(T)===parseInt(r==null?void 0:r.imei));o(b?"Online":"Offline")}else o("Offline");else o("Offline")};return e.jsxs(e.Fragment,{children:[e.jsx(v,{sx:{mx:"10px",pt:"10px",color:u.grey[400]},children:e.jsx("b",{children:r==null?void 0:r.reg_id})}),e.jsx(v,{sx:{backgroundColor:u.grey[200],height:"12vh",borderRadius:"8px",p:"5px"},children:e.jsx(v,{sx:{},children:e.jsx(z,{container:!0,spacing:3,mt:"2.5px",children:e.jsx(z,{item:!0,xs:12,children:e.jsx(z,{container:!0,justifyContent:"space-around",spacing:3,children:[{label:"VenderId",value:m},{label:"Speed",value:j,unit:"km/h"},{label:"Main Input Voltage",value:parseFloat(l).toFixed(2),unit:"voltage"},{label:"Current Status",value:D}].map((b,T)=>e.jsx(z,{item:!0,children:e.jsxs(Qe,{sx:{height:70,width:250,backgroundColor:u.grey[100],color:u.grey[400],display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 10px"},children:[e.jsxs(v,{children:[e.jsx(M,{variant:"h6",sx:{fontSize:"12px"},children:b.label}),e.jsxs(M,{variant:"h6",sx:{fontSize:"18px",fontWeight:"bold"},children:[b.value," ",b==null?void 0:b.unit]})]}),e.jsx(Wt,{src:Be,sx:{width:20,height:20}})]})},T))})})})})})]})},J=({title:t,selectedTripData:r})=>{const{mode:i,loading:n}=A(u=>u.dashboard),{selectedVehicle:h}=A(u=>u.liveMap),[c,x]=g.useState([]);g.useEffect(()=>{let u=r.map(f=>{let C={...f};return C.ignition=C.ignition?1:0,C});const j=p(u);x(j)},[r]);const d=E(i),p=u=>{let j=null;return u.forEach(f=>{const C=new Date(f.createdAt);j&&j.toDateString()===C.toDateString()?(f.date=L(f.createdAt).format("HH:mm:ss"),f.ignition=f.ignition?1:0):(f.date=L(f.createdAt).format("DD-MM-YYYY"),f.ignition=f.ignition?1:0),j=C}),u};return e.jsx(v,{sx:{ml:"2rem",border:d.grey[300],fontSize:"13px",height:"24vh",color:d.grey[400],backgroundColor:d.grey[100],borderRadius:"5px"},children:c&&c.length>0?e.jsx(Ge,{children:e.jsxs(qe,{data:c,margin:{top:15,right:10,left:-25,bottom:0},children:[e.jsx(He,{dataKey:"date",stroke:d.grey[400]}),e.jsx(Ue,{stroke:d.grey[400]}),e.jsx(We,{type:"monotone",dataKey:t,dot:!1,stroke:"#EF5B05",strokeWidth:2}),e.jsx(Je,{layout:"horizontal",verticalAlign:"top",align:"center"}),e.jsx(Ke,{})]})}):e.jsx(at,{style:{background:d.grey[100],width:"400px",height:"100px",margin:"auto",marginTop:"10px"},children:Object.keys(h).length===0?e.jsx(M,{textAlign:"center",align:"center",mt:"20px",color:d.grey[600],children:"Please Select a Vehicle"}):n?e.jsx(Q,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(M,{textAlign:"center",color:d.grey[600],children:"Sorry! No Trips Available"})})})},ur=()=>{const t=V(),{center:r,selectedParameterList:i,selectedVehicle:n,vehicleList:h,tractorIcon:c,icons:x,locationData:d,ivnPid:p,placesData:u}=A(k=>k.liveMap),{mode:j}=A(k=>k.dashboard),{isLoaded:f,loadError:C}=it({googleMapsApiKey:"AIzaSyD8TrUWS9FRTu-MRP339mJF_iWlORvEGUA"}),[S,l]=g.useState(null),[a,m]=g.useState(!0),[w,D]=g.useState(5),[o,s]=g.useState(),y=E(j);g.useEffect(()=>{if(a)s(d);else{let k=d==null?void 0:d.filter(I=>(I==null?void 0:I._id)===(n==null?void 0:n.imei));s(k)}},[d,n,a]);const b=()=>{if(!a)t(se({lat:21,lng:78})),D(4),m(I=>!I);else{const k=d.find(I=>I.latestDocument.imei===n.imei);if(k){console.log(k.latestDocument,"getCenter");const{lat:I,lng:q}=k.latestDocument;t(se({lat:I,lng:q})),D(12),m(ve=>!ve)}else R.error("Data is not available for selected vehicle")}};if(g.useEffect(()=>{f&&l(window.google.maps)},[f,d]),C)return"Error loading maps";if(!f)return"Loading maps";const T={height:"41.5vh",width:"99%",marginTop:"0px",marginLeft:"10px"},P=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}];return S?e.jsxs("div",{children:[e.jsxs(v,{sx:{ml:"10px",fontSize:"20px",display:"flex",justifyContent:"space-between",color:y.grey[400]},children:[e.jsx("b",{children:"Live Map"}),e.jsx(dr,{sx:{marginLeft:0,paddingTop:0,color:y.grey[400]},children:e.jsx(sr,{control:e.jsx(tt,{checked:a,onChange:b}),label:a?"Group":"Individual"})})]}),e.jsx(ct,{mapContainerStyle:T,zoom:w,center:r,options:{mapTypeControl:!1,styles:j?P:""},children:o&&o.length>0&&o.map((k,I)=>e.jsx(dt,{position:{lat:k.latestDocument.lat,lng:k.latestDocument.lng},icon:{url:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",scaledSize:new google.maps.Size(32,32),fillColor:"red",fillOpacity:2,strokeWeight:1,scale:2}},I))})]}):null},hr=({vehicleData:t})=>{const r=["Engine RPM","Engine coolant temperature","Battery Potential"],i=V(),{selectedVehicle:n,loading:h}=A(o=>o.liveMap),{startDate:c,endDate:x,mode:d}=A(o=>o.dashboard),[p,u]=g.useState(""),[j,f]=g.useState(""),C=E(d),S=g.useRef(null),l=g.useRef(0),a=t.length>0&&t.filter(o=>{var s;return o.label.toLowerCase().includes(p.toLowerCase())&&(j===""||((s=o==null?void 0:o.workShop)==null?void 0:s.region)===j)}),m=o=>{u(o.target.value)},w=async o=>{var T;S.current&&(l.current=S.current.scrollTop),i(Fe({imei:o.value,reg_id:o.label})),o.value,ie().subtract(5,"day"),ie();let s=o.label;const y=await i(Ae({registration_id:s}));let b=[];if(y&&y.payload.length>0&&((T=y.payload)==null||T.map(P=>{P.ivn_parameter.length>0&&b.push(P.ivn_parameter[0])})),b.length>0){let P=b.filter(k=>r.includes(k.pid_description));i(le(P))}else i(le([]));setTimeout(()=>{S.current&&(S.current.scrollTop=l.current)},0)};g.useEffect(()=>{S.current&&(S.current.scrollTop=l.current)},[h,a,n]);const D=o=>{console.log("clicked btn region",o),f(o)};return e.jsx(e.Fragment,{children:h?e.jsx("div",{children:e.jsx(v,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:e.jsx(Q,{})})}):e.jsxs("div",{ref:S,style:{overflowY:"auto",height:"90vh"},children:[e.jsx(v,{sx:{align:"center",my:"15px",ml:"20px"},children:e.jsxs(xe,{sx:{width:"90%",backgroundColor:"white",borderRadius:"5px"},variant:"outlined",children:[e.jsx(fe,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px"},children:"Search"}),e.jsx(pt,{onChange:o=>m(o),inputProps:{style:{padding:7}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ut,{position:"end",children:e.jsx(ot,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Xe,{})})}),label:"Search"})]})}),e.jsx(Ze,{region:j,handleRegion:D}),e.jsx(v,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsxs(Y,{variant:"outlined",sx:{width:"90%",color:C.grey[400],"&:hover":{color:"#DAE0EE"}},children:["Total Vehicle: ",a.length]})}),a.length>0?a.map((o,s)=>e.jsx(v,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(Y,{variant:"outlined",onClick:()=>w(o),sx:{width:"90%",bgcolor:o.label===n.reg_id?Ie.bgColor:"undefined",color:o.label===n.reg_id?"#DAE0EE":C.grey[400]},children:o.label})},s)):e.jsx(v,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsxs(ht,{style:{textAlign:"center",color:C.grey[400]},children:["Sorry! No vehicles in"," ",e.jsx("span",{style:{fontWeight:"bold"},children:j})," region"]})})]})})};var ee={},gr=pe;Object.defineProperty(ee,"__esModule",{value:!0});var ye=ee.default=void 0,xr=gr(me()),ce=e;ye=ee.default=(0,xr.default)([(0,ce.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,ce.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");var te={},fr=pe;Object.defineProperty(te,"__esModule",{value:!0});var be=te.default=void 0,mr=fr(me()),yr=e;be=te.default=(0,mr.default)((0,yr.jsx)("path",{d:"m22 12-4-4v3H3v2h15v3z"}),"TrendingFlat");function br(){const{allTripList:t,loading:r,mode:i,activeIndex:n,selectedDate:h,selectedTripData:c}=A(s=>s.dashboard),{selectedVehicle:x}=A(s=>s.liveMap),[d,p]=g.useState([]),[u,j]=g.useState("0"),[f,C]=g.useState(0);let S=V();const l=Re(),a=E(i);g.useEffect(()=>{const s=m(t);p(s),s.length>0&&K(s[0])},[t]);const m=s=>{const y=new Set,b=[];return s.forEach(T=>{const P=L(T.startTime).format("YYYY-MM-DD");y.has(P)||(y.add(P),b.push(P))}),b},w=(s,y)=>{S(ue(y)),console.log("item, i",s,y),S(Me(s.data));let b=Ee(s==null?void 0:s.data);C(b);let T=Le(new Date(s==null?void 0:s.startTime).toISOString(),new Date(s==null?void 0:s.endTime).toISOString());j(T)},D=s=>{console.log("activeIndex",n),console.log("i",s),n!==null?s===n?l("/trip-monitor"):R.error("Trip not selected"):R.error("Please select the trip")},o=t.filter(s=>L(s.startTime).format("YYYY-MM-DD")===h);return e.jsxs(e.Fragment,{children:[e.jsx(v,{sx:{width:"95%",display:"flex",overflow:"auto",mx:"10px",mt:2},children:o&&o.length>0?e.jsx(mt,{sx:{maxHeight:250,height:250,width:"98%",ml:"10px",mt:"10px",borderRadius:"5px",border:"1px solid #dbdad5"},children:e.jsx(yt,{stickyHeader:!0,"aria-label":"sticky table",children:e.jsx(bt,{children:o.map((s,y)=>{var b,T,P,k;return e.jsxs(vt,{sx:{backgroundColor:n===y?"#DAE0EE":a.grey[100]},children:[e.jsxs(W,{align:"left",style:{fontSize:"12px",padding:10,color:n===y?"black":a.grey[400],cursor:"pointer"},onClick:()=>{w(s,y)},children:[y+1,"."," ",`${(T=(b=s==null?void 0:s.startLocation)==null?void 0:b.address)==null?void 0:T.display_name}`," ",e.jsx(v,{component:"span",sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle"},children:e.jsx(be,{})}),`${(k=(P=s==null?void 0:s.endLocation)==null?void 0:P.address)==null?void 0:k.display_name}`]}),e.jsxs(W,{align:"right",style:{fontSize:"12px",padding:10,color:n===y?"black":a.grey[400]},children:[s!=null&&s.startTime?L(new Date(s.startTime).toISOString()).format("YYYY-MM-DD, HH:mm a"):""," ","/"," ",s!=null&&s.endTime?L(new Date(s.endTime).toISOString()).format("YYYY-MM-DD, HH:mm a"):"----"]}),e.jsx(W,{align:"right",style:{fontSize:"12px",padding:10,color:n===y?"black":a.grey[400]},children:e.jsx("span",{title:"Navigate to map",style:{cursor:"pointer"},onClick:()=>{D(y)},children:e.jsx(ye,{})})})]},y)})})})}):e.jsx(v,{sx:{height:210,display:"flex",justifyContent:"center",alignItems:"center",color:a.grey[400],margin:"auto"},children:e.jsx(jt,{style:{background:a.grey[100],width:"400px",height:"100px"},children:Object.keys(x).length===0?e.jsx(M,{textAlign:"center",align:"center",mt:"20px",color:a.grey[600],children:"Please Select a Vehicle"}):r?e.jsx(Q,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(M,{textAlign:"center",color:a.grey[600],children:"Sorry! No Trips Available"})})})}),c.length>0&&e.jsx(v,{sx:{my:"0px"},children:e.jsxs(v,{sx:{display:"flex",mx:"5px",mt:"10px"},children:[e.jsxs(v,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Braking"}),e.jsx("div",{children:"0"})]}),e.jsxs(v,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Acceleration"}),e.jsx("div",{children:"0"})]}),e.jsxs(v,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Running Hrs"}),e.jsx("div",{children:u})]}),e.jsxs(v,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Distance"}),e.jsxs("div",{children:[parseFloat(parseFloat(f).toFixed(2))," km"]})]})]})})]})}function vr(){const{allTripList:t,activeIndex:r,selectedDate:i,loading:n,mode:h,trip_payload:c,page:x}=A(a=>a.dashboard),d=V(),p=E(h),[u,j]=g.useState([]);g.useEffect(()=>{const a=f(t);j(a),a.length>0&&d(K(a[0]))},[t,d]);const f=a=>{const m=new Set,w=[];return a.forEach(D=>{const o=L(D.startTime).format("YYYY-MM-DD");m.has(o)||(m.add(o),w.push(o))}),w},C=a=>{d(K(a.target.value)),d(ue(null))},S=async()=>{const a={...c,page:x+1};try{(await d(ne(a))).error?R.error("No Trip! within selected date"):d(ae(x+1))}catch{R.error("No Trip! within selected date")}},l=()=>{if(x<=1)return;const a={...c,page:x-1};d(ae(x-1)),d(ne(a))};return e.jsx(v,{sx:{width:"50%",mx:"10px"},children:e.jsxs(xe,{fullWidth:!0,sx:{height:"10px","& .MuiInputBase-root":{height:"38px",backgroundColor:p.grey[500],color:p.grey[400]},"& .MuiInputLabel-root":{lineHeight:"15px",color:p.grey[400]}},children:[e.jsx(fe,{id:"select-date-label",children:"Trip's Date"}),e.jsxs(St,{labelId:"select-date-label",value:i,label:"Select Date",onChange:C,sx:{height:"40px",fontSize:"14px",padding:"0 12px",backgroundColor:p.grey[500],color:p.grey[400],"& .MuiSelect-icon":{color:p.grey[400]}},children:[u.map((a,m)=>e.jsx(Ct,{value:a,sx:{backgroundColor:p.grey[500],color:p.grey[400],"&:hover":{backgroundColor:p.grey[600],color:p.grey[300]},"&.Mui-selected":{backgroundColor:p.grey[600],color:p.grey[300],"&:hover":{backgroundColor:p.grey[600]}}},children:a},m)),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Y,{disabled:x<=1,onClick:l,children:e.jsx(gt,{})}),e.jsx(Y,{disabled:!(c!=null&&c.imei),onClick:S,children:e.jsx(xt,{})})]})]})]})})}const jr=()=>{const{mode:t}=A(i=>i.dashboard),r=E(t);return e.jsxs(v,{children:[e.jsxs(v,{sx:{display:"flex",ml:"5px",justifyContent:"center"},children:[e.jsx(v,{sx:{m:"5px",fontSize:"20px",width:"20%",color:r.grey[400]},children:e.jsx("b",{children:"Trip History"})}),e.jsx(vr,{}),e.jsx(v,{children:e.jsx(ft,{})})]}),e.jsx(v,{sx:{my:"5px"},children:e.jsx(br,{})})]})},Kr=()=>{const{w_customer_id:t}=A(l=>l.auth),{mode:r,selectedTripData:i}=A(l=>l.dashboard),[n,h]=g.useState(()=>{const l=sessionStorage.getItem("imeiNo");return l?JSON.parse(l):[]}),c=V(),x=E(r),[d,p]=g.useState([]),[u,j]=g.useState(!1),[f,C]=g.useState(!1);g.useEffect(()=>{S()},[]),g.useEffect(()=>{sessionStorage.setItem("imeiNo",JSON.stringify(n))},[n]),g.useEffect(()=>{U.on("geofenceAlert",l=>{(l==null?void 0:l.imei)!==null&&n.find(w=>parseInt(w)===(l==null?void 0:l.imei))&&(console.log("geofence"),R.error(`Type: ${l==null?void 0:l.type} ${l==null?void 0:l.msg} ${l==null?void 0:l.imei}`,{id:"geofence",autoClose:5e3}))}),U.on("speedAlert",l=>{(l==null?void 0:l.imei)!==null&&n.find(w=>parseInt(w)===(l==null?void 0:l.imei))&&R.error(`${l==null?void 0:l.msg} ${l==null?void 0:l.imei}`,{id:"speed",autoClose:5e3})})},[U]);const S=async()=>{try{let l=[],a=[];const m=await c(Ne({w_customer_id:t}));if(console.log("data",m),Array.isArray(m.payload)){m.payload.forEach(o=>{var s,y;Array.isArray(o.imei)&&o.imei.length>0?(l.push({id:o.id,label:o.registration_id,value:(s=o==null?void 0:o.imei[0])==null?void 0:s.mac_id,vehilce_type:o==null?void 0:o.segment,workShop:o==null?void 0:o.workshop}),a.push((y=o.imei[0])==null?void 0:y.mac_id),o.registration_id):(console.error("IMEI data not found for item:",o),R.error(`IMEI Number not found for the vehicle: ${o==null?void 0:o.registration_id}`))}),h(a);const w="one",D=a;a.length>0&&(c(_e({type:w,imei:D})),c($e(D))),p(l),c(Oe(l)),c(Ve({w_customer_id:t})),c(ze({}))}else console.error("Unexpected data format:",m),R.error("Unexpected data format:")}catch(l){console.error("Error fetching vehicle data:",l),R.error(`Error fetching vehicle data: ${l}`)}};return e.jsxs("div",{className:"app",children:[e.jsx(Ye,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(wt,{title:"Dashboard",showVehicles:u,setShowVehicles:j,setShowNotification:C,showNotification:f}),e.jsxs("div",{style:{height:"92vh",backgroundColor:x.grey[100],padding:"10px"},children:[u&&e.jsx(v,{sx:{position:"fixed",width:"18%",right:"0px",height:"90vh",zIndex:9999,backgroundColor:x.grey[100],overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"},children:e.jsx(hr,{vehicleData:d})}),f&&e.jsx(v,{sx:{position:"fixed",width:"18%",right:"0px",height:"90vh",zIndex:9999,backgroundColor:x.grey[100]},children:e.jsx(Tt,{})}),e.jsx(v,{sx:{height:"21%"},children:e.jsx(pr,{imeiNo:n})}),e.jsxs(v,{sx:{display:"flex",height:"50%"},children:[e.jsx(v,{sx:{width:"50%",border:"1px solid #E8E8E8",padding:"2px",borderRadius:"5px"},children:e.jsx(jr,{})}),e.jsx(v,{sx:{width:"50%"},children:e.jsx(ur,{})})]}),e.jsxs(v,{sx:{display:"flex",height:"30%",mt:"5px",pt:"10px"},children:[e.jsx(v,{style:{width:"33%"},children:e.jsx(J,{title:"speed",selectedTripData:i})}),e.jsx(v,{style:{width:"33%"},children:e.jsx(J,{title:"mainInputVoltage",selectedTripData:i})}),e.jsx(v,{style:{width:"33%"},children:e.jsx(J,{title:"ignition",selectedTripData:i})})]})]})]})]})};export{Kr as default};
