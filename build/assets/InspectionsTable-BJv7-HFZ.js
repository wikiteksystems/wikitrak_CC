import{j as s,B as k,i as O,k as b,r as p,I as F,ah as M,aR as W,aS as G,aQ as H,w as j,aj as q,aE as V,ac as Y}from"./index-C_wM5jQm.js";import{D as z,a as N,b as Q,T as J}from"./TablePagination-CF9QGP_D.js";import{D as K,a as X,E as Z,T as B}from"./Edit-2sOflnM1.js";import{B as T}from"./menu2-BdQ5f_y8.js";import{T as ee,a as se}from"./TableHead-BQskxLbQ.js";import{T as te,b as S,a as ae}from"./TableRow-C76zo8Qh.js";import{T as u}from"./TableCell-DbbSGxQ8.js";const oe=({open:r,onClose:c,onConfirm:h})=>s.jsxs(z,{open:r,onClose:c,children:[s.jsx(K,{children:"Confirm Deletion"}),s.jsx(N,{children:s.jsxs(X,{children:["Are you sure you want to delete this vehicle data?"," ",s.jsx("span",{style:{color:"red"},children:"This action cannot be undone."})]})}),s.jsxs(Q,{children:[s.jsx(k,{onClick:c,color:"primary",children:"Cancel"}),s.jsx(k,{onClick:h,color:"secondary",children:"Delete"})]})]}),ne="http://134.209.145.234/api/v1",re={display:"flex",alignItems:"left",justifyContent:"left",gap:"8px"},ie=({inspectionData:r})=>{const c=O(),{isUpdateInspection:h}=b(i=>i.inspection),[x,m]=p.useState(!1),d=()=>{console.log("inspectionData",r);const i=localStorage.getItem("role");M.includes(i)?(c(W(!h)),c(G(r)),c(H(r))):j.error(`Sorry! Your role is ${i}. You're not allowed to add, edit or delete the vehicle`)},_=async()=>{console.log("Vehicle data deleting");try{await q.delete(`${ne}/vehicles/delete/${vehicleData.id}/`),j.success("Vehicle data deleted successfully!"),c(V())}catch(i){console.error("Error deleting vehicle data:",i),j.error("Failed to delete vehicle data. Please try again.")}m(!1)},g=()=>{m(!1)},f={color:"#686868"};return s.jsxs(T,{sx:re,children:[s.jsx(F,{onClick:d,children:s.jsx(Z,{sx:f})}),s.jsx(oe,{open:x,onClose:g,onConfirm:_})]})},ce=[{id:"BDID",label:"BDID"},{id:"User",label:"User"},{id:"SubmissionDate",label:"Submission Date"},{id:"WorkshopGroup",label:"Workshop Group"},{id:"Status",label:"Status"}],le=({where:r})=>{const{breakdowns:c}=b(e=>e.breakdown),{searchTerm:h}=b(e=>e.inspection),[x,m]=p.useState("asc"),[d,_]=p.useState("BDID"),[g,f]=p.useState(0),[i,I]=p.useState(5),[P,ue]=p.useState({id:"",status:"",workshop:"",user:""}),v=e=>{m(d===e&&x==="asc"?"desc":"asc"),_(e)},L=(e,t)=>{f(t)},y=e=>{I(parseInt(e.target.value,10)),f(0)},A=(e,t,l)=>e.filter(o=>{const a=l.toLowerCase(),n=o.breakdown_id.toLowerCase().includes(a),C=`${o.user.us_user.first_name} ${o.user.us_user.last_name}`.toLowerCase().includes(a),U=o.status.toLowerCase().includes(a),E=o.workshop_group.group_name.toLowerCase().includes(a);return!(l&&!(n||C||U||E)||t.id&&!o.breakdown_id.includes(t.id)||t.status&&o.status!==t.status||t.workshop&&o.workshop_group.group_name!==t.workshop||t.user&&!o.user.us_user.first_name.toLowerCase().includes(t.user.toLowerCase())&&!o.user.us_user.last_name.toLowerCase().includes(t.user.toLowerCase()))}),$=(e,t,l,o)=>{if(o==="User"){const a=`${e.user.us_user.first_name} ${e.user.us_user.last_name}`.toLowerCase(),n=`${t.user.us_user.first_name} ${t.user.us_user.last_name}`.toLowerCase();return l==="asc"?a.localeCompare(n):n.localeCompare(a)}if(o==="WorkshopGroup"){const a=e.workshop_group.group_name.toLowerCase(),n=t.workshop_group.group_name.toLowerCase();return l==="asc"?a.localeCompare(n):n.localeCompare(a)}if(o==="BDID"){const a=parseInt(e.breakdown_id.replace("BD-",""),10),n=parseInt(t.breakdown_id.replace("BD-",""),10);return l==="asc"?a-n:n-a}if(o==="SubmissionDate"){const a=new Date(e.submission_date),n=new Date(t.submission_date);return l==="asc"?a-n:n-a}if(o==="Status"){const a={Open:1,Close:2,Rejected:3},n=a[e.status]||0,C=a[t.status]||0;return l==="asc"?n-C:C-n}return 0},D=A(c.slice(),P,h).sort((e,t)=>$(e,t,x,d)),R=D.slice(g*i,g*i+i),w={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"};return s.jsx(T,{sx:{m:r!=="inspection report"&&"10px",width:r==="inspection report"?"60%":"99%"},children:s.jsxs(Y,{children:[s.jsx(ee,{sx:{height:r==="inspection report"?"50vh":"73vh",bgcolor:"white",borderRadius:"10px"},children:s.jsxs(te,{stickyHeader:!0,children:[s.jsx(se,{children:s.jsxs(S,{children:[ce.map(e=>s.jsx(u,{sx:w,children:s.jsx(B,{active:d===e.id,direction:d===e.id?x:"asc",onClick:()=>v(e.id),children:e.label})},e.id)),r!=="inspection report"&&s.jsx(u,{sx:w,children:s.jsx(B,{children:"Actions"})})]})}),s.jsx(ae,{children:R.map((e,t)=>s.jsxs(S,{children:[s.jsx(u,{children:e.breakdown_id}),s.jsx(u,{children:`${e.user.us_user.first_name} ${e.user.us_user.last_name}`}),s.jsx(u,{children:e.submission_date||"N/A"}),s.jsx(u,{children:e.workshop_group.group_name}),s.jsx(u,{sx:{color:e.status==="Open"?"blue":e.status==="Close"?"green":"red"},children:e.status}),r!=="inspection report"&&s.jsx(u,{children:s.jsx(ie,{inspectionData:e})})]},t))})]})}),s.jsx(J,{component:"div",count:D.length,page:g,onPageChange:L,rowsPerPage:i,onRowsPerPageChange:y,rowsPerPageOptions:[5,10,15]})]})})},Ce=le;export{Ce as I};
