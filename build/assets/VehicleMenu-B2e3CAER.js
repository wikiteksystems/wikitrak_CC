import{k,r as l,i as q,j as o,B as _,w as x,t as a,T as z,l as G,v as H,m as T,n as J,bL as V}from"./index-C_wM5jQm.js";import{S as K,R as Q,t as U}from"./LeftSideBar2-BL42KEV5.js";import{B as b,C as X}from"./menu2-BdQ5f_y8.js";const re=({vehicleData:c,title:f,setParameterData:L,loadingVehicle:R})=>{const{selectedVehicle:n,locationData:s,loading:p}=k(e=>e.liveMap),{mode:E,showVehicles:A}=k(e=>e.dashboard),d=U(E),[y,B]=l.useState(""),[h,M]=l.useState(""),i=l.useRef(null),j=l.useRef(0);let g=q();l.useEffect(()=>{console.log("loading",p)},[p]),l.useEffect(()=>{console.log("vehicleData",c)},[c]),l.useEffect(()=>{i.current&&setTimeout(()=>{i.current.scrollTop=j.current},0)});const m=c.length>0&&c.filter(e=>{var r,u;return((r=e==null?void 0:e.label)==null?void 0:r.toLowerCase().includes(y.toLowerCase()))&&(h===""||((u=e==null?void 0:e.workShop)==null?void 0:u.region)===h)}),O=async e=>{var v,C;if(i.current&&(j.current=i.current.scrollTop),G(!A),(s==null?void 0:s.length)<=0)return x.error("Data not available for this vehicle",{id:"clipboard"});const r=s==null?void 0:s.filter(t=>t.latestDocument.imei===e.value);if((r==null?void 0:r.length)<=0)return x.error("Data not available for this vehicle",{id:"clipboard"});const{lat:u,lng:I}=((v=r==null?void 0:r[0])==null?void 0:v.latestDocument)??{},N={lat:u||V.lat,lng:I||V.lat};g(H(N)),g(T({imei:e.value,reg_id:e.label}));const W=e.label,$=await g(J({w_registration_id:W})),w=[];let Y=0;(C=$.payload)==null||C.map(t=>{t[t.parameter_type.toLowerCase()+"_parameter"].forEach(S=>{w.push({reg_id:e.label,imei:e.value,id:S.id,_id:t.id,key:Y++,label:t.parameter_type==="Telematic"&&S.short_name})})}),f==="Live Map"&&L(w)},P=()=>{g(T({}))},D=e=>{M(e)},F={backgroundColor:d.grey[100],position:"relative",width:"100%",float:"right",height:"90vh",overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"};return o.jsx(o.Fragment,{children:o.jsx("div",{ref:i,style:F,children:p||R?o.jsx(b,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:o.jsx(X,{})}):o.jsxs(o.Fragment,{children:[o.jsx(K,{searchTerm:y,setSearchedTerm:B}),o.jsx(Q,{region:h,handleRegion:D}),f==="Live Map"&&o.jsx(b,{sx:{align:"center",my:"8px",ml:"20px"},children:o.jsx(_,{variant:"outlined",onClick:()=>{if(Object.keys(n).length>0)P();else return x.success("Already Selected To View All Vehicle Location.",{id:"already selected"})},sx:{width:"90%",bgcolor:Object.keys(n).length===0?a.bgColor:"undefined",color:Object.keys(n).length===0?"white":d.grey[400],border:`1px solid ${a.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:a.bgShadow}},children:"All Vehicles"})}),m.length>0?m.map((e,r)=>o.jsx(b,{sx:{align:"center",my:"8px",ml:"20px"},children:o.jsx(_,{variant:"outlined",onClick:()=>{O(e)},sx:{width:"90%",bgcolor:e.label===n.reg_id?a.bgColor:"undefined",color:e.label===n.reg_id?"white":d.grey[400],border:`1px solid ${a.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:a.bgShadow}},children:e.label})},r)):o.jsx(b,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:o.jsxs(z,{sx:{textAlign:"center",color:d.grey[400]},children:["Sorry! No vehicles in"," ",o.jsx("span",{style:{fontWeight:"bold"},children:h})," region"]})})]})})})};export{re as V};
