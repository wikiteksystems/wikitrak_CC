import{p as Ee,q as $e,w as M,x as fe,y as re,z as Oe,A as Be,B as Ve,r as p,C as ze,D as q,j as e,E as X,F as Ge,H as ye,I as Q,J as Z,K as qe,L as ce,M as H,N as de,O as Ce,T as z,a as N,G as K,c as G,u as ee,b as be,_ as V,P as He,t as Ue,Q as We,R as Ye,S as Xe,U as ve,i as pe,V as Je,W as se,X as Ke,Y as Qe,Z as je,$ as ne,a0 as Ze,l as et,m as tt,n as ot,o as rt,v as st}from"./index-C_4gHeOh.js";import{L as nt}from"./LightModeOutlined--znN02Bn.js";import{s as le}from"./Socket-0N_gnJcr.js";import{p as lt,R as at,L as it,X as ct,Y as dt,a as pt,b as ut,T as ht}from"./LineChart-DXd-svRe.js";import{t as U,d as gt}from"./Search-CWG6crCq.js";import{B as b,C as ke}from"./CircularProgress-D3m1apge.js";import{P as mt}from"./Paper-_ohx_GPa.js";import{c as xt,S as ft}from"./Switch-BpUci2Ym.js";import{c as yt,I as bt}from"./IconButton-ikx-DoFd.js";import{r as vt,m as jt,a as St}from"./mergeSlotProps-Bp2Ixco-.js";import{C as Te}from"./index-BPH8xVQP.js";import{u as wt,G as Ct,M as kt}from"./esm-D4QauObS.js";import{u as Pe,f as De,F as Tt,I as Pt,O as Dt,a as It}from"./OutlinedInput-DH688o9S.js";import{d as Se}from"./index-AzJBaX0m.js";import{D as At}from"./DateTimePicker-C268J9JJ.js";import{r as ue}from"./createSvgIcon-Gmgz6FzL.js";import{T as Ft,a as Lt,d as Mt,b as Rt,c as ae}from"./TableRow-DvOklg4m.js";import{T as Nt}from"./TopBar-QG_cFEhL.js";import{G as _t}from"./GeofencAlert-C-8VHAYU.js";import"./index-D_PtdUc8.js";import"./roundedArrow-BbKGAnPH.js";import"./button-DnqWUkk_.js";import"./NotificationsNone-BMkhl_bd.js";const Et=["component","direction","spacing","divider","children","className","useFlexGap"],$t=Ee(),Ot=$e("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,o)=>o.root});function Bt(t){return Ge({props:t,name:"MuiStack",defaultTheme:$t})}function Vt(t,o){const r=p.Children.toArray(t).filter(Boolean);return r.reduce((l,u,a)=>(l.push(u),a<r.length-1&&l.push(p.cloneElement(o,{key:`separator-${a}`})),l),[])}const zt=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],Gt=({ownerState:t,theme:o})=>{let r=M({display:"flex",flexDirection:"column"},fe({theme:o},re({values:t.direction,breakpoints:o.breakpoints.values}),l=>({flexDirection:l})));if(t.spacing){const l=Oe(o),u=Object.keys(o.breakpoints.values).reduce((y,c)=>((typeof t.spacing=="object"&&t.spacing[c]!=null||typeof t.direction=="object"&&t.direction[c]!=null)&&(y[c]=!0),y),{}),a=re({values:t.direction,base:u}),g=re({values:t.spacing,base:u});typeof a=="object"&&Object.keys(a).forEach((y,c,m)=>{if(!a[y]){const k=c>0?a[m[c-1]]:"column";a[y]=k}}),r=Be(r,fe({theme:o},g,(y,c)=>t.useFlexGap?{gap:ye(l,y)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${zt(c?a[c]:t.direction)}`]:ye(l,y)}}))}return r=Ve(o.breakpoints,r),r};function qt(t={}){const{createStyledComponent:o=Ot,useThemeProps:r=Bt,componentName:l="MuiStack"}=t,u=()=>Q({root:["root"]},y=>Z(l,y),{}),a=o(Gt);return p.forwardRef(function(y,c){const m=r(y),x=ze(m),{component:k="div",direction:d="column",spacing:n=0,divider:v,children:j,className:w,useFlexGap:P=!1}=x,h=q(x,Et),D={direction:d,spacing:n,useFlexGap:P},A=u();return e.jsx(a,M({as:k,ownerState:D,ref:c,className:X(A.root,w)},h,{children:v?Vt(j,v):j}))})}const Ht=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Ut=["component","slots","slotProps"],Wt=["component"];function Yt(t,o){const{className:r,elementType:l,ownerState:u,externalForwardedProps:a,getSlotOwnerState:g,internalForwardedProps:i}=o,y=q(o,Ht),{component:c,slots:m={[t]:void 0},slotProps:x={[t]:void 0}}=a,k=q(a,Ut),d=m[t]||l,n=vt(x[t],u),v=jt(M({className:r},y,{externalForwardedProps:t==="root"?k:void 0,externalSlotProps:n})),{props:{component:j},internalRef:w}=v,P=q(v.props,Wt),h=qe(w,n==null?void 0:n.ref,o.ref),D=g?g(P):{},A=M({},u,D),T=t==="root"?j||c:j,L=St(d,M({},t==="root"&&!c&&!m[t]&&i,t!=="root"&&!m[t]&&i,P,T&&{as:T},{ref:h}),A);return Object.keys(D).forEach(F=>{delete L[F]}),[d,L]}const Xt=yt(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function Jt(t){return Z("MuiAvatar",t)}ce("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Kt=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],Qt=xt(),Zt=t=>{const{classes:o,variant:r,colorDefault:l}=t;return Q({root:["root",r,l&&"colorDefault"],img:["img"],fallback:["fallback"]},Jt,o)},eo=H("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.root,o[r.variant],r.colorDefault&&o.colorDefault]}})(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:M({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:M({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]})),to=H("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,o)=>o.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),oo=H(Xt,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,o)=>o.fallback})({width:"75%",height:"75%"});function ro({crossOrigin:t,referrerPolicy:o,src:r,srcSet:l}){const[u,a]=p.useState(!1);return p.useEffect(()=>{if(!r&&!l)return;a(!1);let g=!0;const i=new Image;return i.onload=()=>{g&&a("loaded")},i.onerror=()=>{g&&a("error")},i.crossOrigin=t,i.referrerPolicy=o,i.src=r,l&&(i.srcset=l),()=>{g=!1}},[t,o,r,l]),u}const so=p.forwardRef(function(o,r){const l=Qt({props:o,name:"MuiAvatar"}),{alt:u,children:a,className:g,component:i="div",slots:y={},slotProps:c={},imgProps:m,sizes:x,src:k,srcSet:d,variant:n="circular"}=l,v=q(l,Kt);let j=null;const w=ro(M({},m,{src:k,srcSet:d})),P=k||d,h=P&&w!=="error",D=M({},l,{colorDefault:!h,component:i,variant:n}),A=Zt(D),[T,L]=Yt("img",{className:A.img,elementType:to,externalForwardedProps:{slots:y,slotProps:{img:M({},m,c.img)}},additionalProps:{alt:u,src:k,srcSet:d,sizes:x},ownerState:D});return h?j=e.jsx(T,M({},L)):a||a===0?j=a:P&&u?j=u[0]:j=e.jsx(oo,{ownerState:D,className:A.fallback}),e.jsx(eo,M({as:i,ownerState:D,className:X(A.root,g),ref:r},v,{children:j}))}),no=so,lo=qt({createStyledComponent:H("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,o)=>o.root}),useThemeProps:t=>de({props:t,name:"MuiStack"})}),ao=lo;function io(t){return Z("MuiFormControlLabel",t)}const co=ce("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Y=co,po=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],uo=t=>{const{classes:o,disabled:r,labelPlacement:l,error:u,required:a}=t,g={root:["root",r&&"disabled",`labelPlacement${Ce(l)}`,u&&"error",a&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",u&&"error"]};return Q(g,io,o)},ho=H("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[{[`& .${Y.label}`]:o.label},o.root,o[`labelPlacement${Ce(r.labelPlacement)}`]]}})(({theme:t,ownerState:o})=>M({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Y.disabled}`]:{cursor:"default"}},o.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},o.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},o.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${Y.label}`]:{[`&.${Y.disabled}`]:{color:(t.vars||t).palette.text.disabled}}})),go=H("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(t,o)=>o.asterisk})(({theme:t})=>({[`&.${Y.error}`]:{color:(t.vars||t).palette.error.main}})),mo=p.forwardRef(function(o,r){var l,u;const a=de({props:o,name:"MuiFormControlLabel"}),{className:g,componentsProps:i={},control:y,disabled:c,disableTypography:m,label:x,labelPlacement:k="end",required:d,slotProps:n={}}=a,v=q(a,po),j=Pe(),w=(l=c??y.props.disabled)!=null?l:j==null?void 0:j.disabled,P=d??y.props.required,h={disabled:w,required:P};["checked","name","onChange","value","inputRef"].forEach(I=>{typeof y.props[I]>"u"&&typeof a[I]<"u"&&(h[I]=a[I])});const D=De({props:a,muiFormControl:j,states:["error"]}),A=M({},a,{disabled:w,labelPlacement:k,required:P,error:D.error}),T=uo(A),L=(u=n.typography)!=null?u:i.typography;let F=x;return F!=null&&F.type!==z&&!m&&(F=e.jsx(z,M({component:"span"},L,{className:X(T.label,L==null?void 0:L.className),children:F}))),e.jsxs(ho,M({className:X(T.root,g),ownerState:A,ref:r},v,{children:[p.cloneElement(y,h),P?e.jsxs(ao,{display:"block",children:[F,e.jsxs(go,{ownerState:A,"aria-hidden":!0,className:T.asterisk,children:["â€‰","*"]})]}):F]}))}),xo=mo;function fo(t){return Z("MuiFormGroup",t)}ce("MuiFormGroup",["root","row","error"]);const yo=["className","row"],bo=t=>{const{classes:o,row:r,error:l}=t;return Q({root:["root",r&&"row",l&&"error"]},fo,o)},vo=H("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.root,r.row&&o.row]}})(({ownerState:t})=>M({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})),jo=p.forwardRef(function(o,r){const l=de({props:o,name:"MuiFormGroup"}),{className:u,row:a=!1}=l,g=q(l,yo),i=Pe(),y=De({props:l,muiFormControl:i,states:["error"]}),c=M({},l,{row:a,error:y.error}),m=bo(c);return e.jsx(vo,M({className:X(m.root,u),ownerState:c,ref:r},g))}),So=jo,wo=({imeiNo:t})=>{const{selectedVehicle:o,parameterData:r,ivnPid:l,locationData:u,vehicleList:a,onlineVehicle:g}=N(T=>T.liveMap),{ivnParameters:i,mode:y}=N(T=>T.dashboard),c=U(y),[m,x]=p.useState(),[k,d]=p.useState(!1),[n,v]=p.useState();p.useState({mainInputVoltage:0,ignition:0,speed:0});const[j,w]=p.useState("Not Available"),[P,h]=p.useState("Offline");p.useEffect(()=>{D()},[o]);const D=()=>{var T,L,F,I;if((u==null?void 0:u.length)>0){console.log("locationData",u);let C=u==null?void 0:u.find(W=>W.latestDocument.imei===o.imei);C?(x((T=C==null?void 0:C.latestDocument)==null?void 0:T.speed),d((L=C==null?void 0:C.latestDocument)==null?void 0:L.ignition),v((F=C==null?void 0:C.latestDocument)==null?void 0:F.mainInputVoltage),w((I=C==null?void 0:C.latestDocument)==null?void 0:I.venderId)):(x(0),d(0),v(0),w("Not Available"))}else x(0),d(0),v(0),w("Not Available")};p.useEffect(()=>{Object.keys(o).length>0&&A()},[o]);const A=()=>{if(Object.keys(o).length>0)if(g&&g.length>0){const T=g.some(L=>parseInt(L)===parseInt(o==null?void 0:o.imei));h(T?"Online":"Offline")}else h("Offline");else h("Offline")};return e.jsxs(e.Fragment,{children:[e.jsx(b,{sx:{mx:"10px",pt:"10px",color:c.grey[400]},children:e.jsx("b",{children:o==null?void 0:o.reg_id})}),e.jsx(b,{sx:{backgroundColor:c.grey[200],height:"12vh",borderRadius:"8px",p:"5px"},children:e.jsx(b,{sx:{},children:e.jsx(K,{container:!0,spacing:3,mt:"2.5px",children:e.jsx(K,{item:!0,xs:12,children:e.jsx(K,{container:!0,justifyContent:"space-around",spacing:3,children:[{label:"VenderId",value:j},{label:"Speed",value:m,unit:"km/h"},{label:"Main Input Voltage",value:parseFloat(n).toFixed(2),unit:"voltage"},{label:"Current Status",value:P}].map((T,L)=>e.jsx(K,{item:!0,children:e.jsxs(mt,{sx:{height:70,width:250,backgroundColor:c.grey[100],color:c.grey[400],display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 10px"},children:[e.jsxs(b,{children:[e.jsx(z,{variant:"h6",sx:{fontSize:"12px"},children:T.label}),e.jsxs(z,{variant:"h6",sx:{fontSize:"18px",fontWeight:"bold"},children:[T.value," ",T==null?void 0:T.unit]})]}),e.jsx(no,{src:lt,sx:{width:20,height:20}})]})},L))})})})})})]})},ie=({title:t,selectedTripData:o})=>{const{mode:r,loading:l}=N(c=>c.dashboard),{selectedVehicle:u}=N(c=>c.liveMap),[a,g]=p.useState([]);p.useEffect(()=>{let c=o.map(x=>{let k={...x};return k.ignition=k.ignition?1:0,k});const m=y(c);g(m)},[o]);const i=U(r),y=c=>{let m=null;return c.forEach(x=>{const k=new Date(x.createdAt);m&&m.toDateString()===k.toDateString()?(x.date=G(x.createdAt).format("HH:mm:ss"),x.ignition=x.ignition?1:0):(x.date=G(x.createdAt).format("DD-MM-YYYY"),x.ignition=x.ignition?1:0),m=k}),c};return e.jsx(b,{sx:{ml:"2rem",border:i.grey[300],fontSize:"13px",height:"24vh",color:i.grey[400],backgroundColor:i.grey[100],borderRadius:"5px"},children:a&&a.length>0?e.jsx(at,{children:e.jsxs(it,{data:a,margin:{top:15,right:10,left:-25,bottom:0},children:[e.jsx(ct,{dataKey:"date",stroke:i.grey[400]}),e.jsx(dt,{stroke:i.grey[400]}),e.jsx(pt,{type:"monotone",dataKey:t,dot:!1,stroke:"#EF5B05",strokeWidth:2}),e.jsx(ut,{layout:"horizontal",verticalAlign:"top",align:"center"}),e.jsx(ht,{})]})}):e.jsx(Te,{style:{background:i.grey[100],width:"400px",height:"100px",margin:"auto",marginTop:"10px"},children:Object.keys(u).length===0?e.jsx(z,{textAlign:"center",align:"center",mt:"20px",color:i.grey[600],children:"Please Select a Vehicle"}):l?e.jsx(ke,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(z,{textAlign:"center",color:i.grey[600],children:"Sorry! No Trips Available"})})})},Co=()=>{const t=ee(),{center:o,selectedParameterList:r,selectedVehicle:l,vehicleList:u,tractorIcon:a,icons:g,locationData:i,ivnPid:y,placesData:c}=N(I=>I.liveMap),{mode:m}=N(I=>I.dashboard),{isLoaded:x,loadError:k}=wt({googleMapsApiKey:"AIzaSyA_S7GfAh6rJYWQ5X4n4X-3poo3vymuspU"}),[d,n]=p.useState(null),[v,j]=p.useState(!0),[w,P]=p.useState(5),[h,D]=p.useState(),A=U(m);p.useEffect(()=>{if(v)D(i);else{let I=i==null?void 0:i.filter(C=>(C==null?void 0:C._id)===(l==null?void 0:l.imei));D(I)}},[i,l,v]);const T=()=>{if(!v)t(be({lat:21,lng:78})),P(4),j(C=>!C);else{const I=i.find(C=>C.latestDocument.imei===l.imei);if(I){console.log(I.latestDocument,"getCenter");const{lat:C,lng:W}=I.latestDocument;t(be({lat:C,lng:W})),P(12),j(te=>!te)}else V.error("Data is not available for selected vehicle")}};if(p.useEffect(()=>{x&&n(window.google.maps)},[x,i]),k)return"Error loading maps";if(!x)return"Loading maps";const L={height:"41.5vh",width:"99%",marginTop:"0px",marginLeft:"10px"},F=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}];return d?e.jsxs("div",{children:[e.jsxs(b,{sx:{ml:"10px",fontSize:"20px",display:"flex",justifyContent:"space-between",color:A.grey[400]},children:[e.jsx("b",{children:"Live Map"}),e.jsx(So,{sx:{marginLeft:0,paddingTop:0,color:A.grey[400]},children:e.jsx(xo,{control:e.jsx(ft,{checked:v,onChange:T}),label:v?"Group":"Individual"})})]}),e.jsx(Ct,{mapContainerStyle:L,zoom:w,center:o,options:{mapTypeControl:!1,styles:m?F:""},children:h&&h.length>0&&h.map((I,C)=>e.jsx(kt,{position:{lat:I.latestDocument.lat,lng:I.latestDocument.lng},icon:{fillColor:"red",fillOpacity:2,strokeWeight:1,scale:2}},C))})]}):null},ko=({vehicleData:t})=>{const o=["Engine RPM","Engine coolant temperature","Battery Potential"],r=ee(),{selectedVehicle:l}=N(d=>d.liveMap),{startDate:u,endDate:a,mode:g}=N(d=>d.dashboard),[i,y]=p.useState(""),c=U(g),m=t.length>0&&t.filter(d=>d.label.toLowerCase().includes(i.toLowerCase())),x=d=>{y(d.target.value)},k=async d=>{var P;r(We({imei:d.value,reg_id:d.label}));let n={imei:d.value,startDate:Se().subtract(5,"day"),endDate:Se()};r(Ye(n));let v=d.label;const j=await r(Xe({registration_id:v}));let w=[];if(j&&j.payload.length>0&&((P=j.payload)==null||P.map(h=>{h.ivn_parameter.length>0&&w.push(h.ivn_parameter[0])})),w.length>0){let h=w.filter(D=>o.includes(D.pid_description));r(ve(h))}else r(ve([]))};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(b,{sx:{align:"center",my:"15px",ml:"20px"},children:e.jsxs(Tt,{sx:{width:"90%",backgroundColor:"white",borderRadius:"5px"},variant:"outlined",children:[e.jsx(Pt,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px"},children:"Search"}),e.jsx(Dt,{onChange:d=>x(d),inputProps:{style:{padding:7}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(It,{position:"end",children:e.jsx(bt,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(gt,{})})}),label:"Search"})]})}),m.length>0&&m.map((d,n)=>e.jsx(b,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(He,{variant:"outlined",onClick:()=>{k(d)},sx:{width:"90%",bgcolor:d.label===l.reg_id?Ue.bgColor:"undefined",color:d.label===l.reg_id?"#DAE0EE":c.grey[400]},children:d.label})},n))]})})};var he={},To=pe;Object.defineProperty(he,"__esModule",{value:!0});var Ie=he.default=void 0,Po=To(ue()),Do=e;Ie=he.default=(0,Po.default)((0,Do.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined");var ge={},Io=pe;Object.defineProperty(ge,"__esModule",{value:!0});var Ae=ge.default=void 0,Ao=Io(ue()),Fo=e;Ae=ge.default=(0,Ao.default)((0,Fo.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined");var me={},Lo=pe;Object.defineProperty(me,"__esModule",{value:!0});var Fe=me.default=void 0,Mo=Lo(ue()),we=e;Fe=me.default=(0,Mo.default)([(0,we.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,we.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");const Ro=()=>{const t=ee(),o=Je(),{tripList:r,selectedTripData:l,loading:u,trips:a,activeIndex:g,searchText:i,mode:y}=N(s=>s.dashboard),{selectedVehicle:c}=N(s=>s.liveMap),[m,x]=p.useState(0),[k,d]=p.useState(0),[n,v]=p.useState(0),[j,w]=p.useState(0),[P,h]=p.useState("0"),[D,A]=p.useState(0),[T,L]=p.useState(!1),F=U(y),I=()=>{x(s=>s+3)},C=()=>{x(s=>Math.max(s-5,0))};p.useEffect(()=>{const s=W(r);if(s.length>0){t(se(s[0]));const f=r&&r.length>0&&r.filter(S=>S.formatedDate.toLowerCase().includes(i.toLowerCase()));f.length>0&&oe(0,f[0])}t(Ke(s))},[r]),p.useEffect(()=>{if(l.length>0){const s=l.map(S=>({lat:parseFloat(S.lat),lng:parseFloat(S.lng)})),f=new window.google.maps.Polygon({paths:s});xe(f)}},[l]);const W=s=>{const f=new Set,S=[];return s.forEach(R=>{f.has(R.formatedDate)||(f.add(R.formatedDate),S.push(R.formatedDate))}),S},$=r&&r.length>0&&r.filter(s=>s.formatedDate.toLowerCase().includes(i.toLowerCase())),te=s=>{if($&&$.length>0){const f=r&&r.length>0&&r.filter(S=>S.formatedDate.toLowerCase().includes(s.toLowerCase()));t(ne(0)),t(se(s)),oe(0,f[0])}else t(ne(null)),t(se(s))},oe=async(s,f)=>{var _;console.log("item",f);let S={imei:c.imei,startDate:f.startDate,endDate:f.endDate};L(!0);const R=await Qe(S);((_=R==null?void 0:R.data)==null?void 0:_.documents.length)>0?(t(je(R.data.documents[0].data)),Le(R.data.documents[0].data),L(!1)):(w(0),v(0),A(0),d(0),h("0"),t(je([])),L(!1)),t(ne(s))},Le=s=>{let f=0,S=0;s.map((E,J)=>{E.packetType==="HB"&&f++,E.packetType==="HA"&&S++}),d(f),v(S);let R=Me(new Date(s[0].createdAt).toISOString(),new Date(s[s.length-1].createdAt).toISOString());console.log("hours: ",R),h(R);const _=Re(s);A(_);const O=s.map(E=>({lat:parseFloat(E.lat),lng:parseFloat(E.lng)})),B=new window.google.maps.Polygon({paths:O});xe(B)};function Me(s,f){var S=G(s),R=G(f);console.log("startDate-------->",s,f);let _=G.duration(R.diff(S)),O=_.hours(),B=_.minutes(),E=_.seconds(),J=`${O}h ${B}m ${E}s`;return console.log("string",J),J}function Re(s){let f=0;for(let S=0;S<s.length-1;S++){const R=s[S].lat,_=s[S].lng,O=s[S+1].lat,B=s[S+1].lng;f+=Ne(R,_,O,B)}return f}function Ne(s,f,S,R){const O=(S-s)*Math.PI/180,B=(R-f)*Math.PI/180,E=Math.sin(O/2)*Math.sin(O/2)+Math.cos(s*Math.PI/180)*Math.cos(S*Math.PI/180)*Math.sin(B/2)*Math.sin(B/2);return 6371*(2*Math.atan2(Math.sqrt(E),Math.sqrt(1-E)))}const xe=s=>{if(!window.google||!window.google.maps.geometry){console.log("not loaded");return}const S=window.google.maps.geometry.spherical.computeArea(s.getPath())/4046.86;w(S)},_e=s=>{g!==null?s===g?(t(Ze(!0)),o("/trip-monitor")):V.error("Trip not selected"):V.error("Please select the trip")};return e.jsxs(e.Fragment,{children:[e.jsxs(b,{sx:{width:"95%",display:"flex",overflow:"auto",mx:"10px"},children:[e.jsx("div",{style:{display:"flex"},children:a&&a.length>0&&a.slice(m,m+5).map((s,f)=>e.jsx(b,{sx:{backgroundColor:i===s?"#EF5B05":"white",color:i===s?"white":"#EF5B05",mx:"5px",p:"5px",borderRadius:"5px",width:"90px",height:"25px",textAlign:"center",cursor:"pointer"},onClick:()=>{te(s)},children:s},f))}),m!==0&&e.jsx("button",{onClick:C,style:{marginLeft:"5px",backgroundColor:"white",color:"black"},disabled:m===0,children:e.jsx(Ae,{})}),!(m+5>=a.length)&&e.jsx("button",{onClick:I,style:{marginLeft:"5px",backgroundColor:"white",color:"black"},disabled:m+5>=a.length,children:e.jsx(Ie,{})})]}),e.jsx(b,{children:$&&$.length>0?e.jsx(Ft,{sx:{maxHeight:210,height:210,width:"98%",ml:"10px",mt:"10px",borderRadius:"5px",border:"1px solid #dbdad5"},children:e.jsx(Lt,{stickyHeader:!0,"aria-label":"sticky table",children:e.jsx(Mt,{children:$&&$.length>0&&$.map((s,f)=>e.jsxs(Rt,{sx:{backgroundColor:g===f?"#DAE0EE":F.grey[100]},children:[e.jsxs(ae,{align:"left",style:{fontSize:"12px",padding:10,color:g===f?"black":F.grey[400],cursor:"pointer"},onClick:()=>{oe(f,s)},children:[f+1,". ",s.startLocation," to ",s.endLocation]}),e.jsxs(ae,{align:"right",style:{fontSize:"12px",padding:10,color:g===f?"black":F.grey[400]},children:[s!=null&&s.startDate?G(new Date(s.startDate).toISOString()).format("LT"):""," ","to"," ",s!=null&&s.endDate?G(new Date(s.endDate).toISOString()).format("LT"):"----"]}),e.jsx(ae,{align:"right",style:{fontSize:"12px",padding:10,color:g===f?"black":F.grey[400]},children:e.jsx("span",{title:"Navigate to map",style:{cursor:"pointer"},onClick:()=>{_e(f)},children:e.jsx(Fe,{})})})]}))})})}):e.jsx(b,{sx:{height:210,display:"flex",justifyContent:"center",alignItems:"center",color:F.grey[400],margin:"auto"},children:e.jsx(Te,{style:{background:F.grey[100],width:"400px",height:"100px"},children:Object.keys(c).length===0?e.jsx(z,{textAlign:"center",align:"center",mt:"20px",color:F.grey[600],children:"Please Select a Vehicle"}):u?e.jsx(ke,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(z,{textAlign:"center",color:F.grey[600],children:"Sorry! No Trips Available"})})})}),l.length>0&&e.jsx(b,{sx:{my:"0px"},children:e.jsxs(b,{sx:{display:"flex",mx:"5px",mt:"5px"},children:[e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Braking"}),e.jsx("div",{children:"0"})]}),e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Acceleration"}),e.jsx("div",{children:"0"})]}),e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Running Hrs"}),e.jsx("div",{children:P})]}),e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Distance"}),e.jsx("div",{children:parseFloat(parseFloat(D).toFixed(2))})]})]})})]})},No=()=>{const{mode:t}=N(r=>r.dashboard),o=U(t);return e.jsxs(b,{children:[e.jsxs(b,{sx:{display:"flex",ml:"5px"},children:[e.jsx(b,{sx:{m:"5px",fontSize:"20px",width:"60%",color:o.grey[400]},children:e.jsx("b",{children:"Trip History"})}),e.jsx(b,{children:e.jsx(At,{})})]}),e.jsx(b,{sx:{my:"5px"},children:e.jsx(Ro,{})})]})},lr=()=>{const{w_customer_id:t}=N(n=>n.auth),{mode:o,selectedTripData:r}=N(n=>n.dashboard),[l,u]=p.useState(()=>{const n=sessionStorage.getItem("imeiNo");return n?JSON.parse(n):[]}),a=ee(),g=U(o),[i,y]=p.useState([]),[c,m]=p.useState(!1),[x,k]=p.useState(!1);p.useEffect(()=>{d()},[]),p.useEffect(()=>{sessionStorage.setItem("imeiNo",JSON.stringify(l))},[l]),p.useEffect(()=>{le.on("geofenceAlert",n=>{(n==null?void 0:n.imei)!==null&&l.find(w=>parseInt(w)===(n==null?void 0:n.imei))&&(console.log("geofence"),V.error(`Type: ${n==null?void 0:n.type} ${n==null?void 0:n.msg} ${n==null?void 0:n.imei}`,{id:"geofence",autoClose:5e3}))}),le.on("speedAlert",n=>{(n==null?void 0:n.imei)!==null&&l.find(w=>parseInt(w)===(n==null?void 0:n.imei))&&V.error(`${n==null?void 0:n.msg} ${n==null?void 0:n.imei}`,{id:"speed",autoClose:5e3})})},[le]);const d=async()=>{try{let n=[],v=[];const j=await a(et({w_customer_id:t}));if(Array.isArray(j.payload)){j.payload.forEach(h=>{var D,A;Array.isArray(h.imei)&&h.imei.length>0?(n.push({id:h.id,label:h.registration_id,value:(D=h==null?void 0:h.imei[0])==null?void 0:D.mac_id}),v.push((A=h.imei[0])==null?void 0:A.mac_id)):(console.error("IMEI data not found for item:",h),V.error(`IMEI Number not found for the vehicle: ${h==null?void 0:h.registration_id}`))}),u(v);const w="one",P=v;v.length>0&&(a(tt({type:w,imei:P})),a(ot(P))),y(n),a(rt({w_customer_id:t})),a(st({}))}else console.error("Unexpected data format:",j),V.error("Unexpected data format:")}catch(n){console.error("Error fetching vehicle data:",n),V.error(`Error fetching vehicle data: ${n}`)}};return e.jsxs("div",{className:"app",children:[e.jsx(nt,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(Nt,{title:"Dashboard",showVehicles:c,setShowVehicles:m,setShowNotification:k,showNotification:x}),e.jsxs("div",{style:{height:"92vh",backgroundColor:g.grey[100],padding:"10px"},children:[c&&e.jsx(b,{sx:{position:"fixed",width:"250px",right:"0px",height:"90vh",zIndex:9999,backgroundColor:g.grey[100],overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"},children:e.jsx(ko,{vehicleData:i})}),x&&e.jsx(b,{sx:{position:"fixed",width:"300px",right:"0px",height:"90vh",zIndex:9999,backgroundColor:g.grey[100]},children:e.jsx(_t,{})}),e.jsx(b,{sx:{height:"21%"},children:e.jsx(wo,{imeiNo:l})}),e.jsxs(b,{sx:{display:"flex",height:"50%"},children:[e.jsx(b,{sx:{width:"50%",border:"1px solid #E8E8E8",padding:"2px",borderRadius:"5px"},children:e.jsx(No,{})}),e.jsx(b,{sx:{width:"50%"},children:e.jsx(Co,{})})]}),e.jsxs(b,{sx:{display:"flex",height:"30%",mt:"5px",pt:"10px"},children:[e.jsx(b,{style:{width:"33%"},children:e.jsx(ie,{title:"speed",selectedTripData:r})}),e.jsx(b,{style:{width:"33%"},children:e.jsx(ie,{title:"mainInputVoltage",selectedTripData:r})}),e.jsx(b,{style:{width:"33%"},children:e.jsx(ie,{title:"ignition",selectedTripData:r})})]})]})]})]})};export{lr as default};
