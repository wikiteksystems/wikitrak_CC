import{i as sa,j as t,a as D,r as n,u as te,t as X,P as N,T as C,as as fe,s as Oa,h as Ea,at as _a,au as re,_ as M,av as Fa,aw as Ia,v as La,l as Pa,m as Ga}from"./index-DjqlciL2.js";import{d as Ta,a as Va,m as Ba,b as Wa,c as Na,L as Ma}from"./LightModeOutlined-BiFEkYGq.js";import{r as ia}from"./createSvgIcon-DQRdXtjD.js";import{d as za}from"./NotificationsNone-zCq-MNiA.js";import{j as Xa}from"./jcb-aCHXMCXy.js";import{B as o}from"./CircularProgress-D1_1jMhc.js";import{I as me}from"./IconButton-BwM6YMlX.js";import{V as Ua}from"./VehicleMenu-DHYsfVQf.js";import{G as Ja}from"./GeofencAlert-CIJF9HkI.js";import{u as Ka,c as Ha,a as $t,b as Ya,d as qa,V as ea,e as ta}from"./Form-DlJvtC9P.js";import{t as ce}from"./Search-CSG1x6aD.js";import{T as aa}from"./TextField-C4RRXEFG.js";import{a as oa}from"./OutlinedInput-X6AkQhfw.js";import{m as le,f as ra}from"./4W-CSnZ3_ps.js";import{t as la}from"./ol-6TvppJQB.js";import{u as Za,G as Qa,C as $a,R as eo,b as na,M as to}from"./esm-_3X0RUr1.js";import{S as ue}from"./Switch-aixylP3X.js";import{I as ao}from"./Select-D-5iZ2GH.js";import"./proj-XQwXs9DQ.js";import"./Modal-B0dV1QMA.js";import"./Paper-DoGSc9zf.js";var we={},oo=sa;Object.defineProperty(we,"__esModule",{value:!0});var ca=we.default=void 0,no=oo(ia()),so=t;ca=we.default=(0,no.default)((0,so.jsx)("path",{d:"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonOutlined");var ye={},io=sa;Object.defineProperty(ye,"__esModule",{value:!0});var da=ye.default=void 0,ro=io(ia()),lo=t;da=ye.default=(0,ro.default)((0,lo.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Place");const co=({title:r,setShowContent:u,showContent:c,showMap:m,setShowMap:s,setShowGfBar:S,showGfBar:R,setShowGfAlert:y,showGfAlert:v})=>{const{collapsed:O}=D(h=>h.auth),{selectedVehicle:j}=D(h=>h.liveMap),{vehicleSideBar:d}=D(h=>h.geofence);n.useState(!1);const{mode:b}=D(h=>h.dashboard);JSON.parse(localStorage.getItem("w_userDetails"));const p=te(),w=()=>{p(Ea(!O))},f=()=>{u({...c,vehicle:!c.vehicle}),S(!1),y(!1),p(fe({data:!d}))};return t.jsxs(o,{display:"flex",justifyContent:"space-between",p:1,sx:{bgcolor:X.bgColor,border:"1px solid white",borderRadius:"4px",height:"55px"},children:[t.jsxs(o,{style:{display:"flex",justifyContent:"space-between",gap:"10px",alignItems:"center"},children:[O?t.jsx(N,{onClick:w,sx:{color:"white"},children:t.jsx(Ta,{style:{width:"30px",height:"30px"}})}):t.jsx(N,{onClick:w,sx:{color:"white"},children:t.jsx(Va,{style:{width:"30px",height:"30px"}})}),t.jsx(o,{children:t.jsx("img",{src:`${Ba}`,style:{width:"36px",height:"36px"}})}),t.jsx(C,{style:{fontSize:"20px",fontFamily:"ubuntu",fontWeight:"500",color:"#FFFFFF"},children:"WIKITRAK"})]}),t.jsx(o,{children:t.jsx(C,{variant:"h6",color:"white",fontWeight:"bold",sx:{ml:"15px",mt:"15px"},children:Object.keys(j).length>0&&m?`${r} - Geofence (${j.reg_id})`:t.jsxs(t.Fragment,{children:[r," ",Object.keys(j).length>0&&j.reg_id]})})}),t.jsxs(o,{sx:{display:"flex"},children:[t.jsxs(N,{variant:"outlined",size:"small",sx:{color:c.vehicle?"white":"black",backgroundColor:c.vehicle?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:f,children:[t.jsx("img",{src:Xa,style:{marginRight:"5px"}}),Object.keys(j).length>0?j.reg_id:"Vehicles"]}),m&&t.jsx(o,{children:t.jsx(N,{variant:"outlined",size:"small",sx:{color:R?"white":"black",backgroundColor:R?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{y(!1),S(!R),p(fe({data:!1}))},children:"Geofence"})}),t.jsx(o,{sx:{color:"white",mr:"10px"},children:t.jsxs(o,{sx:{display:"flex",marginTop:"14px",gap:"10px"},children:[t.jsx(o,{onClick:()=>{S(!1),y(!v),p(fe({data:!1}))},children:t.jsx(za,{sx:{cursor:"pointer",width:"30px",height:"30px"}})}),t.jsx(o,{onClick:()=>{u({...c,user:!c.user}),s(!1)},children:c.user?t.jsx(da,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}}):t.jsx(ca,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}})})]})}),t.jsx(me,{onClick:()=>{p(Oa(!b))},sx:{color:"white"},children:b?t.jsx(Wa,{}):t.jsx(Na,{})})]})]})},go=co,po=()=>{const r=te(),u=Ka("(min-width:600px)"),[c,m]=n.useState(!1),[s,S]=n.useState(!1),{mode:R}=D(d=>d.dashboard),y=ce(R),v={new_password:"",confirmPassword:""},O=Ha().shape({new_password:$t().required("Password is required").min(8,"Password must be at least 8 characters"),confirmPassword:$t().oneOf([Ya("new_password"),null],"Passwords must match").required("Confirm password is required")}),j=d=>{console.log("values",d);let b=d.confirmPassword;r(_a({new_password:b}))};return t.jsx(o,{sx:{display:"flex",justifyContent:"center"},children:t.jsxs(o,{sx:{width:"30%"},children:[t.jsx(o,{sx:{align:"center"},children:t.jsx(C,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",align:"center",color:y.grey[400]},children:"Change Password"})}),t.jsx(qa,{onSubmit:j,initialValues:v,validationSchema:O,children:({values:d,errors:b,touched:p,handleBlur:w,handleChange:f,handleSubmit:h})=>t.jsxs("form",{onSubmit:h,children:[t.jsxs(o,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:u?void 0:"span 4"}},marginTop:"20px",children:[t.jsx(aa,{fullWidth:!0,variant:"outlined",type:c?"text":"password",label:"New Password",onBlur:w,onChange:f,value:d.new_password,name:"new_password",error:!!p.new_password&&!!b.new_password,helperText:p.new_password&&b.new_password,sx:{gridColumn:"span 4",backgroundColor:"white",borderRadius:"5px"},InputProps:{endAdornment:t.jsx(oa,{position:"end",children:t.jsx(me,{"aria-label":"toggle password visibility",onClick:()=>m(!c),edge:"end",children:c?t.jsx(ea,{}):t.jsx(ta,{})})})}}),t.jsx(aa,{fullWidth:!0,variant:"outlined",type:s?"text":"password",label:"Confirm Password",onBlur:w,onChange:f,value:d.confirmPassword,name:"confirmPassword",error:!!p.confirmPassword&&!!b.confirmPassword,helperText:p.confirmPassword&&b.confirmPassword,sx:{gridColumn:"span 4",backgroundColor:"white",borderRadius:"5px"},InputProps:{endAdornment:t.jsx(oa,{position:"end",children:t.jsx(me,{"aria-label":"toggle password visibility",onClick:()=>S(!s),edge:"end",children:s?t.jsx(ea,{}):t.jsx(ta,{})})})}})]}),t.jsx(o,{sx:{my:"29px"},children:t.jsx(N,{type:"submit",sx:{background:X.bgColor,width:"100%",p:"10px","&:hover":{background:X.bgShadow,color:y.grey[100]}},variant:"contained",children:"submit"})})]})})]})})},ho=()=>{const r=JSON.parse(localStorage.getItem("w_userDetails")),{mode:u}=D(m=>m.dashboard),c=ce(u);return t.jsxs(o,{children:[t.jsxs(o,{sx:{backgroundColor:c.grey[200],m:"10px",borderRadius:"5px",height:"150px"},children:[t.jsx(o,{sx:{pl:"20px",pt:"10px",mb:"10px",color:`${c.grey[400]}`},children:t.jsx("b",{children:"User Settings"})}),t.jsxs(o,{sx:{display:"flex"},children:[t.jsx(o,{sx:{ml:"23px",mt:"11px",height:"70px",width:"70px",backgroundColor:"white",borderRadius:"50%"}}),t.jsxs(o,{sx:{height:"80px",width:"200px",display:"flex",justifyContent:"center",flexDirection:"column",mx:"20px",color:c.grey[400]},children:[t.jsx(o,{sx:{fontWeight:"bold",fontSize:"1.2rem"},children:r&&t.jsxs(t.Fragment,{children:[r.first_name.charAt(0).toUpperCase()+r.first_name.slice(1).toLowerCase()," ",r.last_name.charAt(0).toUpperCase()+r.last_name.slice(1).toLowerCase()]})}),t.jsx(o,{children:r&&r.role})]})]})]}),t.jsx(o,{sx:{marginTop:"9%",alignContent:"center",textAlign:"center"},children:t.jsx(po,{})})]})},xo=ho,fo="data:image/png;base64,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";function uo({shapeType:r,setShapeType:u}){const c=m=>{console.log("selectedType",m),u(m)};return t.jsxs(o,{children:[t.jsx(N,{onClick:()=>{c("circular")},style:{background:r==="circular"?X.bgColor:"transparent",color:r==="circular"?"white":re[400],margin:"0 5px"},children:"Circle"}),t.jsx(N,{onClick:()=>{c("polygon")},style:{background:r==="polygon"?X.bgColor:"transparent",color:r==="polygon"?"white":re[400],margin:"0 5px"},children:"Polygon"})]})}function mo({shapeType:r,center:u,radius:c,active:m,setActive:s,setInward:S,inward:R,setSpeedLimit:y,speedLimit:v,setSpeedValue:O,handleGeofence:j,speedValue:d}){const{selectedVehicle:b,locationData:p,tractorIcon:w}=D(f=>f.liveMap);return t.jsxs(o,{sx:{display:"flex",padding:"15px",flexDirection:"column",gap:"10px",color:re[600]},children:[t.jsx(C,{sx:{fontWeight:"bold",fontSize:"16px"},children:"Geofence Setting"}),t.jsxs(C,{sx:{fontWeight:"400",fontSize:"14px",textTransform:"capitalize"},children:["Type: ",r]}),r==="circular"&&t.jsxs(t.Fragment,{children:[t.jsx(C,{sx:{color:"#686868"},children:"Centered At "}),t.jsxs(C,{sx:{color:"#686868"},children:["Lat: ",u.lat.toFixed(2)]}),t.jsxs(C,{sx:{color:"#686868"},children:["Lng: ",u.lng.toFixed(2)]}),t.jsxs(C,{sx:{color:"#686868",border:"1px solid #686868",borderRadius:"4px",padding:"8px"},children:["Radius ( ",(c/1e3).toFixed(2)," in km)"]})]}),t.jsxs(o,{display:"flex",alignItems:"center",children:[t.jsx(C,{variant:"body1",component:"b",children:m?"Active":"Inactive"}),t.jsx(ue,{defaultChecked:m,onChange:()=>{s(!m)},color:"primary",inputProps:{"aria-label":"toggle active state"}})]}),t.jsxs(o,{display:"flex",alignItems:"center",children:[t.jsx(C,{variant:"body1",component:"b",children:R?"Inward":"Outward"}),t.jsx(ue,{checked:R,onChange:()=>{S(!R)},color:"primary",inputProps:{"aria-label":"toggle direction"}})]}),t.jsxs(o,{display:"flex",alignItems:"center",children:[t.jsx(ue,{checked:v,onChange:()=>{y(!v)},color:"primary",inputProps:{"aria-label":"toggle direction"}}),t.jsx(C,{variant:"body1",component:"b",children:"Speed Limit"})]}),v&&t.jsx(o,{sx:{},children:t.jsx(ao,{sx:{width:"100%",color:re[600],border:"none","&:focus":{outline:"none"}},value:d,placeholder:"Enter Speed Limit",type:"number",onChange:f=>{const h=Math.max(0,parseInt(f.target.value));O(h)}})}),t.jsx(N,{disabled:Object.keys(b).length===0&&!1,variant:"outlined",size:"small",sx:{color:"white",backgroundColor:X.bgColor,mt:"6px",mx:"5px",border:"1px solid white",height:"40px",width:"100%","&:hover":{color:"black",background:X.bgShadow,border:"1px solid black"},letterSpacing:"1.5px",fontSize:"16px"},onClick:()=>{if(Object.keys(b).length===0)return M.error("please select a vehicle.");j()},children:"SUBMIT"})]})}const wo="http://139.59.37.47:3031",yo="AIzaSyD8TrUWS9FRTu-MRP339mJF_iWlORvEGUA",jo=({showGfBar:r,showGfAlert:u})=>{const{isLoaded:c,loadError:m}=Za({googleMapsApiKey:`${yo}`}),{selectedVehicle:s,locationData:S,tractorIcon:R}=D(a=>a.liveMap),{geofence:y,vehicleSideBar:v}=D(a=>a.geofence),{mode:O,styles:j,vehicles_details:d}=D(a=>a.dashboard),{collapsed:b}=D(a=>a.auth),[p,w]=n.useState(null),[f,h]=n.useState(null),[A,U]=n.useState(1e3),[P,de]=n.useState([]),[z,x]=n.useState(!0),[G,T]=n.useState(!1),[E,Y]=n.useState(!1),[i,J]=n.useState({lat:18.516726,lng:73.856255}),[q,Z]=n.useState(50),[k,Q]=n.useState("circular"),[_,ga]=n.useState([]),[je,be]=n.useState({north:i.lat+.01,south:i.lat-.01,east:i.lng+.01,west:i.lng-.01}),[V,Se]=n.useState([{lat:i.lat+.01,lng:i.lng},{lat:i.lat-.01,lng:i.lng-.01},{lat:i.lat-.01,lng:i.lng+.01}]),[ve,ae]=n.useState([{lat:i.lat+.01,lng:i.lng},{lat:i.lat-.01,lng:i.lng-.01},{lat:i.lat-.01,lng:i.lng+.01}]),[ge,pe]=n.useState(!1),pa=n.useRef(null),oe=n.useRef(null),he=n.useRef(!1),ne=n.useRef(null),se=n.useRef(null);let ha=te();n.useEffect(()=>{xa()},[s]),n.useEffect(()=>{ge&&ae([{lat:i.lat+.01,lng:i.lng},{lat:i.lat-.01,lng:i.lng-.01},{lat:i.lat-.01,lng:i.lng+.01}])},[ge]),n.useEffect(()=>{var a,g,l,F,I,B,L,$;if(S.length>0&&Object.keys(s).length>0){let W=S.filter(ie=>{var ee;return((ee=ie.latestDocument)==null?void 0:ee.imei)===s.imei});de(W),J({lat:(g=(a=W[0])==null?void 0:a.latestDocument)==null?void 0:g.lat,lng:(F=(l=W[0])==null?void 0:l.latestDocument)==null?void 0:F.lng});let K=(B=(I=W[0])==null?void 0:I.latestDocument)==null?void 0:B.lat,H=($=(L=W[0])==null?void 0:L.latestDocument)==null?void 0:$.lng;ge&&ae([{lat:K+.01,lng:H},{lat:K-.01,lng:H-.01},{lat:K-.01,lng:H+.01}])}},[s,S,k]),n.useEffect(()=>{p&&f&&p.fitBounds(f)},[p,f]);const xa=async()=>{var a,g,l,F,I,B,L,$,W,K,H,ie,ee,Ce,De,ke,Re,Oe,Ee,_e,Fe,Ie,Le,Pe,Ge,Te,Ve,Be,We,Ne,Me,ze,Xe,Ue,Je,Ke,He,Ye,qe,Ze,Qe,$e,et,tt,at,ot,nt,st,it,rt,lt,ct,dt,gt,pt,ht,xt,ft,ut,mt,wt,yt,jt,bt,St,vt,At,Ct,Dt,kt,Rt,Ot,Et,_t,Ft,It,Lt,Pt,Gt,Tt,Vt,Bt,Wt,Nt,Mt,zt,Xt,Ut,Jt,Kt,Ht,Yt,qt,Zt,Qt;if(Object.keys(s).length>0)try{const e=await Fa.get(`${wo}/api/get/geofance/${s==null?void 0:s.imei}`);if(console.log(e.data.geofenceData,"result"),((g=(a=e==null?void 0:e.data)==null?void 0:a.geofenceData)==null?void 0:g.area_type)==="circular")if(Q("circular"),pe(!0),(F=(l=e==null?void 0:e.data)==null?void 0:l.geofenceData)!=null&&F.lat)J({lat:(B=(I=e==null?void 0:e.data)==null?void 0:I.geofenceData)==null?void 0:B.lat,lng:($=(L=e==null?void 0:e.data)==null?void 0:L.geofenceData)==null?void 0:$.long}),U((K=(W=e==null?void 0:e.data)==null?void 0:W.geofenceData)==null?void 0:K.radius),x((ie=(H=e==null?void 0:e.data)==null?void 0:H.geofenceData)==null?void 0:ie.isActive_Geofance),T(((Ce=(ee=e==null?void 0:e.data)==null?void 0:ee.geofenceData)==null?void 0:Ce.type)==="inward"),Y((ke=(De=e==null?void 0:e.data)==null?void 0:De.geofenceData)==null?void 0:ke.isActive_Speed),Z((Oe=(Re=e==null?void 0:e.data)==null?void 0:Re.geofenceData)==null?void 0:Oe.speed);else return M.success("No Geofence For Selected Vehicle",{id:"getting geofence"});else((_e=(Ee=e==null?void 0:e.data)==null?void 0:Ee.geofenceData)==null?void 0:_e.area_type)==="triangle"?(Q("triangle"),console.log("get for triangle",(Fe=e==null?void 0:e.data)==null?void 0:Fe.geofenceData),Se([{lat:(Pe=(Le=(Ie=e==null?void 0:e.data)==null?void 0:Ie.geofenceData)==null?void 0:Le.triangle_points[0])==null?void 0:Pe.lat,lng:(Ve=(Te=(Ge=e==null?void 0:e.data)==null?void 0:Ge.geofenceData)==null?void 0:Te.triangle_points[0])==null?void 0:Ve.long},{lat:(Ne=(We=(Be=e==null?void 0:e.data)==null?void 0:Be.geofenceData)==null?void 0:We.triangle_points[1])==null?void 0:Ne.lat,lng:(Xe=(ze=(Me=e==null?void 0:e.data)==null?void 0:Me.geofenceData)==null?void 0:ze.triangle_points[1])==null?void 0:Xe.long},{lat:(Ke=(Je=(Ue=e==null?void 0:e.data)==null?void 0:Ue.geofenceData)==null?void 0:Je.triangle_points[2])==null?void 0:Ke.lat,lng:(qe=(Ye=(He=e==null?void 0:e.data)==null?void 0:He.geofenceData)==null?void 0:Ye.triangle_points[2])==null?void 0:qe.long}]),J({lat:(Qe=(Ze=e==null?void 0:e.data)==null?void 0:Ze.geofenceData)==null?void 0:Qe.lat,lng:(et=($e=e==null?void 0:e.data)==null?void 0:$e.geofenceData)==null?void 0:et.long}),Z((at=(tt=e==null?void 0:e.data)==null?void 0:tt.geofenceData)==null?void 0:at.speed),x((nt=(ot=e==null?void 0:e.data)==null?void 0:ot.geofenceData)==null?void 0:nt.isActive_Geofance),T(((it=(st=e==null?void 0:e.data)==null?void 0:st.geofenceData)==null?void 0:it.type)==="inward"),Y((lt=(rt=e==null?void 0:e.data)==null?void 0:rt.geofenceData)==null?void 0:lt.isActive_Speed)):((dt=(ct=e==null?void 0:e.data)==null?void 0:ct.geofenceData)==null?void 0:dt.area_type)==="rectangle"?(Q("rectangle"),console.log("get for rectangle",(gt=e==null?void 0:e.data)==null?void 0:gt.geofenceData),be({north:(xt=(ht=(pt=e==null?void 0:e.data)==null?void 0:pt.geofenceData)==null?void 0:ht.rectangle_points[0])==null?void 0:xt.lat,south:(mt=(ut=(ft=e==null?void 0:e.data)==null?void 0:ft.geofenceData)==null?void 0:ut.rectangle_points[1])==null?void 0:mt.lat,east:(jt=(yt=(wt=e==null?void 0:e.data)==null?void 0:wt.geofenceData)==null?void 0:yt.rectangle_points[1])==null?void 0:jt.long,west:(vt=(St=(bt=e==null?void 0:e.data)==null?void 0:bt.geofenceData)==null?void 0:St.rectangle_points[0])==null?void 0:vt.long}),J({lat:(Ct=(At=e==null?void 0:e.data)==null?void 0:At.geofenceData)==null?void 0:Ct.lat,lng:(kt=(Dt=e==null?void 0:e.data)==null?void 0:Dt.geofenceData)==null?void 0:kt.long}),Z((Ot=(Rt=e==null?void 0:e.data)==null?void 0:Rt.geofenceData)==null?void 0:Ot.speed),x((_t=(Et=e==null?void 0:e.data)==null?void 0:Et.geofenceData)==null?void 0:_t.isActive_Geofance),T(((It=(Ft=e==null?void 0:e.data)==null?void 0:Ft.geofenceData)==null?void 0:It.type)==="inward"),Y((Pt=(Lt=e==null?void 0:e.data)==null?void 0:Lt.geofenceData)==null?void 0:Pt.isActive_Speed)):((Tt=(Gt=e==null?void 0:e.data)==null?void 0:Gt.geofenceData)==null?void 0:Tt.area_type)==="polygon"&&(pe(!1),Q("polygon"),console.log("get for polygon",(Vt=e==null?void 0:e.data)==null?void 0:Vt.geofenceData),ae((Wt=(Bt=e==null?void 0:e.data)==null?void 0:Bt.geofenceData)==null?void 0:Wt.polygon_points),Z((Mt=(Nt=e==null?void 0:e.data)==null?void 0:Nt.geofenceData)==null?void 0:Mt.speed),x((Xt=(zt=e==null?void 0:e.data)==null?void 0:zt.geofenceData)==null?void 0:Xt.isActive_Geofance),T(((Jt=(Ut=e==null?void 0:e.data)==null?void 0:Ut.geofenceData)==null?void 0:Jt.type)==="inward"),J({lat:(Ht=(Kt=e==null?void 0:e.data)==null?void 0:Kt.geofenceData)==null?void 0:Ht.lat,lng:(qt=(Yt=e==null?void 0:e.data)==null?void 0:Yt.geofenceData)==null?void 0:qt.long}),Y((Qt=(Zt=e==null?void 0:e.data)==null?void 0:Zt.geofenceData)==null?void 0:Qt.isActive_Speed))}catch(e){pe(!0),console.log("vehicleDetail",P),console.log(e,"error while getting geofence"),M.error("Error while getting geofence",{id:"getting geofence"})}},fa=a=>{w(a)},ua=()=>{var a,g,l,F,I,B;if(Object.keys(s).length>0){let L;k==="circular"?L={imei:s.imei,area_type:k,type:G?"inward":"outward",lat:i.lat,long:i.lng,radius:A,isActive_Geofance:z,isActive_Speed:!!E,speed:E?q:5}:k==="rectangle"?L={imei:s.imei,area_type:k,type:G?"inward":"outward",rectangle_points:[{lat:_==null?void 0:_.north,long:_==null?void 0:_.west},{lat:_==null?void 0:_.south,long:_==null?void 0:_.east}],isActive_Geofance:z,isActive_Speed:!!E,speed:E?q:50}:k==="triangle"?L={imei:s.imei,area_type:k,type:G?"inward":"outward",triangle_points:[{lat:(a=V[0])==null?void 0:a.lat,long:(g=V[0])==null?void 0:g.lng},{lat:(l=V[1])==null?void 0:l.lat,long:(F=V[1])==null?void 0:F.lng},{lat:(I=V[2])==null?void 0:I.lat,long:(B=V[2])==null?void 0:B.lng}],isActive_Geofance:z,isActive_Speed:!!E,speed:E?q:50}:k==="polygon"&&(L={imei:s.imei,area_type:k,type:G?"inward":"outward",polygon_points:ve,isActive_Geofance:z,isActive_Speed:!!E,speed:E?q:50}),ha(Ia({data:L})),M.success("Successful Saved",{id:"geofence"})}else M.error("Please Select Vehicle",{id:"geofence"})},ma=()=>{if(!he.current){he.current=!0;const a=xe.getRadius();console.log("newRadius",a),U(a),he.current=!1}},wa=a=>{console.log("New Center:",a.toJSON()),J(a.toJSON())},ya=()=>{if(ne.current&&ne.current.getBounds){const a=ne.current.getBounds(),g=a.getNorthEast().lat(),l=a.getSouthWest().lat(),F=a.getNorthEast().lng(),I=a.getSouthWest().lng();console.log("{ north, south, east, west }",{north:g,south:l,east:F,west:I}),be({north:g,south:l,east:F,west:I}),ga({north:g,south:l,east:F,west:I})}},ja={bounds:je,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}},ba=a=>{ne.current=a},Sa=()=>{if(oe.current&&oe.current.getPath){const g=oe.current.getPath().getArray().map(l=>({lat:l.lat(),lng:l.lng()}));Se(g),console.log("newVertices",g)}},va={paths:V,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}},Aa=a=>{oe.current=a},Ca=()=>{if(se.current&&se.current.getPath){const g=se.current.getPath().getArray().map(l=>({lat:l.lat(),lng:l.lng()}));ae(g),console.log("newVertices",g)}},Da=a=>{se.current=a},ka=a=>{const g=d&&(d==null?void 0:d.length)>0&&d.find(l=>(l==null?void 0:l.value)===a&&(l==null?void 0:l.vehilce_type));return g?g.vehilce_type:null},Ae={paths:ve,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}};if(m)return"Error loading maps";if(!c)return"Loading maps";const Ra={width:"100%",height:"86.8vh"};let xe;return t.jsxs(t.Fragment,{children:[t.jsx(uo,{setShapeType:Q,shapeType:k}),t.jsxs(o,{sx:{display:"flex",flexDirection:"row"},children:[t.jsxs(Qa,{ref:pa,mapContainerStyle:Ra,zoom:15,center:i,onLoad:fa,options:{mapTypeControl:!1,styles:O?j:""},children:[k==="circular"&&t.jsx($a,{center:i,radius:A,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0},onLoad:a=>{xe=a,xe.addListener("radius_changed",ma)},onDragEnd:a=>wa(a.latLng)}),k==="rectangle"&&t.jsx(eo,{bounds:je,options:ja.options,onDragEnd:ya,onLoad:ba}),k==="triangle"&&t.jsx(na,{paths:V,options:va.options,onDragEnd:Sa,onLoad:Aa}),k==="polygon"&&t.jsx(na,{paths:Ae.paths,options:Ae.options,draggable:!0,editable:!0,onDragEnd:Ca,onLoad:Da}),P&&P.length>0&&P.map((a,g)=>{const l=ka(a.latestDocument.imei);return t.jsx(to,{position:{lat:a.latestDocument.lat,lng:a.latestDocument.lng},icon:{url:(()=>{switch(l){case"2W":return le;case"3W":return la;case"4W":return ra;default:return le}})(),fillColor:"red",fillOpacity:2,strokeWeight:1,size:new window.google.maps.Size(55,55),scaledSize:new window.google.maps.Size(55,55),scale:2}},g)})]}),r&&!u&&!v&&i&&t.jsx(o,{sx:{width:b?"25%":"20%"},children:t.jsx(mo,{shapeType:k,center:i,radius:A,active:z,setActive:x,setInward:T,inward:G,setSpeedLimit:Y,speedLimit:E,setSpeedValue:Z,handleGeofence:ua,speedValue:q})})]})]})},bo=({showMap:r,setShowMap:u,showGfBar:c,showGfAlert:m})=>{const{selectedVehicle:s,onlineVehicle:S}=D(w=>w.liveMap),{mode:R,vehicles_details:y}=D(w=>w.dashboard),v=ce(R),[O,j]=n.useState(!1);let d=te();n.useEffect(()=>{console.log("onlineVehicle",S),console.log("selectedVehicle",s);let w=S.find(f=>f==s.imei);console.log("isActive",w),w?j(!0):(j(!1),console.log("Vehicle is not active"))},[S,s]),n.useEffect(()=>{d(La({}))},[s]);const b=w=>{const f=y&&(y==null?void 0:y.length)>0&&y.find(h=>(h==null?void 0:h.value)===w&&(h==null?void 0:h.vehilce_type));return f?f.vehilce_type:null},p=Object.keys(s).length>0?b(s.imei):null;return t.jsx(t.Fragment,{children:r?t.jsx(jo,{showGfBar:c,showGfAlert:m}):t.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",background:v.grey[200],margin:"10px",padding:"10px",borderRadius:"8px"},children:[t.jsxs(o,{sx:{},children:[t.jsx(C,{sx:{fontWeight:"bold",fontSize:"16px",margin:"4px",color:v.grey[400]},children:"Vehicle Settings"}),t.jsxs(o,{sx:{display:"flex"},children:[t.jsx(o,{sx:{border:"2px solid white",padding:"5px",borderRadius:"5px",background:"white",marginRight:"5px"},children:t.jsx("img",{src:(()=>{switch(p){case"2W":return le;case"3W":return la;case"4W":return ra;default:return le}})(),alt:"vehicleIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}})}),t.jsxs(o,{children:[t.jsx(C,{sx:{fontWeight:"bold",color:v.grey[400]},children:Object.keys(s).length>0?s==null?void 0:s.reg_id:"Reg No"}),t.jsx(C,{sx:{marginBottom:"5px",color:v.grey[400]},children:"Chassis No"}),Object.keys(s).length>0&&t.jsx(o,{sx:{width:"200px",display:"flex",gap:"8px"},children:t.jsxs(C,{children:["Status: ",O?"On":"Off"]})})]})]})]}),t.jsxs(o,{onClick:()=>{u(!r)},sx:{cursor:"pointer",marginTop:"50px"},children:[t.jsx("img",{src:fo,alt:"tractorIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}}),t.jsx(C,{sx:{fontSize:"12px",color:v.grey[400]},children:"Set Geofence"})]})]})})};function zo(){const{w_customer_id:r}=D(A=>A.auth),{vehicleSideBar:u}=D(A=>A.geofence),{collapsed:c}=D(A=>A.auth),{mode:m}=D(A=>A.dashboard),s=ce(m),[S,R]=n.useState([]);n.useState([]);const[y,v]=n.useState({user:!0,vehicle:!1}),[O,j]=n.useState(!1),[d,b]=n.useState(!1),[p,w]=n.useState(!1);let f=te();n.useEffect(()=>{h()},[]);const h=async()=>{try{let A=[],U=[];const P=await f(Pa({w_customer_id:r}));if(P.payload&&Array.isArray(P.payload)){P.payload.forEach(x=>{var G,T,E;x.imei&&Array.isArray(x.imei)&&x.imei.length>0&&((G=x.imei[0])!=null&&G.mac_id)?(A.push({id:x.id,label:x.registration_id,value:(T=x.imei[0])==null?void 0:T.mac_id,vehilce_type:x==null?void 0:x.segment}),U.push((E=x.imei[0])==null?void 0:E.mac_id)):(console.error("IMEI data not found for item:",x),M.error(`IMEI Number not found for the vehicle: ${x==null?void 0:x.registration_id}`))});const de="one",z=U;U.length>0&&f(Ga({type:de,imei:z})),R(A)}else console.error("Unexpected data format or empty payload:",P),M.error("Unexpected data format:")}catch(A){console.error("Error fetching vehicle data:",A),M.error(`Error fetching vehicle data: ${A}`)}};return t.jsxs("div",{className:"app",children:[t.jsx(Ma,{}),t.jsxs("main",{className:"content",style:{width:"100%",background:s.grey[100]},children:[t.jsx(go,{title:"Settings",setShowContent:v,showContent:y,showMap:O,setShowMap:j,showGfBar:d,setShowGfBar:b,showGfAlert:p,setShowGfAlert:w}),t.jsxs(o,{style:{display:"flex",width:"100%",height:"95vh"},children:[t.jsx(o,{style:{width:u?"80%":"100%"},children:y.user?t.jsx(xo,{}):t.jsx(bo,{showMap:O,setShowMap:j,showGfBar:d,showGfAlert:p})}),!p&&!d&&u&&t.jsx(o,{style:{width:"20%"},children:t.jsx(Ua,{vehicleData:S,title:"Setting"})}),p&&!d&&!u&&t.jsx(o,{sx:{width:c?"25%":"20%"},children:t.jsx(Ja,{})})]})]})]})}export{zo as default};
