import{r as n,M as zt,i as le,j as e,a as P,u as re,t as _,T as y,B as K,a7 as pe,h as sn,a8 as ue,_ as Y,a9 as ln,n as rn,o as cn}from"./index-Tb90R2_b.js";import{A as Mt,B as xe,ao as dn,e as he,a3 as Lt,ap as gn,r as pn,aq as fe,c as Gt,a0 as un,J as xn,M as Ft,an as hn,d as fn,a as mn,aa as yn,L as vn}from"./Close-BOsQMh6z.js";import{r as ce}from"./createSvgIcon-Cw0CjRpW.js";import{j as bn,V as jn}from"./VehicleMenu-C6Wdfeu7.js";import{B as s,C as Cn}from"./CircularProgress-Dx35-Vjt.js";import{C as Sn}from"./Form-CUGYLPwG.js";import{u as wn,G as An,C as On,R as kn,b as _t,M as En}from"./esm-mwoWbJw9.js";import{a as ie}from"./Switch-CGAYWw2i.js";import{I as Rn}from"./TextField-DiWSJJMw.js";import{B as Dn,S as In}from"./button-CDGZo5rR.js";import"./createSvgIcon-_WZAYDUJ.js";import"./OutlinedInput-DbTc8EPS.js";import"./IconButton-DFxBhuCq.js";import"./Paper-DX5oR_-7.js";var Ln={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"};const Fn=Ln;var _n=function(g,l){return n.createElement(Mt,zt({},g,{ref:l,icon:Fn}))},Nn=n.forwardRef(_n);const Pn=Nn;var zn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"};const Mn=zn;var Gn=function(g,l){return n.createElement(Mt,zt({},g,{ref:l,icon:Mn}))},Tn=n.forwardRef(Gn);const Bn=Tn,Vn=o=>{const{getPrefixCls:g,direction:l}=n.useContext(xe),{prefixCls:r,className:a}=o,u=g("input-group",r),A=g("input"),[j,L]=dn(A),C=he(u,{[`${u}-lg`]:o.size==="large",[`${u}-sm`]:o.size==="small",[`${u}-compact`]:o.compact,[`${u}-rtl`]:l==="rtl"},L,a),m=n.useContext(Lt),S=n.useMemo(()=>Object.assign(Object.assign({},m),{isFormItemInput:!1}),[m]);return j(n.createElement("span",{className:C,style:o.style,onMouseEnter:o.onMouseEnter,onMouseLeave:o.onMouseLeave,onFocus:o.onFocus,onBlur:o.onBlur},n.createElement(Lt.Provider,{value:S},o.children)))},Xn=Vn;var Wn=function(o,g){var l={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&g.indexOf(r)<0&&(l[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(o);a<r.length;a++)g.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(o,r[a])&&(l[r[a]]=o[r[a]]);return l};const Jn=o=>o?n.createElement(Bn,null):n.createElement(Pn,null),Un={click:"onClick",hover:"onMouseOver"},$n=n.forwardRef((o,g)=>{const{visibilityToggle:l=!0}=o,r=typeof l=="object"&&l.visible!==void 0,[a,u]=n.useState(()=>r?l.visible:!1),A=n.useRef(null);n.useEffect(()=>{r&&u(l.visible)},[r,l]);const j=gn(A),L=()=>{const{disabled:B}=o;B||(a&&j(),u(v=>{var N;const p=!v;return typeof l=="object"&&((N=l.onVisibleChange)===null||N===void 0||N.call(l,p)),p}))},C=B=>{const{action:v="click",iconRender:N=Jn}=o,p=Un[v]||"",G=N(a),M={[p]:L,className:`${B}-icon`,key:"passwordIcon",onMouseDown:V=>{V.preventDefault()},onMouseUp:V=>{V.preventDefault()}};return n.cloneElement(n.isValidElement(G)?G:n.createElement("span",null,G),M)},{className:m,prefixCls:S,inputPrefixCls:R,size:D}=o,c=Wn(o,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:d}=n.useContext(xe),k=d("input",R),z=d("input-password",S),x=l&&C(z),F=he(z,m,{[`${z}-${D}`]:!!D}),I=Object.assign(Object.assign({},pn(c,["suffix","iconRender","visibilityToggle"])),{type:a?"text":"password",className:F,prefixCls:k,suffix:x});return D&&(I.size=D),n.createElement(fe,Object.assign({ref:Gt(g,A)},I))}),Hn=$n;var Kn=function(o,g){var l={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&g.indexOf(r)<0&&(l[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(o);a<r.length;a++)g.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(o,r[a])&&(l[r[a]]=o[r[a]]);return l};const Yn=n.forwardRef((o,g)=>{const{prefixCls:l,inputPrefixCls:r,className:a,size:u,suffix:A,enterButton:j=!1,addonAfter:L,loading:C,disabled:m,onSearch:S,onChange:R,onCompositionStart:D,onCompositionEnd:c}=o,d=Kn(o,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:k,direction:z}=n.useContext(xe),x=n.useRef(!1),F=k("input-search",l),I=k("input",r),{compactSize:B}=un(F,z),v=xn(f=>{var O;return(O=u??B)!==null&&O!==void 0?O:f}),N=n.useRef(null),p=f=>{f&&f.target&&f.type==="click"&&S&&S(f.target.value,f,{source:"clear"}),R&&R(f)},G=f=>{var O;document.activeElement===((O=N.current)===null||O===void 0?void 0:O.input)&&f.preventDefault()},M=f=>{var O,W;S&&S((W=(O=N.current)===null||O===void 0?void 0:O.input)===null||W===void 0?void 0:W.value,f,{source:"input"})},V=f=>{x.current||C||M(f)},h=typeof j=="boolean"?n.createElement(In,null):null,$=`${F}-button`;let w;const X=j||{},q=X.type&&X.type.__ANT_BUTTON===!0;q||X.type==="button"?w=Ft(X,Object.assign({onMouseDown:G,onClick:f=>{var O,W;(W=(O=X==null?void 0:X.props)===null||O===void 0?void 0:O.onClick)===null||W===void 0||W.call(O,f),M(f)},key:"enterButton"},q?{className:$,size:v}:{})):w=n.createElement(Dn,{className:$,type:j?"primary":void 0,size:v,disabled:m,key:"enterButton",onMouseDown:G,onClick:M,loading:C,icon:h},j),L&&(w=[w,Ft(L,{key:"addonAfter"})]);const ee=he(F,{[`${F}-rtl`]:z==="rtl",[`${F}-${v}`]:!!v,[`${F}-with-button`]:!!j},a),T=f=>{x.current=!0,D==null||D(f)},te=f=>{x.current=!1,c==null||c(f)};return n.createElement(fe,Object.assign({ref:Gt(N,g),onPressEnter:V},d,{size:v,onCompositionStart:T,onCompositionEnd:te,prefixCls:I,addonAfter:w,suffix:A,onChange:p,className:ee,disabled:m}))}),qn=Yn,Z=fe;Z.Group=Xn;Z.Search=qn;Z.TextArea=hn;Z.Password=Hn;const Nt=Z;var me={},Qn=le;Object.defineProperty(me,"__esModule",{value:!0});var Tt=me.default=void 0,Zn=Qn(ce()),eo=e;Tt=me.default=(0,Zn.default)((0,eo.jsx)("path",{d:"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonOutlined");var ye={},to=le;Object.defineProperty(ye,"__esModule",{value:!0});var Bt=ye.default=void 0,no=to(ce()),oo=e;Bt=ye.default=(0,no.default)((0,oo.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Place");var ve={},ao=le;Object.defineProperty(ve,"__esModule",{value:!0});var Vt=ve.default=void 0,so=ao(ce()),io=e;Vt=ve.default=(0,so.default)((0,io.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2m6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5z"}),"NotificationsNone");const lo=({title:o,setShowContent:g,showContent:l,showMap:r,setShowMap:a,setShowGfBar:u,showGfBar:A,setShowGfAlert:j,showGfAlert:L})=>{const{collapsed:C}=P(d=>d.auth),{selectedVehicle:m}=P(d=>d.liveMap),{vehicleSideBar:S}=P(d=>d.geofence);n.useState(!1),JSON.parse(localStorage.getItem("w_userDetails"));const R=re(),D=()=>{R(sn(!C))},c=()=>{g({...l,vehicle:!l.vehicle}),u(!1),j(!1),R(pe({data:!S}))};return e.jsxs(s,{display:"flex",justifyContent:"space-between",p:1,sx:{bgcolor:_.bgColor,border:"1px solid white",borderRadius:"4px",height:"55px"},children:[e.jsxs(s,{display:"flex",children:[e.jsx(s,{sx:{color:"white",my:"20px"},children:C?e.jsx(fn,{style:{cursor:"pointer",width:"30px",height:"30px"},onClick:D}):e.jsx(mn,{style:{cursor:"pointer",width:"30px",height:"30px"},onClick:D})}),e.jsx(s,{sx:{my:"20px",mx:"10px"},children:e.jsx(y,{style:{fontSize:"20px",fontFamily:"ubuntu",fontWeight:"500",color:"#FFFFFF"},children:"WIKITRACK"})})]}),e.jsx(s,{children:e.jsx(y,{variant:"h6",color:"white",fontWeight:"bold",sx:{ml:"15px",mt:"15px"},children:Object.keys(m).length>0&&r?`${o} - Geofence (${m.reg_id})`:e.jsxs(e.Fragment,{children:[o," ",Object.keys(m).length>0&&m.reg_id]})})}),e.jsxs(s,{sx:{display:"flex"},children:[e.jsxs(K,{variant:"outlined",size:"small",sx:{color:l.vehicle?"white":"black",backgroundColor:l.vehicle?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:c,children:[e.jsx("img",{src:bn,style:{marginRight:"5px"}}),Object.keys(m).length>0?m.reg_id:"Vehicles"]}),r&&e.jsx(s,{children:e.jsx(K,{variant:"outlined",size:"small",sx:{color:A?"white":"black",backgroundColor:A?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{j(!1),u(!A),R(pe({data:!1}))},children:"Geofence"})}),e.jsx(s,{sx:{color:"white",mr:"10px"},children:e.jsxs(s,{sx:{display:"flex",marginTop:"14px",gap:"10px"},children:[e.jsx(s,{onClick:()=>{u(!1),j(!L),R(pe({data:!1}))},children:e.jsx(Vt,{sx:{cursor:"pointer",width:"30px",height:"30px"}})}),e.jsx(s,{onClick:()=>{g({...l,user:!l.user}),a(!1)},children:l.user?e.jsx(Bt,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}}):e.jsx(Tt,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}})})]})})]})]})},ro=lo;var be={},co=le;Object.defineProperty(be,"__esModule",{value:!0});var Xt=be.default=void 0,go=co(ce()),po=e;Xt=be.default=(0,go.default)((0,po.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff");const Pt="http://139.59.37.47:3031",uo=()=>{const{selectedVehicle:o}=P(c=>c.liveMap);P(c=>c.geofence);const[g,l]=n.useState([]),[r,a]=n.useState(null),[u,A]=n.useState(!1),[j,L]=n.useState(10),C=n.useRef(null);let m=re();n.useEffect(()=>{S()},[m,o]),n.useEffect(()=>{C.current&&(C.current.scrollTop=0)},[g]);const S=async()=>{var c,d,k;if(Object.keys(o).length>0){let z={imei:o==null?void 0:o.imei};try{A(!0);const x=await ue.post(`${Pt}/ccServer/location/getNotifications`,z);((d=(c=x==null?void 0:x.data)==null?void 0:c.notifications)==null?void 0:d.length)>0?l((k=x==null?void 0:x.data)==null?void 0:k.notifications):Y.error("No Geofence Alert For Selected Vehicle."),A(!1)}catch(x){console.log("error while getting gfAlertHistory",x),Y.error(`Geofence ${x==null?void 0:x.message}`),A(!1)}}},R=async c=>{try{const d=await ue.post(`${Pt}/ccServer/location/updateNotifications`,{_id:c==null?void 0:c._id});S()}catch(d){console.log("error while getting gfAlertHistory",d),Y.error(`Geofence ${d==null?void 0:d.message}`),A(!1)}},D=()=>{L(c=>c+10)};return e.jsxs(s,{sx:{padding:"15px",display:"flex",flexDirection:"column",gap:"15px",color:"#686868",backgroundColor:"#FFFFFF",height:"86vh",overflowY:"auto",scrollBehavior:"smooth"},ref:C,children:[u&&e.jsx(s,{style:{width:"100%",margin:"auto",display:"flex",justifyContent:"center"},children:e.jsx(Cn,{style:{color:_.bgColor}})}),!u&&g.length===0&&e.jsx(y,{style:{width:"100%",margin:"auto"},children:"Please Select A Vehicle."}),!u&&g.length>0&&g.slice(0,j).map((c,d)=>{var k;return e.jsxs(s,{sx:{position:"relative"},onMouseEnter:()=>a(d),onMouseLeave:()=>a(null),children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(y,{children:e.jsx("b",{children:c==null?void 0:c.type})}),e.jsxs(s,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:(k=c==null?void 0:c.createdAt)==null?void 0:k.slice(0,10)}),e.jsx("span",{style:{paddingLeft:"15px"},children:new Date(c==null?void 0:c.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]}),e.jsxs(s,{sx:{display:"flex",border:"1px solid #686868",padding:"5px",borderRadius:"5px",color:"#686868","&:hover":{background:_.bgShadow,color:"black"}},children:[e.jsx("img",{style:{width:"30px",height:"30px",borderRadius:"5px",marginRight:"15px",alignItems:"center",marginTop:"15px"},src:yn,alt:"logo"}),e.jsxs(s,{sx:{display:"flex",flexDirection:"column"},children:[e.jsxs(y,{sx:{fontSize:"15px",width:"100%"},children:["Your Vehicle No."," ",Object.keys(o).length>0?o.reg_id:"XXX"]}),e.jsx(y,{children:c==null?void 0:c.msg})]})]}),r===d&&e.jsx(Xt,{onClick:()=>{R(c)},sx:{position:"absolute",top:"35%",left:"84.4%",transform:"translate(-50%, -50%)",fontWeight:"600",color:"black",cursor:"pointer"}})]},d)}),!u&&j<g.length&&e.jsx(s,{sx:{display:"flex",justifyContent:"center",marginTop:"15px"},children:e.jsx(K,{variant:"outlined",onClick:D,sx:{border:`1px solid ${_.bgShadow}`,color:"#686868","&:hover":{background:_.bgColor,color:"white",border:`1px solid ${_.bgShadow}`}},children:"Load More"})})]})},xo=()=>{const o=JSON.parse(localStorage.getItem("w_userDetails"));return e.jsxs(s,{children:[e.jsxs(s,{sx:{backgroundColor:_.bgShadow,m:"10px",borderRadius:"5px",height:"150px"},children:[e.jsx(s,{sx:{pl:"20px",pt:"10px",mb:"10px"},children:e.jsx("b",{children:"User Settings"})}),e.jsxs(s,{sx:{display:"flex"},children:[e.jsx(s,{sx:{ml:"23px",mt:"11px",height:"70px",width:"70px",backgroundColor:"white",borderRadius:"50%"}}),e.jsxs(s,{sx:{height:"80px",width:"200px",display:"flex",justifyContent:"center",flexDirection:"column",mx:"20px"},children:[e.jsx(s,{children:e.jsxs("b",{children:[" ",o&&o.first_name," ",o.last_name]})}),e.jsx(s,{children:o&&o.role})]})]})]}),e.jsx(s,{sx:{marginTop:"9%",alignContent:"center",textAlign:"center"},children:e.jsx(Sn,{})})]})},ho=xo,fo="/assets/tractorIcon-zWRQE9nW.jpg",mo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABuCAYAAADGWyb7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAizSURBVHgB7Z0xbxNJFMfH6AQNSBHQQBOnABoQSFDRJBU0oDuJjga+wX2Ey1e4bwAVFegQVDQXGmgAIUEDFHEaaICLBA00uf05fj5fsL1vPLO776H5SZtdJ3Zs73/emzdv3s72Qg07OzvL1W6t2voT29JoC3uOC3oGo/32xPZStl6vtzXvxb1pv6zEQojfq+1m2BWq0D6Daluvto1pIv4gXCXar9XuVihWZIVBta1X4t2e/OW+yQeVaH9Uu79CEc0S/Wq7NdJmzNjiqj/cCLuWVrDLb5Xl3edgKFwlWr/a/R1Kf2YdApiVSrxtcZWroYjmAQkaxxa3GYpwXhhUFrfSG7nJzVDwRB9XeTYUvLGGcOdCwRv9IpxPhsKVwbY/inBOWSrC+WTpl/AT8OXLl7C1tRU+fvwYPnz4EL5//x6+ffs2/NuBAwfCwYMHw6FDh8Lx48fD8vLy8Ng7jON2gkMQ5t27d2EwGIT3799HvfbIkSPhzJkz4eTJk8Ep2y6Fe/v2bXj69OnYqhYFyzt//rxLAV0Jh0t8/PhxtIXVgXAI6MmFuhEO0R4+fDjcNwGiXblyxY14LoT79OnTULRU11jH/v37w9WrV4d9oHX2BeNgYY8ePWpcNCAa5b2asuqcmBeuSfc4jTYbSgqmhXv27FknrR/X/OLFi2AZswNwBIs9efRRRIhHjx4dDroB9ydjva9fv6r/16tXr8Lp06fNBitmg5ONjY3heE0DghHOM6iex5s3b8Lz58/VAvb7/XDp0qVgEZMWh7VpRcOyiAQ1lnHq1Klh2uvBgwcq8bBU+jrSZtYw2cdxwjTEiCbwXF4jrrSO169fB4u4Fi5WNIHXrK2tqZ5L0toi5oTDNWlOFkFISuCAyzx27Fjt8whqLA4NzAlHKK6B/ioVAhoNMdFoW5gTjvBdg8Za6sDqiEjr0DamNjEnnGbAnTOXqIkYi6tUoLG4nOG5JrrUeoE2MSecJuDImQbTiGIxe2JOOE2fg+vK5b40/VcRToGm/8JKPn/+HFLRzqQfPnw4WMOkq9S0cHKOqWjSajSkkvJSoh0Yp2Q1yM5ohMsx7GgCk8IxvtLADMIigQqvoUpMw8rKSrCISeEoWtUEKYsUEMW8hqFCsbgI6FO0g2wEuHPnzrDPmycGUSjPuXfvnlporeV3gdmJVPowLCMGBMdCOOFYC9EnG6XplKjHDiGuXbtmtuLLbOkCJwx3GZO1QBiCDu200DwQ3nKZntliIayny9Jw7cxBV5iu8qLmoyss929gWjjtZGduUidp28B8QWwXVpdjkrZpzAtH69eM6XJheew2iXnhCFIoTG0L60GJYF44aMt1YW0e3CS4EI5AoQ33ZT2SnMSFcNCGC/PiJsGNcFhDk5kMoldPlxK7EQ6azKTUXTBiDXfCNTE08DIEmMSVcE0NDTz1bYIr4SC3S8PausyJLoo74WTOLRcEPRaLgepwJxzkdG0e3SS4FC7XrAH/x+uCbC6Fgxz90okTJ4JX3AqXOjTwlJechlvhUksbPOUlp+FWOEhxl16DEsG1cIsGKZ6DEsG1cLCI1XkOSgT3wsUGKTzXc1AidF4QK8tjsLKBLIaNG1tdXVW5MylX1165E2OhlKrLElIILlNLXC/Xdbal9RJ0hJIVy9nPquPnRFECrhEvplydRW00/WLdxSEIyEZDYN92n9mKxS2yYjml56xgd/HixdrnasvVY6ZveO95F4dwCTKbXGOHNeK2+f9tiNiocLgvXM2ii19rrxvAbdHy6y5UjBm7xa60wHeU7ykiNjnx24hwnMC6y540xIT6nKQ64WKCEt5bu4LfXkREzkFTy+NnFQ7XwZWeOZaX58vGnGiNu4xpCLw33ydl9TwaLlfNImDuFdazBSf0CdrLc6fBiefEsrqrdPyxsA7lrOgS98XJi4VGKP2ZbIuC9eXK2GSxONZOjl2GF5HkIsRcKxvQz80SjsuTF4HPN9k3EmghHu8Tu4CArBSRQ7xk4bA0rWgIhQviJDYxDppnpVhyDvjcIiYC4A4RkP5QIyLi4dJTSzCShNOsXsCHpMCHD9r0oHVeP9dUFRf9Fo2RjfNBQ2bYM2+pRM5Zah1nknB1i8QgGK2yrSwD78PJ2NsPtXVJMO/NuJNGysLd8zyRdow6i6Rc5ayOmlZPIMAHazs1NE2ktrMavN+FCxeGmZ9ZeVSyRik0IhzrHXc1UTlNpK4uwud9Zy1/nzrGTRJuVmvqcgHqaZ+pzQsj95L7lmlCUh83KyuP/5abOLTNtEuyurK4J0+ezBzAp3qkpAF43fjN8x0RU6AxI9q8wTrTVinzgknCMRi9e/du7SrhImBT4zcLxMyAMEtx/fr1kEJyyotWRapJu5Yy4jGGwZ15F1EmgRFLu+RUrpsLZslVxog3iRT7sLcwq1wHwrAyraS6YgOPnHeEzJZkJrzV3mxoFjKTLElmjnErbQuKQHwPGiTfiw2hUkJ4vsfly5ezBUrZSxcWSTjXITdhn7wZO7CnFU8Ky+Np4f9kgxIB5EbvPOaYPc/LeZ+BplJ+jdScSJHNohORPwNN52gbLRaSzDljGYu3OWkCma5qOqneWpUXIspaklZv7bUoIhbjsrbyop2sECthtERn3qxRZuslKu4iGka4f6r9UugYKRHAMtkTJHR9P26JcAmIpKSiiyh3Ggi3We37wSiIKOE5QnIsESBMixZnMenGRACJQmUuj+MuClwjGZhdk1mwvC5ylzCtsx0K3tguwvlkKNwgFLxRhHPKS4RLq1opdMFLhgP96mAzFDzR39fr9QahuEtPDCrNtqTK61YoeGGdHz1+VO6SlBfusvPUV2Eug2pbG1tcdcBY7mYoWGcd0TgYF8RWv7gfRmZYMAmi3ZYHvb1/rdzmjbArYD8ULDD0hiPDGtOb9szREGE1FAG7ZBB2g8Y/R13Z/+jVvXok4rlqOzvaL01s0A+FWLbDfzliOR6MNvqwjdEwbSb/AmA6VQ6UiC1pAAAAAElFTkSuQmCC",yo="http://139.59.37.47:3031",vo=({showGfBar:o,showGfAlert:g})=>{const{isLoaded:l,loadError:r}=wn({googleMapsApiKey:"AIzaSyA_S7GfAh6rJYWQ5X4n4X-3poo3vymuspU"}),{selectedVehicle:a,locationData:u,tractorIcon:A}=P(i=>i.liveMap),{geofence:j,vehicleSideBar:L}=P(i=>i.geofence),{collapsed:C}=P(i=>i.auth),[m,S]=n.useState(null),[R,D]=n.useState(null),[c,d]=n.useState(1e3),[k,z]=n.useState([]),[x,F]=n.useState(!0),[I,B]=n.useState(!0),[v,N]=n.useState(!1),[p,G]=n.useState({lat:18.516726,lng:73.856255}),[M,V]=n.useState(50),[h,$]=n.useState("circular"),[w,X]=n.useState([]),[q,ee]=n.useState({north:p.lat+.01,south:p.lat-.01,east:p.lng+.01,west:p.lng-.01}),[T,te]=n.useState([{lat:p.lat+.01,lng:p.lng},{lat:p.lat-.01,lng:p.lng-.01},{lat:p.lat-.01,lng:p.lng+.01}]),[f,O]=n.useState([{lat:p.lat+.01,lng:p.lng},{lat:p.lat-.01,lng:p.lng-.01},{lat:p.lat-.01,lng:p.lng+.01}]),W=n.useRef(null),ne=n.useRef(null),de=n.useRef(!1),oe=n.useRef(null),ae=n.useRef(null);let Wt=re();n.useEffect(()=>{console.log(w,"rectangleVertices")},[w]),n.useEffect(()=>{Jt()},[a]),n.useEffect(()=>{if(u.length>0&&Object.keys(a).length>0){let i=u.filter(b=>{var E;return((E=b.latestDocument)==null?void 0:E.imei)===a.imei});z(i)}},[a]),n.useEffect(()=>{m&&R&&m.fitBounds(R)},[m,R]);const Jt=async()=>{var i,b,E,J,U,Q,H,Ce,Se,we,Ae,Oe,ke,Ee,Re,De,Ie,Le,Fe,_e,Ne,Pe,ze,Me,Ge,Te,Be,Ve,Xe,We,Je,Ue,$e,He,Ke,Ye,qe,Qe,Ze,et,tt,nt,ot,at,st,it,lt,rt,ct,dt,gt,pt,ut,xt,ht,ft,mt,yt,vt,bt,jt,Ct,St,wt,At,Ot,kt,Et,Rt,Dt,It;if(Object.keys(a).length>0)try{const t=await ue.get(`${yo}/api/get/geofance/${a==null?void 0:a.imei}`);if(console.log(t.data.geofenceData,"result"),((b=(i=t==null?void 0:t.data)==null?void 0:i.geofenceData)==null?void 0:b.area_type)==="circular")if($("circular"),(J=(E=t==null?void 0:t.data)==null?void 0:E.geofenceData)!=null&&J.lat)G({lat:(Q=(U=t==null?void 0:t.data)==null?void 0:U.geofenceData)==null?void 0:Q.lat,lng:(Ce=(H=t==null?void 0:t.data)==null?void 0:H.geofenceData)==null?void 0:Ce.long}),d((we=(Se=t==null?void 0:t.data)==null?void 0:Se.geofenceData)==null?void 0:we.radius),F((Oe=(Ae=t==null?void 0:t.data)==null?void 0:Ae.geofenceData)==null?void 0:Oe.isActive_Geofance),B(((Ee=(ke=t==null?void 0:t.data)==null?void 0:ke.geofenceData)==null?void 0:Ee.type)==="inward"),N((De=(Re=t==null?void 0:t.data)==null?void 0:Re.geofenceData)==null?void 0:De.isActive_Speed),V((Le=(Ie=t==null?void 0:t.data)==null?void 0:Ie.geofenceData)==null?void 0:Le.speed);else return Y.success("No Geofence For Selected Vehicle",{id:"getting geofence"});else((_e=(Fe=t==null?void 0:t.data)==null?void 0:Fe.geofenceData)==null?void 0:_e.area_type)==="triangle"?($("triangle"),console.log("get for triangle",(Ne=t==null?void 0:t.data)==null?void 0:Ne.geofenceData),te([{lat:(Me=(ze=(Pe=t==null?void 0:t.data)==null?void 0:Pe.geofenceData)==null?void 0:ze.triangle_points[0])==null?void 0:Me.lat,lng:(Be=(Te=(Ge=t==null?void 0:t.data)==null?void 0:Ge.geofenceData)==null?void 0:Te.triangle_points[0])==null?void 0:Be.long},{lat:(We=(Xe=(Ve=t==null?void 0:t.data)==null?void 0:Ve.geofenceData)==null?void 0:Xe.triangle_points[1])==null?void 0:We.lat,lng:($e=(Ue=(Je=t==null?void 0:t.data)==null?void 0:Je.geofenceData)==null?void 0:Ue.triangle_points[1])==null?void 0:$e.long},{lat:(Ye=(Ke=(He=t==null?void 0:t.data)==null?void 0:He.geofenceData)==null?void 0:Ke.triangle_points[2])==null?void 0:Ye.lat,lng:(Ze=(Qe=(qe=t==null?void 0:t.data)==null?void 0:qe.geofenceData)==null?void 0:Qe.triangle_points[2])==null?void 0:Ze.long}])):((tt=(et=t==null?void 0:t.data)==null?void 0:et.geofenceData)==null?void 0:tt.area_type)==="rectangle"?($("rectangle"),console.log("get for rectangle",(nt=t==null?void 0:t.data)==null?void 0:nt.geofenceData),ee({north:(st=(at=(ot=t==null?void 0:t.data)==null?void 0:ot.geofenceData)==null?void 0:at.rectangle_points[0])==null?void 0:st.lat,south:(rt=(lt=(it=t==null?void 0:t.data)==null?void 0:it.geofenceData)==null?void 0:lt.rectangle_points[1])==null?void 0:rt.lat,east:(gt=(dt=(ct=t==null?void 0:t.data)==null?void 0:ct.geofenceData)==null?void 0:dt.rectangle_points[1])==null?void 0:gt.long,west:(xt=(ut=(pt=t==null?void 0:t.data)==null?void 0:pt.geofenceData)==null?void 0:ut.rectangle_points[0])==null?void 0:xt.long})):((ft=(ht=t==null?void 0:t.data)==null?void 0:ht.geofenceData)==null?void 0:ft.area_type)==="polygon"&&($("polygon"),console.log("get for polygon",(mt=t==null?void 0:t.data)==null?void 0:mt.geofenceData),O((vt=(yt=t==null?void 0:t.data)==null?void 0:yt.geofenceData)==null?void 0:vt.polygon_points),V((jt=(bt=t==null?void 0:t.data)==null?void 0:bt.geofenceData)==null?void 0:jt.speed),F((St=(Ct=t==null?void 0:t.data)==null?void 0:Ct.geofenceData)==null?void 0:St.isActive_Geofance),B(((At=(wt=t==null?void 0:t.data)==null?void 0:wt.geofenceData)==null?void 0:At.type)==="inward"),G({lat:(kt=(Ot=t==null?void 0:t.data)==null?void 0:Ot.geofenceData)==null?void 0:kt.lat,lng:(Rt=(Et=t==null?void 0:t.data)==null?void 0:Et.geofenceData)==null?void 0:Rt.long}),N((It=(Dt=t==null?void 0:t.data)==null?void 0:Dt.geofenceData)==null?void 0:It.isActive_Speed))}catch(t){console.log(t,"error while getting geofence"),Y.error("Error while getting geofence",{id:"getting geofence"})}},Ut=i=>{S(i)},$t=()=>{var i,b,E,J,U,Q;if(Object.keys(a).length>0){let H;h==="circular"?H={imei:a.imei,area_type:h,type:I?"inward":"outward",lat:p.lat,long:p.lng,radius:c,isActive_Geofance:x,isActive_Speed:!!v,speed:v?M:5}:h==="rectangle"?H={imei:a.imei,area_type:h,type:I?"inward":"outward",rectangle_points:[{lat:w==null?void 0:w.north,long:w==null?void 0:w.west},{lat:w==null?void 0:w.south,long:w==null?void 0:w.east}],isActive_Geofance:x,isActive_Speed:!!v,speed:v?M:50}:h==="triangle"?H={imei:a.imei,area_type:h,type:I?"inward":"outward",triangle_points:[{lat:(i=T[0])==null?void 0:i.lat,long:(b=T[0])==null?void 0:b.lng},{lat:(E=T[1])==null?void 0:E.lat,long:(J=T[1])==null?void 0:J.lng},{lat:(U=T[2])==null?void 0:U.lat,long:(Q=T[2])==null?void 0:Q.lng}],isActive_Geofance:x,isActive_Speed:!!v,speed:v?M:50}:h==="polygon"&&(H={imei:a.imei,area_type:h,type:I?"inward":"outward",polygon_points:f,isActive_Geofance:x,isActive_Speed:!!v,speed:v?M:50}),Wt(ln({data:H})),Y.success("Successful Saved",{id:"geofence"})}else Y.error("Please Select Vehicle",{id:"geofence"})},se=i=>{console.log("selectedType",i),$(i)},Ht=()=>{if(!de.current){de.current=!0;const i=ge.getRadius();console.log("newRadius",i),d(i),de.current=!1}},Kt=i=>{console.log("New Center:",i.toJSON()),G(i.toJSON())},Yt=()=>{if(oe.current&&oe.current.getBounds){const i=oe.current.getBounds(),b=i.getNorthEast().lat(),E=i.getSouthWest().lat(),J=i.getNorthEast().lng(),U=i.getSouthWest().lng();console.log("{ north, south, east, west }",{north:b,south:E,east:J,west:U}),ee({north:b,south:E,east:J,west:U}),X({north:b,south:E,east:J,west:U})}},qt={bounds:q,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}},Qt=i=>{oe.current=i},Zt=()=>{if(ne.current&&ne.current.getPath){const b=ne.current.getPath().getArray().map(E=>({lat:E.lat(),lng:E.lng()}));te(b),console.log("newVertices",b)}},en={paths:T,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}},tn=i=>{ne.current=i},nn=()=>{if(ae.current&&ae.current.getPath){const b=ae.current.getPath().getArray().map(E=>({lat:E.lat(),lng:E.lng()}));O(b),console.log("newVertices",b)}},on=i=>{ae.current=i},je={paths:f,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}};if(r)return"Error loading maps";if(!l)return"Loading maps";const an={width:"100%",height:"92vh"};let ge;return e.jsxs(e.Fragment,{children:[e.jsxs(s,{children:[e.jsx(K,{onClick:()=>{se("rectangle")},style:{background:h==="rectangle"?_.bgColor:"transparent",color:h==="rectangle"?"white":"black"},children:"Rectangle"}),e.jsx(K,{onClick:()=>{se("circular")},style:{background:h==="circular"?_.bgColor:"transparent",color:h==="circular"?"white":"black"},children:"Circle"}),e.jsx(K,{onClick:()=>{se("triangle")},style:{background:h==="triangle"?_.bgColor:"transparent",color:h==="triangle"?"white":"black"},children:"Triangle"}),e.jsx(K,{onClick:()=>{se("polygon")},style:{background:h==="polygon"?_.bgColor:"transparent",color:h==="polygon"?"white":"black"},children:"Polygon"})]}),e.jsxs(s,{sx:{display:"flex",flexDirection:"row"},children:[e.jsxs(An,{ref:W,mapContainerStyle:an,zoom:15,center:p,onLoad:Ut,children:[h==="circular"&&e.jsx(On,{center:p,radius:c,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0},onLoad:i=>{ge=i,ge.addListener("radius_changed",Ht)},onDragEnd:i=>Kt(i.latLng)}),h==="rectangle"&&e.jsx(kn,{bounds:q,options:qt.options,onDragEnd:Yt,onLoad:Qt}),h==="triangle"&&e.jsx(_t,{paths:T,options:en.options,onDragEnd:Zt,onLoad:tn}),h==="polygon"&&e.jsx(_t,{paths:je.paths,options:je.options,draggable:!0,editable:!0,onDragEnd:nn,onLoad:on}),k&&k.length>0&&k.map((i,b)=>e.jsx(En,{position:{lat:i.latestDocument.lat,lng:i.latestDocument.lng},icon:{path:A.path1,fillColor:"red",fillOpacity:2,strokeWeight:1,scale:2}},b))]}),o&&!g&&!L&&p&&e.jsx(s,{sx:{width:C?"25%":"20%"},children:e.jsxs(s,{sx:{display:"flex",padding:"15px",flexDirection:"column",gap:"10px"},children:[e.jsx(y,{sx:{fontWeight:"bold",fontSize:"16px"},children:"Geofence Setting"}),e.jsxs(y,{sx:{fontWeight:"400",fontSize:"14px",textTransform:"capitalize"},children:["Type: ",h]}),h==="circular"&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{sx:{color:"#686868"},children:["Centered At"," "]}),e.jsxs(y,{sx:{color:"#686868"},children:["Lat: ",p.lat.toFixed(2)]}),e.jsxs(y,{sx:{color:"#686868"},children:["Lng: ",p.lng.toFixed(2)]}),e.jsxs(y,{sx:{color:"#686868",border:"1px solid #686868",borderRadius:"4px",padding:"8px"},children:["Radius ( ",(c/1e3).toFixed(2)," in km)"]})]}),e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(y,{variant:"body1",component:"b",children:"Inactive"}),e.jsx(ie,{defaultChecked:x,onChange:()=>{F(!x)},color:"primary",inputProps:{"aria-label":"toggle active state"}}),e.jsx(y,{variant:"body1",component:"b",children:"Active"})]}),e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(y,{variant:"body1",component:"b",children:"Inward"}),e.jsx(ie,{checked:I,onChange:()=>{B(!I)},color:"primary",inputProps:{"aria-label":"toggle direction"}}),e.jsx(y,{variant:"body1",component:"b",children:"Outward"})]}),e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(ie,{checked:v,onChange:()=>{N(!v)},color:"primary",inputProps:{"aria-label":"toggle direction"}}),e.jsx(y,{variant:"body1",component:"b",children:"Speed Limit"})]}),v&&e.jsx(s,{sx:{},children:e.jsx(Rn,{sx:{width:"100%",border:"none","&:focus":{outline:"none"}},value:M,placeholder:"Enter Speed Limit",type:"number",onChange:i=>{const b=Math.max(0,parseInt(i.target.value));V(b)}})}),e.jsx(K,{disabled:Object.keys(a).length===0&&!1,variant:"outlined",size:"small",sx:{color:"white",backgroundColor:_.bgColor,mt:"6px",mx:"5px",border:"1px solid white",height:"40px",width:"100%","&:hover":{color:"black",background:_.bgShadow,border:"1px solid black"},letterSpacing:"1.5px",fontSize:"16px"},onClick:()=>{if(Object.keys(a).length===0)return Y.error("please select a vehicle.");$t()},children:"SUBMIT"})]})})]})]})},bo=({showMap:o,setShowMap:g,showGfBar:l,showGfAlert:r})=>{const{selectedVehicle:a}=P(u=>u.liveMap);return e.jsx(e.Fragment,{children:o?e.jsx(vo,{showGfBar:l,showGfAlert:r}):e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",background:_.bgShadow,margin:"10px",padding:"10px",borderRadius:"8px"},children:[e.jsxs(s,{sx:{},children:[e.jsx(y,{sx:{fontWeight:"bold",fontSize:"16px",margin:"4px"},children:"Vehicle Settings"}),e.jsxs(s,{sx:{display:"flex"},children:[e.jsx(s,{children:e.jsx("img",{src:fo,alt:"tractorIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}})}),e.jsxs(s,{children:[e.jsx(y,{sx:{fontWeight:"bold"},children:Object.keys(a).length>0?a==null?void 0:a.reg_id:"Reg No"}),e.jsx(y,{sx:{marginBottom:"5px"},children:"Chassis No"}),e.jsxs(s,{sx:{width:"200px",display:"flex",gap:"8px"},children:[e.jsx(Nt,{placeholder:"ONLINE"}),e.jsx(Nt,{placeholder:"RUNNING"})]}),e.jsx(s,{sx:{marginLeft:"-8px"},children:e.jsxs(y,{children:[e.jsx(ie,{})," ",e.jsx("b",{children:"Switched ON / OFF"})]})})]})]})]}),e.jsxs(s,{onClick:()=>{g(!o)},sx:{cursor:"pointer",marginTop:"50px"},children:[e.jsx("img",{src:mo,alt:"tractorIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}}),e.jsx(y,{sx:{fontSize:"12px"},children:"Set Geofence"})]})]})})};function No(){const{w_customer_id:o}=P(d=>d.auth),{vehicleSideBar:g}=P(d=>d.geofence),{collapsed:l}=P(d=>d.auth),[r,a]=n.useState([]);n.useState([]);const[u,A]=n.useState({user:!0,vehicle:!1}),[j,L]=n.useState(!1),[C,m]=n.useState(!1),[S,R]=n.useState(!1);let D=re();n.useEffect(()=>{c()},[]);const c=async()=>{let d=[],k=[];(await D(rn({w_customer_id:o}))).payload.map(I=>{d.push({id:I.id,label:I.registration_id,value:I.imei[0].mac_id}),k.push(I.imei[0].mac_id)});const x="one",F=k;k.length>0&&D(cn({type:x,imei:F})),a(d)};return e.jsxs("div",{className:"app",children:[e.jsx(vn,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(ro,{title:"Settings",setShowContent:A,showContent:u,showMap:j,setShowMap:L,showGfBar:C,setShowGfBar:m,showGfAlert:S,setShowGfAlert:R}),e.jsxs(s,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(s,{style:{width:g?"80%":"100%"},children:u.user?e.jsx(ho,{}):e.jsx(bo,{showMap:j,setShowMap:L,showGfBar:C,showGfAlert:S})}),!S&&!C&&g&&e.jsx(s,{style:{width:"20%"},children:e.jsx(jn,{vehicleData:r,title:"Setting"})}),S&&!C&&!g&&e.jsx(s,{sx:{width:l?"25%":"20%"},children:e.jsx(uo,{})})]})]})]})}export{No as default};
