import{p as je,q as Se,w as F,x as re,y as U,z as Ce,A as Te,B as we,r as m,C as ke,D as N,j as e,E as O,F as De,H as oe,I as G,J as q,K as Pe,L as X,M as _,N as Z,O as de,T as M,a as A,G as z,c as E,u as V,b as se,_ as R,P as B,t as Ie,Q as Fe,R as Ae,S as le,i as pe,U as Re,V as K,W as ue,X as Me,Y as Le,Z as Ee,$ as ne,a0 as ae,l as Ne,m as _e,n as $e,a1 as Oe,o as Ve,v as ze}from"./index-BUGQRcLH.js";import{L as Be}from"./LightModeOutlined-BQz76xco.js";import{s as H}from"./Socket-0N_gnJcr.js";import{p as Ge,R as qe,L as Ye,X as Ue,Y as He,a as We,b as Je,T as Ke}from"./LineChart-C7zoPqri.js";import{t as L,d as Xe}from"./Search-CungJLJi.js";import{B as b,C as Q}from"./CircularProgress-BxozFURZ.js";import{P as Ze}from"./Paper-CG34LR64.js";import{c as Qe,S as et}from"./Switch-D5eivKrD.js";import{c as tt,I as rt}from"./IconButton-gYY4leoZ.js";import{r as ot,m as st,a as lt}from"./Modal-BiD1DfJ1.js";import{C as nt}from"./index-Crqgo4FU.js";import{u as at,G as it,M as ct}from"./esm-uiUPgVex.js";import{u as he,f as ge,F as xe,I as me,O as dt,a as pt}from"./OutlinedInput-CdJ2FxGP.js";import{d as ie}from"./index-CB00D44A.js";import{d as ut,a as ht,D as gt}from"./ArrowForwardIos-t_dbBM16.js";import{r as fe}from"./createSvgIcon-DCBbxJSk.js";import{T as xt,a as mt,d as ft,b as yt,c as W}from"./TableRow-DOPjGE4B.js";import{C as bt}from"./Card-9WrPfXMb.js";import{S as vt,M as jt}from"./Select-BrWFVId6.js";import{T as St}from"./TopBar-D2qzAON6.js";import{G as Ct}from"./GeofencAlert-BJq3iRVs.js";import"./proj-XQwXs9DQ.js";import"./index-CI24IKTI.js";import"./index-BpiCMaNo.js";import"./NotificationsNone-MSsaixS0.js";const Tt=["component","direction","spacing","divider","children","className","useFlexGap"],wt=je(),kt=Se("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,r)=>r.root});function Dt(t){return De({props:t,name:"MuiStack",defaultTheme:wt})}function Pt(t,r){const a=m.Children.toArray(t).filter(Boolean);return a.reduce((s,g,i)=>(s.push(g),i<a.length-1&&s.push(m.cloneElement(r,{key:`separator-${i}`})),s),[])}const It=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],Ft=({ownerState:t,theme:r})=>{let a=F({display:"flex",flexDirection:"column"},re({theme:r},U({values:t.direction,breakpoints:r.breakpoints.values}),s=>({flexDirection:s})));if(t.spacing){const s=Ce(r),g=Object.keys(r.breakpoints.values).reduce((p,h)=>((typeof t.spacing=="object"&&t.spacing[h]!=null||typeof t.direction=="object"&&t.direction[h]!=null)&&(p[h]=!0),p),{}),i=U({values:t.direction,base:g}),y=U({values:t.spacing,base:g});typeof i=="object"&&Object.keys(i).forEach((p,h,j)=>{if(!i[p]){const S=h>0?i[j[h-1]]:"column";i[p]=S}}),a=Te(a,re({theme:r},y,(p,h)=>t.useFlexGap?{gap:oe(s,p)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${It(h?i[h]:t.direction)}`]:oe(s,p)}}))}return a=we(r.breakpoints,a),a};function At(t={}){const{createStyledComponent:r=kt,useThemeProps:a=Dt,componentName:s="MuiStack"}=t,g=()=>G({root:["root"]},p=>q(s,p),{}),i=r(Ft);return m.forwardRef(function(p,h){const j=a(p),x=ke(j),{component:S="div",direction:C="column",spacing:l=0,divider:c,children:n,className:T,useFlexGap:w=!1}=x,u=N(x,Tt),o={direction:C,spacing:l,useFlexGap:w},f=g();return e.jsx(i,F({as:S,ownerState:o,ref:h,className:O(f.root,T)},u,{children:c?Pt(n,c):n}))})}const Rt=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Mt=["component","slots","slotProps"],Lt=["component"];function Et(t,r){const{className:a,elementType:s,ownerState:g,externalForwardedProps:i,getSlotOwnerState:y,internalForwardedProps:d}=r,p=N(r,Rt),{component:h,slots:j={[t]:void 0},slotProps:x={[t]:void 0}}=i,S=N(i,Mt),C=j[t]||s,l=ot(x[t],g),c=st(F({className:a},p,{externalForwardedProps:t==="root"?S:void 0,externalSlotProps:l})),{props:{component:n},internalRef:T}=c,w=N(c.props,Lt),u=Pe(T,l==null?void 0:l.ref,r.ref),o=y?y(w):{},f=F({},g,o),v=t==="root"?n||h:n,D=lt(C,F({},t==="root"&&!h&&!j[t]&&d,t!=="root"&&!j[t]&&d,w,v&&{as:v},{ref:u}),f);return Object.keys(o).forEach(I=>{delete D[I]}),[C,D]}const Nt=tt(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function _t(t){return q("MuiAvatar",t)}X("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const $t=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],Ot=Qe(),Vt=t=>{const{classes:r,variant:a,colorDefault:s}=t;return G({root:["root",a,s&&"colorDefault"],img:["img"],fallback:["fallback"]},_t,r)},zt=_("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:a}=t;return[r.root,r[a.variant],a.colorDefault&&r.colorDefault]}})(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:F({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:F({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]})),Bt=_("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,r)=>r.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),Gt=_(Nt,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,r)=>r.fallback})({width:"75%",height:"75%"});function qt({crossOrigin:t,referrerPolicy:r,src:a,srcSet:s}){const[g,i]=m.useState(!1);return m.useEffect(()=>{if(!a&&!s)return;i(!1);let y=!0;const d=new Image;return d.onload=()=>{y&&i("loaded")},d.onerror=()=>{y&&i("error")},d.crossOrigin=t,d.referrerPolicy=r,d.src=a,s&&(d.srcset=s),()=>{y=!1}},[t,r,a,s]),g}const Yt=m.forwardRef(function(r,a){const s=Ot({props:r,name:"MuiAvatar"}),{alt:g,children:i,className:y,component:d="div",slots:p={},slotProps:h={},imgProps:j,sizes:x,src:S,srcSet:C,variant:l="circular"}=s,c=N(s,$t);let n=null;const T=qt(F({},j,{src:S,srcSet:C})),w=S||C,u=w&&T!=="error",o=F({},s,{colorDefault:!u,component:d,variant:l}),f=Vt(o),[v,D]=Et("img",{className:f.img,elementType:Bt,externalForwardedProps:{slots:p,slotProps:{img:F({},j,h.img)}},additionalProps:{alt:g,src:S,srcSet:C,sizes:x},ownerState:o});return u?n=e.jsx(v,F({},D)):i||i===0?n=i:w&&g?n=g[0]:n=e.jsx(Gt,{ownerState:o,className:f.fallback}),e.jsx(zt,F({as:d,ownerState:o,className:O(f.root,y),ref:a},c,{children:n}))}),Ut=Yt,Ht=At({createStyledComponent:_("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,r)=>r.root}),useThemeProps:t=>Z({props:t,name:"MuiStack"})}),Wt=Ht;function Jt(t){return q("MuiFormControlLabel",t)}const Kt=X("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),$=Kt,Xt=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],Zt=t=>{const{classes:r,disabled:a,labelPlacement:s,error:g,required:i}=t,y={root:["root",a&&"disabled",`labelPlacement${de(s)}`,g&&"error",i&&"required"],label:["label",a&&"disabled"],asterisk:["asterisk",g&&"error"]};return G(y,Jt,r)},Qt=_("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:a}=t;return[{[`& .${$.label}`]:r.label},r.root,r[`labelPlacement${de(a.labelPlacement)}`]]}})(({theme:t,ownerState:r})=>F({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${$.disabled}`]:{cursor:"default"}},r.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},r.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},r.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${$.label}`]:{[`&.${$.disabled}`]:{color:(t.vars||t).palette.text.disabled}}})),er=_("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(t,r)=>r.asterisk})(({theme:t})=>({[`&.${$.error}`]:{color:(t.vars||t).palette.error.main}})),tr=m.forwardRef(function(r,a){var s,g;const i=Z({props:r,name:"MuiFormControlLabel"}),{className:y,componentsProps:d={},control:p,disabled:h,disableTypography:j,label:x,labelPlacement:S="end",required:C,slotProps:l={}}=i,c=N(i,Xt),n=he(),T=(s=h??p.props.disabled)!=null?s:n==null?void 0:n.disabled,w=C??p.props.required,u={disabled:T,required:w};["checked","name","onChange","value","inputRef"].forEach(P=>{typeof p.props[P]>"u"&&typeof i[P]<"u"&&(u[P]=i[P])});const o=ge({props:i,muiFormControl:n,states:["error"]}),f=F({},i,{disabled:T,labelPlacement:S,required:w,error:o.error}),v=Zt(f),D=(g=l.typography)!=null?g:d.typography;let I=x;return I!=null&&I.type!==M&&!j&&(I=e.jsx(M,F({component:"span"},D,{className:O(v.label,D==null?void 0:D.className),children:I}))),e.jsxs(Qt,F({className:O(v.root,y),ownerState:f,ref:a},c,{children:[m.cloneElement(p,u),w?e.jsxs(Wt,{display:"block",children:[I,e.jsxs(er,{ownerState:f,"aria-hidden":!0,className:v.asterisk,children:["â€‰","*"]})]}):I]}))}),rr=tr;function or(t){return q("MuiFormGroup",t)}X("MuiFormGroup",["root","row","error"]);const sr=["className","row"],lr=t=>{const{classes:r,row:a,error:s}=t;return G({root:["root",a&&"row",s&&"error"]},or,r)},nr=_("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:a}=t;return[r.root,a.row&&r.row]}})(({ownerState:t})=>F({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})),ar=m.forwardRef(function(r,a){const s=Z({props:r,name:"MuiFormGroup"}),{className:g,row:i=!1}=s,y=N(s,sr),d=he(),p=ge({props:s,muiFormControl:d,states:["error"]}),h=F({},s,{row:i,error:p.error}),j=lr(h);return e.jsx(nr,F({className:O(j.root,g),ownerState:h,ref:a},y))}),ir=ar,cr=({imeiNo:t})=>{const{selectedVehicle:r,parameterData:a,ivnPid:s,locationData:g,vehicleList:i,onlineVehicle:y}=A(v=>v.liveMap),{ivnParameters:d,mode:p}=A(v=>v.dashboard),h=L(p),[j,x]=m.useState(),[S,C]=m.useState(!1),[l,c]=m.useState();m.useState({mainInputVoltage:0,ignition:0,speed:0});const[n,T]=m.useState("Not Available"),[w,u]=m.useState("Offline");m.useEffect(()=>{o()},[r]);const o=()=>{var v,D,I,P;if((g==null?void 0:g.length)>0){console.log("locationData",g);let k=g==null?void 0:g.find(Y=>Y.latestDocument.imei===r.imei);k?(x((v=k==null?void 0:k.latestDocument)==null?void 0:v.speed),C((D=k==null?void 0:k.latestDocument)==null?void 0:D.ignition),c((I=k==null?void 0:k.latestDocument)==null?void 0:I.mainInputVoltage),T((P=k==null?void 0:k.latestDocument)==null?void 0:P.venderId)):(x(0),C(0),c(0),T("Not Available"))}else x(0),C(0),c(0),T("Not Available")};m.useEffect(()=>{Object.keys(r).length>0&&f()},[r]);const f=()=>{if(Object.keys(r).length>0)if(y&&y.length>0){const v=y.some(D=>parseInt(D)===parseInt(r==null?void 0:r.imei));u(v?"Online":"Offline")}else u("Offline");else u("Offline")};return e.jsxs(e.Fragment,{children:[e.jsx(b,{sx:{mx:"10px",pt:"10px",color:h.grey[400]},children:e.jsx("b",{children:r==null?void 0:r.reg_id})}),e.jsx(b,{sx:{backgroundColor:h.grey[200],height:"12vh",borderRadius:"8px",p:"5px"},children:e.jsx(b,{sx:{},children:e.jsx(z,{container:!0,spacing:3,mt:"2.5px",children:e.jsx(z,{item:!0,xs:12,children:e.jsx(z,{container:!0,justifyContent:"space-around",spacing:3,children:[{label:"VenderId",value:n},{label:"Speed",value:j,unit:"km/h"},{label:"Main Input Voltage",value:parseFloat(l).toFixed(2),unit:"voltage"},{label:"Current Status",value:w}].map((v,D)=>e.jsx(z,{item:!0,children:e.jsxs(Ze,{sx:{height:70,width:250,backgroundColor:h.grey[100],color:h.grey[400],display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 10px"},children:[e.jsxs(b,{children:[e.jsx(M,{variant:"h6",sx:{fontSize:"12px"},children:v.label}),e.jsxs(M,{variant:"h6",sx:{fontSize:"18px",fontWeight:"bold"},children:[v.value," ",v==null?void 0:v.unit]})]}),e.jsx(Ut,{src:Ge,sx:{width:20,height:20}})]})},D))})})})})})]})},J=({title:t,selectedTripData:r})=>{const{mode:a,loading:s}=A(h=>h.dashboard),{selectedVehicle:g}=A(h=>h.liveMap),[i,y]=m.useState([]);m.useEffect(()=>{let h=r.map(x=>{let S={...x};return S.ignition=S.ignition?1:0,S});const j=p(h);y(j)},[r]);const d=L(a),p=h=>{let j=null;return h.forEach(x=>{const S=new Date(x.createdAt);j&&j.toDateString()===S.toDateString()?(x.date=E(x.createdAt).format("HH:mm:ss"),x.ignition=x.ignition?1:0):(x.date=E(x.createdAt).format("DD-MM-YYYY"),x.ignition=x.ignition?1:0),j=S}),h};return e.jsx(b,{sx:{ml:"2rem",border:d.grey[300],fontSize:"13px",height:"24vh",color:d.grey[400],backgroundColor:d.grey[100],borderRadius:"5px"},children:i&&i.length>0?e.jsx(qe,{children:e.jsxs(Ye,{data:i,margin:{top:15,right:10,left:-25,bottom:0},children:[e.jsx(Ue,{dataKey:"date",stroke:d.grey[400]}),e.jsx(He,{stroke:d.grey[400]}),e.jsx(We,{type:"monotone",dataKey:t,dot:!1,stroke:"#EF5B05",strokeWidth:2}),e.jsx(Je,{layout:"horizontal",verticalAlign:"top",align:"center"}),e.jsx(Ke,{})]})}):e.jsx(nt,{style:{background:d.grey[100],width:"400px",height:"100px",margin:"auto",marginTop:"10px"},children:Object.keys(g).length===0?e.jsx(M,{textAlign:"center",align:"center",mt:"20px",color:d.grey[600],children:"Please Select a Vehicle"}):s?e.jsx(Q,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(M,{textAlign:"center",color:d.grey[600],children:"Sorry! No Trips Available"})})})},dr=()=>{const t=V(),{center:r,selectedParameterList:a,selectedVehicle:s,vehicleList:g,tractorIcon:i,icons:y,locationData:d,ivnPid:p,placesData:h}=A(P=>P.liveMap),{mode:j}=A(P=>P.dashboard),{isLoaded:x,loadError:S}=at({googleMapsApiKey:"AIzaSyD8TrUWS9FRTu-MRP339mJF_iWlORvEGUA"}),[C,l]=m.useState(null),[c,n]=m.useState(!0),[T,w]=m.useState(5),[u,o]=m.useState(),f=L(j);m.useEffect(()=>{if(c)o(d);else{let P=d==null?void 0:d.filter(k=>(k==null?void 0:k._id)===(s==null?void 0:s.imei));o(P)}},[d,s,c]);const v=()=>{if(!c)t(se({lat:21,lng:78})),w(4),n(k=>!k);else{const P=d.find(k=>k.latestDocument.imei===s.imei);if(P){console.log(P.latestDocument,"getCenter");const{lat:k,lng:Y}=P.latestDocument;t(se({lat:k,lng:Y})),w(12),n(ve=>!ve)}else R.error("Data is not available for selected vehicle")}};if(m.useEffect(()=>{x&&l(window.google.maps)},[x,d]),S)return"Error loading maps";if(!x)return"Loading maps";const D={height:"41.5vh",width:"99%",marginTop:"0px",marginLeft:"10px"},I=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}];return C?e.jsxs("div",{children:[e.jsxs(b,{sx:{ml:"10px",fontSize:"20px",display:"flex",justifyContent:"space-between",color:f.grey[400]},children:[e.jsx("b",{children:"Live Map"}),e.jsx(ir,{sx:{marginLeft:0,paddingTop:0,color:f.grey[400]},children:e.jsx(rr,{control:e.jsx(et,{checked:c,onChange:v}),label:c?"Group":"Individual"})})]}),e.jsx(it,{mapContainerStyle:D,zoom:T,center:r,options:{mapTypeControl:!1,styles:j?I:""},children:u&&u.length>0&&u.map((P,k)=>e.jsx(ct,{position:{lat:P.latestDocument.lat,lng:P.latestDocument.lng},icon:{url:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",scaledSize:new google.maps.Size(32,32),fillColor:"red",fillOpacity:2,strokeWeight:1,scale:2}},k))})]}):null},pr=({vehicleData:t})=>{const r=["Engine RPM","Engine coolant temperature","Battery Potential"],a=V(),{selectedVehicle:s,loading:g}=A(n=>n.liveMap),{startDate:i,endDate:y,mode:d}=A(n=>n.dashboard),[p,h]=m.useState(""),j=L(d),x=m.useRef(null),S=m.useRef(0),C=t.length>0&&t.filter(n=>n.label.toLowerCase().includes(p.toLowerCase())),l=n=>{h(n.target.value)},c=async n=>{var o;x.current&&(S.current=x.current.scrollTop),a(Fe({imei:n.value,reg_id:n.label})),n.value,ie().subtract(5,"day"),ie();let T=n.label;const w=await a(Ae({registration_id:T}));let u=[];if(w&&w.payload.length>0&&((o=w.payload)==null||o.map(f=>{f.ivn_parameter.length>0&&u.push(f.ivn_parameter[0])})),u.length>0){let f=u.filter(v=>r.includes(v.pid_description));a(le(f))}else a(le([]));setTimeout(()=>{x.current&&(x.current.scrollTop=S.current)},0)};return m.useEffect(()=>{x.current&&(x.current.scrollTop=S.current)},[g,C,s]),e.jsx(e.Fragment,{children:g?e.jsx("div",{children:e.jsx(b,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:e.jsx(Q,{})})}):e.jsxs("div",{ref:x,style:{overflowY:"auto",height:"90vh"},children:[e.jsx(b,{sx:{align:"center",my:"15px",ml:"20px"},children:e.jsxs(xe,{sx:{width:"90%",backgroundColor:"white",borderRadius:"5px"},variant:"outlined",children:[e.jsx(me,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px"},children:"Search"}),e.jsx(dt,{onChange:n=>l(n),inputProps:{style:{padding:7}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(pt,{position:"end",children:e.jsx(rt,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Xe,{})})}),label:"Search"})]})}),e.jsx(b,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsxs(B,{variant:"outlined",sx:{width:"90%",color:j.grey[400],"&:hover":{color:"#DAE0EE"}},children:["Total Vehicle: ",C.length]})}),C.length>0&&C.map((n,T)=>e.jsx(b,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(B,{variant:"outlined",onClick:()=>c(n),sx:{width:"90%",bgcolor:n.label===s.reg_id?Ie.bgColor:"undefined",color:n.label===s.reg_id?"#DAE0EE":j.grey[400]},children:n.label})},T))]})})};var ee={},ur=pe;Object.defineProperty(ee,"__esModule",{value:!0});var ye=ee.default=void 0,hr=ur(fe()),ce=e;ye=ee.default=(0,hr.default)([(0,ce.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,ce.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");var te={},gr=pe;Object.defineProperty(te,"__esModule",{value:!0});var be=te.default=void 0,xr=gr(fe()),mr=e;be=te.default=(0,xr.default)((0,mr.jsx)("path",{d:"m22 12-4-4v3H3v2h15v3z"}),"TrendingFlat");function fr(){const{allTripList:t,loading:r,mode:a,activeIndex:s,selectedDate:g,selectedTripData:i}=A(o=>o.dashboard),{selectedVehicle:y}=A(o=>o.liveMap),[d,p]=m.useState([]),[h,j]=m.useState("0"),[x,S]=m.useState(0);let C=V();const l=Re(),c=L(a);m.useEffect(()=>{const o=n(t);p(o),o.length>0&&K(o[0])},[t]);const n=o=>{const f=new Set,v=[];return o.forEach(D=>{const I=E(D.startTime).format("YYYY-MM-DD");f.has(I)||(f.add(I),v.push(I))}),v},T=(o,f)=>{C(ue(f)),console.log("item, i",o,f),C(Me(o.data));let v=Le(o==null?void 0:o.data);S(v);let D=Ee(new Date(o==null?void 0:o.startTime).toISOString(),new Date(o==null?void 0:o.endTime).toISOString());j(D)},w=o=>{console.log("activeIndex",s),console.log("i",o),s!==null?o===s?l("/trip-monitor"):R.error("Trip not selected"):R.error("Please select the trip")},u=t.filter(o=>E(o.startTime).format("YYYY-MM-DD")===g);return e.jsxs(e.Fragment,{children:[e.jsx(b,{sx:{width:"95%",display:"flex",overflow:"auto",mx:"10px",mt:2},children:u&&u.length>0?e.jsx(xt,{sx:{maxHeight:250,height:250,width:"98%",ml:"10px",mt:"10px",borderRadius:"5px",border:"1px solid #dbdad5"},children:e.jsx(mt,{stickyHeader:!0,"aria-label":"sticky table",children:e.jsx(ft,{children:u.map((o,f)=>{var v,D,I,P;return e.jsxs(yt,{sx:{backgroundColor:s===f?"#DAE0EE":c.grey[100]},children:[e.jsxs(W,{align:"left",style:{fontSize:"12px",padding:10,color:s===f?"black":c.grey[400],cursor:"pointer"},onClick:()=>{T(o,f)},children:[f+1,"."," ",`${(D=(v=o==null?void 0:o.startLocation)==null?void 0:v.address)==null?void 0:D.display_name}`," ",e.jsx(b,{component:"span",sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle"},children:e.jsx(be,{})}),`${(P=(I=o==null?void 0:o.endLocation)==null?void 0:I.address)==null?void 0:P.display_name}`]}),e.jsxs(W,{align:"right",style:{fontSize:"12px",padding:10,color:s===f?"black":c.grey[400]},children:[o!=null&&o.startTime?E(new Date(o.startTime).toISOString()).format("LT"):""," ","to"," ",o!=null&&o.endTime?E(new Date(o.endTime).toISOString()).format("LT"):"----"]}),e.jsx(W,{align:"right",style:{fontSize:"12px",padding:10,color:s===f?"black":c.grey[400]},children:e.jsx("span",{title:"Navigate to map",style:{cursor:"pointer"},onClick:()=>{w(f)},children:e.jsx(ye,{})})})]},f)})})})}):e.jsx(b,{sx:{height:210,display:"flex",justifyContent:"center",alignItems:"center",color:c.grey[400],margin:"auto"},children:e.jsx(bt,{style:{background:c.grey[100],width:"400px",height:"100px"},children:Object.keys(y).length===0?e.jsx(M,{textAlign:"center",align:"center",mt:"20px",color:c.grey[600],children:"Please Select a Vehicle"}):r?e.jsx(Q,{style:{position:"absolute",left:"40%",top:"38%",zIndex:9999}}):e.jsx(M,{textAlign:"center",color:c.grey[600],children:"Sorry! No Trips Available"})})})}),i.length>0&&e.jsx(b,{sx:{my:"0px"},children:e.jsxs(b,{sx:{display:"flex",mx:"5px",mt:"10px"},children:[e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Braking"}),e.jsx("div",{children:"0"})]}),e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Harsh Acceleration"}),e.jsx("div",{children:"0"})]}),e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Running Hrs"}),e.jsx("div",{children:h})]}),e.jsxs(b,{sx:{backgroundColor:"#EF5B05",color:"white",fontSize:"15px",height:"45px",pt:"5px",borderRadius:"5px",textAlign:"center",width:"25%",ml:"5px"},children:[e.jsx("div",{children:"Distance"}),e.jsxs("div",{children:[parseFloat(parseFloat(x).toFixed(2))," km"]})]})]})})]})}function yr(){const{allTripList:t,activeIndex:r,selectedDate:a,loading:s,mode:g,trip_payload:i,page:y}=A(c=>c.dashboard),d=V(),p=L(g),[h,j]=m.useState([]);m.useEffect(()=>{const c=x(t);j(c),c.length>0&&d(K(c[0]))},[t,d]);const x=c=>{const n=new Set,T=[];return c.forEach(w=>{const u=E(w.startTime).format("YYYY-MM-DD");n.has(u)||(n.add(u),T.push(u))}),T},S=c=>{d(K(c.target.value)),d(ue(null))},C=async()=>{const c={...i,page:y+1};try{(await d(ne(c))).error?R.error("No Trip! within selected date"):d(ae(y+1))}catch{R.error("No Trip! within selected date")}},l=()=>{if(y<=1)return;const c={...i,page:y-1};d(ae(y-1)),d(ne(c))};return e.jsx(b,{sx:{width:"50%",mx:"10px"},children:e.jsxs(xe,{fullWidth:!0,sx:{height:"10px","& .MuiInputBase-root":{height:"38px",backgroundColor:p.grey[500],color:p.grey[400]},"& .MuiInputLabel-root":{lineHeight:"15px",color:p.grey[400]}},children:[e.jsx(me,{id:"select-date-label",children:"Trip's Date"}),e.jsxs(vt,{labelId:"select-date-label",value:a,label:"Select Date",onChange:S,sx:{height:"40px",fontSize:"14px",padding:"0 12px",backgroundColor:p.grey[500],color:p.grey[400],"& .MuiSelect-icon":{color:p.grey[400]}},children:[h.map((c,n)=>e.jsx(jt,{value:c,sx:{backgroundColor:p.grey[500],color:p.grey[400],"&:hover":{backgroundColor:p.grey[600],color:p.grey[300]},"&.Mui-selected":{backgroundColor:p.grey[600],color:p.grey[300],"&:hover":{backgroundColor:p.grey[600]}}},children:c},n)),e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(B,{disabled:y<=1,onClick:l,children:e.jsx(ut,{})}),e.jsx(B,{disabled:!(i!=null&&i.imei),onClick:C,children:e.jsx(ht,{})})]})]})]})})}const br=()=>{const{mode:t}=A(a=>a.dashboard),r=L(t);return e.jsxs(b,{children:[e.jsxs(b,{sx:{display:"flex",ml:"5px",justifyContent:"center"},children:[e.jsx(b,{sx:{m:"5px",fontSize:"20px",width:"20%",color:r.grey[400]},children:e.jsx("b",{children:"Trip History"})}),e.jsx(yr,{}),e.jsx(b,{children:e.jsx(gt,{})})]}),e.jsx(b,{sx:{my:"5px"},children:e.jsx(fr,{})})]})},Ur=()=>{const{w_customer_id:t}=A(l=>l.auth),{mode:r,selectedTripData:a}=A(l=>l.dashboard),[s,g]=m.useState(()=>{const l=sessionStorage.getItem("imeiNo");return l?JSON.parse(l):[]}),i=V(),y=L(r),[d,p]=m.useState([]),[h,j]=m.useState(!1),[x,S]=m.useState(!1);m.useEffect(()=>{C()},[]),m.useEffect(()=>{sessionStorage.setItem("imeiNo",JSON.stringify(s))},[s]),m.useEffect(()=>{H.on("geofenceAlert",l=>{(l==null?void 0:l.imei)!==null&&s.find(T=>parseInt(T)===(l==null?void 0:l.imei))&&(console.log("geofence"),R.error(`Type: ${l==null?void 0:l.type} ${l==null?void 0:l.msg} ${l==null?void 0:l.imei}`,{id:"geofence",autoClose:5e3}))}),H.on("speedAlert",l=>{(l==null?void 0:l.imei)!==null&&s.find(T=>parseInt(T)===(l==null?void 0:l.imei))&&R.error(`${l==null?void 0:l.msg} ${l==null?void 0:l.imei}`,{id:"speed",autoClose:5e3})})},[H]);const C=async()=>{try{let l=[],c=[];const n=await i(Ne({w_customer_id:t}));if(console.log("data",n),Array.isArray(n.payload)){n.payload.forEach(u=>{var o,f;Array.isArray(u.imei)&&u.imei.length>0?(l.push({id:u.id,label:u.registration_id,value:(o=u==null?void 0:u.imei[0])==null?void 0:o.mac_id,vehilce_type:u==null?void 0:u.segment}),c.push((f=u.imei[0])==null?void 0:f.mac_id),u.registration_id):(console.error("IMEI data not found for item:",u),R.error(`IMEI Number not found for the vehicle: ${u==null?void 0:u.registration_id}`))}),g(c);const T="one",w=c;c.length>0&&(i(_e({type:T,imei:w})),i($e(w))),p(l),i(Oe(l)),i(Ve({w_customer_id:t})),i(ze({}))}else console.error("Unexpected data format:",n),R.error("Unexpected data format:")}catch(l){console.error("Error fetching vehicle data:",l),R.error(`Error fetching vehicle data: ${l}`)}};return e.jsxs("div",{className:"app",children:[e.jsx(Be,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(St,{title:"Dashboard",showVehicles:h,setShowVehicles:j,setShowNotification:S,showNotification:x}),e.jsxs("div",{style:{height:"92vh",backgroundColor:y.grey[100],padding:"10px"},children:[h&&e.jsx(b,{sx:{position:"fixed",width:"250px",right:"0px",height:"90vh",zIndex:9999,backgroundColor:y.grey[100],overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"},children:e.jsx(pr,{vehicleData:d})}),x&&e.jsx(b,{sx:{position:"fixed",width:"300px",right:"0px",height:"90vh",zIndex:9999,backgroundColor:y.grey[100]},children:e.jsx(Ct,{})}),e.jsx(b,{sx:{height:"21%"},children:e.jsx(cr,{imeiNo:s})}),e.jsxs(b,{sx:{display:"flex",height:"50%"},children:[e.jsx(b,{sx:{width:"50%",border:"1px solid #E8E8E8",padding:"2px",borderRadius:"5px"},children:e.jsx(br,{})}),e.jsx(b,{sx:{width:"50%"},children:e.jsx(dr,{})})]}),e.jsxs(b,{sx:{display:"flex",height:"30%",mt:"5px",pt:"10px"},children:[e.jsx(b,{style:{width:"33%"},children:e.jsx(J,{title:"speed",selectedTripData:a})}),e.jsx(b,{style:{width:"33%"},children:e.jsx(J,{title:"mainInputVoltage",selectedTripData:a})}),e.jsx(b,{style:{width:"33%"},children:e.jsx(J,{title:"ignition",selectedTripData:a})})]})]})]})]})};export{Ur as default};
