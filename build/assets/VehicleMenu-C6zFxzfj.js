import{l as S,r as l,k as Y,j as o,B as k,v as b,t as a,T as z,m as G,q as H,n as _,o as J,bp as T}from"./index-DSirb0Vv.js";import{S as K,R as Q,t as U}from"./LeftSideBar2-Bd-SQDFh.js";import{B as u,C as X}from"./menu2-BQG8o08i.js";const re=({vehicleData:c,title:x,setParameterData:V,loadingVehicle:R})=>{const{selectedVehicle:n,locationData:t,loading:p}=S(e=>e.liveMap),{mode:L,showVehicles:E}=S(e=>e.dashboard),d=U(L),[f,A]=l.useState(""),[h,B]=l.useState(""),i=l.useRef(null),y=l.useRef(0);let g=Y();l.useEffect(()=>{console.log("loading",p)},[p]),l.useEffect(()=>{console.log("vehicleData",c)},[c]),l.useEffect(()=>{i.current&&setTimeout(()=>{i.current.scrollTop=y.current},0)});const m=c.length>0&&c.filter(e=>{var r;return e.label.toLowerCase().includes(f.toLowerCase())&&(h===""||((r=e==null?void 0:e.workShop)==null?void 0:r.region)===h)}),M=async e=>{var v,w;if(i.current&&(y.current=i.current.scrollTop),G(!E),(t==null?void 0:t.length)<=0)return b.error("Data not available for this vehicle",{id:"clipboard"});const r=t==null?void 0:t.filter(s=>s.latestDocument.imei===e.value);if((r==null?void 0:r.length)<=0)return b.error("Data not available for this vehicle",{id:"clipboard"});const{lat:F,lng:I}=((v=r==null?void 0:r[0])==null?void 0:v.latestDocument)??{},N={lat:F||T.lat,lng:I||T.lat};g(H(N)),g(_({imei:e.value,reg_id:e.label}));const W=e.label,$=await g(J({w_registration_id:W})),j=[];let q=0;(w=$.payload)==null||w.map(s=>{s[s.parameter_type.toLowerCase()+"_parameter"].forEach(C=>{j.push({reg_id:e.label,imei:e.value,id:C.id,_id:s.id,key:q++,label:s.parameter_type==="Telematic"&&C.short_name})})}),x==="Live Map"&&V(j)},O=()=>{g(_({}))},P=e=>{B(e)},D={backgroundColor:d.grey[100],position:"relative",width:"100%",float:"right",height:"90vh",overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"};return o.jsx(o.Fragment,{children:o.jsx("div",{ref:i,style:D,children:p||R?o.jsx(u,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:o.jsx(X,{})}):o.jsxs(o.Fragment,{children:[o.jsx(K,{searchTerm:f,setSearchedTerm:A}),o.jsx(Q,{region:h,handleRegion:P}),x==="Live Map"&&o.jsx(u,{sx:{align:"center",my:"8px",ml:"20px"},children:o.jsx(k,{variant:"outlined",onClick:()=>{if(Object.keys(n).length>0)O();else return b.success("Already Selected To View All Vehicle Location.",{id:"already selected"})},sx:{width:"90%",bgcolor:Object.keys(n).length===0?a.bgColor:"undefined",color:Object.keys(n).length===0?"white":d.grey[400],border:`1px solid ${a.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:a.bgShadow}},children:"All Vehicles"})}),m.length>0?m.map((e,r)=>o.jsx(u,{sx:{align:"center",my:"8px",ml:"20px"},children:o.jsx(k,{variant:"outlined",onClick:()=>{M(e)},sx:{width:"90%",bgcolor:e.label===n.reg_id?a.bgColor:"undefined",color:e.label===n.reg_id?"white":d.grey[400],border:`1px solid ${a.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:a.bgShadow}},children:e.label})},r)):o.jsx(u,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:o.jsxs(z,{sx:{textAlign:"center",color:d.grey[400]},children:["Sorry! No vehicles in"," ",o.jsx("span",{style:{fontWeight:"bold"},children:h})," region"]})})]})})})};export{re as V};
