import{i as _,j as e,a as R,u as I,t as h,T as j,w as Q,x as Y,r as o,B as k,n as Z,o as ee,y as te}from"./index-Dia834ar.js";import{L as ae}from"./Close-BcaH1Zvm.js";import{L as re}from"./LiveMapTopBar-Be0CqcHg.js";import{V as se}from"./VehicleMenu-CChgbeQR.js";import{u as oe,G as ie,M as N}from"./esm-DRdjdbsr.js";import le from"./Loader-DNMRSAGQ.js";import{r as y}from"./createSvgIcon-Bm3SvhAb.js";import{B as r}from"./CircularProgress-C8UVr6Y-.js";import{P as ne}from"./Parameters-DnybJ9_J.js";import"./index-C3iUCzOB.js";import"./OutlinedInput-CtPi7pSe.js";import"./createSvgIcon-PFdOhOJt.js";import"./IconButton-4Yh3gL6u.js";import"./index-CyHjlgv3.js";import"./Card-CuUyhrK_.js";import"./Paper-Cx8BtNu4.js";var E={},ce=_;Object.defineProperty(E,"__esModule",{value:!0});var T=E.default=void 0,pe=ce(y()),he=e;T=E.default=(0,pe.default)((0,he.jsx)("path",{d:"M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4"}),"Restaurant");var A={},de=_;Object.defineProperty(A,"__esModule",{value:!0});var W=A.default=void 0,xe=de(y()),ue=e;W=A.default=(0,xe.default)((0,ue.jsx)("path",{d:"M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3m12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4"}),"Hotel");var q={},ve=_;Object.defineProperty(q,"__esModule",{value:!0});var X=q.default=void 0,me=ve(y()),fe=e;X=q.default=(0,me.default)((0,fe.jsx)("path",{d:"m19.77 7.23.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77M12 10H6V5h6zm6 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"LocalGasStation");var B={},ge=_;Object.defineProperty(B,"__esModule",{value:!0});var U=B.default=void 0,je=ge(y()),_e=e;U=B.default=(0,je.default)((0,_e.jsx)("path",{d:"M16.22 12c.68 0 1.22-.54 1.22-1.22 0-.67-.54-1.22-1.22-1.22S15 10.11 15 10.78c0 .68.55 1.22 1.22 1.22m-9.66-1.22c0 .67.54 1.22 1.22 1.22S9 11.46 9 10.78c0-.67-.54-1.22-1.22-1.22s-1.22.55-1.22 1.22M7.61 4 6.28 8h11.43l-1.33-4zm8.67-1s.54.01.92.54c.02.02.03.04.05.07.07.11.14.24.19.4.22.65 1.56 4.68 1.56 4.68v6.5c0 .45-.35.81-.78.81h-.44c-.43 0-.78-.36-.78-.81V14H7v1.19c0 .45-.35.81-.78.81h-.44c-.43 0-.78-.36-.78-.81v-6.5S6.34 4.67 6.55 4c.05-.16.12-.28.19-.4.03-.02.04-.04.06-.06.38-.53.92-.54.92-.54zM4 17.01h16V19h-7v3h-2v-3H4z"}),"CarRepair");var F={},ye=_;Object.defineProperty(F,"__esModule",{value:!0});var J=F.default=void 0,Se=ye(y()),be=e;J=F.default=(0,Se.default)((0,be.jsx)("path",{d:"M21 5h-2.64l1.14-3.14L17.15 1l-1.46 4H3v2l2 6-2 6v2h18v-2l-2-6 2-6zm-3.9 8.63L18.89 19H5.11l1.79-5.37.21-.63-.21-.63L5.11 7h13.78l-1.79 5.37-.21.63zM13 9h-2v3H8v2h3v3h2v-3h3v-2h-3z"}),"LocalPharmacyOutlined");var G={},we=_;Object.defineProperty(G,"__esModule",{value:!0});var K=G.default=void 0,Me=we(y()),Ce=e;K=G.default=(0,Me.default)((0,Ce.jsx)("path",{d:"M8 9v1.5h2.25V15h1.5v-4.5H14V9zM6 9H3c-.55 0-1 .45-1 1v5h1.5v-1.5h2V15H7v-5c0-.55-.45-1-1-1m-.5 3h-2v-1.5h2zM21 9h-4.5c-.55 0-1 .45-1 1v5H17v-4.5h1V14h1.5v-3.51h1V15H22v-5c0-.55-.45-1-1-1"}),"AtmOutlined");const Le=({setPlace:d,place:t})=>{const{center:n}=R(i=>i.liveMap),p=I(),c=async i=>{t===i?(p(Q([])),d("")):(d(i),p(Y({center:n,clickedPlace:i})))};return e.jsxs(r,{sx:{position:"relative",top:"1vh",left:"5%",display:"flex",justifyContent:"center"},children:[e.jsx(r,{sx:{bgcolor:t==="restaurants"?h.bgColor:"white",color:t==="restaurants"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{c("restaurants")},children:e.jsxs(j,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(T,{style:{height:"17px",position:"relative",top:"1px"}}),"Restaurants"]})}),e.jsx(r,{sx:{bgcolor:t==="hotels"?h.bgColor:"white",color:t==="hotels"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{c("hotels")},children:e.jsxs(j,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(W,{style:{height:"17px",position:"relative",top:"1px"}}),"Hotels"]})}),e.jsx(r,{sx:{bgcolor:t==="hospitals"?h.bgColor:"white",color:t==="hospitals"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{c("hospitals")},children:e.jsxs(j,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(J,{style:{height:"17px",position:"relative",top:"1px"}}),"Hospitals"]})}),e.jsx(r,{sx:{bgcolor:t==="atm"?h.bgColor:"white",color:t==="atm"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{c("atm")},children:e.jsxs(j,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(K,{style:{height:"17px",position:"relative",top:"1px"}}),"ATMs"]})}),e.jsx(r,{sx:{bgcolor:t==="car_repair"?h.bgColor:"white",color:t==="car_repair"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{c("car_repair")},children:e.jsxs(j,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(U,{style:{height:"17px",position:"relative",top:"1px"}}),"Service center"]})}),e.jsx(r,{sx:{bgcolor:t==="gasstation"?h.bgColor:"white",color:t==="gasstation"?"white":"undefined",borderRadius:"20px",mx:"5px",cursor:"pointer"},onClick:()=>{c("gasstation")},children:e.jsxs(j,{variant:"h6",sx:{fontSize:"14px",py:"10px",px:"12px"},children:[e.jsx(X,{style:{height:"17px",position:"relative",top:"1px"}}),"Gas Stations"]})})]})},Re=Le;function Ve({showCard:d}){const{center:t,selectedParameterList:n,selectedVehicle:p,vehicleList:c,tractorIcon:i,icons:S,locationData:x,placesData:b}=R(a=>a.liveMap),[w,V]=o.useState(null),[f,M]=o.useState("");I();const{isLoaded:g,loadError:D}=oe({googleMapsApiKey:"AIzaSyA_S7GfAh6rJYWQ5X4n4X-3poo3vymuspU",loadingElement:e.jsx(le,{})});if(o.useEffect(()=>{g&&V(window.google.maps)},[g]),D)return"Error loading maps";if(!g)return"Loading maps";if(!w)return null;const C={height:d?"87vh":"95vh",width:"100%"};return e.jsxs(e.Fragment,{children:[d&&e.jsx(r,{sx:{bgcolor:h.bgColor,position:"relative",color:"white",display:"flex",alignItems:"center",justifyContent:"space-around",overflowX:"hidden",flexWrap:"wrap",border:"1px solid white"},children:n[0].params.length>0?e.jsxs(e.Fragment,{children:[n[0].params.length>0&&e.jsxs(k,{variant:"outlined",sx:{color:"white",border:"1px solid white",fontSize:"12px"},children:["Registration Id : ",n[0].reg_id]}),n.length>0&&n[0].params.map((a,u)=>e.jsxs(k,{variant:"outlined",sx:{color:"white",border:"1px solid white",mx:"5px",my:"15px",fontSize:"12px"},children:[a.label," : ",a.value]},u))]}):e.jsx(e.Fragment,{children:e.jsx(k,{variant:"outlined",sx:{color:"white",border:"1px solid white",mx:"5px",my:"15px"},children:"No Parameters Selected"})})}),e.jsxs(ie,{mapContainerStyle:C,zoom:10,center:t,children:[Object.keys(p).length>0&&e.jsx(Re,{setPlace:M,place:f}),b&&b.length>0&&b.map((a,u)=>{var s,l;return e.jsx(N,{position:{lat:parseFloat((s=a==null?void 0:a.location)==null?void 0:s.lat),lng:parseFloat((l=a==null?void 0:a.location)==null?void 0:l.lng)},animation:"BOUNCE",icon:{path:S[`${f}`],fillOpacity:2,strokeWeight:1,scale:1,fillColor:"orange"}},u)}),x&&x.length>0&&x.map((a,u)=>e.jsx(N,{position:{lat:a.latestDocument.lat,lng:a.latestDocument.lng},icon:{path:i.path1+i.path2,fillColor:Object.keys(p).length>0&&p.imei===a.latestDocument.imei?"green":h.bgColor,fillOpacity:2,strokeWeight:1,scale:2}},u))]})]})}function Xe(){const{locationData:d,selectedVehicle:t}=R(s=>s.liveMap),[n,p]=o.useState([]),{w_customer_id:c}=R(s=>s.auth),[i,S]=o.useState(),[x,b]=o.useState(!1),[w,V]=o.useState(!1),[f,M]=o.useState([]),[g,D]=o.useState(!1);let C=I();o.useEffect(()=>{a()},[]),o.useEffect(()=>{M([])},[t]);const a=async()=>{let s=[],l=[];(await C(Z({w_customer_id:c}))).payload.map(v=>{s.push({id:v.id,label:v.registration_id,value:v.imei[0].mac_id}),l.push(v.imei[0].mac_id)});const P="one",$=l;l.length>0&&C(ee({type:P,imei:$})),p(s)},u=async s=>{const{label:l,imei:H,_id:P,reg_id:$,checked:v}=s;S(m=>m.map(L=>L._id===P?{...L,checked:!v}:L));let z=[...f],O=[...f];if(!v)d.forEach(m=>{m.latestDocument.imei===H&&(z.push({label:l,value:m.latestDocument[l]}),O=z,M(z))});else{let m=f.filter(L=>L.label!==l);O=m,M(m)}C(te([{reg_id:$,imei:H,params:O}]))};return e.jsxs("div",{className:"app",children:[e.jsx(ae,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(re,{title:"Live Map",setShowVehicles:b,showVehicles:x,showParameters:w,setShowParameters:V,setShowCard:D,showCard:g}),e.jsxs(r,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(r,{style:{width:x||w?"80%":"100%"},children:e.jsx(Ve,{showCard:g})}),x&&e.jsx(r,{style:{width:"20%"},children:e.jsx(se,{vehicleData:n,title:"Live Map",setParameterData:S})}),w&&e.jsx(r,{style:{width:"20%"},children:e.jsx(ne,{parametersData:i,setParameterData:S,handleParameterChange:u})})]})]})]})}export{Xe as default};
