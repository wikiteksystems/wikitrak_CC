import{r as o,q as Gt,i as le,j as e,a as R,u as re,t as T,T as w,N as U,an as xe,Z as co,h as go,ao as fe,_ as H,ap as Y,aq as po,k as uo,l as xo}from"./index-yugurC9t.js";import{A as Bt,B as he,an as fo,e as me,a3 as Pt,r as ho,c as Vt,a0 as mo,J as yo,M as Ft,d as vo,a as jo,aa as bo,L as Co}from"./Close-DrXt86Pf.js";import{r as ce}from"./createSvgIcon-DLvEd_Av.js";import{j as So,a as wo,b as Ao}from"./DarkModeOutlined-CbmsTPc4.js";import{B as l,C as Oo}from"./CircularProgress-WSXXCLok.js";import{I as Eo}from"./IconButton-CU2xPpj8.js";import{V as ko}from"./VehicleMenu-B_E7-Uca.js";import{t as de}from"./theme-cmKXW1hM.js";import{C as Ro}from"./Form-C1dKg34Q.js";import{u as Io,G as Do,C as Lo,R as _o,b as zt,M as No}from"./esm-CMR_PjuD.js";import{S as ie}from"./Switch-B65KS5zr.js";import{I as Po}from"./TextField-idp2yXhI.js";import{u as Fo,I as ye,T as zo}from"./TextArea-dODYW5f5.js";import{B as Mo,S as To}from"./button-Rukvm4cj.js";import"./createSvgIcon-F-AoYie0.js";import"./Paper-D1mpFTxs.js";var Go={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"};const Bo=Go;var Vo=function(g,a){return o.createElement(Bt,Gt({},g,{ref:a,icon:Bo}))},Xo=o.forwardRef(Vo);const Wo=Xo;var $o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"};const Jo=$o;var Uo=function(g,a){return o.createElement(Bt,Gt({},g,{ref:a,icon:Jo}))},Ho=o.forwardRef(Uo);const Ko=Ho,qo=n=>{const{getPrefixCls:g,direction:a}=o.useContext(he),{prefixCls:c,className:s}=n,h=g("input-group",c),y=g("input"),[m,I]=fo(y),L=me(h,{[`${h}-lg`]:n.size==="large",[`${h}-sm`]:n.size==="small",[`${h}-compact`]:n.compact,[`${h}-rtl`]:a==="rtl"},I,s),b=o.useContext(Pt),C=o.useMemo(()=>Object.assign(Object.assign({},b),{isFormItemInput:!1}),[b]);return m(o.createElement("span",{className:L,style:n.style,onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onFocus,onBlur:n.onBlur},o.createElement(Pt.Provider,{value:C},n.children)))},Yo=qo;var Qo=function(n,g){var a={};for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&g.indexOf(c)<0&&(a[c]=n[c]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,c=Object.getOwnPropertySymbols(n);s<c.length;s++)g.indexOf(c[s])<0&&Object.prototype.propertyIsEnumerable.call(n,c[s])&&(a[c[s]]=n[c[s]]);return a};const Zo=n=>n?o.createElement(Ko,null):o.createElement(Wo,null),en={click:"onClick",hover:"onMouseOver"},tn=o.forwardRef((n,g)=>{const{visibilityToggle:a=!0}=n,c=typeof a=="object"&&a.visible!==void 0,[s,h]=o.useState(()=>c?a.visible:!1),y=o.useRef(null);o.useEffect(()=>{c&&h(a.visible)},[c,a]);const m=Fo(y),I=()=>{const{disabled:G}=n;G||(s&&m(),h(j=>{var F;const E=!j;return typeof a=="object"&&((F=a.onVisibleChange)===null||F===void 0||F.call(a,E)),E}))},L=G=>{const{action:j="click",iconRender:F=Zo}=n,E=en[j]||"",B=F(s),u={[E]:I,className:`${G}-icon`,key:"passwordIcon",onMouseDown:X=>{X.preventDefault()},onMouseUp:X=>{X.preventDefault()}};return o.cloneElement(o.isValidElement(B)?B:o.createElement("span",null,B),u)},{className:b,prefixCls:C,inputPrefixCls:N,size:v}=n,_=Qo(n,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:M}=o.useContext(he),r=M("input",N),d=M("input-password",C),A=a&&L(d),P=me(d,b,{[`${d}-${v}`]:!!v}),f=Object.assign(Object.assign({},ho(_,["suffix","iconRender","visibilityToggle"])),{type:s?"text":"password",className:P,prefixCls:r,suffix:A});return v&&(f.size=v),o.createElement(ye,Object.assign({ref:Vt(g,y)},f))}),on=tn;var nn=function(n,g){var a={};for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&g.indexOf(c)<0&&(a[c]=n[c]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,c=Object.getOwnPropertySymbols(n);s<c.length;s++)g.indexOf(c[s])<0&&Object.prototype.propertyIsEnumerable.call(n,c[s])&&(a[c[s]]=n[c[s]]);return a};const an=o.forwardRef((n,g)=>{const{prefixCls:a,inputPrefixCls:c,className:s,size:h,suffix:y,enterButton:m=!1,addonAfter:I,loading:L,disabled:b,onSearch:C,onChange:N,onCompositionStart:v,onCompositionEnd:_}=n,M=nn(n,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:r,direction:d}=o.useContext(he),A=o.useRef(!1),P=r("input-search",a),f=r("input",c),{compactSize:G}=mo(P,d),j=yo(p=>{var O;return(O=h??G)!==null&&O!==void 0?O:p}),F=o.useRef(null),E=p=>{p&&p.target&&p.type==="click"&&C&&C(p.target.value,p,{source:"clear"}),N&&N(p)},B=p=>{var O;document.activeElement===((O=F.current)===null||O===void 0?void 0:O.input)&&p.preventDefault()},u=p=>{var O,V;C&&C((V=(O=F.current)===null||O===void 0?void 0:O.input)===null||V===void 0?void 0:V.value,p,{source:"input"})},X=p=>{A.current||L||u(p)},K=typeof m=="boolean"?o.createElement(To,null):null,q=`${P}-button`;let x;const z=m||{},D=z.type&&z.type.__ANT_BUTTON===!0;D||z.type==="button"?x=Ft(z,Object.assign({onMouseDown:B,onClick:p=>{var O,V;(V=(O=z==null?void 0:z.props)===null||O===void 0?void 0:O.onClick)===null||V===void 0||V.call(O,p),u(p)},key:"enterButton"},D?{className:q,size:j}:{})):x=o.createElement(Mo,{className:q,type:m?"primary":void 0,size:j,disabled:b,key:"enterButton",onMouseDown:B,onClick:u,loading:L,icon:K},m),I&&(x=[x,Ft(I,{key:"addonAfter"})]);const ge=me(P,{[`${P}-rtl`]:d==="rtl",[`${P}-${j}`]:!!j,[`${P}-with-button`]:!!m},s),ee=p=>{A.current=!0,v==null||v(p)},te=p=>{A.current=!1,_==null||_(p)};return o.createElement(ye,Object.assign({ref:Vt(F,g),onPressEnter:X},M,{size:j,onCompositionStart:ee,onCompositionEnd:te,prefixCls:f,addonAfter:x,suffix:y,onChange:E,className:ge,disabled:b}))}),sn=an,Z=ye;Z.Group=Yo;Z.Search=sn;Z.TextArea=zo;Z.Password=on;const Mt=Z;var ve={},ln=le;Object.defineProperty(ve,"__esModule",{value:!0});var Xt=ve.default=void 0,rn=ln(ce()),cn=e;Xt=ve.default=(0,rn.default)((0,cn.jsx)("path",{d:"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonOutlined");var je={},dn=le;Object.defineProperty(je,"__esModule",{value:!0});var Wt=je.default=void 0,gn=dn(ce()),pn=e;Wt=je.default=(0,gn.default)((0,pn.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2m6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5z"}),"NotificationsNone");var be={},un=le;Object.defineProperty(be,"__esModule",{value:!0});var $t=be.default=void 0,xn=un(ce()),fn=e;$t=be.default=(0,xn.default)((0,fn.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Place");const hn=({title:n,setShowContent:g,showContent:a,showMap:c,setShowMap:s,setShowGfBar:h,showGfBar:y,setShowGfAlert:m,showGfAlert:I})=>{const{collapsed:L}=R(r=>r.auth),{selectedVehicle:b}=R(r=>r.liveMap),{vehicleSideBar:C}=R(r=>r.geofence);o.useState(!1);const{mode:N}=R(r=>r.dashboard);JSON.parse(localStorage.getItem("w_userDetails"));const v=re(),_=()=>{v(go(!L))},M=()=>{g({...a,vehicle:!a.vehicle}),h(!1),m(!1),v(xe({data:!C}))};return e.jsxs(l,{display:"flex",justifyContent:"space-between",p:1,sx:{bgcolor:T.bgColor,border:"1px solid white",borderRadius:"4px",height:"55px"},children:[e.jsxs(l,{display:"flex",children:[e.jsx(l,{sx:{color:"white",my:"20px"},children:L?e.jsx(vo,{style:{cursor:"pointer",width:"30px",height:"30px"},onClick:_}):e.jsx(jo,{style:{cursor:"pointer",width:"30px",height:"30px"},onClick:_})}),e.jsx(l,{sx:{my:"20px",mx:"10px"},children:e.jsx(w,{style:{fontSize:"20px",fontFamily:"ubuntu",fontWeight:"500",color:"#FFFFFF"},children:"WIKITRACK"})})]}),e.jsx(l,{children:e.jsx(w,{variant:"h6",color:"white",fontWeight:"bold",sx:{ml:"15px",mt:"15px"},children:Object.keys(b).length>0&&c?`${n} - Geofence (${b.reg_id})`:e.jsxs(e.Fragment,{children:[n," ",Object.keys(b).length>0&&b.reg_id]})})}),e.jsxs(l,{sx:{display:"flex"},children:[e.jsxs(U,{variant:"outlined",size:"small",sx:{color:a.vehicle?"white":"black",backgroundColor:a.vehicle?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:M,children:[e.jsx("img",{src:So,style:{marginRight:"5px"}}),Object.keys(b).length>0?b.reg_id:"Vehicles"]}),c&&e.jsx(l,{children:e.jsx(U,{variant:"outlined",size:"small",sx:{color:y?"white":"black",backgroundColor:y?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{m(!1),h(!y),v(xe({data:!1}))},children:"Geofence"})}),e.jsx(l,{sx:{color:"white",mr:"10px"},children:e.jsxs(l,{sx:{display:"flex",marginTop:"14px",gap:"10px"},children:[e.jsx(l,{onClick:()=>{h(!1),m(!I),v(xe({data:!1}))},children:e.jsx(Wt,{sx:{cursor:"pointer",width:"30px",height:"30px"}})}),e.jsx(l,{onClick:()=>{g({...a,user:!a.user}),s(!1)},children:a.user?e.jsx($t,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}}):e.jsx(Xt,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}})})]})}),e.jsx(Eo,{onClick:()=>{v(co(!N))},sx:{color:"white"},children:N?e.jsx(wo,{}):e.jsx(Ao,{})})]})]})},mn=hn;var Ce={},yn=le;Object.defineProperty(Ce,"__esModule",{value:!0});var Jt=Ce.default=void 0,vn=yn(ce()),jn=e;Jt=Ce.default=(0,vn.default)((0,jn.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff");const Tt="http://139.59.37.47:3031",bn=()=>{const{selectedVehicle:n}=R(r=>r.liveMap);R(r=>r.geofence);const{mode:g}=R(r=>r.dashboard),a=de(g),[c,s]=o.useState([]),[h,y]=o.useState(null),[m,I]=o.useState(!1),[L,b]=o.useState(10),C=o.useRef(null);let N=re();o.useEffect(()=>{v()},[N,n]),o.useEffect(()=>{C.current&&(C.current.scrollTop=0)},[c]);const v=async()=>{var r,d,A;if(Object.keys(n).length>0){let P={imei:n==null?void 0:n.imei};try{I(!0);const f=await fe.post(`${Tt}/ccServer/location/getNotifications`,P);((d=(r=f==null?void 0:f.data)==null?void 0:r.notifications)==null?void 0:d.length)>0?s((A=f==null?void 0:f.data)==null?void 0:A.notifications):H.error("No Geofence Alert For Selected Vehicle."),I(!1)}catch(f){console.log("error while getting gfAlertHistory",f),H.error(`Geofence ${f==null?void 0:f.message}`),I(!1)}}},_=async r=>{try{const d=await fe.post(`${Tt}/ccServer/location/updateNotifications`,{_id:r==null?void 0:r._id});v()}catch(d){console.log("error while getting gfAlertHistory",d),H.error(`Geofence ${d==null?void 0:d.message}`),I(!1)}},M=()=>{b(r=>r+10)};return e.jsxs(l,{sx:{padding:"15px",display:"flex",flexDirection:"column",gap:"15px",color:a.grey[400],backgroundColor:a.grey[100],height:"86vh",overflowY:"auto",scrollBehavior:"smooth"},ref:C,children:[m&&e.jsx(l,{style:{width:"100%",margin:"auto",display:"flex",justifyContent:"center"},children:e.jsx(Oo,{style:{color:T.bgColor}})}),!m&&c.length===0&&e.jsx(w,{style:{width:"100%",margin:"auto",color:a.grey[400]},children:"Please Select A Vehicle."}),!m&&c.length>0&&c.slice(0,L).map((r,d)=>{var A;return e.jsxs(l,{sx:{position:"relative"},onMouseEnter:()=>y(d),onMouseLeave:()=>y(null),children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",color:a.grey[400]},children:[e.jsx(w,{children:e.jsx("b",{children:r==null?void 0:r.type})}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:(A=r==null?void 0:r.createdAt)==null?void 0:A.slice(0,10)}),e.jsx("span",{style:{paddingLeft:"15px"},children:new Date(r==null?void 0:r.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]}),e.jsxs(l,{sx:{display:"flex",border:"1px solid #686868",padding:"5px",borderRadius:"5px",color:"#686868","&:hover":{background:T.bgShadow,color:"black"}},children:[e.jsx("img",{style:{width:"30px",height:"30px",borderRadius:"5px",marginRight:"15px",alignItems:"center",marginTop:"15px"},src:bo,alt:"logo"}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column"},children:[e.jsxs(w,{sx:{fontSize:"15px",width:"100%"},children:["Your Vehicle No."," ",Object.keys(n).length>0?n.reg_id:"XXX"]}),e.jsx(w,{children:r==null?void 0:r.msg})]})]}),h===d&&e.jsx(Jt,{onClick:()=>{_(r)},sx:{position:"absolute",top:"35%",left:"84.4%",transform:"translate(-50%, -50%)",fontWeight:"600",color:"black",cursor:"pointer"}})]},d)}),e.jsx(l,{sx:{display:"flex",justifyContent:"center",marginTop:"15px"},children:e.jsx(U,{variant:"outlined",onClick:M,sx:{border:`1px solid ${T.bgShadow}`,color:a.grey[400],"&:hover":{background:T.bgColor,color:"white",border:`1px solid ${T.bgShadow}`}},children:"Load More"})})]})},Cn=()=>{const n=JSON.parse(localStorage.getItem("w_userDetails")),{mode:g}=R(c=>c.dashboard),a=de(g);return e.jsxs(l,{children:[e.jsxs(l,{sx:{backgroundColor:a.grey[200],m:"10px",borderRadius:"5px",height:"150px"},children:[e.jsx(l,{sx:{pl:"20px",pt:"10px",mb:"10px",color:`${a.grey[400]}`},children:e.jsx("b",{children:"User Settings"})}),e.jsxs(l,{sx:{display:"flex"},children:[e.jsx(l,{sx:{ml:"23px",mt:"11px",height:"70px",width:"70px",backgroundColor:"white",borderRadius:"50%"}}),e.jsxs(l,{sx:{height:"80px",width:"200px",display:"flex",justifyContent:"center",flexDirection:"column",mx:"20px",color:a.grey[400]},children:[e.jsx(l,{children:e.jsxs("b",{children:[" ",n&&n.first_name," ",n.last_name]})}),e.jsx(l,{children:n&&n.role})]})]})]}),e.jsx(l,{sx:{marginTop:"9%",alignContent:"center",textAlign:"center"},children:e.jsx(Ro,{})})]})},Sn=Cn,wn="/assets/tractorIcon-zWRQE9nW.jpg",An="data:image/png;base64,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",On="http://139.59.37.47:3031",En=({showGfBar:n,showGfAlert:g})=>{const{isLoaded:a,loadError:c}=Io({googleMapsApiKey:"AIzaSyA_S7GfAh6rJYWQ5X4n4X-3poo3vymuspU"}),{selectedVehicle:s,locationData:h,tractorIcon:y}=R(i=>i.liveMap),{geofence:m,vehicleSideBar:I}=R(i=>i.geofence),{mode:L,styles:b}=R(i=>i.dashboard),{collapsed:C}=R(i=>i.auth),[N,v]=o.useState(null),[_,M]=o.useState(null),[r,d]=o.useState(1e3),[A,P]=o.useState([]),[f,G]=o.useState(!0),[j,F]=o.useState(!1),[E,B]=o.useState(!1),[u,X]=o.useState({lat:18.516726,lng:73.856255}),[K,q]=o.useState(50),[x,z]=o.useState("circular"),[D,ge]=o.useState([]),[ee,te]=o.useState({north:u.lat+.01,south:u.lat-.01,east:u.lng+.01,west:u.lng-.01}),[p,O]=o.useState([{lat:u.lat+.01,lng:u.lng},{lat:u.lat-.01,lng:u.lng-.01},{lat:u.lat-.01,lng:u.lng+.01}]),[V,Se]=o.useState([{lat:u.lat+.01,lng:u.lng},{lat:u.lat-.01,lng:u.lng-.01},{lat:u.lat-.01,lng:u.lng+.01}]),Ut=o.useRef(null),oe=o.useRef(null),pe=o.useRef(!1),ne=o.useRef(null),ae=o.useRef(null);let Ht=re();o.useEffect(()=>{console.log(D,"rectangleVertices")},[D]),o.useEffect(()=>{Kt()},[s]),o.useEffect(()=>{if(h.length>0&&Object.keys(s).length>0){let i=h.filter(S=>{var k;return((k=S.latestDocument)==null?void 0:k.imei)===s.imei});P(i)}},[s]),o.useEffect(()=>{N&&_&&N.fitBounds(_)},[N,_]);const Kt=async()=>{var i,S,k,W,$,Q,J,Ae,Oe,Ee,ke,Re,Ie,De,Le,_e,Ne,Pe,Fe,ze,Me,Te,Ge,Be,Ve,Xe,We,$e,Je,Ue,He,Ke,qe,Ye,Qe,Ze,et,tt,ot,nt,at,st,it,lt,rt,ct,dt,gt,pt,ut,xt,ft,ht,mt,yt,vt,jt,bt,Ct,St,wt,At,Ot,Et,kt,Rt,It,Dt,Lt,_t,Nt;if(Object.keys(s).length>0)try{const t=await fe.get(`${On}/api/get/geofance/${s==null?void 0:s.imei}`);if(console.log(t.data.geofenceData,"result"),((S=(i=t==null?void 0:t.data)==null?void 0:i.geofenceData)==null?void 0:S.area_type)==="circular")if(z("circular"),(W=(k=t==null?void 0:t.data)==null?void 0:k.geofenceData)!=null&&W.lat)X({lat:(Q=($=t==null?void 0:t.data)==null?void 0:$.geofenceData)==null?void 0:Q.lat,lng:(Ae=(J=t==null?void 0:t.data)==null?void 0:J.geofenceData)==null?void 0:Ae.long}),d((Ee=(Oe=t==null?void 0:t.data)==null?void 0:Oe.geofenceData)==null?void 0:Ee.radius),G((Re=(ke=t==null?void 0:t.data)==null?void 0:ke.geofenceData)==null?void 0:Re.isActive_Geofance),F(((De=(Ie=t==null?void 0:t.data)==null?void 0:Ie.geofenceData)==null?void 0:De.type)==="inward"),B((_e=(Le=t==null?void 0:t.data)==null?void 0:Le.geofenceData)==null?void 0:_e.isActive_Speed),q((Pe=(Ne=t==null?void 0:t.data)==null?void 0:Ne.geofenceData)==null?void 0:Pe.speed);else return H.success("No Geofence For Selected Vehicle",{id:"getting geofence"});else((ze=(Fe=t==null?void 0:t.data)==null?void 0:Fe.geofenceData)==null?void 0:ze.area_type)==="triangle"?(z("triangle"),console.log("get for triangle",(Me=t==null?void 0:t.data)==null?void 0:Me.geofenceData),O([{lat:(Be=(Ge=(Te=t==null?void 0:t.data)==null?void 0:Te.geofenceData)==null?void 0:Ge.triangle_points[0])==null?void 0:Be.lat,lng:(We=(Xe=(Ve=t==null?void 0:t.data)==null?void 0:Ve.geofenceData)==null?void 0:Xe.triangle_points[0])==null?void 0:We.long},{lat:(Ue=(Je=($e=t==null?void 0:t.data)==null?void 0:$e.geofenceData)==null?void 0:Je.triangle_points[1])==null?void 0:Ue.lat,lng:(qe=(Ke=(He=t==null?void 0:t.data)==null?void 0:He.geofenceData)==null?void 0:Ke.triangle_points[1])==null?void 0:qe.long},{lat:(Ze=(Qe=(Ye=t==null?void 0:t.data)==null?void 0:Ye.geofenceData)==null?void 0:Qe.triangle_points[2])==null?void 0:Ze.lat,lng:(ot=(tt=(et=t==null?void 0:t.data)==null?void 0:et.geofenceData)==null?void 0:tt.triangle_points[2])==null?void 0:ot.long}])):((at=(nt=t==null?void 0:t.data)==null?void 0:nt.geofenceData)==null?void 0:at.area_type)==="rectangle"?(z("rectangle"),console.log("get for rectangle",(st=t==null?void 0:t.data)==null?void 0:st.geofenceData),te({north:(rt=(lt=(it=t==null?void 0:t.data)==null?void 0:it.geofenceData)==null?void 0:lt.rectangle_points[0])==null?void 0:rt.lat,south:(gt=(dt=(ct=t==null?void 0:t.data)==null?void 0:ct.geofenceData)==null?void 0:dt.rectangle_points[1])==null?void 0:gt.lat,east:(xt=(ut=(pt=t==null?void 0:t.data)==null?void 0:pt.geofenceData)==null?void 0:ut.rectangle_points[1])==null?void 0:xt.long,west:(mt=(ht=(ft=t==null?void 0:t.data)==null?void 0:ft.geofenceData)==null?void 0:ht.rectangle_points[0])==null?void 0:mt.long})):((vt=(yt=t==null?void 0:t.data)==null?void 0:yt.geofenceData)==null?void 0:vt.area_type)==="polygon"&&(z("polygon"),console.log("get for polygon",(jt=t==null?void 0:t.data)==null?void 0:jt.geofenceData),Se((Ct=(bt=t==null?void 0:t.data)==null?void 0:bt.geofenceData)==null?void 0:Ct.polygon_points),q((wt=(St=t==null?void 0:t.data)==null?void 0:St.geofenceData)==null?void 0:wt.speed),G((Ot=(At=t==null?void 0:t.data)==null?void 0:At.geofenceData)==null?void 0:Ot.isActive_Geofance),F(((kt=(Et=t==null?void 0:t.data)==null?void 0:Et.geofenceData)==null?void 0:kt.type)==="inward"),X({lat:(It=(Rt=t==null?void 0:t.data)==null?void 0:Rt.geofenceData)==null?void 0:It.lat,lng:(Lt=(Dt=t==null?void 0:t.data)==null?void 0:Dt.geofenceData)==null?void 0:Lt.long}),B((Nt=(_t=t==null?void 0:t.data)==null?void 0:_t.geofenceData)==null?void 0:Nt.isActive_Speed))}catch(t){console.log(t,"error while getting geofence"),H.error("Error while getting geofence",{id:"getting geofence"})}},qt=i=>{v(i)},Yt=()=>{var i,S,k,W,$,Q;if(Object.keys(s).length>0){let J;x==="circular"?J={imei:s.imei,area_type:x,type:j?"inward":"outward",lat:u.lat,long:u.lng,radius:r,isActive_Geofance:f,isActive_Speed:!!E,speed:E?K:5}:x==="rectangle"?J={imei:s.imei,area_type:x,type:j?"inward":"outward",rectangle_points:[{lat:D==null?void 0:D.north,long:D==null?void 0:D.west},{lat:D==null?void 0:D.south,long:D==null?void 0:D.east}],isActive_Geofance:f,isActive_Speed:!!E,speed:E?K:50}:x==="triangle"?J={imei:s.imei,area_type:x,type:j?"inward":"outward",triangle_points:[{lat:(i=p[0])==null?void 0:i.lat,long:(S=p[0])==null?void 0:S.lng},{lat:(k=p[1])==null?void 0:k.lat,long:(W=p[1])==null?void 0:W.lng},{lat:($=p[2])==null?void 0:$.lat,long:(Q=p[2])==null?void 0:Q.lng}],isActive_Geofance:f,isActive_Speed:!!E,speed:E?K:50}:x==="polygon"&&(J={imei:s.imei,area_type:x,type:j?"inward":"outward",polygon_points:V,isActive_Geofance:f,isActive_Speed:!!E,speed:E?K:50}),Ht(po({data:J})),H.success("Successful Saved",{id:"geofence"})}else H.error("Please Select Vehicle",{id:"geofence"})},se=i=>{console.log("selectedType",i),z(i)},Qt=()=>{if(!pe.current){pe.current=!0;const i=ue.getRadius();console.log("newRadius",i),d(i),pe.current=!1}},Zt=i=>{console.log("New Center:",i.toJSON()),X(i.toJSON())},eo=()=>{if(ne.current&&ne.current.getBounds){const i=ne.current.getBounds(),S=i.getNorthEast().lat(),k=i.getSouthWest().lat(),W=i.getNorthEast().lng(),$=i.getSouthWest().lng();console.log("{ north, south, east, west }",{north:S,south:k,east:W,west:$}),te({north:S,south:k,east:W,west:$}),ge({north:S,south:k,east:W,west:$})}},to={bounds:ee,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}},oo=i=>{ne.current=i},no=()=>{if(oe.current&&oe.current.getPath){const S=oe.current.getPath().getArray().map(k=>({lat:k.lat(),lng:k.lng()}));O(S),console.log("newVertices",S)}},ao={paths:p,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}},so=i=>{oe.current=i},io=()=>{if(ae.current&&ae.current.getPath){const S=ae.current.getPath().getArray().map(k=>({lat:k.lat(),lng:k.lng()}));Se(S),console.log("newVertices",S)}},lo=i=>{ae.current=i},we={paths:V,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}};if(c)return"Error loading maps";if(!a)return"Loading maps";const ro={width:"100%",height:"92vh"};let ue;return e.jsxs(e.Fragment,{children:[e.jsxs(l,{children:[e.jsx(U,{onClick:()=>{se("rectangle")},style:{background:x==="rectangle"?T.bgColor:"transparent",color:x==="rectangle"?"white":Y[400]},children:"Rectangle"}),e.jsx(U,{onClick:()=>{se("circular")},style:{background:x==="circular"?T.bgColor:"transparent",color:x==="circular"?"white":Y[400]},children:"Circle"}),e.jsx(U,{onClick:()=>{se("triangle")},style:{background:x==="triangle"?T.bgColor:"transparent",color:x==="triangle"?"white":Y[400]},children:"Triangle"}),e.jsx(U,{onClick:()=>{se("polygon")},style:{background:x==="polygon"?T.bgColor:"transparent",color:x==="polygon"?"white":Y[400]},children:"Polygon"})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:"row"},children:[e.jsxs(Do,{ref:Ut,mapContainerStyle:ro,zoom:15,center:u,onLoad:qt,options:{mapTypeControl:!1,styles:L?b:""},children:[x==="circular"&&e.jsx(Lo,{center:u,radius:r,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0},onLoad:i=>{ue=i,ue.addListener("radius_changed",Qt)},onDragEnd:i=>Zt(i.latLng)}),x==="rectangle"&&e.jsx(_o,{bounds:ee,options:to.options,onDragEnd:eo,onLoad:oo}),x==="triangle"&&e.jsx(zt,{paths:p,options:ao.options,onDragEnd:no,onLoad:so}),x==="polygon"&&e.jsx(zt,{paths:we.paths,options:we.options,draggable:!0,editable:!0,onDragEnd:io,onLoad:lo}),A&&A.length>0&&A.map((i,S)=>e.jsx(No,{position:{lat:i.latestDocument.lat,lng:i.latestDocument.lng},icon:{path:y.path1,fillColor:"red",fillOpacity:2,strokeWeight:1,scale:2}},S))]}),n&&!g&&!I&&u&&e.jsx(l,{sx:{width:C?"25%":"20%"},children:e.jsxs(l,{sx:{display:"flex",padding:"15px",flexDirection:"column",gap:"10px",color:Y[600]},children:[e.jsx(w,{sx:{fontWeight:"bold",fontSize:"16px"},children:"Geofence Setting"}),e.jsxs(w,{sx:{fontWeight:"400",fontSize:"14px",textTransform:"capitalize"},children:["Type: ",x]}),x==="circular"&&e.jsxs(e.Fragment,{children:[e.jsxs(w,{sx:{color:"#686868"},children:["Centered At"," "]}),e.jsxs(w,{sx:{color:"#686868"},children:["Lat: ",u.lat.toFixed(2)]}),e.jsxs(w,{sx:{color:"#686868"},children:["Lng: ",u.lng.toFixed(2)]}),e.jsxs(w,{sx:{color:"#686868",border:"1px solid #686868",borderRadius:"4px",padding:"8px"},children:["Radius ( ",(r/1e3).toFixed(2)," in km)"]})]}),e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(w,{variant:"body1",component:"b",children:f?"Active":"Inactive"}),e.jsx(ie,{defaultChecked:f,onChange:()=>{G(!f)},color:"primary",inputProps:{"aria-label":"toggle active state"}})]}),e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(w,{variant:"body1",component:"b",children:j?"Inward":"Outward"}),e.jsx(ie,{checked:j,onChange:()=>{F(!j)},color:"primary",inputProps:{"aria-label":"toggle direction"}})]}),e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(ie,{checked:E,onChange:()=>{B(!E)},color:"primary",inputProps:{"aria-label":"toggle direction"}}),e.jsx(w,{variant:"body1",component:"b",children:"Speed Limit"})]}),E&&e.jsx(l,{sx:{},children:e.jsx(Po,{sx:{width:"100%",color:Y[600],border:"none","&:focus":{outline:"none"}},value:K,placeholder:"Enter Speed Limit",type:"number",onChange:i=>{const S=Math.max(0,parseInt(i.target.value));q(S)}})}),e.jsx(U,{disabled:Object.keys(s).length===0&&!1,variant:"outlined",size:"small",sx:{color:"white",backgroundColor:T.bgColor,mt:"6px",mx:"5px",border:"1px solid white",height:"40px",width:"100%","&:hover":{color:"black",background:T.bgShadow,border:"1px solid black"},letterSpacing:"1.5px",fontSize:"16px"},onClick:()=>{if(Object.keys(s).length===0)return H.error("please select a vehicle.");Yt()},children:"SUBMIT"})]})})]})]})},kn=({showMap:n,setShowMap:g,showGfBar:a,showGfAlert:c})=>{const{selectedVehicle:s}=R(m=>m.liveMap),{mode:h}=R(m=>m.dashboard),y=de(h);return e.jsx(e.Fragment,{children:n?e.jsx(En,{showGfBar:a,showGfAlert:c}):e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",background:y.grey[200],margin:"10px",padding:"10px",borderRadius:"8px"},children:[e.jsxs(l,{sx:{},children:[e.jsx(w,{sx:{fontWeight:"bold",fontSize:"16px",margin:"4px",color:y.grey[400]},children:"Vehicle Settings"}),e.jsxs(l,{sx:{display:"flex"},children:[e.jsx(l,{children:e.jsx("img",{src:wn,alt:"tractorIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}})}),e.jsxs(l,{children:[e.jsx(w,{sx:{fontWeight:"bold",color:y.grey[400]},children:Object.keys(s).length>0?s==null?void 0:s.reg_id:"Reg No"}),e.jsx(w,{sx:{marginBottom:"5px",color:y.grey[400]},children:"Chassis No"}),e.jsxs(l,{sx:{width:"200px",display:"flex",gap:"8px"},children:[e.jsx(Mt,{placeholder:"ONLINE"}),e.jsx(Mt,{placeholder:"RUNNING"})]}),e.jsx(l,{sx:{marginLeft:"-8px",color:y.grey[400]},children:e.jsxs(w,{children:[e.jsx(ie,{})," ",e.jsx("b",{children:"Switched ON / OFF"})]})})]})]})]}),e.jsxs(l,{onClick:()=>{g(!n)},sx:{cursor:"pointer",marginTop:"50px"},children:[e.jsx("img",{src:An,alt:"tractorIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}}),e.jsx(w,{sx:{fontSize:"12px",color:y.grey[400]},children:"Set Geofence"})]})]})})};function $n(){const{w_customer_id:n}=R(d=>d.auth),{vehicleSideBar:g}=R(d=>d.geofence),{collapsed:a}=R(d=>d.auth),{mode:c}=R(d=>d.dashboard),s=de(c),[h,y]=o.useState([]);o.useState([]);const[m,I]=o.useState({user:!0,vehicle:!1}),[L,b]=o.useState(!1),[C,N]=o.useState(!1),[v,_]=o.useState(!1);let M=re();o.useEffect(()=>{r()},[]);const r=async()=>{let d=[],A=[];(await M(uo({w_customer_id:n}))).payload.map(j=>{d.push({id:j.id,label:j.registration_id,value:j.imei[0].mac_id}),A.push(j.imei[0].mac_id)});const f="one",G=A;A.length>0&&M(xo({type:f,imei:G})),y(d)};return e.jsxs("div",{className:"app",children:[e.jsx(Co,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:s.grey[100]},children:[e.jsx(mn,{title:"Settings",setShowContent:I,showContent:m,showMap:L,setShowMap:b,showGfBar:C,setShowGfBar:N,showGfAlert:v,setShowGfAlert:_}),e.jsxs(l,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(l,{style:{width:g?"80%":"100%"},children:m.user?e.jsx(Sn,{}):e.jsx(kn,{showMap:L,setShowMap:b,showGfBar:C,showGfAlert:v})}),!v&&!C&&g&&e.jsx(l,{style:{width:"20%"},children:e.jsx(ko,{vehicleData:h,title:"Setting"})}),v&&!C&&!g&&e.jsx(l,{sx:{width:a?"25%":"20%"},children:e.jsx(bn,{})})]})]})]})}export{$n as default};
