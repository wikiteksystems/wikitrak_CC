import{p as m,o as $,r as t,j as a,B as d,ds as X,dt as E,du as k,H as z,dv as F,C as Q,dw as W,dx as Y,K as Z,a5 as ee,d2 as ae,al as G,a0 as se,a1 as te,a3 as re,a4 as oe,x as A,V as le,X as ie,v as ne}from"./index-Cp4QFi0W.js";import{V as ce}from"./VehicleMenu-Cl7KVXk5.js";import"./Loader-Du2YI5Q4.js";import"./LiveMapServices-BxiCdl_C.js";import{P as de}from"./Parameters-CI0qdzwc.js";/* empty css           */import"./InspectionsTable-CyOUTR2I.js";import"./index.esm-CnKBoDe4.js";import"./ServiceRecordTable-BJa7wQCj.js";import{S as pe}from"./ServiceJobCardTable-BemKYRWT.js";import{B as he}from"./BreakDownJobCardTable-Yyssu1EI.js";import{S as ue}from"./ServicesTopBar-BEgtO04z.js";import"./Autocomplete-sE5ONsgP.js";import"./TextField-DDxAz2Ki.js";import"./Card-Boprh9Dj.js";import"./CardContent-VKOGL9Uv.js";import"./DialogContentText-BZk7AFaF.js";import"./Edit-OuhzljC0.js";import"./formik.esm-Bm3T1UYG.js";import"./excelUtils-B6Yt8QvY.js";function I(o){const{children:p,value:f,index:i,...h}=o;return a.jsx("div",{role:"tabpanel",hidden:f!==i,id:`simple-tabpanel-${i}`,"aria-labelledby":`simple-tab-${i}`,...h,children:f===i&&a.jsx(d,{sx:{p:3},children:p})})}I.propTypes={children:k.node,index:k.number.isRequired,value:k.number.isRequired};function N(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function ge(){const{selectedTabValue:o}=m(i=>i.inspection),p=$();t.useState(0);const f=(i,h)=>{p(z("")),p(F(h))};return a.jsxs(d,{sx:{width:"100%"},children:[a.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(X,{value:o,onChange:f,"aria-label":"basic tabs example",children:[a.jsx(E,{label:"Breakdowns",...N(0)}),a.jsx(E,{label:"Services",...N(1)})]})}),a.jsx(I,{value:o,index:0,children:a.jsx(he,{isInspection:!0})}),a.jsx(I,{value:o,index:1,children:a.jsx(pe,{isInspection:!0})})]})}function Ge(){const{locationData:o,selectedVehicle:p,selectedParameterList:f}=m(s=>s.liveMap),{mode:i,selectedVehicleGroup:h}=m(s=>s.dashboard),T=ne(i),[M,J]=t.useState([]),{w_customer_id:v}=m(s=>s.auth),[R,j]=t.useState(),[b,L]=t.useState(!1),[S,q]=t.useState(!1),[_,y]=t.useState([]);t.useState(!0);const[B,C]=t.useState(!1),[O,w]=t.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let r=$();Q(),t.useEffect(()=>{r(W()),r(Y())},[]),t.useEffect(()=>{U(),r(Z()),r(ee(v)),r(ae())},[]),t.useEffect(()=>{y([]),r(G([{reg_id:"",imei:"",params:[]}]))},[p]);const U=async()=>{try{w(!0);let s=[],n=[];const u=await r(se({w_customer_id:v}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var g,c,D,l;Array.isArray(e.imei)&&e.imei.length>0&&((g=e.imei[0])!=null&&g.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(c=e.imei[0])==null?void 0:c.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(D=e==null?void 0:e.vehicle_model)==null?void 0:D.name,vehicle_group:e==null?void 0:e.vehicle_group}),n.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const V="one",P=n;n.length>0&&r(te({type:V,imei:P})),J(s),r(re(s)),w(!1),r(oe({w_customer_id:v}))}else w(!1),console.error("Unexpected data format:",u),A.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),A.error(`Error fetching vehicle data: ${s}`)}},H=async s=>{const{label:n,imei:u,id:V,reg_id:P,checked:e}=s;j(l=>l.map(x=>x.id===V?{...x,checked:!e}:x));let g=[..._],c=[..._];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(g.push({label:n,value:l.latestDocument[n==="maininputvoltage"?"mainInputVoltage":n]}),c=g,y(g))});else{let l=_.filter(x=>x.label!==n);c=l,y(l)}console.log("tempParamList",c),r(G([{reg_id:P,imei:u,params:c}]))},K=M.filter(s=>Object.keys(h).length===0||s.vehicle_group===h.id);return a.jsxs("div",{className:"app",children:[a.jsx(le,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:L,showVehicles:b,setShowVehiclesGroup:C,showVehiclesGroup:B}),a.jsx(ie,{setShowVehiclesGroup:C,showVehiclesGroup:B}),a.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(d,{style:{width:b||S?"80%":"100%"},children:a.jsx(ge,{})}),b&&a.jsx(d,{style:{width:"20%",backgroundColor:T.grey[100]},children:a.jsx(ce,{vehicleData:K,title:"Inspections",setParameterData:j,loadingVehicle:O,setShowVehicles:L,showVehicles:b,showParameters:S,setShowParameters:q})}),S&&a.jsx(d,{style:{width:"20%",backgroundColor:T.grey[100]},children:a.jsx(de,{parametersData:R,setParameterData:j,handleParameterChange:H})})]})]})]})}export{Ge as default};
