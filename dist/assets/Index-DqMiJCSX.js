import{b as x,o as vt,l as bt,p as tt,_ as h,bL as J,q as ht,f as gt,j as e,g as pt,bM as Ht,bN as Xt,t as A,k as yt,bO as Qt,n as Nt,bP as Zt,bQ as Jt,bR as Bt,bS as Rt,bT as Ot,bU as St,a$ as zt,b0 as K,bV as Kt,bW as ta,bX as ut,bn as rt,aX as j,bY as aa,bZ as ea,T as X,bd as dt,bb as oa,b_ as sa,bG as Et,b$ as ra,c0 as Pt,b6 as wt,c1 as $t,c2 as na,c3 as ia,c4 as Mt,c5 as la,c6 as ca,c7 as da,c8 as ua,c9 as pa,ca as Gt,b9 as kt,cb as ga,bm as xa,bx as fa,by as va,bB as ba,b8 as At,br as ha,bt as ya}from"./index-DwbBqXE5.js";import{L as Ca}from"./LiveMapTopBar-Le_JkVkD.js";import{V as ma}from"./VehicleMenu-BwH_TI_r.js";import{T as $a}from"./TripMap-D-TpgYrM.js";/* empty css           */import"./Autocomplete-DMTv9H2f.js";import"./EllipsisOutlined-83-1piDh.js";function ja(t){return x.Children.toArray(t).filter(a=>x.isValidElement(a))}function Da(t){return bt("MuiButtonGroup",t)}const Ba=vt("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),T=Ba,Ra=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],Pa=(t,a)=>{const{ownerState:s}=t;return[{[`& .${T.grouped}`]:a.grouped},{[`& .${T.grouped}`]:a[`grouped${A(s.orientation)}`]},{[`& .${T.grouped}`]:a[`grouped${A(s.variant)}`]},{[`& .${T.grouped}`]:a[`grouped${A(s.variant)}${A(s.orientation)}`]},{[`& .${T.grouped}`]:a[`grouped${A(s.variant)}${A(s.color)}`]},{[`& .${T.firstButton}`]:a.firstButton},{[`& .${T.lastButton}`]:a.lastButton},{[`& .${T.middleButton}`]:a.middleButton},a.root,a[s.variant],s.disableElevation===!0&&a.disableElevation,s.fullWidth&&a.fullWidth,s.orientation==="vertical"&&a.vertical]},Ma=t=>{const{classes:a,color:s,disabled:n,disableElevation:u,fullWidth:p,orientation:m,variant:l}=t,f={root:["root",l,m==="vertical"&&"vertical",p&&"fullWidth",u&&"disableElevation"],grouped:["grouped",`grouped${A(m)}`,`grouped${A(l)}`,`grouped${A(l)}${A(m)}`,`grouped${A(l)}${A(s)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return yt(f,Da,a)},ka=tt("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Pa})(({theme:t,ownerState:a})=>h({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},a.variant==="contained"&&{boxShadow:(t.vars||t).shadows[2]},a.disableElevation&&{boxShadow:"none"},a.fullWidth&&{width:"100%"},a.orientation==="vertical"&&{flexDirection:"column"},{[`& .${T.grouped}`]:h({minWidth:40,"&:hover":h({},a.variant==="contained"&&{boxShadow:"none"})},a.variant==="contained"&&{boxShadow:"none"}),[`& .${T.firstButton},& .${T.middleButton}`]:h({},a.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},a.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},a.variant==="text"&&a.orientation==="horizontal"&&{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${T.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="text"&&a.orientation==="vertical"&&{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${T.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="text"&&a.color!=="inherit"&&{borderColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / 0.5)`:J(t.palette[a.color].main,.5)},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"transparent"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"transparent"},a.variant==="contained"&&a.orientation==="horizontal"&&{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${T.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="contained"&&a.orientation==="vertical"&&{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${T.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="contained"&&a.color!=="inherit"&&{borderColor:(t.vars||t).palette[a.color].dark},{"&:hover":h({},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"currentColor"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${T.lastButton},& .${T.middleButton}`]:h({},a.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},a.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},a.variant==="outlined"&&a.orientation==="horizontal"&&{marginLeft:-1},a.variant==="outlined"&&a.orientation==="vertical"&&{marginTop:-1})})),Aa=x.forwardRef(function(a,s){const n=ht({props:a,name:"MuiButtonGroup"}),{children:u,className:p,color:m="primary",component:l="div",disabled:f=!1,disableElevation:d=!1,disableFocusRipple:S=!1,disableRipple:W=!1,fullWidth:I=!1,orientation:D="horizontal",size:c="medium",variant:w="outlined"}=n,L=gt(n,Ra),P=h({},n,{color:m,component:l,disabled:f,disableElevation:d,disableFocusRipple:S,disableRipple:W,fullWidth:I,orientation:D,size:c,variant:w}),$=Ma(P),_=x.useMemo(()=>({className:$.grouped,color:m,disabled:f,disableElevation:d,disableFocusRipple:S,disableRipple:W,fullWidth:I,size:c,variant:w}),[m,f,d,S,W,I,c,w,$.grouped]),g=ja(u),G=g.length,z=E=>{const B=E===0,v=E===G-1;return B&&v?"":B?$.firstButton:v?$.lastButton:$.middleButton};return e.jsx(ka,h({as:l,role:"group",className:pt($.root,p),ref:s,ownerState:P},L,{children:e.jsx(Ht.Provider,{value:_,children:g.map((E,B)=>e.jsx(Xt.Provider,{value:z(B),children:E},B))})}))}),_a=Aa;function Ta(t){return bt("MuiCardActions",t)}vt("MuiCardActions",["root","spacing"]);const Ia=["disableSpacing","className"],La=t=>{const{classes:a,disableSpacing:s}=t;return yt({root:["root",!s&&"spacing"]},Ta,a)},Na=tt("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,!s.disableSpacing&&a.spacing]}})(({ownerState:t})=>h({display:"flex",alignItems:"center",padding:8},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Oa=x.forwardRef(function(a,s){const n=ht({props:a,name:"MuiCardActions"}),{disableSpacing:u=!1,className:p}=n,m=gt(n,Ia),l=h({},n,{disableSpacing:u}),f=La(l);return e.jsx(Na,h({className:pt(f.root,p),ownerState:l,ref:s},m))}),Sa=Oa;function za(t){return bt("MuiPagination",t)}vt("MuiPagination",["root","ul","outlined","text"]);const Ea=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function wa(t={}){const{boundaryCount:a=1,componentName:s="usePagination",count:n=1,defaultPage:u=1,disabled:p=!1,hideNextButton:m=!1,hidePrevButton:l=!1,onChange:f,page:d,showFirstButton:S=!1,showLastButton:W=!1,siblingCount:I=1}=t,D=gt(t,Ea),[c,w]=Qt({controlled:d,default:u,name:s,state:"page"}),L=(v,Y)=>{d||w(Y),f&&f(v,Y)},P=(v,Y)=>{const at=Y-v+1;return Array.from({length:at},(nt,M)=>v+M)},$=P(1,Math.min(a,n)),_=P(Math.max(n-a+1,a+1),n),g=Math.max(Math.min(c-I,n-a-I*2-1),a+2),G=Math.min(Math.max(c+I,a+I*2+2),_.length>0?_[0]-2:n-1),z=[...S?["first"]:[],...l?[]:["previous"],...$,...g>a+2?["start-ellipsis"]:a+1<n-a?[a+1]:[],...P(g,G),...G<n-a-1?["end-ellipsis"]:n-a>a?[n-a]:[],..._,...m?[]:["next"],...W?["last"]:[]],E=v=>{switch(v){case"first":return 1;case"previous":return c-1;case"next":return c+1;case"last":return n;default:return null}},B=z.map(v=>typeof v=="number"?{onClick:Y=>{L(Y,v)},type:"page",page:v,selected:v===c,disabled:p,"aria-current":v===c?"true":void 0}:{onClick:Y=>{L(Y,E(v))},type:v,page:E(v),selected:!1,disabled:p||v.indexOf("ellipsis")===-1&&(v==="next"||v==="last"?c>=n:c<=1)});return h({items:B},D)}function Ga(t){return bt("MuiPaginationItem",t)}const Va=vt("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),H=Va,_t=Nt(e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),Tt=Nt(e.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),Wa=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],Vt=(t,a)=>{const{ownerState:s}=t;return[a.root,a[s.variant],a[`size${A(s.size)}`],s.variant==="text"&&a[`text${A(s.color)}`],s.variant==="outlined"&&a[`outlined${A(s.color)}`],s.shape==="rounded"&&a.rounded,s.type==="page"&&a.page,(s.type==="start-ellipsis"||s.type==="end-ellipsis")&&a.ellipsis,(s.type==="previous"||s.type==="next")&&a.previousNext,(s.type==="first"||s.type==="last")&&a.firstLast]},Ya=t=>{const{classes:a,color:s,disabled:n,selected:u,size:p,shape:m,type:l,variant:f}=t,d={root:["root",`size${A(p)}`,f,m,s!=="standard"&&`color${A(s)}`,s!=="standard"&&`${f}${A(s)}`,n&&"disabled",u&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[l]],icon:["icon"]};return yt(d,Ga,a)},Fa=tt("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Vt})(({theme:t,ownerState:a})=>h({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,height:"auto",[`&.${H.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},a.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)})),Ua=tt(Zt,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Vt})(({theme:t,ownerState:a})=>h({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,[`&.${H.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${H.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${H.selected}`]:{backgroundColor:(t.vars||t).palette.action.selected,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:J(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${H.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:J(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},[`&.${H.disabled}`]:{opacity:1,color:(t.vars||t).palette.action.disabled,backgroundColor:(t.vars||t).palette.action.selected}}},a.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)},a.shape==="rounded"&&{borderRadius:(t.vars||t).shape.borderRadius}),({theme:t,ownerState:a})=>h({},a.variant==="text"&&{[`&.${H.selected}`]:h({},a.color!=="standard"&&{color:(t.vars||t).palette[a.color].contrastText,backgroundColor:(t.vars||t).palette[a.color].main,"&:hover":{backgroundColor:(t.vars||t).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[a.color].main}},[`&.${H.focusVisible}`]:{backgroundColor:(t.vars||t).palette[a.color].dark}},{[`&.${H.disabled}`]:{color:(t.vars||t).palette.action.disabled}})},a.variant==="outlined"&&{border:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${H.selected}`]:h({},a.color!=="standard"&&{color:(t.vars||t).palette[a.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / 0.5)`:J(t.palette[a.color].main,.5)}`,backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / ${t.vars.palette.action.activatedOpacity})`:J(t.palette[a.color].main,t.palette.action.activatedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:J(t.palette[a.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${H.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:J(t.palette[a.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity)}},{[`&.${H.disabled}`]:{borderColor:(t.vars||t).palette.action.disabledBackground,color:(t.vars||t).palette.action.disabled}})})),qa=tt("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(t,a)=>a.icon})(({theme:t,ownerState:a})=>h({fontSize:t.typography.pxToRem(20),margin:"0 -8px"},a.size==="small"&&{fontSize:t.typography.pxToRem(18)},a.size==="large"&&{fontSize:t.typography.pxToRem(22)})),Ha=x.forwardRef(function(a,s){const n=ht({props:a,name:"MuiPaginationItem"}),{className:u,color:p="standard",component:m,components:l={},disabled:f=!1,page:d,selected:S=!1,shape:W="circular",size:I="medium",slots:D={},type:c="page",variant:w="text"}=n,L=gt(n,Wa),P=h({},n,{color:p,disabled:f,selected:S,shape:W,size:I,type:c,variant:w}),$=Jt(),_=Ya(P),G=($?{previous:D.next||l.next||Tt,next:D.previous||l.previous||_t,last:D.first||l.first||Bt,first:D.last||l.last||Rt}:{previous:D.previous||l.previous||_t,next:D.next||l.next||Tt,first:D.first||l.first||Bt,last:D.last||l.last||Rt})[c];return c==="start-ellipsis"||c==="end-ellipsis"?e.jsx(Fa,{ref:s,ownerState:P,className:pt(_.root,u),children:"…"}):e.jsxs(Ua,h({ref:s,ownerState:P,component:m,disabled:f,className:pt(_.root,u)},L,{children:[c==="page"&&d,G?e.jsx(qa,{as:G,ownerState:P,className:_.icon}):null]}))}),Xa=Ha,Qa=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Za=t=>{const{classes:a,variant:s}=t;return yt({root:["root",s],ul:["ul"]},za,a)},Ja=tt("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,a[s.variant]]}})({}),Ka=tt("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(t,a)=>a.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function te(t,a,s){return t==="page"?`${s?"":"Go to "}page ${a}`:`Go to ${t} page`}const ae=x.forwardRef(function(a,s){const n=ht({props:a,name:"MuiPagination"}),{boundaryCount:u=1,className:p,color:m="standard",count:l=1,defaultPage:f=1,disabled:d=!1,getItemAriaLabel:S=te,hideNextButton:W=!1,hidePrevButton:I=!1,renderItem:D=B=>e.jsx(Xa,h({},B)),shape:c="circular",showFirstButton:w=!1,showLastButton:L=!1,siblingCount:P=1,size:$="medium",variant:_="text"}=n,g=gt(n,Qa),{items:G}=wa(h({},n,{componentName:"Pagination"})),z=h({},n,{boundaryCount:u,color:m,count:l,defaultPage:f,disabled:d,getItemAriaLabel:S,hideNextButton:W,hidePrevButton:I,renderItem:D,shape:c,showFirstButton:w,showLastButton:L,siblingCount:P,size:$,variant:_}),E=Za(z);return e.jsx(Ja,h({"aria-label":"pagination navigation",className:pt(E.root,p),ownerState:z,ref:s},g,{children:e.jsx(Ka,{className:E.ul,ownerState:z,children:G.map((B,v)=>e.jsx("li",{children:D(h({},B,{color:m,"aria-label":S(B.type,B.page,B.selected),shape:c,size:$,variant:_}))},v))})}))}),ee=ae;var jt={},oe=St;Object.defineProperty(jt,"__esModule",{value:!0});var Wt=jt.default=void 0,se=oe(Ot()),It=e;Wt=jt.default=(0,se.default)([(0,It.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,It.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");var Dt={},re=St;Object.defineProperty(Dt,"__esModule",{value:!0});var Yt=Dt.default=void 0,ne=re(Ot()),Lt=e;Yt=Dt.default=(0,ne.default)([(0,Lt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,Lt.jsx)("circle",{cx:"12",cy:"12",r:"5"},"1")],"RadioButtonCheckedOutlined");const ie="http://206.189.137.185:3031",le=()=>{var U,N,y,Q;const t=zt(),{tripList:a,selectedTripData:s,loading:n,trips:u,activeIndex:p,searchText:m,mode:l,isNavigate:f,allTripList:d,trip_payload:S,page:W,total_page:I,total_trips:D}=K(o=>o.dashboard),{selectedVehicle:c,vehicleList:w}=K(o=>o.liveMap),{parametersConfiguration:L}=K(o=>o.tripMonitor),P=wt(l),[$,_]=x.useState(!1),[g,G]=x.useState({}),[z,E]=x.useState(""),[B,v]=x.useState(null);x.useEffect(()=>{(u==null?void 0:u.length)>0},[u]),x.useEffect(()=>{const o=at(d);t(Kt(o))},[d]),x.useEffect(()=>{!(s.length>0)&&f&&p!==null&&M.length>0&&Y(M[p])},[s,f]);const Y=async o=>{var R;let r={imei:c.imei,startDate:o.startDate,endDate:o.endDate};const b=await ta(r);((R=b==null?void 0:b.data)==null?void 0:R.documents.length)>0?(t(f(!1)),t(ut(b.data.documents[0].data))):(t(f(!1)),t(ut([])))},at=o=>{const r=new Set,b=[];return o.forEach(R=>{const O=rt(R.startTime).format("YYYY-MM-DD");r.has(O)||(r.add(O),b.push(O))}),b},nt=(o,r)=>{t($t(null)),t(na(o)),t(ia(!1)),z===o?(E(""),v(null)):(E(o),v(r))},M=z===""?d:d.filter(o=>rt(o.startTime).format("YYYY-MM-DD")===z),Ct=async(o,r)=>{if(t(ut(r.data)),t($t(o)),t(Mt(r.tripAcreage)),Array.isArray(r==null?void 0:r.data)||r.data.length>5){const b={startDate:r.data[0].createdAt,endDate:r.data[r.data.length-1].createdAt,imei:r.imei};xt(b)}},xt=async o=>{var r,b,R,O,k,Z;try{const q=w.find(V=>{var ot,st;return((st=(ot=V==null?void 0:V.imei)==null?void 0:ot[0])==null?void 0:st.mac_id)===(c==null?void 0:c.imei)});if(!q){console.warn("No matching vehicle found for IMEI:",c==null?void 0:c.imei);return}const it=((Z=(k=(O=(R=(b=(r=q==null?void 0:q.sub_model)==null?void 0:r.model_modelecu)==null?void 0:b[0])==null?void 0:R.ecu)==null?void 0:O.pid_datasets)==null?void 0:k[0])==null?void 0:Z.codes)||[];if(!L||!L.length>0)return;const lt=L.filter(V=>V.checked);console.log("Selected Parameters:",lt);const et=lt.filter(V=>V.pid).map(V=>V.pid.toLowerCase().padStart(4,"0").match(/../g).reverse().join(""));if(et.length===0){console.warn("No valid PIDs found to fetch data.");return}const Ft={pids:et,startDate:o.startDate,endDate:o.endDate,imei:o.imei};console.log("item",o);const ct=(await la.post(`${ie}/pid-data`,Ft)).data;if(console.log("Raw Response:",ct),console.log("pidSet",it),ct&&typeof ct=="object"&&Object.keys(ct).length>0){const V={};for(const[ot,st]of Object.entries(ct))if(Array.isArray(st)&&st.length>0){const Ut=st.map(qt=>ca(qt,ot,it));V[ot]=Ut}else V[ot]=[];console.log("Decoded Data:",V),t(da(V))}else console.warn("Empty or invalid response received.")}catch(q){console.error("Error fetching PID data:",q)}},mt=o=>{G(o),_(!0)},ft=()=>{_(!1),G({})},i=(o,r)=>{t(ua(r));const b={...S,page:r,limit:20};t(pa(b))},C=o=>{if(F(),!Array.isArray(o)||o.length===0)return;const r=o.filter(k=>Array.isArray(k==null?void 0:k.data)&&k.data.length>0);if(r.length===0)return;const b=r.reduce((k,Z)=>k+(Z.tripAcreage||0),0);console.log("Total acreage",b),t(ut([])),t($t("all")),t(Mt(b));const R=r[r.length-1],O={startDate:R.data[R.data.length-1].createdAt,endDate:r[0].data[0].createdAt,imei:r[0].imei};console.log("pidRequestData",O),xt(O)},F=()=>{const o=[...L].map(r=>({...r,value:0}));t(Gt(o))};return e.jsxs(e.Fragment,{children:[e.jsxs(j,{children:[e.jsxs(j,{sx:{m:"10px"},children:[e.jsx(j,{sx:{color:P.grey[400]},children:"Select Date"}),e.jsx(j,{sx:{mt:1},children:e.jsx(aa,{})})]}),n?e.jsx("div",{style:{width:"100%",margin:"38%"},children:e.jsx(ea,{})}):e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx(j,{sx:{display:"flex",overflowX:"auto",gap:"10px",paddingBottom:"5px"},children:d&&(d==null?void 0:d.length)>0?e.jsx(e.Fragment,{}):e.jsx(X,{sx:{width:"100%",mt:"50%",textAlign:"center"},children:"Sorry! No Trips Found"})})}),d&&(d==null?void 0:d.length)>0&&e.jsx(j,{ml:2,display:"flex",gap:1,sx:{width:"90%"},children:e.jsxs(_a,{variant:"outlined","aria-label":"Loading button group",sx:{width:"100%",color:"black"},children:[e.jsx(dt,{sx:{width:"50%",color:"#333333",border:"1px solid #C0C0C0"},children:"Total Trips"}),e.jsx(dt,{sx:{width:"50%",color:"white",border:"1px solid #C0C0C0",backgroundColor:"#C0C0C0"},children:D})]})}),d&&(d==null?void 0:d.length)>0&&e.jsx(ee,{page:W,count:I,sx:{m:2,width:"90%"},onChange:i}),e.jsxs(j,{sx:{height:"75vh",width:"100%",overflowY:"auto"},children:[e.jsx(j,{display:"flex",gap:1,marginLeft:2,children:u.map((o,r)=>e.jsx(j,{children:e.jsx(dt,{onClick:()=>{nt(o,r)},style:{backgroundColor:B===r?P.grey[300]:" #D5D5D5",color:"black",height:"35px",fontWeight:700,fontSize:"12px",width:"90px",marginTop:"10px"},children:o})},r))}),M&&M.length>0&&e.jsx(dt,{variant:p==="all"?"contained":"outlined",sx:{width:"92%",m:"10px 15px",p:1,backgroundColor:p==="all"?oa.bgColor:"transparent"},onClick:()=>{C(M)},children:"Select All trips"})," ",M&&M.length>0&&M.map((o,r)=>{var O,k,Z,q;const b=(k=(O=o==null?void 0:o.startLocation)==null?void 0:O.address)==null?void 0:k.address,R=(q=(Z=o==null?void 0:o.endLocation)==null?void 0:Z.address)==null?void 0:q.address;return b&&`${b.town||b.city||""}`,R&&`${R.town||R.city||""}`,e.jsx(de,{trip:o,index:r,openModal:mt,handleTripData:Ct,activeIndex:p})})]})]})]}),e.jsx(sa,{open:$,onClose:ft,children:e.jsxs(Et,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"40%",bgcolor:"background.paper",boxShadow:24,p:4},children:[e.jsxs(ra,{children:[e.jsx(X,{variant:"h6",component:"div",children:"Trip Details"}),e.jsxs(X,{sx:{mt:2},children:[e.jsx("strong",{children:"Start Location:"})," ",((N=(U=g==null?void 0:g.startLocation)==null?void 0:U.address)==null?void 0:N.display_name)||"N/A"]}),e.jsxs(X,{sx:{mt:2},children:[e.jsx("strong",{children:"End Location:"})," ",((Q=(y=g==null?void 0:g.endLocation)==null?void 0:y.address)==null?void 0:Q.display_name)||"N/A"]}),e.jsxs(X,{sx:{mt:2},children:[e.jsx("strong",{children:"Start Time:"})," ",g!=null&&g.startTime?rt(new Date(g.startTime).toISOString()).format("MMMM Do YYYY, h:mm:ss A"):"N/A"]}),e.jsxs(X,{sx:{mt:2},children:[e.jsx("strong",{children:"End Time:"})," ",g!=null&&g.endTime?rt(new Date(g.endTime).toISOString()).format("MMMM Do YYYY, h:mm:ss A"):"N/A"]})]}),e.jsx(Sa,{children:e.jsx(dt,{onClick:ft,children:"Close"})})]})})]})},ce=le,de=({trip:t,index:a,openModal:s,handleTripData:n,activeIndex:u})=>e.jsxs(Et,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",m:2,px:1,py:1,borderRadius:2,border:"1px solid #DDDDDD",cursor:"pointer",backgroundColor:u===a?"#e8edea":"undefined"},onClick:()=>n(a,t),children:[e.jsxs(j,{sx:{width:40,textAlign:"center"},children:[e.jsx(X,{variant:"caption",color:"text.secondary",children:"Trip"}),e.jsx(X,{variant:"subtitle2",fontWeight:"bold",children:a+1})]}),e.jsx(Pt,{orientation:"vertical",flexItem:!0}),e.jsxs(j,{sx:{flex:1,mx:2},children:[e.jsxs(j,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(Yt,{sx:{color:"#BFBEBE"}}),e.jsx(j,{sx:{flex:1,borderTop:"1px dashed #DDDDDD",mx:1.5}}),e.jsx(Wt,{sx:{color:"red"}})]}),e.jsxs(j,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(X,{variant:"caption",children:t.startTime?rt(t.startTime).format("HH:mm:ss A"):"NA"}),e.jsx(X,{variant:"caption",children:t.startTime?rt(t.endTime).format("HH:mm:ss A"):"NA"})]})]}),e.jsx(Pt,{orientation:"vertical",flexItem:!0}),e.jsx(j,{children:e.jsx(X,{variant:"body2",color:"primary",sx:{cursor:"pointer",m:1},onClick:()=>s(t),children:"See More"})})]},t.id);function ye(){const{w_customer_id:t}=K(i=>i.auth),{collapsed:a}=K(i=>i.auth),{mode:s,selectedVehicleGroup:n}=K(i=>i.dashboard),{vehicleList:u,selectedVehicle:p,onlineVehicle:m,locationData:l}=K(i=>i.liveMap),[f,d]=x.useState(!1),[S,W]=x.useState(!0),[I,D]=x.useState([]),[c,w]=x.useState(!0),[L,P]=x.useState(""),[$,_]=x.useState(""),[g,G]=x.useState(""),[z,E]=x.useState("");x.useState([]);const[B,v]=x.useState({lat:18.516726,lng:73.856255});x.useState([]);const[Y,at]=x.useState(!1),nt=wt(s);let M=zt();x.useEffect(()=>{M(ut([])),Ct()},[]),x.useEffect(()=>{var F,U,N;const i=kt().subtract(5,"day").startOf("day").toISOString(),C=kt().endOf("day").toISOString();M(ga({startDate:i,endDate:C})),Object.keys(p).length===0&&u.length>0&&M(xa({imei:(U=(F=u[0])==null?void 0:F.imei[0])==null?void 0:U.mac_id,reg_id:(N=u[0])==null?void 0:N.registration_id}))},[p,u]),x.useEffect(()=>{var i,C,F,U;if(console.log("seletect vehicle trip monitor",p,u),p&&(p!=null&&p.imei)&&u&&u.length>0){let N=u.find(y=>Array.isArray(y.imei)?y.imei[0].mac_id===p.imei:null);if(N&&Array.isArray(N.imei)&&((C=(i=N.imei[0])==null?void 0:i.device_typ)==null?void 0:C.toLowerCase())==="sinocastel"){let Q=((U=(F=N==null?void 0:N.sub_model)==null?void 0:F.model_modelecu[0])==null?void 0:U.pid_code).map(o=>{var r,b,R,O,k;return{label:(r=o==null?void 0:o.pi_code_variable[0])==null?void 0:r.short_name,value:0,checked:!1,key:(R=(b=o==null?void 0:o.pi_code_variable[0])==null?void 0:b.widget_types)==null?void 0:R.value,pid:o==null?void 0:o.code,decodeConfig:o,unit:(k=(O=o==null?void 0:o.pi_code_variable)==null?void 0:O[0])==null?void 0:k.unit}});M(Gt(Q))}}},[p]);const Ct=async()=>{try{let i=[],C=[];const F=await M(fa({w_customer_id:t}));if(Array.isArray(F.payload)){F.payload.forEach(y=>{var Q,o,r;Array.isArray(y.imei)&&y.imei.length>0&&((Q=y.imei[0])!=null&&Q.mac_id)?(i.push({id:y.id,label:y.registration_id,value:(o=y.imei[0])==null?void 0:o.mac_id,workShop:y==null?void 0:y.workshop,vehicle_group:y==null?void 0:y.vehicle_group}),C.push((r=y.imei[0])==null?void 0:r.mac_id)):console.error("IMEI data not found for item:",y)});const U="one",N=C;C.length>0&&M(va({type:U,imei:N})),M(ba({w_customer_id:t})),D(i)}else console.error("Unexpected data format:",F),At.error("Unexpected data format:")}catch(i){console.error("Error fetching vehicle data:",i),At.error(`Error fetching vehicle data: ${i}`)}},xt=i=>l==null?void 0:l.some(C=>String(C.latestDocument.imei)===String(i)&&C.latestDocument.speed>0&&(C.latestDocument.ignition===!0||C.latestDocument.ignition===1)),mt=i=>l==null?void 0:l.some(C=>String(C.latestDocument.imei)===String(i)&&C.latestDocument.speed<=0&&(C.latestDocument.ignition===!0||C.latestDocument.ignition===1)),ft=I.filter(i=>{var k,Z,q,it,lt;if(!(Object.keys(n).length===0||i.vehicle_group===n.id))return!1;const F=(k=i==null?void 0:i.label)==null?void 0:k.toLowerCase().includes(L.toLowerCase()),U=z===""||((Z=i==null?void 0:i.workShop)==null?void 0:Z.region)===z,N=g===""||((it=(q=i==null?void 0:i.workShop)==null?void 0:q.state)==null?void 0:it.toLowerCase())===(((lt=g==null?void 0:g.toString())==null?void 0:lt.toLowerCase())||""),y=i.value,Q=String(i.value).toLowerCase(),o=m.some(et=>String(et).toLowerCase()===Q),r=!m.some(et=>String(et).toLowerCase()===Q),b=o&&xt(y),R=o&&mt(y);return F&&U&&N&&($==="online"?o:$==="offline"?r:$==="running"?b:$==="idling"?R:!0)}).sort((i,C)=>i.label.localeCompare(C.label));return e.jsxs("div",{className:"app",children:[e.jsx(ha,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(Ca,{title:"Trip Monitor",setShowVehicles:d,showVehicles:f,setShowCard:W,showCard:S,sideBarTrip:c,setSideBarTrip:w,setShowVehiclesGroup:at,showVehiclesGroup:Y}),e.jsx(ya,{setShowVehiclesGroup:at,showVehiclesGroup:Y,where:"tripmonitor"}),e.jsxs(j,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(j,{sx:{width:f||c?"80%":"100%",height:"50px"},children:e.jsx($a,{center:B,showCard:S})}),f&&e.jsx(j,{style:{width:"20%",backgroundColor:nt.grey[100]},children:e.jsx(ma,{vehicleData:ft,setShowVehicles:d,showVehicles:f,title:"Live Monitor",setSearchedTerm:P,setOptions:_,setState:G,setRegion:E,searchTerm:L,options:$,state:g,region:z,setSideBarTrip:w})}),e.jsx(j,{style:{width:a?"22%":"20%",display:c?"block":"none",backgroundColor:nt.grey[100]},children:e.jsx(ce,{})})]})]})]})}export{ye as default};
