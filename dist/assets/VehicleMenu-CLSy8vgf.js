import{a_ as I,j as e,dL as M,dM as D,dN as G,dP as p,fv as v,bl as y,b as m,dK as H,c4 as Q,a$ as V,aW as j,bY as X,fw as ee,bc as L,ba as h,T as le,b5 as te,be as se,b7 as O,b6 as re,fx as ae,fu as ne,bJ as T}from"./index-Dq6tRXvu.js";import{A as oe}from"./Autocomplete-Jy6USDPl.js";function ie({options:r,setOptions:n}){const o=I(),g=b=>{o(v(5.8)),o(y({})),n(b.target.value)};return e.jsx("div",{children:e.jsxs(M,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:[e.jsx(D,{id:"demo-simple-select-standard-label",children:"Vehicle State Options"}),e.jsxs(G,{labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard",value:r,onChange:g,label:"state-options",children:[e.jsx(p,{value:"",children:e.jsx("em",{children:"None"})}),e.jsx(p,{value:"offline",children:"Offline Vehicles"}),e.jsx(p,{value:"online",children:"Online Vehicles"}),e.jsx(p,{value:"running",children:"Running Vehicles"}),e.jsx(p,{value:"idling",children:"Idling Vehicles"})]})]})})}let ce="http://134.209.145.234/api/v1";function de({state:r,setState:n}){const[o,g]=m.useState([]);m.useEffect(()=>{(async()=>{try{let{data:s}=await Q.get(`${ce}/workshop/state/?country=1`);g((s==null?void 0:s.results)||[])}catch(s){console.error("Error while getting state data:",s)}})()},[]);const b=(l,s)=>{n((s==null?void 0:s.name)||""),console.log("Selected option:",s)};return e.jsx("div",{children:e.jsx(M,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:e.jsx(oe,{options:o,getOptionLabel:l=>(l==null?void 0:l.name)||"",value:o.find(l=>(l==null?void 0:l.name)===r)||null,onChange:b,isOptionEqualToValue:(l,s)=>(l==null?void 0:l.name)===(s==null?void 0:s.name),renderInput:l=>e.jsx(H,{...l,label:"State filter options",variant:"standard"})})})})}const ue=({vehicleData:r,title:n,setParameterData:o,loadingVehicle:g,setSearchedTerm:b,setOptions:l,setState:s,setRegion:he,searchTerm:R,region:E,state:A,options:W})=>{const{selectedVehicle:x,locationData:i,loading:F,onlineVehicle:ge}=V(t=>t.liveMap),{mode:N,showVehicles:P}=V(t=>t.dashboard),f=te(N),u=m.useRef(null),S=m.useRef(0);let c=I();m.useEffect(()=>{u.current&&setTimeout(()=>{u.current.scrollTop=S.current},0)});const $=async t=>{var _,k;if(u.current&&(S.current=u.current.scrollTop),se(!P),!i||(i==null?void 0:i.length)<=0)return O.error("Data not available for this vehicle",{id:"clipboard"});const a=i==null?void 0:i.filter(d=>d.latestDocument.imei===t.value);if(console.log("selected vehicle",a),(a==null?void 0:a.length)<=0)return O.error("Data not available for this vehicle",{id:"clipboard"});const{lat:q,lng:J}=((_=a==null?void 0:a[0])==null?void 0:_.latestDocument)??{},K={lat:q||T.lat,lng:J||T.lat};c(re(K)),c(v(15)),c(y({imei:t.value,reg_id:t.label})),c(ae(t.value));const U=t.label,Z=await c(ne({w_registration_id:U})),C=[];let z=0;(k=Z.payload)==null||k.map(d=>{d[d.parameter_type.toLowerCase()+"_parameter"].forEach(w=>{C.push({reg_id:t.label,imei:t.value,id:w.id,_id:d.id,key:z++,label:d.parameter_type==="Telematic"&&w.short_name})})}),n==="Live Map"&&o(C)},B=()=>{c(v(5.8)),c(y({}))},Y={backgroundColor:f.grey[100],position:"relative",width:"100%",float:"right",height:"90vh",overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"};return e.jsx(e.Fragment,{children:e.jsx("div",{ref:u,style:Y,children:F||g?e.jsx(j,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:e.jsx(X,{})}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{searchTerm:R,setSearchedTerm:b,vehicleMenu:!0}),e.jsx(ie,{options:W,setOptions:l}),e.jsx(de,{state:A,setState:s}),(n==="Live Map"||n==="Live Monitor")&&e.jsx(j,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsxs(L,{variant:"outlined",onClick:()=>{B()},sx:{width:"90%",bgcolor:Object.keys(x).length===0?h.bgColor:"undefined",color:Object.keys(x).length===0?"white":f.grey[400],border:`1px solid ${h.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:h.bgShadow}},children:["All Vehicles: ",r==null?void 0:r.length]})}),r.length>0?r.map((t,a)=>e.jsx(j,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(L,{disabled:t.label===x.reg_id,variant:"outlined",onClick:()=>{$(t)},sx:{width:"90%",bgcolor:t.label===x.reg_id?h.bgColor:"undefined",color:t.label===x.reg_id?"white":f.grey[400],border:`1px solid ${h.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:h.bgShadow}},children:t.label})},a)):e.jsx(j,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsxs(le,{sx:{textAlign:"center",color:f.grey[400]},children:["Sorry! No vehicles in"," ",e.jsx("span",{style:{fontWeight:"bold"},children:E})," region"]})})]})})})};export{ue as V};
