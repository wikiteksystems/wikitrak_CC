import{R as N,r as B,p as je,o as He,j as i,B as ae,T as Je,cY as ne,ch as Ue,ci as De,cj as ke,ck as qe,cm as he,E as pe,dm as ns,dn as ls,dp as Xe,cl as os,co as bt,dq as cs,y as le,dr as Ne,ds as us,dt as ds,du as we,dv as Re,dw as Be,dx as fs,dy as Lt,dz as Ot,dA as Ut,dB as hs,m as it,aF as ms,az as Ze,cM as gs,C as rt,I as ys,n as xs,cq as ps,cr as vs,cs as bs,ct as _t,cu as Z,cv as _s,dC as js,dD as Vs,dE as Ss,dF as Es,ae as jt,a3 as As,a4 as Cs,a6 as Fs,a7 as Ds,Y as ks,$ as qs,w as ws}from"./index-3Nq5Ytru.js";import{V as Ts}from"./VehicleMenu-CzMQ0rug.js";import{P as Ls}from"./Parameters-CwatjeGc.js";/* empty css           */import{d as Os}from"./Add-B66MoT4E.js";import{c as Us,a as be,d as Vt,e as Ps}from"./index.esm-Dvr05BRv.js";import{D as Ns}from"./DialogContentText-D_He5uK_.js";import{E as Rs,T as Se}from"./Edit-Z1OM6OEm.js";import{S as Bs}from"./ServicesTopBar-CWp8-CzX.js";import"./Autocomplete-lZl0hfWR.js";var Oe=e=>e.type==="checkbox",_e=e=>e instanceof Date,ee=e=>e==null;const Pt=e=>typeof e=="object";var W=e=>!ee(e)&&!Array.isArray(e)&&Pt(e)&&!_e(e),Nt=e=>W(e)&&e.target?Oe(e.target)?e.target.checked:e.target.value:e,Is=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Rt=(e,s)=>e.has(Is(s)),Ms=e=>{const s=e.constructor&&e.constructor.prototype;return W(s)&&s.hasOwnProperty("isPrototypeOf")},nt=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function se(e){let s;const t=Array.isArray(e);if(e instanceof Date)s=new Date(e);else if(e instanceof Set)s=new Set(e);else if(!(nt&&(e instanceof Blob||e instanceof FileList))&&(t||W(e)))if(s=t?[]:{},!t&&!Ms(e))s=e;else for(const a in e)e.hasOwnProperty(a)&&(s[a]=se(e[a]));else return e;return s}var Ge=e=>Array.isArray(e)?e.filter(Boolean):[],M=e=>e===void 0,f=(e,s,t)=>{if(!s||!W(e))return t;const a=Ge(s.split(/[,[\].]+?/)).reduce((o,n)=>ee(o)?o:o[n],e);return M(a)||a===e?M(e[s])?t:e[s]:a},oe=e=>typeof e=="boolean",lt=e=>/^\w*$/.test(e),Bt=e=>Ge(e.replace(/["|']|\]/g,"").split(/\.|\[/)),U=(e,s,t)=>{let a=-1;const o=lt(s)?[s]:Bt(s),n=o.length,u=n-1;for(;++a<n;){const g=o[a];let S=t;if(a!==u){const y=e[g];S=W(y)||Array.isArray(y)?y:isNaN(+o[a+1])?{}:[]}if(g==="__proto__")return;e[g]=S,e=e[g]}return e};const Ie={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ce={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},fe={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},$s=N.createContext(null),ot=()=>N.useContext($s);var It=(e,s,t,a=!0)=>{const o={defaultValues:s._defaultValues};for(const n in e)Object.defineProperty(o,n,{get:()=>{const u=n;return s._proxyFormState[u]!==ce.all&&(s._proxyFormState[u]=!a||ce.all),t&&(t[u]=!0),e[u]}});return o},re=e=>W(e)&&!Object.keys(e).length,Mt=(e,s,t,a)=>{t(e);const{name:o,...n}=e;return re(n)||Object.keys(n).length>=Object.keys(s).length||Object.keys(n).find(u=>s[u]===(!a||ce.all))},Te=e=>Array.isArray(e)?e:[e],$t=(e,s,t)=>!e||!s||e===s||Te(e).some(a=>a&&(t?a===s:a.startsWith(s)||s.startsWith(a)));function ct(e){const s=N.useRef(e);s.current=e,N.useEffect(()=>{const t=!e.disabled&&s.current.subject&&s.current.subject.subscribe({next:s.current.next});return()=>{t&&t.unsubscribe()}},[e.disabled])}function Ws(e){const s=ot(),{control:t=s.control,disabled:a,name:o,exact:n}=e||{},[u,g]=N.useState(t._formState),S=N.useRef(!0),y=N.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),_=N.useRef(o);return _.current=o,ct({disabled:a,next:m=>S.current&&$t(_.current,m.name,n)&&Mt(m,y.current,t._updateFormState)&&g({...t._formState,...m}),subject:t._subjects.state}),N.useEffect(()=>(S.current=!0,y.current.isValid&&t._updateValid(!0),()=>{S.current=!1}),[t]),It(u,t,y.current,!1)}var de=e=>typeof e=="string",Wt=(e,s,t,a,o)=>de(e)?(a&&s.watch.add(e),f(t,e,o)):Array.isArray(e)?e.map(n=>(a&&s.watch.add(n),f(t,n))):(a&&(s.watchAll=!0),t);function Hs(e){const s=ot(),{control:t=s.control,name:a,defaultValue:o,disabled:n,exact:u}=e||{},g=N.useRef(a);g.current=a,ct({disabled:n,subject:t._subjects.values,next:_=>{$t(g.current,_.name,u)&&y(se(Wt(g.current,t._names,_.values||t._formValues,!1,o)))}});const[S,y]=N.useState(t._getWatch(a,o));return N.useEffect(()=>t._removeUnmounted()),S}function Gs(e){const s=ot(),{name:t,disabled:a,control:o=s.control,shouldUnregister:n}=e,u=Rt(o._names.array,t),g=Hs({control:o,name:t,defaultValue:f(o._formValues,t,f(o._defaultValues,t,e.defaultValue)),exact:!0}),S=Ws({control:o,name:t,exact:!0}),y=N.useRef(o.register(t,{...e.rules,value:g,...oe(e.disabled)?{disabled:e.disabled}:{}}));return N.useEffect(()=>{const _=o._options.shouldUnregister||n,m=(I,$)=>{const k=f(o._fields,I);k&&k._f&&(k._f.mount=$)};if(m(t,!0),_){const I=se(f(o._options.defaultValues,t));U(o._defaultValues,t,I),M(f(o._formValues,t))&&U(o._formValues,t,I)}return()=>{(u?_&&!o._state.action:_)?o.unregister(t):m(t,!1)}},[t,o,u,n]),N.useEffect(()=>{f(o._fields,t)&&o._updateDisabledField({disabled:a,fields:o._fields,name:t,value:f(o._fields,t)._f.value})},[a,t,o]),{field:{name:t,value:g,...oe(a)||S.disabled?{disabled:S.disabled||a}:{},onChange:N.useCallback(_=>y.current.onChange({target:{value:Nt(_),name:t},type:Ie.CHANGE}),[t]),onBlur:N.useCallback(()=>y.current.onBlur({target:{value:f(o._formValues,t),name:t},type:Ie.BLUR}),[t,o]),ref:N.useCallback(_=>{const m=f(o._fields,t);m&&_&&(m._f.ref={focus:()=>_.focus(),select:()=>_.select(),setCustomValidity:I=>_.setCustomValidity(I),reportValidity:()=>_.reportValidity()})},[o._fields,t])},formState:S,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!f(S.errors,t)},isDirty:{enumerable:!0,get:()=>!!f(S.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!f(S.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!f(S.validatingFields,t)},error:{enumerable:!0,get:()=>f(S.errors,t)}})}}const ue=e=>e.render(Gs(e));var Ht=(e,s,t,a,o)=>s?{...t[e],types:{...t[e]&&t[e].types?t[e].types:{},[a]:o||!0}}:{},St=e=>({isOnSubmit:!e||e===ce.onSubmit,isOnBlur:e===ce.onBlur,isOnChange:e===ce.onChange,isOnAll:e===ce.all,isOnTouch:e===ce.onTouched}),Et=(e,s,t)=>!t&&(s.watchAll||s.watch.has(e)||[...s.watch].some(a=>e.startsWith(a)&&/^\.\w+/.test(e.slice(a.length))));const Le=(e,s,t,a)=>{for(const o of t||Object.keys(e)){const n=f(e,o);if(n){const{_f:u,...g}=n;if(u){if(u.refs&&u.refs[0]&&s(u.refs[0],o)&&!a)return!0;if(u.ref&&s(u.ref,u.name)&&!a)return!0;if(Le(g,s))break}else if(W(g)&&Le(g,s))break}}};var zs=(e,s,t)=>{const a=Te(f(e,t));return U(a,"root",s[t]),U(e,t,a),e},ut=e=>e.type==="file",me=e=>typeof e=="function",Me=e=>{if(!nt)return!1;const s=e?e.ownerDocument:0;return e instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},Pe=e=>de(e),dt=e=>e.type==="radio",$e=e=>e instanceof RegExp;const At={value:!1,isValid:!1},Ct={value:!0,isValid:!0};var Gt=e=>{if(Array.isArray(e)){if(e.length>1){const s=e.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:s,isValid:!!s.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!M(e[0].attributes.value)?M(e[0].value)||e[0].value===""?Ct:{value:e[0].value,isValid:!0}:Ct:At}return At};const Ft={isValid:!1,value:null};var zt=e=>Array.isArray(e)?e.reduce((s,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:s,Ft):Ft;function Dt(e,s,t="validate"){if(Pe(e)||Array.isArray(e)&&e.every(Pe)||oe(e)&&!e)return{type:t,message:Pe(e)?e:"",ref:s}}var Ee=e=>W(e)&&!$e(e)?e:{value:e,message:""},kt=async(e,s,t,a,o)=>{const{ref:n,refs:u,required:g,maxLength:S,minLength:y,min:_,max:m,pattern:I,validate:$,name:k,valueAsNumber:H,mount:G,disabled:ie}=e._f,F=f(s,k);if(!G||ie)return{};const b=u?u[0]:n,R=C=>{a&&b.reportValidity&&(b.setCustomValidity(oe(C)?"":C||""),b.reportValidity())},A={},T=dt(n),Q=Oe(n),J=T||Q,L=(H||ut(n))&&M(n.value)&&M(F)||Me(n)&&n.value===""||F===""||Array.isArray(F)&&!F.length,O=Ht.bind(null,k,t,A),X=(C,q,j,x=fe.maxLength,v=fe.minLength)=>{const E=C?q:j;A[k]={type:C?x:v,message:E,ref:n,...O(C?x:v,E)}};if(o?!Array.isArray(F)||!F.length:g&&(!J&&(L||ee(F))||oe(F)&&!F||Q&&!Gt(u).isValid||T&&!zt(u).isValid)){const{value:C,message:q}=Pe(g)?{value:!!g,message:g}:Ee(g);if(C&&(A[k]={type:fe.required,message:q,ref:b,...O(fe.required,q)},!t))return R(q),A}if(!L&&(!ee(_)||!ee(m))){let C,q;const j=Ee(m),x=Ee(_);if(!ee(F)&&!isNaN(F)){const v=n.valueAsNumber||F&&+F;ee(j.value)||(C=v>j.value),ee(x.value)||(q=v<x.value)}else{const v=n.valueAsDate||new Date(F),E=te=>new Date(new Date().toDateString()+" "+te),P=n.type=="time",w=n.type=="week";de(j.value)&&F&&(C=P?E(F)>E(j.value):w?F>j.value:v>new Date(j.value)),de(x.value)&&F&&(q=P?E(F)<E(x.value):w?F<x.value:v<new Date(x.value))}if((C||q)&&(X(!!C,j.message,x.message,fe.max,fe.min),!t))return R(A[k].message),A}if((S||y)&&!L&&(de(F)||o&&Array.isArray(F))){const C=Ee(S),q=Ee(y),j=!ee(C.value)&&F.length>+C.value,x=!ee(q.value)&&F.length<+q.value;if((j||x)&&(X(j,C.message,q.message),!t))return R(A[k].message),A}if(I&&!L&&de(F)){const{value:C,message:q}=Ee(I);if($e(C)&&!F.match(C)&&(A[k]={type:fe.pattern,message:q,ref:n,...O(fe.pattern,q)},!t))return R(q),A}if($){if(me($)){const C=await $(F,s),q=Dt(C,b);if(q&&(A[k]={...q,...O(fe.validate,q.message)},!t))return R(q.message),A}else if(W($)){let C={};for(const q in $){if(!re(C)&&!t)break;const j=Dt(await $[q](F,s),b,q);j&&(C={...j,...O(q,j.message)},R(j.message),t&&(A[k]=C))}if(!re(C)&&(A[k]={ref:b,...C},!t))return A}}return R(!0),A};function Ys(e,s){const t=s.slice(0,-1).length;let a=0;for(;a<t;)e=M(e)?a++:e[s[a++]];return e}function Ks(e){for(const s in e)if(e.hasOwnProperty(s)&&!M(e[s]))return!1;return!0}function z(e,s){const t=Array.isArray(s)?s:lt(s)?[s]:Bt(s),a=t.length===1?e:Ys(e,t),o=t.length-1,n=t[o];return a&&delete a[n],o!==0&&(W(a)&&re(a)||Array.isArray(a)&&Ks(a))&&z(e,t.slice(0,-1)),e}var et=()=>{let e=[];return{get observers(){return e},next:o=>{for(const n of e)n.next&&n.next(o)},subscribe:o=>(e.push(o),{unsubscribe:()=>{e=e.filter(n=>n!==o)}}),unsubscribe:()=>{e=[]}}},at=e=>ee(e)||!Pt(e);function xe(e,s){if(at(e)||at(s))return e===s;if(_e(e)&&_e(s))return e.getTime()===s.getTime();const t=Object.keys(e),a=Object.keys(s);if(t.length!==a.length)return!1;for(const o of t){const n=e[o];if(!a.includes(o))return!1;if(o!=="ref"){const u=s[o];if(_e(n)&&_e(u)||W(n)&&W(u)||Array.isArray(n)&&Array.isArray(u)?!xe(n,u):n!==u)return!1}}return!0}var Yt=e=>e.type==="select-multiple",Qs=e=>dt(e)||Oe(e),tt=e=>Me(e)&&e.isConnected,Kt=e=>{for(const s in e)if(me(e[s]))return!0;return!1};function We(e,s={}){const t=Array.isArray(e);if(W(e)||t)for(const a in e)Array.isArray(e[a])||W(e[a])&&!Kt(e[a])?(s[a]=Array.isArray(e[a])?[]:{},We(e[a],s[a])):ee(e[a])||(s[a]=!0);return s}function Qt(e,s,t){const a=Array.isArray(e);if(W(e)||a)for(const o in e)Array.isArray(e[o])||W(e[o])&&!Kt(e[o])?M(s)||at(t[o])?t[o]=Array.isArray(e[o])?We(e[o],[]):{...We(e[o])}:Qt(e[o],ee(s)?{}:s[o],t[o]):t[o]=!xe(e[o],s[o]);return t}var Ce=(e,s)=>Qt(e,s,We(s)),Jt=(e,{valueAsNumber:s,valueAsDate:t,setValueAs:a})=>M(e)?e:s?e===""?NaN:e&&+e:t&&de(e)?new Date(e):a?a(e):e;function st(e){const s=e.ref;if(!(e.refs?e.refs.every(t=>t.disabled):s.disabled))return ut(s)?s.files:dt(s)?zt(e.refs).value:Yt(s)?[...s.selectedOptions].map(({value:t})=>t):Oe(s)?Gt(e.refs).value:Jt(M(s.value)?e.ref.value:s.value,e)}var Js=(e,s,t,a)=>{const o={};for(const n of e){const u=f(s,n);u&&U(o,n,u._f)}return{criteriaMode:t,names:[...e],fields:o,shouldUseNativeValidation:a}},Fe=e=>M(e)?e:$e(e)?e.source:W(e)?$e(e.value)?e.value.source:e.value:e;const qt="AsyncFunction";var Xs=e=>(!e||!e.validate)&&!!(me(e.validate)&&e.validate.constructor.name===qt||W(e.validate)&&Object.values(e.validate).find(s=>s.constructor.name===qt)),Zs=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function wt(e,s,t){const a=f(e,t);if(a||lt(t))return{error:a,name:t};const o=t.split(".");for(;o.length;){const n=o.join("."),u=f(s,n),g=f(e,n);if(u&&!Array.isArray(u)&&t!==n)return{name:t};if(g&&g.type)return{name:n,error:g};o.pop()}return{name:t}}var er=(e,s,t,a,o)=>o.isOnAll?!1:!t&&o.isOnTouch?!(s||e):(t?a.isOnBlur:o.isOnBlur)?!e:(t?a.isOnChange:o.isOnChange)?e:!0,tr=(e,s)=>!Ge(f(e,s)).length&&z(e,s);const sr={mode:ce.onSubmit,reValidateMode:ce.onChange,shouldFocusError:!0};function rr(e={}){let s={...sr,...e},t={submitCount:0,isDirty:!1,isLoading:me(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},o=W(s.defaultValues)||W(s.values)?se(s.defaultValues||s.values)||{}:{},n=s.shouldUnregister?{}:se(o),u={action:!1,mount:!1,watch:!1},g={mount:new Set,unMount:new Set,array:new Set,watch:new Set},S,y=0;const _={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},m={values:et(),array:et(),state:et()},I=St(s.mode),$=St(s.reValidateMode),k=s.criteriaMode===ce.all,H=r=>l=>{clearTimeout(y),y=setTimeout(r,l)},G=async r=>{if(!e.disabled&&(_.isValid||r)){const l=s.resolver?re((await J()).errors):await O(a,!0);l!==t.isValid&&m.state.next({isValid:l})}},ie=(r,l)=>{!e.disabled&&(_.isValidating||_.validatingFields)&&((r||Array.from(g.mount)).forEach(c=>{c&&(l?U(t.validatingFields,c,l):z(t.validatingFields,c))}),m.state.next({validatingFields:t.validatingFields,isValidating:!re(t.validatingFields)}))},F=(r,l=[],c,p,h=!0,d=!0)=>{if(p&&c&&!e.disabled){if(u.action=!0,d&&Array.isArray(f(a,r))){const V=c(f(a,r),p.argA,p.argB);h&&U(a,r,V)}if(d&&Array.isArray(f(t.errors,r))){const V=c(f(t.errors,r),p.argA,p.argB);h&&U(t.errors,r,V),tr(t.errors,r)}if(_.touchedFields&&d&&Array.isArray(f(t.touchedFields,r))){const V=c(f(t.touchedFields,r),p.argA,p.argB);h&&U(t.touchedFields,r,V)}_.dirtyFields&&(t.dirtyFields=Ce(o,n)),m.state.next({name:r,isDirty:C(r,l),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else U(n,r,l)},b=(r,l)=>{U(t.errors,r,l),m.state.next({errors:t.errors})},R=r=>{t.errors=r,m.state.next({errors:t.errors,isValid:!1})},A=(r,l,c,p)=>{const h=f(a,r);if(h){const d=f(n,r,M(c)?f(o,r):c);M(d)||p&&p.defaultChecked||l?U(n,r,l?d:st(h._f)):x(r,d),u.mount&&G()}},T=(r,l,c,p,h)=>{let d=!1,V=!1;const D={name:r};if(!e.disabled){const Y=!!(f(a,r)&&f(a,r)._f&&f(a,r)._f.disabled);if(!c||p){_.isDirty&&(V=t.isDirty,t.isDirty=D.isDirty=C(),d=V!==D.isDirty);const K=Y||xe(f(o,r),l);V=!!(!Y&&f(t.dirtyFields,r)),K||Y?z(t.dirtyFields,r):U(t.dirtyFields,r,!0),D.dirtyFields=t.dirtyFields,d=d||_.dirtyFields&&V!==!K}if(c){const K=f(t.touchedFields,r);K||(U(t.touchedFields,r,c),D.touchedFields=t.touchedFields,d=d||_.touchedFields&&K!==c)}d&&h&&m.state.next(D)}return d?D:{}},Q=(r,l,c,p)=>{const h=f(t.errors,r),d=_.isValid&&oe(l)&&t.isValid!==l;if(e.delayError&&c?(S=H(()=>b(r,c)),S(e.delayError)):(clearTimeout(y),S=null,c?U(t.errors,r,c):z(t.errors,r)),(c?!xe(h,c):h)||!re(p)||d){const V={...p,...d&&oe(l)?{isValid:l}:{},errors:t.errors,name:r};t={...t,...V},m.state.next(V)}},J=async r=>{ie(r,!0);const l=await s.resolver(n,s.context,Js(r||g.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return ie(r),l},L=async r=>{const{errors:l}=await J(r);if(r)for(const c of r){const p=f(l,c);p?U(t.errors,c,p):z(t.errors,c)}else t.errors=l;return l},O=async(r,l,c={valid:!0})=>{for(const p in r){const h=r[p];if(h){const{_f:d,...V}=h;if(d){const D=g.array.has(d.name),Y=h._f&&Xs(h._f);Y&&_.validatingFields&&ie([p],!0);const K=await kt(h,n,k,s.shouldUseNativeValidation&&!l,D);if(Y&&_.validatingFields&&ie([p]),K[d.name]&&(c.valid=!1,l))break;!l&&(f(K,d.name)?D?zs(t.errors,K,d.name):U(t.errors,d.name,K[d.name]):z(t.errors,d.name))}!re(V)&&await O(V,l,c)}}return c.valid},X=()=>{for(const r of g.unMount){const l=f(a,r);l&&(l._f.refs?l._f.refs.every(c=>!tt(c)):!tt(l._f.ref))&&ze(r)}g.unMount=new Set},C=(r,l)=>!e.disabled&&(r&&l&&U(n,r,l),!xe(Ae(),o)),q=(r,l,c)=>Wt(r,g,{...u.mount?n:M(l)?o:de(r)?{[r]:l}:l},c,l),j=r=>Ge(f(u.mount?n:o,r,e.shouldUnregister?f(o,r,[]):[])),x=(r,l,c={})=>{const p=f(a,r);let h=l;if(p){const d=p._f;d&&(!d.disabled&&U(n,r,Jt(l,d)),h=Me(d.ref)&&ee(l)?"":l,Yt(d.ref)?[...d.ref.options].forEach(V=>V.selected=h.includes(V.value)):d.refs?Oe(d.ref)?d.refs.length>1?d.refs.forEach(V=>(!V.defaultChecked||!V.disabled)&&(V.checked=Array.isArray(h)?!!h.find(D=>D===V.value):h===V.value)):d.refs[0]&&(d.refs[0].checked=!!h):d.refs.forEach(V=>V.checked=V.value===h):ut(d.ref)?d.ref.value="":(d.ref.value=h,d.ref.type||m.values.next({name:r,values:{...n}})))}(c.shouldDirty||c.shouldTouch)&&T(r,h,c.shouldTouch,c.shouldDirty,!0),c.shouldValidate&&te(r)},v=(r,l,c)=>{for(const p in l){const h=l[p],d=`${r}.${p}`,V=f(a,d);(g.array.has(r)||W(h)||V&&!V._f)&&!_e(h)?v(d,h,c):x(d,h,c)}},E=(r,l,c={})=>{const p=f(a,r),h=g.array.has(r),d=se(l);U(n,r,d),h?(m.array.next({name:r,values:{...n}}),(_.isDirty||_.dirtyFields)&&c.shouldDirty&&m.state.next({name:r,dirtyFields:Ce(o,n),isDirty:C(r,d)})):p&&!p._f&&!ee(d)?v(r,d,c):x(r,d,c),Et(r,g)&&m.state.next({...t}),m.values.next({name:u.mount?r:void 0,values:{...n}})},P=async r=>{u.mount=!0;const l=r.target;let c=l.name,p=!0;const h=f(a,c),d=()=>l.type?st(h._f):Nt(r),V=D=>{p=Number.isNaN(D)||_e(D)&&isNaN(D.getTime())||xe(D,f(n,c,D))};if(h){let D,Y;const K=d(),ve=r.type===Ie.BLUR||r.type===Ie.FOCUS_OUT,rs=!Zs(h._f)&&!s.resolver&&!f(t.errors,c)&&!h._f.deps||er(ve,f(t.touchedFields,c),t.isSubmitted,$,I),Ke=Et(c,g,ve);U(n,c,K),ve?(h._f.onBlur&&h._f.onBlur(r),S&&S(0)):h._f.onChange&&h._f.onChange(r);const Qe=T(c,K,ve,!1),as=!re(Qe)||Ke;if(!ve&&m.values.next({name:c,type:r.type,values:{...n}}),rs)return _.isValid&&(e.mode==="onBlur"?ve&&G():G()),as&&m.state.next({name:c,...Ke?{}:Qe});if(!ve&&Ke&&m.state.next({...t}),s.resolver){const{errors:pt}=await J([c]);if(V(K),p){const is=wt(t.errors,a,c),vt=wt(pt,a,is.name||c);D=vt.error,c=vt.name,Y=re(pt)}}else ie([c],!0),D=(await kt(h,n,k,s.shouldUseNativeValidation))[c],ie([c]),V(K),p&&(D?Y=!1:_.isValid&&(Y=await O(a,!0)));p&&(h._f.deps&&te(h._f.deps),Q(c,Y,D,Qe))}},w=(r,l)=>{if(f(t.errors,l)&&r.focus)return r.focus(),1},te=async(r,l={})=>{let c,p;const h=Te(r);if(s.resolver){const d=await L(M(r)?r:h);c=re(d),p=r?!h.some(V=>f(d,V)):c}else r?(p=(await Promise.all(h.map(async d=>{const V=f(a,d);return await O(V&&V._f?{[d]:V}:V)}))).every(Boolean),!(!p&&!t.isValid)&&G()):p=c=await O(a);return m.state.next({...!de(r)||_.isValid&&c!==t.isValid?{}:{name:r},...s.resolver||!r?{isValid:c}:{},errors:t.errors}),l.shouldFocus&&!p&&Le(a,w,r?h:g.mount),p},Ae=r=>{const l={...u.mount?n:o};return M(r)?l:de(r)?f(l,r):r.map(c=>f(l,c))},Ve=(r,l)=>({invalid:!!f((l||t).errors,r),isDirty:!!f((l||t).dirtyFields,r),error:f((l||t).errors,r),isValidating:!!f(t.validatingFields,r),isTouched:!!f((l||t).touchedFields,r)}),Zt=r=>{r&&Te(r).forEach(l=>z(t.errors,l)),m.state.next({errors:r?t.errors:{}})},ft=(r,l,c)=>{const p=(f(a,r,{_f:{}})._f||{}).ref,h=f(t.errors,r)||{},{ref:d,message:V,type:D,...Y}=h;U(t.errors,r,{...Y,...l,ref:p}),m.state.next({name:r,errors:t.errors,isValid:!1}),c&&c.shouldFocus&&p&&p.focus&&p.focus()},es=(r,l)=>me(r)?m.values.subscribe({next:c=>r(q(void 0,l),c)}):q(r,l,!0),ze=(r,l={})=>{for(const c of r?Te(r):g.mount)g.mount.delete(c),g.array.delete(c),l.keepValue||(z(a,c),z(n,c)),!l.keepError&&z(t.errors,c),!l.keepDirty&&z(t.dirtyFields,c),!l.keepTouched&&z(t.touchedFields,c),!l.keepIsValidating&&z(t.validatingFields,c),!s.shouldUnregister&&!l.keepDefaultValue&&z(o,c);m.values.next({values:{...n}}),m.state.next({...t,...l.keepDirty?{isDirty:C()}:{}}),!l.keepIsValid&&G()},ht=({disabled:r,name:l,field:c,fields:p,value:h})=>{if(oe(r)&&u.mount||r){const d=r?void 0:M(h)?st(c?c._f:f(p,l)._f):h;U(n,l,d),T(l,d,!1,!1,!0)}},Ye=(r,l={})=>{let c=f(a,r);const p=oe(l.disabled)||oe(e.disabled);return U(a,r,{...c||{},_f:{...c&&c._f?c._f:{ref:{name:r}},name:r,mount:!0,...l}}),g.mount.add(r),c?ht({field:c,disabled:oe(l.disabled)?l.disabled:e.disabled,name:r,value:l.value}):A(r,!0,l.value),{...p?{disabled:l.disabled||e.disabled}:{},...s.progressive?{required:!!l.required,min:Fe(l.min),max:Fe(l.max),minLength:Fe(l.minLength),maxLength:Fe(l.maxLength),pattern:Fe(l.pattern)}:{},name:r,onChange:P,onBlur:P,ref:h=>{if(h){Ye(r,l),c=f(a,r);const d=M(h.value)&&h.querySelectorAll&&h.querySelectorAll("input,select,textarea")[0]||h,V=Qs(d),D=c._f.refs||[];if(V?D.find(Y=>Y===d):d===c._f.ref)return;U(a,r,{_f:{...c._f,...V?{refs:[...D.filter(tt),d,...Array.isArray(f(o,r))?[{}]:[]],ref:{type:d.type,name:r}}:{ref:d}}}),A(r,!1,void 0,d)}else c=f(a,r,{}),c._f&&(c._f.mount=!1),(s.shouldUnregister||l.shouldUnregister)&&!(Rt(g.array,r)&&u.action)&&g.unMount.add(r)}}},mt=()=>s.shouldFocusError&&Le(a,w,g.mount),ts=r=>{oe(r)&&(m.state.next({disabled:r}),Le(a,(l,c)=>{const p=f(a,c);p&&(l.disabled=p._f.disabled||r,Array.isArray(p._f.refs)&&p._f.refs.forEach(h=>{h.disabled=p._f.disabled||r}))},0,!1))},gt=(r,l)=>async c=>{let p;c&&(c.preventDefault&&c.preventDefault(),c.persist&&c.persist());let h=se(n);if(m.state.next({isSubmitting:!0}),s.resolver){const{errors:d,values:V}=await J();t.errors=d,h=V}else await O(a);if(z(t.errors,"root"),re(t.errors)){m.state.next({errors:{}});try{await r(h,c)}catch(d){p=d}}else l&&await l({...t.errors},c),mt(),setTimeout(mt);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:re(t.errors)&&!p,submitCount:t.submitCount+1,errors:t.errors}),p)throw p},ss=(r,l={})=>{f(a,r)&&(M(l.defaultValue)?E(r,se(f(o,r))):(E(r,l.defaultValue),U(o,r,se(l.defaultValue))),l.keepTouched||z(t.touchedFields,r),l.keepDirty||(z(t.dirtyFields,r),t.isDirty=l.defaultValue?C(r,se(f(o,r))):C()),l.keepError||(z(t.errors,r),_.isValid&&G()),m.state.next({...t}))},yt=(r,l={})=>{const c=r?se(r):o,p=se(c),h=re(r),d=h?o:p;if(l.keepDefaultValues||(o=c),!l.keepValues){if(l.keepDirtyValues){const V=new Set([...g.mount,...Object.keys(Ce(o,n))]);for(const D of Array.from(V))f(t.dirtyFields,D)?U(d,D,f(n,D)):E(D,f(d,D))}else{if(nt&&M(r))for(const V of g.mount){const D=f(a,V);if(D&&D._f){const Y=Array.isArray(D._f.refs)?D._f.refs[0]:D._f.ref;if(Me(Y)){const K=Y.closest("form");if(K){K.reset();break}}}}a={}}n=e.shouldUnregister?l.keepDefaultValues?se(o):{}:se(d),m.array.next({values:{...d}}),m.values.next({values:{...d}})}g={mount:l.keepDirtyValues?g.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},u.mount=!_.isValid||!!l.keepIsValid||!!l.keepDirtyValues,u.watch=!!e.shouldUnregister,m.state.next({submitCount:l.keepSubmitCount?t.submitCount:0,isDirty:h?!1:l.keepDirty?t.isDirty:!!(l.keepDefaultValues&&!xe(r,o)),isSubmitted:l.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:h?{}:l.keepDirtyValues?l.keepDefaultValues&&n?Ce(o,n):t.dirtyFields:l.keepDefaultValues&&r?Ce(o,r):l.keepDirty?t.dirtyFields:{},touchedFields:l.keepTouched?t.touchedFields:{},errors:l.keepErrors?t.errors:{},isSubmitSuccessful:l.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},xt=(r,l)=>yt(me(r)?r(n):r,l);return{control:{register:Ye,unregister:ze,getFieldState:Ve,handleSubmit:gt,setError:ft,_executeSchema:J,_getWatch:q,_getDirty:C,_updateValid:G,_removeUnmounted:X,_updateFieldArray:F,_updateDisabledField:ht,_getFieldArray:j,_reset:yt,_resetDefaultValues:()=>me(s.defaultValues)&&s.defaultValues().then(r=>{xt(r,s.resetOptions),m.state.next({isLoading:!1})}),_updateFormState:r=>{t={...t,...r}},_disableForm:ts,_subjects:m,_proxyFormState:_,_setErrors:R,get _fields(){return a},get _formValues(){return n},get _state(){return u},set _state(r){u=r},get _defaultValues(){return o},get _names(){return g},set _names(r){g=r},get _formState(){return t},set _formState(r){t=r},get _options(){return s},set _options(r){s={...s,...r}}},trigger:te,register:Ye,handleSubmit:gt,watch:es,setValue:E,getValues:Ae,reset:xt,resetField:ss,clearErrors:Zt,unregister:ze,setError:ft,setFocus:(r,l={})=>{const c=f(a,r),p=c&&c._f;if(p){const h=p.refs?p.refs[0]:p.ref;h.focus&&(h.focus(),l.shouldSelect&&h.select())}},getFieldState:Ve}}function ar(e={}){const s=N.useRef(),t=N.useRef(),[a,o]=N.useState({isDirty:!1,isValidating:!1,isLoading:me(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:me(e.defaultValues)?void 0:e.defaultValues});s.current||(s.current={...rr(e),formState:a});const n=s.current.control;return n._options=e,ct({subject:n._subjects.state,next:u=>{Mt(u,n._proxyFormState,n._updateFormState,!0)&&o({...n._formState})}}),N.useEffect(()=>n._disableForm(e.disabled),[n,e.disabled]),N.useEffect(()=>{if(n._proxyFormState.isDirty){const u=n._getDirty();u!==a.isDirty&&n._subjects.state.next({isDirty:u})}},[n,a.isDirty]),N.useEffect(()=>{e.values&&!xe(e.values,t.current)?(n._reset(e.values,n._options.resetOptions),t.current=e.values,o(u=>({...u}))):n._resetDefaultValues()},[e.values,n]),N.useEffect(()=>{e.errors&&n._setErrors(e.errors)},[e.errors,n]),N.useEffect(()=>{n._state.mount||(n._updateValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),N.useEffect(()=>{e.shouldUnregister&&n._subjects.values.next({values:n._getWatch()})},[e.shouldUnregister,n]),N.useEffect(()=>{s.current&&(s.current.watch=s.current.watch.bind({}))},[a]),s.current.formState=It(a,n),s.current}const Tt=(e,s,t)=>{if(e&&"reportValidity"in e){const a=f(t,s);e.setCustomValidity(a&&a.message||""),e.reportValidity()}},Xt=(e,s)=>{for(const t in s.fields){const a=s.fields[t];a&&a.ref&&"reportValidity"in a.ref?Tt(a.ref,t,e):a.refs&&a.refs.forEach(o=>Tt(o,t,e))}},ir=(e,s)=>{s.shouldUseNativeValidation&&Xt(e,s);const t={};for(const a in e){const o=f(s.fields,a),n=Object.assign(e[a]||{},{ref:o&&o.ref});if(nr(s.names||Object.keys(e),a)){const u=Object.assign({},f(t,a));U(u,"root",n),U(t,a,u)}else U(t,a,n)}return t},nr=(e,s)=>e.some(t=>t.startsWith(s+"."));function lr(e,s,t){return s===void 0&&(s={}),t===void 0&&(t={}),function(a,o,n){try{return Promise.resolve(function(u,g){try{var S=(s.context,Promise.resolve(e[t.mode==="sync"?"validateSync":"validate"](a,Object.assign({abortEarly:!1},s,{context:o}))).then(function(y){return n.shouldUseNativeValidation&&Xt({},n),{values:t.raw?a:y,errors:{}}}))}catch(y){return g(y)}return S&&S.then?S.then(void 0,g):S}(0,function(u){if(!u.inner)throw u;return{values:{},errors:ir((g=u,S=!n.shouldUseNativeValidation&&n.criteriaMode==="all",(g.inner||[]).reduce(function(y,_){if(y[_.path]||(y[_.path]={message:_.message,type:_.type}),S){var m=y[_.path].types,I=m&&m[_.type];y[_.path]=Ht(_.path,S,y,_.type,I?[].concat(I,_.message):_.message)}return y},{})),n)};var g,S}))}catch(u){return Promise.reject(u)}}}const or=Us().shape({name:be().required("Name is required"),vehicle_model:Vt().required("Vehicle model is required"),operator:be().required("Operator is required"),equipment_type:be().required("Equipment type is required"),serial_no:be().required("Serial No is required."),chassis_no:be().required("Chassis No is required."),odometer:Vt().required("Odometer is required."),status:be().required("Status is required"),oem:be().required("OEM is required"),attachment:Ps().nullable()});function cr(){var j;const{handleSubmit:e,control:s,formState:{errors:t},reset:a}=ar({resolver:lr(or),defaultValues:{name:"",vehicle_model:"",operator:"",equipment_type:"",serial_no:"",chassis_no:"",odometer:"",status:"Assigned",oem:"",attachment:null}}),[o,n]=B.useState([]),{oemList:u,userList:g,equipmentTypes:S,UpdatedEqipmentData:y,isUpdateEqipment:_,isAddEqipment:m}=je(x=>x.equipment),[I,$]=B.useState(null),[k,H]=B.useState(null),[G,ie]=B.useState(""),[F,b]=B.useState(null),[R,A]=B.useState("Upload Attachment"),T=He();B.useEffect(()=>{console.log("equipmentTypes",S)},[S]),B.useEffect(()=>{if(console.log("UpdatedEqipmentData",y),y){a({name:y.name,vehicle_model:y.vehicle_model.id,operator:y.operator.id,equipment_type:y.equipment_type.id,serial_no:y.serial_no,chassis_no:y.chassis_no,odometer:y.odometer,status:y.status,oem:y.vehicle_model.oem,attachment:y.attachment});let x=[];x.push(y.vehicle_model),n(x),H(y.operator.id),b(y.attachment),A("edit")}},[y,a]);const Q=async x=>{console.log("form data",x);const v=new FormData;if(Object.keys(x).forEach(E=>{const P=x[E]==null?"":x[E];v.append(E,P)}),!y)T(cs(v)).unwrap().then(()=>{le.success("Equipment added successfully"),a(),T(Ne())}).catch(E=>{var P,w;le.error("Failed to add equipment"),console.error("Error adding equipment:",E),((P=E==null?void 0:E.attachment)==null?void 0:P.length)>0&&E.attachment.map(te=>le.error(`Error: ${te}`)),((w=E==null?void 0:E.name)==null?void 0:w.length)>0&&E.name.map(te=>le.error(`Error: ${te}`))});else{const E=y.id;if(console.log("payload in action",v),typeof x.attachment=="string"){let w=await us(x.attachment);console.log("file conversion",w),x.attachment=w}let P=new FormData;Object.keys(x).forEach(w=>{w==="attachment"&&x.attachment instanceof Blob?P.append(w,x.attachment,"attachment.jpg"):P.append(w,x[w])});for(let[w,te]of P.entries())console.log(w,te);T(ds({formData:P,id:E})).unwrap().then(()=>{le.success("Equipment updated successfully"),a(),T(Ne()),T(we(null)),T(Re(!1)),T(Be(!1))}).catch(w=>{var te,Ae;le.error("Failed to update equipment"),console.error("Error updating equipment:",w),((te=w==null?void 0:w.attachment)==null?void 0:te.length)>0&&w.attachment.map(Ve=>le.error(`Error: ${Ve}`)),((Ae=w==null?void 0:w.name)==null?void 0:Ae.length)>0&&w.name.map(Ve=>le.error(`Error: ${Ve}`))})}},J=async x=>{try{const v=await T(fs({oem_id:x}));v!=null&&v.payload&&n(v.payload.map(E=>({id:E.id,name:E.name,oem:E.oem})))}catch(v){console.error("Error while getting submodels:",v)}},L=x=>$(x.currentTarget),O=()=>{T(we(null)),$(null)},X=g==null?void 0:g.filter(x=>`${x.first_name} ${x.last_name}`.toLowerCase().includes(G.toLowerCase())),C=x=>{H(x),O()},q=()=>{T(Be(!1)),T(Re(!1)),T(we(null)),console.log("Form Canceled")};return i.jsxs(ae,{component:"form",onSubmit:e(Q),sx:{p:3,backgroundColor:"#fff",borderRadius:2,boxShadow:3},children:[i.jsx(Je,{variant:"h6",sx:{mb:2},children:"Add New Equipment"}),i.jsxs(ne,{container:!0,spacing:2,children:[i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"name",control:s,render:({field:x})=>{var v;return i.jsx(Ue,{...x,label:"Name",fullWidth:!0,variant:"outlined",error:!!t.name,helperText:(v=t.name)==null?void 0:v.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"oem",control:s,render:({field:x})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.oem,children:[i.jsx(ke,{children:"OEM"}),i.jsxs(qe,{...x,label:"OEM",onChange:v=>{x.onChange(v.target.value),J(v.target.value)},children:[i.jsx(he,{value:"",children:"Select OEM"}),u==null?void 0:u.map((v,E)=>i.jsx(he,{value:v.id,children:v.name},E))]})]})})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"vehicle_model",control:s,render:({field:x})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.vehicle_model,children:[i.jsx(ke,{children:"Vehicle Model"}),i.jsx(qe,{...x,label:"Vehicle Model",children:o.map(v=>i.jsx(he,{value:v.id,children:v.name},v.id))})]})})}),i.jsxs(ne,{item:!0,xs:12,sm:6,children:[i.jsx(ue,{name:"operator",control:s,render:({field:x})=>i.jsxs(i.Fragment,{children:[i.jsx(pe,{fullWidth:!0,onClick:L,sx:{textAlign:"left",border:1,p:1.5},children:k?`${k.first_name} ${k.last_name}`:"Select Operator"}),i.jsx(ns,{open:!!I,anchorEl:I,onClose:O,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},PaperProps:{sx:{maxHeight:300,overflowY:"auto"}},children:i.jsxs(ls,{children:[i.jsx(Xe,{children:i.jsx(os,{autoFocus:!0,placeholder:"Search user",fullWidth:!0,value:G,onChange:v=>ie(v.target.value)})}),X.length>0?X.map((v,E)=>i.jsx(Xe,{button:!0,onClick:()=>{C(v),x.onChange(v.id)},children:i.jsx(bt,{primary:`${v.first_name} ${v.last_name}`,secondary:v.email})},E)):i.jsx(Xe,{children:i.jsx(bt,{primary:"No Operator found"})})]})})]})}),i.jsx(Je,{variant:"caption",color:"error",children:(j=t.operator)==null?void 0:j.message})]}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"equipment_type",control:s,render:({field:x})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.equipment_type,children:[i.jsx(ke,{children:"Equipment Types"}),i.jsxs(qe,{...x,label:"Equipment Type",onChange:v=>{x.onChange(v.target.value)},children:[i.jsx(he,{value:"",children:"Select Equipment Type"}),S==null?void 0:S.map((v,E)=>i.jsx(he,{value:v.id,children:v.name},E))]})]})})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"serial_no",control:s,render:({field:x})=>{var v;return i.jsx(Ue,{...x,label:"Serial Number",fullWidth:!0,variant:"outlined",error:!!t.serial_no,helperText:(v=t.serial_no)==null?void 0:v.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"chassis_no",control:s,render:({field:x})=>{var v;return i.jsx(Ue,{...x,label:"Chassis Number",fullWidth:!0,variant:"outlined",error:!!t.chassis_no,helperText:(v=t.chassis_no)==null?void 0:v.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"odometer",control:s,render:({field:x})=>{var v;return i.jsx(Ue,{...x,label:"Odometer",fullWidth:!0,type:"number",variant:"outlined",error:!!t.odometer,helperText:(v=t.odometer)==null?void 0:v.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(ue,{name:"status",control:s,render:({field:x})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.status,children:[i.jsx(ke,{children:"Status"}),i.jsxs(qe,{...x,label:"Status",children:[i.jsx(he,{value:"Assigned",children:"Assigned"}),i.jsx(he,{value:"Unassigned",children:"Unassigned"})]})]})})}),i.jsxs(ne,{item:!0,xs:12,sm:6,children:[i.jsx(ue,{name:"attachment",control:s,render:({field:x})=>i.jsxs(pe,{variant:"outlined",component:"label",fullWidth:!0,children:[R,i.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:v=>{const E=v.target.files[0];if(x.onChange(E),E){const P=URL.createObjectURL(E);b(P),A(E.name)}}})]})}),F&&i.jsxs(ae,{mt:2,textAlign:"center",children:[i.jsx(Je,{variant:"subtitle1",children:"Uploaded Image:"}),i.jsx("img",{src:F,alt:"Preview",style:{width:"100%",maxHeight:"300px",objectFit:"contain"}})]})]}),i.jsxs(ne,{item:!0,xs:12,children:[i.jsx(pe,{color:"primary",sx:{marginRight:"10px",border:"1px solid #f6f6f6"},onClick:q,children:"Cancel"}),i.jsx(pe,{variant:"contained",color:"primary",type:"submit",children:y?"Update":"Submit"})]})]})]})}const ur=({open:e,onClose:s,onConfirm:t})=>i.jsxs(Lt,{open:e,onClose:s,children:[i.jsx(Ot,{children:"Confirm Deletion"}),i.jsx(Ut,{children:i.jsxs(Ns,{children:["Are you sure you want to delete this vehicle data?"," ",i.jsx("span",{style:{color:"red"},children:"This action cannot be undone."})]})}),i.jsxs(hs,{children:[i.jsx(pe,{onClick:s,color:"primary",children:"Cancel"}),i.jsx(pe,{onClick:t,color:"secondary",children:"Delete"})]})]}),dr="https://cc.wikitrak.in/api-proxy/api/v1",fr={display:"flex",alignItems:"left",justifyContent:"left",gap:"8px"},hr=({equipmentData:e})=>{const s=He(),{isUpdateEqipment:t}=je(y=>y.equipment),[a,o]=B.useState(!1),n=()=>{console.log("equipmentData",e),localStorage.getItem("role"),s(Be(!t)),s(we(e))},u=async()=>{console.log("Vehicle data deleting");try{await ms.delete(`${dr}/vehicles/delete/${vehicleData.id}/`),le.success("Vehicle data deleted successfully!"),s(Ne())}catch(y){console.error("Error deleting vehicle data:",y),le.error("Failed to delete vehicle data. Please try again.")}o(!1)},g=()=>{o(!1)},S={color:"#686868"};return i.jsxs(ae,{sx:fr,children:[i.jsx(it,{onClick:n,children:i.jsx(Rs,{sx:S})}),i.jsx(ur,{open:a,onClose:g,onConfirm:u})]})},mr=[{id:"all",name:"All"},{id:"assigned",name:"Assigned"},{id:"unassigned",name:"Unassigned"}],gr={assigned:!1,unAssgined:!1,all:!0},yr=()=>{const{isAddEqipment:e,equipmentTypes:s,isUpdateEqipment:t}=je(k=>k.equipment),[a,o]=B.useState(""),[n,u]=B.useState(gr),[g,S]=B.useState("");let y=He();const _=()=>{y(Re(!e))},m=()=>{y(Re(!1)),y(Be(!1)),y(we(null))},I=k=>{console.log("equipment type selected",k),o(k.id)},$=k=>{const H={assigned:k.id==="assigned",unassigned:k.id==="unassigned",all:k.id==="all"};u(H)};return i.jsxs(ae,{sx:{bgcolor:"white",height:"89vh",m:"15px",borderRadius:"10px"},children:[i.jsx(xr,{handleAdd:_,handleFilters:$,appliedFilters:n}),i.jsx(Ze,{}),i.jsxs(ae,{sx:{display:"flex",width:"100%",gap:"30px",padding:"10px"},children:[i.jsx(pr,{searchQuery:g,setSearchQuery:S}),i.jsx(vr,{equipmentTypes:s,handleOnChange:I,selectedValue:a})]}),i.jsx(Ze,{}),i.jsx(br,{appliedFilters:n,selectedEquipmentType:a,searchQuery:g}),i.jsx(Ze,{}),i.jsxs(Lt,{open:e||t,onClose:m,maxWidth:"md",fullWidth:!0,children:[i.jsx(Ot,{children:i.jsx(it,{"aria-label":"close",onClick:m,sx:{position:"absolute",right:8,top:8,color:k=>k.palette.grey[500]},children:i.jsx(gs,{})})}),i.jsx(Ut,{children:i.jsx(cr,{})})]})]})},xr=({handleAdd:e,handleFilters:s,appliedFilters:t})=>i.jsxs(ae,{sx:{display:"flex",justifyContent:"space-between",padding:"10px"},children:[i.jsx(ae,{children:mr.map(a=>i.jsx(pe,{onClick:()=>{s(a)},sx:{background:t[a.id]?"lightblue":"transparent",color:t[a.id]?"white":"black",ml:"3px","&:hover":{background:t[a.id]?rt.bgColor:"lightgrey"}},children:a.name},a.id))}),i.jsxs(pe,{onClick:e,sx:{color:"black",background:rt.bgColor},children:[i.jsx(Os,{}),"Equipment"]})]}),pr=({setSearchQuery:e,searchQuery:s})=>i.jsxs(ae,{component:"form",border:"1px solid #000000",backgroundColor:"white",borderRadius:"20px",opacity:"75%",m:"3px",width:300,children:[i.jsx(ys,{sx:{my:.5,mx:2},placeholder:"Search equipments...",value:s,onChange:t=>e(t.target.value)}),i.jsx(it,{type:"submit",sx:{p:1},children:i.jsx(xs,{})})]}),vr=({equipmentTypes:e,handleOnChange:s,selectedValue:t})=>i.jsx(ae,{sx:{width:"200px"},children:i.jsxs(De,{fullWidth:!0,children:[i.jsx(ke,{id:"equipment-type-label",children:"Equipment Type"}),i.jsxs(qe,{labelId:"equipment-type-label",id:"equipment-type-select",label:"Equipment Type",value:t,onChange:a=>{const o=e.find(n=>n.id===a.target.value);s(o||{id:"",name:"No Equipment"})},children:[i.jsx(he,{value:"",children:"No Equipment"}),e&&e.length>0&&e.map(a=>i.jsx(he,{value:a.id,children:a.name},a.id))]})]})}),ge={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"},ye={fontSize:"14px",padding:"10px"},br=({appliedFilters:e,selectedEquipmentType:s,searchQuery:t})=>{const a=[5,10,25],[o,n]=B.useState(0),[u,g]=B.useState(10),{equipmentList:S}=je(b=>b.equipment),[y,_]=B.useState("asc"),[m,I]=B.useState(""),$=(b,R)=>{n(R)},k=b=>{g(parseInt(b.target.value,10)),n(0)},H=b=>{_(m===b&&y==="asc"?"desc":"asc"),I(b)},G=(b,R)=>R.split(".").reduce((A,T)=>A&&A[T],b),F=(b=>[...b].sort((R,A)=>{const T=G(R,m)||"",Q=G(A,m)||"";return T<Q?y==="asc"?-1:1:T>Q?y==="asc"?1:-1:0}))(S.filter(b=>{var Q,J,L,O,X;const R=(e==null?void 0:e.all)||(e==null?void 0:e.assigned)&&(b==null?void 0:b.status.toLowerCase())==="assigned"||e.unassigned&&(b==null?void 0:b.status.toLowerCase())==="unassigned"||(e==null?void 0:e.archived)&&(b==null?void 0:b.archived)===!0,A=!s||((Q=b==null?void 0:b.equipment_type)==null?void 0:Q.id)===s,T=!t||b.name.toLowerCase().includes(t.toLowerCase())||((J=b==null?void 0:b.serial_no)==null?void 0:J.toLowerCase().includes(t.toLowerCase()))||((L=b==null?void 0:b.operator)==null?void 0:L.email)&&((O=b==null?void 0:b.operator)==null?void 0:O.email.toLowerCase().includes(t.toLowerCase()))||((X=b==null?void 0:b.equipment_type)==null?void 0:X.name.toLowerCase().includes(t.toLowerCase()));return R&&A&&T}));return i.jsxs(ae,{children:[i.jsx(ps,{sx:{height:"66vh",bgcolor:"white",borderRadius:"10px"},children:i.jsxs(vs,{stickyHeader:!0,children:[i.jsx(bs,{children:i.jsxs(_t,{children:[i.jsx(Z,{sx:ge,children:i.jsx(Se,{active:m==="name",direction:m==="name"?y:"asc",onClick:()=>H("name"),children:"Name"})}),i.jsx(Z,{sx:ge,children:i.jsx(Se,{active:m==="vehicle_model.name",direction:m==="vehicle_model.name"?y:"asc",onClick:()=>H("vehicle_model.name"),children:"Model"})}),i.jsx(Z,{sx:ge,children:i.jsx(Se,{active:m==="serial_no",direction:m==="serial_no"?y:"asc",onClick:()=>H("serial_no"),children:"Serial"})}),i.jsx(Z,{sx:ge,children:i.jsx(Se,{active:m==="operator.name",direction:m==="operator.name"?y:"asc",onClick:()=>H("operator.name"),children:"Operator"})}),i.jsx(Z,{sx:ge,children:i.jsx(Se,{active:m==="equipment_type.name",direction:m==="equipment_type.name"?y:"asc",onClick:()=>H("equipment_type.name"),children:"Equipment Name"})}),i.jsx(Z,{sx:ge,children:i.jsx(Se,{active:m==="status",direction:m==="status"?y:"asc",onClick:()=>H("status"),children:"Status"})}),i.jsx(Z,{sx:ge,children:"Open Issues"}),i.jsx(Z,{sx:ge,children:"Action"})]})}),i.jsx(_s,{children:F.slice(o*u,o*u+u).map((b,R)=>{var A,T,Q,J,L,O;return i.jsxs(_t,{hover:!0,children:[i.jsx(Z,{sx:ye,children:b.name||"N/A"}),i.jsx(Z,{sx:ye,children:((A=b.vehicle_model)==null?void 0:A.name)||"N/A"}),i.jsx(Z,{sx:ye,children:b.serial_no||"N/A"}),i.jsx(Z,{sx:ye,children:`${(Q=(T=b.operator)==null?void 0:T.us_user)==null?void 0:Q.first_name} ${(L=(J=b.operator)==null?void 0:J.us_user)==null?void 0:L.last_name}`||"N/A"}),i.jsx(Z,{sx:ye,children:((O=b.equipment_type)==null?void 0:O.name)||"N/A"}),i.jsx(Z,{sx:ye,children:b.status||"N/A"}),i.jsx(Z,{sx:ye,children:R+1}),i.jsx(Z,{sx:ye,children:i.jsx(hr,{equipmentData:b})})]},R)})})]})}),i.jsx(js,{component:"div",rowsPerPageOptions:a,count:F.length,rowsPerPage:u,page:o,onPageChange:$,onRowsPerPageChange:k,sx:{bgcolor:"white",borderTop:"1px solid #e0e0e0",boxShadow:"0px -2px 5px rgba(0,0,0,0.1)",mt:1,borderRadius:"0 0 10px 10px"}})]})},_r=yr;function Or(){const{locationData:e,selectedVehicle:s,selectedParameterList:t}=je(L=>L.liveMap),{mode:a,selectedVehicleGroup:o}=je(L=>L.dashboard),n=ws(a),[u,g]=B.useState([]),{w_customer_id:S}=je(L=>L.auth),[y,_]=B.useState(),[m,I]=B.useState(!1),[$,k]=B.useState(!1),[H,G]=B.useState([]);B.useState(!0);const[ie,F]=B.useState(!1),[b,R]=B.useState(!1);let A=He();B.useEffect(()=>{T(),A(Vs()),A(Ss()),A(Es()),A(Ne())},[A]),B.useEffect(()=>{G([]),A(jt([{reg_id:"",imei:"",params:[]}]))},[s]);const T=async()=>{try{F(!0);let L=[],O=[];const X=await A(As({w_customer_id:S}));if(Array.isArray(X.payload)){X.payload.forEach(j=>{var x,v,E,P;Array.isArray(j.imei)&&j.imei.length>0&&((x=j.imei[0])!=null&&x.mac_id)?(L.push({id:j.id,label:j.registration_id,value:(v=j.imei[0])==null?void 0:v.mac_id,vehilce_type:j==null?void 0:j.segment,chassis_no:j==null?void 0:j.chassis_no,engine_no:j==null?void 0:j.engine_no,workShop:j==null?void 0:j.workshop,registration_id:j==null?void 0:j.registration_id,sell_date:j==null?void 0:j.sell_date,customer_name:j==null?void 0:j.customer_name,vehicle_model:(E=j==null?void 0:j.vehicle_model)==null?void 0:E.name,vehicle_group:j==null?void 0:j.vehicle_group}),O.push((P=j.imei[0])==null?void 0:P.mac_id)):console.error("IMEI data not found for item:",j)});const C="one",q=O;O.length>0&&A(Cs({type:C,imei:q})),g(L),A(Fs(L)),F(!1),A(Ds({w_customer_id:S}))}else F(!1),console.error("Unexpected data format:",X),le.error("Unexpected data format:")}catch(L){console.error("Error fetching vehicle data:",L),le.error(`Error fetching vehicle data: ${L}`)}},Q=async L=>{const{label:O,imei:X,id:C,reg_id:q,checked:j}=L;_(P=>P.map(w=>w.id===C?{...w,checked:!j}:w));let x=[...H],v=[...H];if(!j)e.forEach(P=>{P.latestDocument.imei===X&&(x.push({label:O,value:P.latestDocument[O==="maininputvoltage"?"mainInputVoltage":O]}),v=x,G(x))});else{let P=H.filter(w=>w.label!==O);v=P,G(P)}console.log("tempParamList",v),A(jt([{reg_id:q,imei:X,params:v}]))},J=u.filter(L=>Object.keys(o).length===0||L.vehicle_group===o.id);return i.jsxs("div",{className:"app",children:[i.jsx(ks,{}),i.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[i.jsx(Bs,{title:"Equipments",setShowVehicles:I,showVehicles:m,setShowVehiclesGroup:R,showVehiclesGroup:b}),i.jsx(qs,{setShowVehiclesGroup:R,showVehiclesGroup:b}),i.jsxs(ae,{style:{display:"flex",width:"100%",height:"95vh"},children:[i.jsx(ae,{style:{width:m||$?"80%":"100%",background:rt.bgShadow},children:i.jsx(_r,{})}),m&&i.jsx(ae,{style:{width:"20%",backgroundColor:n.grey[100]},children:i.jsx(Ts,{vehicleData:J,title:"Live Map",setParameterData:_,loadingVehicle:ie,setShowVehicles:I,showVehicles:m,showParameters:$,setShowParameters:k})}),$&&i.jsx(ae,{style:{width:"20%",backgroundColor:n.grey[100]},children:i.jsx(Ls,{parametersData:y,setParameterData:_,handleParameterChange:Q})})]})]})]})}export{Or as default};
