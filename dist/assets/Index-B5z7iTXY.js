import{w as m,v as N,e as t,j as a,B as d,cO as Q,cP as E,cQ as T,M as Z,cR as F,H as K,cS as W,cT as X,O as Y,a9 as ee,co as ae,ap as G,a4 as se,a5 as te,a7 as re,a8 as oe,C as A,Z as le,a0 as ce,z as ie}from"./index-Diq4l7Dq.js";import{V as ne}from"./VehicleMenu-DXCJds7i.js";import"./Loader-CFovNNvA.js";import"./LiveMapServices-BU2oE7j9.js";import{P as de}from"./Parameters-BeCsG3B9.js";/* empty css           */import"./InspectionsTable-BQKdtZrv.js";import"./index.esm-CF2jjTSD.js";import"./ServiceRecordTable-CclOj0Tb.js";import{S as pe}from"./ServiceJobCardTable-C1ddGA7T.js";import{B as he}from"./BreakDownJobCardTable-CYNsm1XF.js";import{S as ue}from"./ServicesTopBar-CJnfgXXg.js";import"./Autocomplete-DEa_thwn.js";import"./TextField-qTbTcyyL.js";import"./Card-BgTbyo_l.js";import"./CardContent-B_YmKDp8.js";import"./DialogContentText-CkD1EcLh.js";import"./Edit-DxPNcG24.js";import"./formik.esm-BYLq67Ll.js";import"./excelUtils-KMgkXs86.js";function k(o){const{children:p,value:f,index:c,...h}=o;return a.jsx("div",{role:"tabpanel",hidden:f!==c,id:`simple-tabpanel-${c}`,"aria-labelledby":`simple-tab-${c}`,...h,children:f===c&&a.jsx(d,{sx:{p:3},children:p})})}k.propTypes={children:T.node,index:T.number.isRequired,value:T.number.isRequired};function M(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function ge(){const{selectedTabValue:o}=m(c=>c.inspection),p=N();t.useState(0);const f=(c,h)=>{p(Z("")),p(F(h))};return a.jsxs(d,{sx:{width:"100%"},children:[a.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(Q,{value:o,onChange:f,"aria-label":"basic tabs example",children:[a.jsx(E,{label:"Breakdowns",...M(0)}),a.jsx(E,{label:"Services",...M(1)})]})}),a.jsx(k,{value:o,index:0,children:a.jsx(he,{isInspection:!0})}),a.jsx(k,{value:o,index:1,children:a.jsx(pe,{isInspection:!0})})]})}function Ge(){const{locationData:o,selectedVehicle:p,selectedParameterList:f}=m(s=>s.liveMap),{mode:c,selectedVehicleGroup:h}=m(s=>s.dashboard),I=ie(c),[$,O]=t.useState([]),{w_customer_id:v}=m(s=>s.auth),[R,j]=t.useState(),[b,L]=t.useState(!1),[S,J]=t.useState(!1),[_,y]=t.useState([]);t.useState(!0);const[B,C]=t.useState(!1),[q,w]=t.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let r=N();K(),t.useEffect(()=>{r(W()),r(X())},[]),t.useEffect(()=>{U(),r(Y()),r(ee(v)),r(ae())},[]),t.useEffect(()=>{y([]),r(G([{reg_id:"",imei:"",params:[]}]))},[p]);const U=async()=>{try{w(!0);let s=[],i=[];const u=await r(se({w_customer_id:v}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var g,n,D,l;Array.isArray(e.imei)&&e.imei.length>0&&((g=e.imei[0])!=null&&g.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(n=e.imei[0])==null?void 0:n.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(D=e==null?void 0:e.vehicle_model)==null?void 0:D.name,vehicle_group:e==null?void 0:e.vehicle_group}),i.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const V="one",P=i;i.length>0&&r(te({type:V,imei:P})),O(s),r(re(s)),w(!1),r(oe({w_customer_id:v}))}else w(!1),console.error("Unexpected data format:",u),A.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),A.error(`Error fetching vehicle data: ${s}`)}},z=async s=>{const{label:i,imei:u,id:V,reg_id:P,checked:e}=s;j(l=>l.map(x=>x.id===V?{...x,checked:!e}:x));let g=[..._],n=[..._];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(g.push({label:i,value:l.latestDocument[i==="maininputvoltage"?"mainInputVoltage":i]}),n=g,y(g))});else{let l=_.filter(x=>x.label!==i);n=l,y(l)}console.log("tempParamList",n),r(G([{reg_id:P,imei:u,params:n}]))},H=$.filter(s=>Object.keys(h).length===0||s.vehicle_group===h.id);return a.jsxs("div",{className:"app",children:[a.jsx(le,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:L,showVehicles:b,setShowVehiclesGroup:C,showVehiclesGroup:B}),a.jsx(ce,{setShowVehiclesGroup:C,showVehiclesGroup:B}),a.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(d,{style:{width:b||S?"80%":"100%"},children:a.jsx(ge,{})}),b&&a.jsx(d,{style:{width:"20%",backgroundColor:I.grey[100]},children:a.jsx(ne,{vehicleData:H,title:"Inspections",setParameterData:j,loadingVehicle:q,setShowVehicles:L,showVehicles:b,showParameters:S,setShowParameters:J})}),S&&a.jsx(d,{style:{width:"20%",backgroundColor:I.grey[100]},children:a.jsx(de,{parametersData:R,setParameterData:j,handleParameterChange:z})})]})]})]})}export{Ge as default};
