import{r as x,a as ht,g as bt,u as yt,_ as ct,b as h,j as e,s as tt,d as lt,an as Kt,ao as Qt,ap as k,e as Ct,aq as Q,ar as Zt,c as Gt,as as ta,at as Tt,au as It,av as aa,aa as Ft,ab as Wt,o as Ut,p as Z,aw as ea,ax as oa,ay as it,O as at,B as $,v as Yt,az as sa,ad as ra,T as Y,C as nt,z as na,aA as ia,aB as la,aC as ca,aD as Pt,aE as da,aF as pa,aG as Lt,aH as Nt,aI as Ot,ak as ua,aJ as ga,aK as xa,x as zt,aL as va,N as fa,a0 as ha,a1 as ba,a4 as ya,V as St,U as Ca,X as ma}from"./index-D58bEPpO.js";import{L as ja}from"./LiveMapTopBar-B8BYSQUi.js";import{V as $a}from"./VehicleMenu-DmcPzaQ-.js";import{T as Da}from"./TripMap-KRfxf5bR.js";import"./DateTimePicker-2733PP0K.js";import{C as qt}from"./Card-DhsXIvNU.js";import{C as Ba}from"./CardContent-BUgEzqNd.js";/* empty css           */import"./Autocomplete-dSkUzWNC.js";import"./TextField-DenrDSLS.js";import"./esm-CjjiDMUF.js";import"./redTractor-NXgVJyvR.js";import"./EllipsisOutlined-BkLaEQsL.js";function Ra(t){return x.Children.toArray(t).filter(a=>x.isValidElement(a))}function Pa(t){return bt("MuiButtonGroup",t)}const I=ht("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Ma=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],ka=(t,a)=>{const{ownerState:o}=t;return[{[`& .${I.grouped}`]:a.grouped},{[`& .${I.grouped}`]:a[`grouped${k(o.orientation)}`]},{[`& .${I.grouped}`]:a[`grouped${k(o.variant)}`]},{[`& .${I.grouped}`]:a[`grouped${k(o.variant)}${k(o.orientation)}`]},{[`& .${I.grouped}`]:a[`grouped${k(o.variant)}${k(o.color)}`]},{[`& .${I.firstButton}`]:a.firstButton},{[`& .${I.lastButton}`]:a.lastButton},{[`& .${I.middleButton}`]:a.middleButton},a.root,a[o.variant],o.disableElevation===!0&&a.disableElevation,o.fullWidth&&a.fullWidth,o.orientation==="vertical"&&a.vertical]},Aa=t=>{const{classes:a,color:o,disabled:n,disableElevation:v,fullWidth:b,orientation:y,variant:c}=t,g={root:["root",c,y==="vertical"&&"vertical",b&&"fullWidth",v&&"disableElevation"],grouped:["grouped",`grouped${k(y)}`,`grouped${k(c)}`,`grouped${k(c)}${k(y)}`,`grouped${k(c)}${k(o)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return Ct(g,Pa,a)},Ta=tt("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:ka})(({theme:t,ownerState:a})=>h({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},a.variant==="contained"&&{boxShadow:(t.vars||t).shadows[2]},a.disableElevation&&{boxShadow:"none"},a.fullWidth&&{width:"100%"},a.orientation==="vertical"&&{flexDirection:"column"},{[`& .${I.grouped}`]:h({minWidth:40,"&:hover":h({},a.variant==="contained"&&{boxShadow:"none"})},a.variant==="contained"&&{boxShadow:"none"}),[`& .${I.firstButton},& .${I.middleButton}`]:h({},a.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},a.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},a.variant==="text"&&a.orientation==="horizontal"&&{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${I.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="text"&&a.orientation==="vertical"&&{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${I.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="text"&&a.color!=="inherit"&&{borderColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / 0.5)`:Q(t.palette[a.color].main,.5)},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"transparent"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"transparent"},a.variant==="contained"&&a.orientation==="horizontal"&&{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${I.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="contained"&&a.orientation==="vertical"&&{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${I.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="contained"&&a.color!=="inherit"&&{borderColor:(t.vars||t).palette[a.color].dark},{"&:hover":h({},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"currentColor"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${I.lastButton},& .${I.middleButton}`]:h({},a.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},a.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},a.variant==="outlined"&&a.orientation==="horizontal"&&{marginLeft:-1},a.variant==="outlined"&&a.orientation==="vertical"&&{marginTop:-1})})),Ia=x.forwardRef(function(a,o){const n=yt({props:a,name:"MuiButtonGroup"}),{children:v,className:b,color:y="primary",component:c="div",disabled:g=!1,disableElevation:p=!1,disableFocusRipple:N=!1,disableRipple:w=!1,fullWidth:L=!1,orientation:D="horizontal",size:d="medium",variant:S="outlined"}=n,_=ct(n,Ma),R=h({},n,{color:y,component:c,disabled:g,disableElevation:p,disableFocusRipple:N,disableRipple:w,fullWidth:L,orientation:D,size:d,variant:S}),C=Aa(R),A=x.useMemo(()=>({className:C.grouped,color:y,disabled:g,disableElevation:p,disableFocusRipple:N,disableRipple:w,fullWidth:L,size:d,variant:S}),[y,g,p,N,w,L,d,S,C.grouped]),u=Ra(v),E=u.length,O=z=>{const P=z===0,f=z===E-1;return P&&f?"":P?C.firstButton:f?C.lastButton:C.middleButton};return e.jsx(Ta,h({as:c,role:"group",className:lt(C.root,b),ref:o,ownerState:R},_,{children:e.jsx(Kt.Provider,{value:A,children:u.map((z,P)=>e.jsx(Qt.Provider,{value:O(P),children:z},P))})}))});function La(t){return bt("MuiCardActions",t)}ht("MuiCardActions",["root","spacing"]);const Na=["disableSpacing","className"],Oa=t=>{const{classes:a,disableSpacing:o}=t;return Ct({root:["root",!o&&"spacing"]},La,a)},za=tt("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:o}=t;return[a.root,!o.disableSpacing&&a.spacing]}})(({ownerState:t})=>h({display:"flex",alignItems:"center",padding:8},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Sa=x.forwardRef(function(a,o){const n=yt({props:a,name:"MuiCardActions"}),{disableSpacing:v=!1,className:b}=n,y=ct(n,Na),c=h({},n,{disableSpacing:v}),g=Oa(c);return e.jsx(za,h({className:lt(g.root,b),ownerState:c,ref:o},y))});function _a(t){return bt("MuiPagination",t)}ht("MuiPagination",["root","ul","outlined","text"]);const Ea=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function wa(t={}){const{boundaryCount:a=1,componentName:o="usePagination",count:n=1,defaultPage:v=1,disabled:b=!1,hideNextButton:y=!1,hidePrevButton:c=!1,onChange:g,page:p,showFirstButton:N=!1,showLastButton:w=!1,siblingCount:L=1}=t,D=ct(t,Ea),[d,S]=Zt({controlled:p,default:v,name:o,state:"page"}),_=(f,V)=>{p||S(V),g&&g(f,V)},R=(f,V)=>{const dt=V-f+1;return Array.from({length:dt},(mt,F)=>f+F)},C=R(1,Math.min(a,n)),A=R(Math.max(n-a+1,a+1),n),u=Math.max(Math.min(d-L,n-a-L*2-1),a+2),E=Math.min(Math.max(d+L,a+L*2+2),A.length>0?A[0]-2:n-1),O=[...N?["first"]:[],...c?[]:["previous"],...C,...u>a+2?["start-ellipsis"]:a+1<n-a?[a+1]:[],...R(u,E),...E<n-a-1?["end-ellipsis"]:n-a>a?[n-a]:[],...A,...y?[]:["next"],...w?["last"]:[]],z=f=>{switch(f){case"first":return 1;case"previous":return d-1;case"next":return d+1;case"last":return n;default:return null}},P=O.map(f=>typeof f=="number"?{onClick:V=>{_(V,f)},type:"page",page:f,selected:f===d,disabled:b,"aria-current":f===d?"true":void 0}:{onClick:V=>{_(V,z(f))},type:f,page:z(f),selected:!1,disabled:b||f.indexOf("ellipsis")===-1&&(f==="next"||f==="last"?d>=n:d<=1)});return h({items:P},D)}function Va(t){return bt("MuiPaginationItem",t)}const G=ht("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),_t=Gt(e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),Et=Gt(e.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),Ga=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],Ht=(t,a)=>{const{ownerState:o}=t;return[a.root,a[o.variant],a[`size${k(o.size)}`],o.variant==="text"&&a[`text${k(o.color)}`],o.variant==="outlined"&&a[`outlined${k(o.color)}`],o.shape==="rounded"&&a.rounded,o.type==="page"&&a.page,(o.type==="start-ellipsis"||o.type==="end-ellipsis")&&a.ellipsis,(o.type==="previous"||o.type==="next")&&a.previousNext,(o.type==="first"||o.type==="last")&&a.firstLast]},Fa=t=>{const{classes:a,color:o,disabled:n,selected:v,size:b,shape:y,type:c,variant:g}=t,p={root:["root",`size${k(b)}`,g,y,o!=="standard"&&`color${k(o)}`,o!=="standard"&&`${g}${k(o)}`,n&&"disabled",v&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[c]],icon:["icon"]};return Ct(p,Va,a)},Wa=tt("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Ht})(({theme:t,ownerState:a})=>h({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,height:"auto",[`&.${G.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},a.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)})),Ua=tt(aa,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Ht})(({theme:t,ownerState:a})=>h({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,[`&.${G.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${G.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${G.selected}`]:{backgroundColor:(t.vars||t).palette.action.selected,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Q(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${G.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Q(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},[`&.${G.disabled}`]:{opacity:1,color:(t.vars||t).palette.action.disabled,backgroundColor:(t.vars||t).palette.action.selected}}},a.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)},a.shape==="rounded"&&{borderRadius:(t.vars||t).shape.borderRadius}),({theme:t,ownerState:a})=>h({},a.variant==="text"&&{[`&.${G.selected}`]:h({},a.color!=="standard"&&{color:(t.vars||t).palette[a.color].contrastText,backgroundColor:(t.vars||t).palette[a.color].main,"&:hover":{backgroundColor:(t.vars||t).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[a.color].main}},[`&.${G.focusVisible}`]:{backgroundColor:(t.vars||t).palette[a.color].dark}},{[`&.${G.disabled}`]:{color:(t.vars||t).palette.action.disabled}})},a.variant==="outlined"&&{border:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${G.selected}`]:h({},a.color!=="standard"&&{color:(t.vars||t).palette[a.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / 0.5)`:Q(t.palette[a.color].main,.5)}`,backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / ${t.vars.palette.action.activatedOpacity})`:Q(t.palette[a.color].main,t.palette.action.activatedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Q(t.palette[a.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${G.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Q(t.palette[a.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity)}},{[`&.${G.disabled}`]:{borderColor:(t.vars||t).palette.action.disabledBackground,color:(t.vars||t).palette.action.disabled}})})),Ya=tt("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(t,a)=>a.icon})(({theme:t,ownerState:a})=>h({fontSize:t.typography.pxToRem(20),margin:"0 -8px"},a.size==="small"&&{fontSize:t.typography.pxToRem(18)},a.size==="large"&&{fontSize:t.typography.pxToRem(22)})),qa=x.forwardRef(function(a,o){const n=yt({props:a,name:"MuiPaginationItem"}),{className:v,color:b="standard",component:y,components:c={},disabled:g=!1,page:p,selected:N=!1,shape:w="circular",size:L="medium",slots:D={},type:d="page",variant:S="text"}=n,_=ct(n,Ga),R=h({},n,{color:b,disabled:g,selected:N,shape:w,size:L,type:d,variant:S}),C=ta(),A=Fa(R),E=(C?{previous:D.next||c.next||Et,next:D.previous||c.previous||_t,last:D.first||c.first||It,first:D.last||c.last||Tt}:{previous:D.previous||c.previous||_t,next:D.next||c.next||Et,first:D.first||c.first||It,last:D.last||c.last||Tt})[d];return d==="start-ellipsis"||d==="end-ellipsis"?e.jsx(Wa,{ref:o,ownerState:R,className:lt(A.root,v),children:"…"}):e.jsxs(Ua,h({ref:o,ownerState:R,component:y,disabled:g,className:lt(A.root,v)},_,{children:[d==="page"&&p,E?e.jsx(Ya,{as:E,ownerState:R,className:A.icon}):null]}))}),Ha=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Xa=t=>{const{classes:a,variant:o}=t;return Ct({root:["root",o],ul:["ul"]},_a,a)},Ja=tt("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:o}=t;return[a.root,a[o.variant]]}})({}),Ka=tt("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(t,a)=>a.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Qa(t,a,o){return t==="page"?`${o?"":"Go to "}page ${a}`:`Go to ${t} page`}const Za=x.forwardRef(function(a,o){const n=yt({props:a,name:"MuiPagination"}),{boundaryCount:v=1,className:b,color:y="standard",count:c=1,defaultPage:g=1,disabled:p=!1,getItemAriaLabel:N=Qa,hideNextButton:w=!1,hidePrevButton:L=!1,renderItem:D=P=>e.jsx(qa,h({},P)),shape:d="circular",showFirstButton:S=!1,showLastButton:_=!1,siblingCount:R=1,size:C="medium",variant:A="text"}=n,u=ct(n,Ha),{items:E}=wa(h({},n,{componentName:"Pagination"})),O=h({},n,{boundaryCount:v,color:y,count:c,defaultPage:g,disabled:p,getItemAriaLabel:N,hideNextButton:w,hidePrevButton:L,renderItem:D,shape:d,showFirstButton:S,showLastButton:_,siblingCount:R,size:C,variant:A}),z=Xa(O);return e.jsx(Ja,h({"aria-label":"pagination navigation",className:lt(z.root,b),ownerState:O,ref:o},u,{children:e.jsx(Ka,{className:z.ul,ownerState:O,children:E.map((P,f)=>e.jsx("li",{children:D(h({},P,{color:y,"aria-label":N(P.type,P.page,P.selected),shape:d,size:C,variant:A}))},f))})}))});var Mt={},te=Ft;Object.defineProperty(Mt,"__esModule",{value:!0});var Xt=Mt.default=void 0,ae=te(Wt()),wt=e;Xt=Mt.default=(0,ae.default)([(0,wt.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,wt.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");var kt={},ee=Ft;Object.defineProperty(kt,"__esModule",{value:!0});var Jt=kt.default=void 0,oe=ee(Wt()),Vt=e;Jt=kt.default=(0,oe.default)([(0,Vt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,Vt.jsx)("circle",{cx:"12",cy:"12",r:"5"},"1")],"RadioButtonCheckedOutlined");const se="https://cc.wikitrak.in/proxy-3031",re=()=>{var gt,l,m,W;const t=Ut(),{tripList:a,selectedTripData:o,loading:n,trips:v,activeIndex:b,searchText:y,mode:c,isNavigate:g,allTripList:p,trip_payload:N,page:w,total_page:L,total_trips:D}=Z(s=>s.dashboard),{selectedVehicle:d,vehicleList:S}=Z(s=>s.liveMap),{parametersConfiguration:_}=Z(s=>s.tripMonitor),R=Yt(c),[C,A]=x.useState(!1),[u,E]=x.useState({}),[O,z]=x.useState(""),[P,f]=x.useState(null);x.useEffect(()=>{(v==null?void 0:v.length)>0},[v]),x.useEffect(()=>{const s=dt(p);t(ea(s))},[p]),x.useEffect(()=>{!(o.length>0)&&g&&b!==null&&F.length>0&&V(F[b])},[o,g]);const V=async s=>{var j;let r={imei:d.imei,startDate:s.startDate,endDate:s.endDate};const i=await oa(r);((j=i==null?void 0:i.data)==null?void 0:j.documents.length)>0?(t(g(!1)),t(it(i.data.documents[0].data))):(t(g(!1)),t(it([])))},dt=s=>{const r=new Set,i=[];return s.forEach(j=>{const B=at(j.startTime).format("YYYY-MM-DD");r.has(B)||(r.add(B),i.push(B))}),i},mt=(s,r)=>{t(Pt(null)),t(da(s)),t(pa(!1)),O===s?(z(""),f(null)):(z(s),f(r))},F=O===""?p:p.filter(s=>at(s.startTime).format("YYYY-MM-DD")===O),pt=async(s,r)=>{if(t(it(r.data)),t(Pt(s)),t(Lt(r.tripAcreage)),Array.isArray(r==null?void 0:r.data)||r.data.length>5){const i={startDate:r.data[0].createdAt,endDate:r.data[r.data.length-1].createdAt,imei:r.imei};et(i)}},et=async s=>{var r,i,j,B,T,J;try{const U=S.find(M=>{var q,H;return((H=(q=M==null?void 0:M.imei)==null?void 0:q[0])==null?void 0:H.mac_id)===(d==null?void 0:d.imei)});if(!U){console.warn("No matching vehicle found for IMEI:",d==null?void 0:d.imei);return}const Bt=((J=(T=(B=(j=(i=(r=U==null?void 0:U.sub_model)==null?void 0:r.model_modelecu)==null?void 0:i[0])==null?void 0:j.ecu)==null?void 0:B.pid_datasets)==null?void 0:T[0])==null?void 0:J.codes)||[],ot=_.map(M=>{const q=Bt.find(H=>{var vt,ft,At;return((At=(ft=(vt=H==null?void 0:H.pi_code_variable)==null?void 0:vt[0])==null?void 0:ft.short_name)==null?void 0:At.toLowerCase())===M.label.toLowerCase()});return q?{...M,pid:q.code,decodeConfig:q}:{...M}});t(Ot(ot));const st=ot.filter(M=>M.checked);console.log("Selected Parameters:",st);const rt=st.filter(M=>M.pid).map(M=>M.pid.toLowerCase().padStart(4,"0").match(/../g).reverse().join(""));if(rt.length===0){console.warn("No valid PIDs found to fetch data.");return}const xt={pids:rt,startDate:s.startDate,endDate:s.endDate,imei:s.imei};console.log("item",s);const K=(await ua.post(`${se}/pid-data`,xt)).data;if(console.log("Raw Response:",K),K&&typeof K=="object"&&Object.keys(K).length>0){const M={};for(const[q,H]of Object.entries(K))if(Array.isArray(H)&&H.length>0){const vt=H.map(ft=>ga(ft,q,Bt));M[q]=vt}else M[q]=[];console.log("Decoded Data:",M),t(xa(M))}else console.warn("Empty or invalid response received.")}catch(U){console.error("Error fetching PID data:",U)}},ut=s=>{E(s),A(!0)},X=()=>{A(!1),E({})},jt=(s,r)=>{t(la(r));const i={...N,page:r,limit:20};t(ca(i))},$t=s=>{if(Dt(),!Array.isArray(s)||s.length===0)return;const r=s.filter(T=>Array.isArray(T==null?void 0:T.data)&&T.data.length>0);if(r.length===0)return;const i=r.reduce((T,J)=>T+(J.tripAcreage||0),0);console.log("Total acreage",i),t(it([])),t(Pt("all")),t(Lt(i));const j=r[r.length-1],B={startDate:j.data[j.data.length-1].createdAt,endDate:r[0].data[0].createdAt,imei:r[0].imei};console.log("pidRequestData",B),et(B)},Dt=()=>{const s=[..._].map(r=>({...r,value:0}));t(Ot(s))};return e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsxs($,{sx:{m:"10px"},children:[e.jsx($,{sx:{color:R.grey[400]},children:"Select Date"}),e.jsx($,{sx:{mt:1},children:e.jsx(sa,{})})]}),n?e.jsx("div",{style:{width:"100%",margin:"38%"},children:e.jsx(ra,{})}):e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsx($,{sx:{display:"flex",overflowX:"auto",gap:"10px",paddingBottom:"5px"},children:p&&(p==null?void 0:p.length)>0?e.jsx(e.Fragment,{}):e.jsx(Y,{sx:{width:"100%",mt:"50%",textAlign:"center"},children:"Sorry! No Trips Found"})})}),p&&(p==null?void 0:p.length)>0&&e.jsx($,{ml:2,display:"flex",gap:1,sx:{width:"90%"},children:e.jsxs(Ia,{variant:"outlined","aria-label":"Loading button group",sx:{width:"100%",color:"black"},children:[e.jsx(nt,{sx:{width:"50%",color:"#333333",border:"1px solid #C0C0C0"},children:"Total Trips"}),e.jsx(nt,{sx:{width:"50%",color:"white",border:"1px solid #C0C0C0",backgroundColor:"#C0C0C0"},children:D})]})}),p&&(p==null?void 0:p.length)>0&&e.jsx(Za,{page:w,count:L,sx:{m:2,width:"90%"},onChange:jt}),e.jsxs($,{sx:{height:"75vh",width:"100%",overflowY:"auto"},children:[e.jsx($,{display:"flex",gap:1,marginLeft:2,children:v.map((s,r)=>e.jsx($,{children:e.jsx(nt,{onClick:()=>{mt(s,r)},style:{backgroundColor:P===r?R.grey[300]:" #D5D5D5",color:"black",height:"35px",fontWeight:700,fontSize:"12px",width:"90px",marginTop:"10px"},children:s})},r))}),F&&F.length>0&&e.jsx(nt,{variant:b==="all"?"contained":"outlined",sx:{width:"92%",m:"10px 15px",p:1,backgroundColor:b==="all"?na.bgColor:"transparent"},onClick:()=>{$t(F)},children:"Select All trips"})," ",F&&F.length>0&&F.map((s,r)=>{var B,T,J,U;const i=(T=(B=s==null?void 0:s.startLocation)==null?void 0:B.address)==null?void 0:T.address,j=(U=(J=s==null?void 0:s.endLocation)==null?void 0:J.address)==null?void 0:U.address;return i&&`${i.town||i.city||""}`,j&&`${j.town||j.city||""}`,e.jsx(ne,{trip:s,index:r,openModal:ut,handleTripData:pt,activeIndex:b})})]})]})]}),e.jsx(ia,{open:C,onClose:X,children:e.jsxs(qt,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"40%",bgcolor:"background.paper",boxShadow:24,p:4},children:[e.jsxs(Ba,{children:[e.jsx(Y,{variant:"h6",component:"div",children:"Trip Details"}),e.jsxs(Y,{sx:{mt:2},children:[e.jsx("strong",{children:"Start Location:"})," ",((l=(gt=u==null?void 0:u.startLocation)==null?void 0:gt.address)==null?void 0:l.display_name)||"N/A"]}),e.jsxs(Y,{sx:{mt:2},children:[e.jsx("strong",{children:"End Location:"})," ",((W=(m=u==null?void 0:u.endLocation)==null?void 0:m.address)==null?void 0:W.display_name)||"N/A"]}),e.jsxs(Y,{sx:{mt:2},children:[e.jsx("strong",{children:"Start Time:"})," ",u!=null&&u.startTime?at(new Date(u.startTime).toISOString()).format("MMMM Do YYYY, h:mm:ss A"):"N/A"]}),e.jsxs(Y,{sx:{mt:2},children:[e.jsx("strong",{children:"End Time:"})," ",u!=null&&u.endTime?at(new Date(u.endTime).toISOString()).format("MMMM Do YYYY, h:mm:ss A"):"N/A"]})]}),e.jsx(Sa,{children:e.jsx(nt,{onClick:X,children:"Close"})})]})})]})},ne=({trip:t,index:a,openModal:o,handleTripData:n,activeIndex:v})=>e.jsxs(qt,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",m:2,px:1,py:1,borderRadius:2,border:"1px solid #DDDDDD",cursor:"pointer",backgroundColor:v===a?"#e8edea":"undefined"},onClick:()=>n(a,t),children:[e.jsxs($,{sx:{width:40,textAlign:"center"},children:[e.jsx(Y,{variant:"caption",color:"text.secondary",children:"Trip"}),e.jsx(Y,{variant:"subtitle2",fontWeight:"bold",children:a+1})]}),e.jsx(Nt,{orientation:"vertical",flexItem:!0}),e.jsxs($,{sx:{flex:1,mx:2},children:[e.jsxs($,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(Jt,{sx:{color:"#BFBEBE"}}),e.jsx($,{sx:{flex:1,borderTop:"1px dashed #DDDDDD",mx:1.5}}),e.jsx(Xt,{sx:{color:"red"}})]}),e.jsxs($,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(Y,{variant:"caption",children:t.startTime?at(t.startTime).format("HH:mm:ss A"):"NA"}),e.jsx(Y,{variant:"caption",children:t.startTime?at(t.endTime).format("HH:mm:ss A"):"NA"})]})]}),e.jsx(Nt,{orientation:"vertical",flexItem:!0}),e.jsx($,{children:e.jsx(Y,{variant:"body2",color:"primary",sx:{cursor:"pointer",m:1},onClick:()=>o(t),children:"See More"})})]},t.id);function Ce(){const{w_customer_id:t}=Z(l=>l.auth),{collapsed:a}=Z(l=>l.auth),{mode:o,selectedVehicleGroup:n}=Z(l=>l.dashboard),{vehicleList:v,selectedVehicle:b,onlineVehicle:y,locationData:c}=Z(l=>l.liveMap),[g,p]=x.useState(!1),[N,w]=x.useState(!0),[L,D]=x.useState([]),[d,S]=x.useState(!0),[_,R]=x.useState(""),[C,A]=x.useState(""),[u,E]=x.useState(""),[O,z]=x.useState(""),[P,f]=x.useState([]),[V,dt]=x.useState({lat:18.516726,lng:73.856255}),[mt,F]=x.useState([]),[pt,et]=x.useState(!1),ut=Yt(o);let X=Ut();x.useEffect(()=>{X(it([])),jt()},[]),x.useEffect(()=>{var W,s,r;const l=zt().subtract(5,"day").startOf("day").toISOString(),m=zt().endOf("day").toISOString();X(va({startDate:l,endDate:m})),Object.keys(b).length===0&&v.length>0&&X(fa({imei:(s=(W=v[0])==null?void 0:W.imei[0])==null?void 0:s.mac_id,reg_id:(r=v[0])==null?void 0:r.registration_id}))},[b,v]);const jt=async()=>{try{let l=[],m=[];const W=await X(ha({w_customer_id:t}));if(Array.isArray(W.payload)){W.payload.forEach(i=>{var j,B,T;Array.isArray(i.imei)&&i.imei.length>0&&((j=i.imei[0])!=null&&j.mac_id)?(l.push({id:i.id,label:i.registration_id,value:(B=i.imei[0])==null?void 0:B.mac_id,workShop:i==null?void 0:i.workshop,vehicle_group:i==null?void 0:i.vehicle_group}),m.push((T=i.imei[0])==null?void 0:T.mac_id)):console.error("IMEI data not found for item:",i)});const s="one",r=m;m.length>0&&X(ba({type:s,imei:r})),X(ya({w_customer_id:t})),D(l)}else console.error("Unexpected data format:",W),St.error("Unexpected data format:")}catch(l){console.error("Error fetching vehicle data:",l),St.error(`Error fetching vehicle data: ${l}`)}},$t=l=>c==null?void 0:c.some(m=>String(m.latestDocument.imei)===String(l)&&m.latestDocument.speed>0&&(m.latestDocument.ignition===!0||m.latestDocument.ignition===1)),Dt=l=>c==null?void 0:c.some(m=>String(m.latestDocument.imei)===String(l)&&m.latestDocument.speed<=0&&(m.latestDocument.ignition===!0||m.latestDocument.ignition===1)),gt=L.filter(l=>{var ot,st,rt,xt,Rt;if(!(Object.keys(n).length===0||l.vehicle_group===n.id))return!1;const W=(ot=l==null?void 0:l.label)==null?void 0:ot.toLowerCase().includes(_.toLowerCase()),s=O===""||((st=l==null?void 0:l.workShop)==null?void 0:st.region)===O,r=u===""||((xt=(rt=l==null?void 0:l.workShop)==null?void 0:rt.state)==null?void 0:xt.toLowerCase())===(((Rt=u==null?void 0:u.toString())==null?void 0:Rt.toLowerCase())||""),i=l.value,j=String(l.value).toLowerCase(),B=y.some(K=>String(K).toLowerCase()===j),T=!y.some(K=>String(K).toLowerCase()===j),J=B&&$t(i),U=B&&Dt(i);return W&&s&&r&&(C==="online"?B:C==="offline"?T:C==="running"?J:C==="idling"?U:!0)}).sort((l,m)=>l.label.localeCompare(m.label));return e.jsxs("div",{className:"app",children:[e.jsx(Ca,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(ja,{title:"Trip Monitor",setShowVehicles:p,showVehicles:g,setShowCard:w,showCard:N,sideBarTrip:d,setSideBarTrip:S,setShowVehiclesGroup:et,showVehiclesGroup:pt}),e.jsx(ma,{setShowVehiclesGroup:et,showVehiclesGroup:pt,where:"tripmonitor"}),e.jsxs($,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx($,{sx:{width:g||d?"80%":"100%",height:"50px"},children:e.jsx(Da,{center:V,showCard:N})}),g&&e.jsx($,{style:{width:"20%",backgroundColor:ut.grey[100]},children:e.jsx($a,{vehicleData:gt,setShowVehicles:p,showVehicles:g,title:"Live Monitor",setSearchedTerm:R,setOptions:A,setState:E,setRegion:z,searchTerm:_,options:C,state:u,region:O,setSideBarTrip:S})}),e.jsx($,{style:{width:a?"22%":"20%",display:d?"block":"none",backgroundColor:ut.grey[100]},children:e.jsx(re,{})})]})]})]})}export{Ce as default};
