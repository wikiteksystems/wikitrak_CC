import{a$ as v,a_ as $,b as t,j as a,aW as d,eM as W,eN as C,aT as T,bf as F,f9 as K,bb as Q,fa as X,fb as Y,bh as Z,bB as ee,fc as ae,bH as A,bw as se,bx as te,bz as re,bA as oe,b7 as G,bq as le,bs as ne,b5 as ce}from"./index-C_fl7o4d.js";import{V as ie}from"./VehicleMenu-BNp23o60.js";import{P as de}from"./Parameters-D68vMp5z.js";/* empty css           */import"./index.esm-CrGCYPLO.js";import{S as he}from"./ServiceJobCardTable-DiNh2Xr5.js";import{B as pe}from"./BreakDownJobCardTable-B2TDZ2wU.js";import{S as ue}from"./ServicesTopBar-Dk8OMCSa.js";import"./Autocomplete-DQzPwokd.js";import"./formik.esm-CkDNdtUO.js";import"./Remove-Db7Q6F84.js";import"./excelUtils-XEzm5y4L.js";import"./Edit-BDSp-1tk.js";function k(o){const{children:h,value:f,index:n,...p}=o;return a.jsx("div",{role:"tabpanel",hidden:f!==n,id:`simple-tabpanel-${n}`,"aria-labelledby":`simple-tab-${n}`,...p,children:f===n&&a.jsx(d,{sx:{p:3},children:h})})}k.propTypes={children:T.node,index:T.number.isRequired,value:T.number.isRequired};function N(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function be(){const{selectedTabValue:o}=v(n=>n.inspection),h=$();t.useState(0);const f=(n,p)=>{h(F("")),h(K(p))};return a.jsxs(d,{sx:{width:"100%"},children:[a.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(W,{value:o,onChange:f,"aria-label":"basic tabs example",children:[a.jsx(C,{label:"Breakdowns",...N(0)}),a.jsx(C,{label:"Services",...N(1)})]})}),a.jsx(k,{value:o,index:0,children:a.jsx(pe,{isInspection:!0})}),a.jsx(k,{value:o,index:1,children:a.jsx(he,{isInspection:!0})})]})}function Te(){const{locationData:o,selectedVehicle:h,selectedParameterList:f}=v(s=>s.liveMap),{mode:n,selectedVehicleGroup:p}=v(s=>s.dashboard),I=ce(n),[M,q]=t.useState([]),{w_customer_id:m}=v(s=>s.auth),[J,j]=t.useState(),[x,L]=t.useState(!1),[_,R]=t.useState(!1),[S,y]=t.useState([]);t.useState(!0);const[B,E]=t.useState(!1),[O,w]=t.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let r=$();Q(),t.useEffect(()=>{r(X()),r(Y())},[]),t.useEffect(()=>{U(),r(Z()),r(ee(m)),r(ae())},[]),t.useEffect(()=>{y([]),r(A([{reg_id:"",imei:"",params:[]}]))},[h]);const U=async()=>{try{w(!0);let s=[],c=[];const u=await r(se({w_customer_id:m}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var b,i,D,l;Array.isArray(e.imei)&&e.imei.length>0&&((b=e.imei[0])!=null&&b.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(i=e.imei[0])==null?void 0:i.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(D=e==null?void 0:e.vehicle_model)==null?void 0:D.name,vehicle_group:e==null?void 0:e.vehicle_group}),c.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const V="one",P=c;c.length>0&&r(te({type:V,imei:P})),q(s),r(re(s)),w(!1),r(oe({w_customer_id:m}))}else w(!1),console.error("Unexpected data format:",u),G.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),G.error(`Error fetching vehicle data: ${s}`)}},z=async s=>{const{label:c,imei:u,id:V,reg_id:P,checked:e}=s;j(l=>l.map(g=>g.id===V?{...g,checked:!e}:g));let b=[...S],i=[...S];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(b.push({label:c,value:l.latestDocument[c==="maininputvoltage"?"mainInputVoltage":c]}),i=b,y(b))});else{let l=S.filter(g=>g.label!==c);i=l,y(l)}console.log("tempParamList",i),r(A([{reg_id:P,imei:u,params:i}]))},H=M.filter(s=>Object.keys(p).length===0||s.vehicle_group===p.id);return a.jsxs("div",{className:"app",children:[a.jsx(le,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:L,showVehicles:x,setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsx(ne,{setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(d,{style:{width:x||_?"80%":"100%"},children:a.jsx(be,{})}),x&&a.jsx(d,{style:{width:"20%",backgroundColor:I.grey[100]},children:a.jsx(ie,{vehicleData:H,title:"Inspections",setParameterData:j,loadingVehicle:O,setShowVehicles:L,showVehicles:x,showParameters:_,setShowParameters:R})}),_&&a.jsx(d,{style:{width:"20%",backgroundColor:I.grey[100]},children:a.jsx(de,{parametersData:J,setParameterData:j,handleParameterChange:z})})]})]})]})}export{Te as default};
