import{j as s,G as R,y as O,z as S,b as i,I as z,aB as N,ba as V,bb as Y,b9 as Z,C as y,ad as J,aZ as K,bv as Q,P as X}from"./index-D4iVSzVY.js";import{D as ee,a as se,b as ae,c as te}from"./DialogTitle-Doe521zb.js";import{D as oe,E as ne,T as U}from"./Edit-ROSlukWy.js";import{B as w}from"./CircularProgress-Cwyu3UN0.js";import{T as re,a as le,b as ce,c as $,d as l,e as ie}from"./TableRow-BVmcoVxJ.js";import{T as de}from"./TablePagination-C0ybdT36.js";const ue=({open:o,onClose:n,onConfirm:d})=>s.jsxs(ee,{open:o,onClose:n,children:[s.jsx(se,{children:"Confirm Deletion"}),s.jsx(ae,{children:s.jsxs(oe,{children:["Are you sure you want to delete this vehicle data?"," ",s.jsx("span",{style:{color:"red"},children:"This action cannot be undone."})]})}),s.jsxs(te,{children:[s.jsx(R,{onClick:n,color:"primary",children:"Cancel"}),s.jsx(R,{onClick:d,color:"secondary",children:"Delete"})]})]}),pe="https://cc.wikitrak.in/api-proxy/api/v1",he={display:"flex",alignItems:"left",justifyContent:"left",gap:"8px"},xe=({inspectionData:o})=>{const n=O(),{isUpdateInspection:d}=S(r=>r.inspection),[D,u]=i.useState(!1),k=()=>{console.log("inspectionData",o);const r=localStorage.getItem("role");N.includes(r)?(n(V(!d)),n(Y(o)),n(Z(o))):y.error(`Sorry! Your role is ${r}. You're not allowed to add, edit or delete the vehicle`)},p=async()=>{console.log("Vehicle data deleting");try{await J.delete(`${pe}/vehicles/delete/${vehicleData.id}/`),y.success("Vehicle data deleted successfully!"),n(K())}catch(r){console.error("Error deleting vehicle data:",r),y.error("Failed to delete vehicle data. Please try again.")}u(!1)},_=()=>{u(!1)},h={color:"#686868"};return s.jsxs(w,{sx:he,children:[s.jsx(z,{onClick:k,children:s.jsx(ne,{sx:h})}),s.jsx(ue,{open:D,onClose:_,onConfirm:p})]})},ge=[{id:"BDID",label:"BDID"},{id:"User",label:"User"},{id:"SubmissionDate",label:"Submission Date"},{id:"WorkshopGroup",label:"Workshop Group"},{id:"Status",label:"Status"}],be=({where:o})=>{S(e=>e.breakdown);const n=O(),{searchTerm:d,inspectionHistory:D}=S(e=>e.inspection),[u,k]=i.useState("asc"),[p,_]=i.useState("BDID"),[h,r]=i.useState(0),[g,F]=i.useState(5),[H,fe]=i.useState({id:"",status:"",workshop:"",user:""});i.useEffect(()=>{n(Q({}))},[]);const M=e=>{k(p===e&&u==="asc"?"desc":"asc"),_(e)},G=(e,t)=>{r(t)},W=e=>{F(parseInt(e.target.value,10)),r(0)},P=((e,t,x)=>e.filter(a=>{var v,B,I,L,m,A,E;const c=x.toLowerCase(),b=(v=a==null?void 0:a.breakdown_id)==null?void 0:v.toLowerCase().includes(c),f=`${(I=(B=a==null?void 0:a.user)==null?void 0:B.us_user)==null?void 0:I.first_name} ${(m=(L=a==null?void 0:a.user)==null?void 0:L.us_user)==null?void 0:m.last_name}`.toLowerCase().includes(c),j=(A=a==null?void 0:a.status)==null?void 0:A.toLowerCase().includes(c),C=(E=a==null?void 0:a.workshop_group)==null?void 0:E.group_name.toLowerCase().includes(c);return!(x&&!(b||f||j||C)||t.id&&!a.breakdown_id.includes(t.id)||t.status&&a.status!==t.status||t.workshop&&a.workshop_group.group_name!==t.workshop||t.user&&!a.user.us_user.first_name.toLowerCase().includes(t.user.toLowerCase())&&!a.user.us_user.last_name.toLowerCase().includes(t.user.toLowerCase()))}))(D.slice(),H,d),q=P.slice(h*g,h*g+g),T={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"};return s.jsx(w,{sx:{m:o!=="inspection report"&&"10px",width:o==="inspection report"?"60%":"99%"},children:s.jsxs(X,{children:[s.jsx(re,{sx:{height:o==="inspection report"?"50vh":"60vh",bgcolor:"white",borderRadius:"10px"},children:s.jsxs(le,{stickyHeader:!0,children:[s.jsx(ce,{children:s.jsxs($,{children:[ge.map(e=>s.jsx(l,{sx:T,children:s.jsx(U,{active:p===e.id,direction:p===e.id?u:"asc",onClick:()=>M(e.id),children:e.label})},e.id)),o!=="inspection report"&&s.jsx(l,{sx:T,children:s.jsx(U,{children:"Actions"})})]})}),s.jsx(ie,{children:q.map((e,t)=>{var x,a,c,b,f,j,C;return s.jsxs($,{children:[s.jsx(l,{children:((x=e==null?void 0:e.breakdown)==null?void 0:x.breakdown_id)||"N/A"}),s.jsx(l,{children:`${(c=(a=e==null?void 0:e.submitted_by)==null?void 0:a.us_user)==null?void 0:c.first_name} ${(f=(b=e==null?void 0:e.submitted_by)==null?void 0:b.us_user)==null?void 0:f.last_name}`}),s.jsx(l,{children:((j=e==null?void 0:e.breakdown)==null?void 0:j.submission_date)||"N/A"}),s.jsx(l,{children:(C=e==null?void 0:e.workshop_group)==null?void 0:C.group_name}),s.jsx(l,{sx:{color:e.status==="Open"?"blue":e.status==="Close"?"green":"red"},children:e.status}),o!=="inspection report"&&s.jsx(l,{children:s.jsx(xe,{inspectionData:e})})]},t)})})]})}),s.jsx(de,{component:"div",count:P.length,page:h,onPageChange:G,rowsPerPage:g,onRowsPerPageChange:W,rowsPerPageOptions:[5,10,15]})]})})},Pe=be;export{Pe as I};
