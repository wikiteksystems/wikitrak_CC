import{b as g,j as e,aX as _,T as Ee,bd as X,b8 as P,b0 as k,a$ as F,bc as je,dU as be,cg as ve,dV as Se,dW as ye,dX as H,dY as n,dZ as Te,ei as de,bm as ke,cb as Ae,b9 as oe,eC as Z,eD as E,bZ as _e,eE as Ce,eF as De,bw as Ne,bn as U,eG as Oe,eH as he,eI as xe,eJ as ze,eK as pe,eL as ge,eM as fe,eN as Ie,bx as $e,by as Re,bz as me,bB as Me,bD as Ye,br as Ge,bs as Be,bt as We,eO as Pe,b6 as Fe}from"./index-DwbBqXE5.js";import{D as Ve}from"./jspdf.plugin.autotable-CyNqMJGA.js";import"./index.esm-C6Iki90P.js";import{u as K,w as He}from"./xlsx-D5JNrnKm.js";function Le({handleBack:V,downloadData:T}){g.useEffect(()=>{},[T]);const v=()=>{if(T.length===0){P.error("No data available for download.");return}const o=K.json_to_sheet(T),d=K.book_new();K.book_append_sheet(d,o,"Sheet1"),He(d,"Report.xlsx"),P.success("Excel file downloaded successfully!")};return e.jsx(_,{sx:{backgroundColor:"white",mb:2,display:"flex",textAlign:"center",justifyContent:"end",alignItems:"center",padding:"10px 20px",borderRadius:"8px",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.1)"},children:e.jsxs(_,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ee,{sx:{fontWeight:"bold",mr:1},children:"Download In:"}),e.jsx(X,{variant:"outlined",onClick:v,sx:{borderColor:"green",color:"green","&:hover":{backgroundColor:"green",color:"white"}},children:"EXCEL"})]})})}function Ke({tableData:V}){const{vehicleList:T}=k(l=>l.liveMap),v=F(),o=je();console.log("tableData: ",V);let d=l=>T.find(p=>{var i;return((i=p==null?void 0:p.imei[0])==null?void 0:i.mac_id)==l||""});const s=l=>{var p;v(ke({imei:l==null?void 0:l.imei,reg_id:(p=d(l.imei))==null?void 0:p.registration_id})),v(Ae({startDate:oe(l.date).startOf("day").toISOString(),endDate:oe(l.date).endOf("day").toISOString()})),o("/trip-monitor?source=TripDetail")};return e.jsx(be,{component:ve,sx:{maxHeight:"70vh"},children:e.jsxs(Se,{stickyHeader:!0,"aria-label":"simple table",children:[e.jsx(ye,{children:e.jsxs(H,{children:[e.jsx(n,{align:"left",children:"Date"}),e.jsx(n,{align:"left",children:"Vehicle Name"}),e.jsx(n,{align:"left",children:"Start location"}),e.jsx(n,{align:"left",children:"End location"}),e.jsx(n,{align:"left",children:"Segment"}),e.jsx(n,{align:"left",children:"Operator"}),e.jsx(n,{align:"left",children:"Work done (acre)"}),e.jsx(n,{align:"left",children:"Engine hours"}),e.jsx(n,{align:"left",children:"Running Time"}),e.jsx(n,{align:"left",children:"Idle time"}),e.jsx(n,{align:"left",children:"Total Distance (km)"}),e.jsx(n,{align:"left",children:"Average Speed"}),e.jsx(n,{align:"left",children:"View Trips"})]})}),e.jsx(Te,{children:V.map((l,p)=>{var i,u,C,f,S,A,j;return e.jsxs(H,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(n,{align:"left",children:l.date}),e.jsx(n,{align:"left",children:(i=d(l.imei))==null?void 0:i.registration_id}),e.jsx(n,{align:"left",sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.jsx(de,{title:((u=l==null?void 0:l.startLocationName)==null?void 0:u.display_name)||(l==null?void 0:l.startLocationName)||"",children:e.jsx("span",{children:((C=l==null?void 0:l.startLocationName)==null?void 0:C.display_name)||(l==null?void 0:l.startLocationName)||""})})}),e.jsx(n,{align:"left",sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.jsx(de,{title:((f=l==null?void 0:l.endLocationName)==null?void 0:f.display_name)||(l==null?void 0:l.endLocationName)||"",children:e.jsx("span",{children:((S=l==null?void 0:l.endLocationName)==null?void 0:S.display_name)||(l==null?void 0:l.endLocationName)||""})})}),e.jsx(n,{align:"left",children:(A=d(l.imei))==null?void 0:A.segment}),e.jsx(n,{align:"left",children:(j=d(l.imei))==null?void 0:j.customer_name}),e.jsx(n,{align:"left",children:l.acreageStr}),e.jsx(n,{align:"left",children:l.engineHours}),e.jsx(n,{align:"left",children:l.runningTime}),e.jsx(n,{align:"left",children:l.idleTime}),e.jsx(n,{align:"left",children:l.totalDistance}),e.jsx(n,{align:"left",children:l.averageSpeed}),e.jsx(n,{align:"left",children:e.jsx(_,{sx:{color:"primary.main",cursor:"pointer",display:"inline-flex",alignItems:"center",padding:"4px 8px",borderRadius:"4px",border:"1px solid",borderColor:"primary.main","&:hover":{backgroundColor:"primary.light",color:"white",borderColor:"primary.dark"}},onClick:()=>s(l),children:"View on Map 🔍"})})]},p+1)})})]})})}function Ue({handleBack:V,setStartDate:T,startDate:v,setEndDate:o,endDate:d}){const s=F(),{vehicleGroup:l,vehicleList:p}=k(h=>h.liveMap),{vehicleStatesData:i,loading:u,selectedGroup:C,selectedVehicle:f,distributorList:S}=k(h=>h.report),[A,j]=g.useState([]);g.useState([]);const[N,O]=g.useState([]);g.useEffect(()=>{},[u]),g.useEffect(()=>{if(l&&l.length>0){let h=l.map(c=>({...c,label:c.group_name,value:c.id}));j(h)}},[l,p,S]),g.useEffect(()=>{},[v,d]);let R=h=>p.find(c=>{var y;return((y=c==null?void 0:c.imei[0])==null?void 0:y.mac_id)==h||""});g.useEffect(()=>{let h=(i==null?void 0:i.data)&&i.data.map(c=>{var G,$;let{customer_name:y,registration_id:B,segment:W}=R(c==null?void 0:c.imei);return{Date:c.date,vehicle:B,"Start Location":(G=c==null?void 0:c.startLocationName)==null?void 0:G.display_name,"End Location":($=c==null?void 0:c.endLocationName)==null?void 0:$.display_name,operator:y,segment:W,"Work Done":c==null?void 0:c.acreageStr,"Running Time":c.runningTime,"Idle Time":c.idleTime,"Engine hours":c.engineHours,"Total Distance (km)":c.totalDistance,"Average Speed":c.averageSpeed}});O(h)},[i]),g.useEffect(()=>{f||s(Z())},[]);function m(h){console.log("value changed",h),s(Ce(h))}function b(h){s(De(h))}const z=async()=>{const h=`${v} 00:00`,c=`${d} 23:59`;if(!I())return;s(Ne({imei:f,startTime:h,endTime:c}))},I=()=>!v||!d||f==="all"?(P.error("Please select start date, end date, and vehicle."),!1):!0,M=C==="All"?p:p.filter(h=>h.vehicle_group===C);return e.jsxs(_,{sx:{width:"100%",m:"auto"},children:[e.jsx(_,{sx:{ml:"10px"},children:e.jsx(Le,{handleBack:V,downloadData:N})}),e.jsxs(_,{children:[e.jsxs(E,{size:"large",value:C,showSearch:!0,style:{width:200,margin:"10px"},placeholder:"Select vehicle group",optionFilterProp:"children",onChange:m,filterOption:(h,c)=>{var y;return typeof((y=c==null?void 0:c.props)==null?void 0:y.children)=="string"&&c.props.children.toLowerCase().indexOf(h.toLowerCase())>=0},children:[e.jsx(E.Option,{value:"All",children:"All"}),A.map((h,c)=>e.jsx(E.Option,{value:h.value,children:h.label},c))]}),e.jsxs(E,{size:"large",value:f,showSearch:!0,style:{width:200,margin:"10px"},placeholder:"Select vehicle",optionFilterProp:"children",onChange:b,filterOption:(h,c)=>{var y;return typeof((y=c==null?void 0:c.props)==null?void 0:y.children)=="string"&&c.props.children.toLowerCase().indexOf(h.toLowerCase())>=0},children:[e.jsx(E.Option,{value:"all",children:"None"},"all"),M&&M.length>0&&M.map((h,c)=>{var y;return e.jsx(E.Option,{value:(y=h.imei[0])==null?void 0:y.mac_id,children:h.registration_id},c)})]}),e.jsx(Ve,{setStartDate:T,setEndDate:o,selectedDate:!1,startDate:v,endDate:d}),e.jsx(X,{variant:"contained",style:{width:200,marginLeft:"10px",backgroundColor:"#43556C"},onClick:z,disabled:!f,children:"Generate report"})]}),u&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1050},children:e.jsx(_e,{})}),(i==null?void 0:i.data)&&(i==null?void 0:i.data.length)>0&&e.jsx(_,{ml:1.5,children:e.jsx(Ke,{tableData:(i==null?void 0:i.data)||[]})})]})}function Xe({tableData:V}){const{vehicleList:T}=k(s=>s.liveMap);F(),je();let v=s=>T.find(l=>{var p;return((p=l==null?void 0:l.imei[0])==null?void 0:p.mac_id)==s||""});const o=(s,l)=>l.find(i=>{var u;return((u=i==null?void 0:i.name)==null?void 0:u.toLowerCase().trim())===s})||null,d={fontSize:"12px",fontWeight:"bold"};return e.jsx(be,{component:ve,sx:{maxHeight:"70vh"},children:e.jsxs(Se,{stickyHeader:!0,"aria-label":"simple table",children:[e.jsx(ye,{children:e.jsxs(H,{children:[e.jsx(n,{align:"left",sx:d,children:"Date"}),e.jsx(n,{align:"left",sx:d,children:"Vehicle Name"}),e.jsx(n,{align:"left",sx:d,children:"Batch No"}),e.jsx(n,{align:"left",sx:d,children:"Start Time"}),e.jsx(n,{align:"left",sx:d,children:"End Time"}),e.jsx(n,{align:"left",sx:d,children:"Total Target Weight"}),e.jsx(n,{align:"left",sx:d,children:"Total Achieved Weight"}),e.jsx(n,{align:"left",sx:d,children:"Recipe 1"}),e.jsx(n,{align:"left",sx:d,children:"Cement"}),e.jsx(n,{align:"left",sx:d,children:"10mm"}),e.jsx(n,{align:"left",sx:d,children:"20mm"}),e.jsx(n,{align:"left",sx:d,children:"Sand"}),e.jsx(n,{align:"left",sx:d,children:"Crush Sand"}),e.jsx(n,{align:"left",sx:d,children:"River Sand"}),e.jsx(n,{align:"left",sx:d,children:"Fly Ash"}),e.jsx(n,{align:"left",sx:d,children:"30mm"}),e.jsx(n,{align:"left",sx:d,children:"Water"}),e.jsx(n,{align:"left",sx:d,children:"Admix"})]})}),e.jsx(Te,{children:V.map((s,l)=>{var p,i,u,C,f,S,A,j,N,O,R,m,b,z,I,M,h,c,y,B,W,G,$,r,t,x,a,L,D,Y,J,q,Q,w,ee,ae,le,se,te,ne,re,ce,ie;return e.jsxs(H,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:(s==null?void 0:s.date)&&U(s==null?void 0:s.date,"DDMMYYYY").format("DD-MM-YYYY")||"-"}),e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:(p=v(s.imei))==null?void 0:p.registration_id}),e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:s.batch_no}),e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:s.start_time}),e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:s==null?void 0:s.end_time}),e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:(i=s==null?void 0:s.total_target)==null?void 0:i.replace(/^0+/,"")}),e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:(u=s==null?void 0:s.totalAcheived)==null?void 0:u.replace(/^0+/,"")}),e.jsx(n,{align:"left",sx:{fontSize:"10px"},children:s==null?void 0:s.mix_name}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(f=(C=o("cement",s.materials||[]))==null?void 0:C.target)==null?void 0:f.replace(/^0+/,""),":",(A=(S=o("cement",s.materials||[]))==null?void 0:S.actual)==null?void 0:A.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(N=(j=o("10 mm",s.materials||[]))==null?void 0:j.target)==null?void 0:N.replace(/^0+/,""),":",(R=(O=o("10 mm",s.materials||[]))==null?void 0:O.actual)==null?void 0:R.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(b=(m=o("20 mm",s.materials||[]))==null?void 0:m.target)==null?void 0:b.replace(/^0+/,""),":",(I=(z=o("20 mm",s.materials||[]))==null?void 0:z.actual)==null?void 0:I.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(h=(M=o("sand",s.materials||[]))==null?void 0:M.target)==null?void 0:h.replace(/^0+/,""),":",(y=(c=o("sand",s.materials||[]))==null?void 0:c.actual)==null?void 0:y.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(W=(B=o("crush sand",s.materials||[]))==null?void 0:B.target)==null?void 0:W.replace(/^0+/,""),":",($=(G=o("crush sand",s.materials||[]))==null?void 0:G.actual)==null?void 0:$.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(t=(r=o("river sand",s.materials||[]))==null?void 0:r.target)==null?void 0:t.replace(/^0+/,""),":",(a=(x=o("river sand",s.materials||[]))==null?void 0:x.actual)==null?void 0:a.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(D=(L=o("fly ash",s.materials||[]))==null?void 0:L.target)==null?void 0:D.replace(/^0+/,""),":",(J=(Y=o("fly ash",s.materials||[]))==null?void 0:Y.actual)==null?void 0:J.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(Q=(q=o("30 mm",s.materials||[]))==null?void 0:q.target)==null?void 0:Q.replace(/^0+/,""),":",(ee=(w=o("30 mm",s.materials||[]))==null?void 0:w.actual)==null?void 0:ee.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(le=(ae=o("water",s.materials||[]))==null?void 0:ae.target)==null?void 0:le.replace(/^0+/,""),":",(te=(se=o("water",s.materials||[]))==null?void 0:se.actual)==null?void 0:te.replace(/^0+/,"")]}),e.jsxs(n,{align:"left",sx:{fontSize:"10px"},children:[(re=(ne=o("admix",s.materials||[]))==null?void 0:ne.target)==null?void 0:re.replace(/^0+/,""),":",(ie=(ce=o("admix",s.materials||[]))==null?void 0:ce.actual)==null?void 0:ie.replace(/^0+/,"")]})]},l+1)})})]})})}function Ze({handleBack:V,setStartDate:T,startDate:v,setEndDate:o,endDate:d}){const s=F(),{vehicleGroup:l,vehicleList:p}=k(r=>r.liveMap),{batchReportsData:i,batchReportsData2:u,loading:C,selectedGroup:f,selectedVehicle:S,distributorList:A}=k(r=>r.report),[j,N]=g.useState([]);g.useState([]);const[O,R]=g.useState([]),[m,b]=g.useState([]);let z=r=>p.find(t=>{var x;return((x=t==null?void 0:t.imei[0])==null?void 0:x.mac_id)==r||""});const I=(r,t)=>t.find(a=>{var L;return((L=a==null?void 0:a.name)==null?void 0:L.toLowerCase())===r})||null;g.useEffect(()=>{const r=a=>a&&String(a).replace(/^0+/,"")||"-",t=(a,L=[])=>{const D=I(a,L);return{target:r(D==null?void 0:D.target),actual:r(D==null?void 0:D.actual)}};let x=(i==null?void 0:i.map(a=>{const{customer_name:L="-",registration_id:D="-",segment:Y="-"}=z(a==null?void 0:a.imei)||{};return{Date:a!=null&&a.date&&U(a==null?void 0:a.date,"DDMMYYYY").isValid()?U(a==null?void 0:a.date,"DDMMYYYY").format("DD-MM-YYYY"):"-",Vehicle:D||"-","Batch No":(a==null?void 0:a.batch_no)||"-","Start Time":(a==null?void 0:a.start_time)||"-",EndTime:(a==null?void 0:a.end_time)||"-","Total Target Weight":r(a==null?void 0:a.total_target),"Total Achieved Weight":r(a==null?void 0:a.totalAcheived),"Recipe 1":(a==null?void 0:a.mix_name)||"-",Cement:`${t("cement",a==null?void 0:a.materials).target}:${t("cement",a==null?void 0:a.materials).actual}`,"10mm":`${t("10mm",a==null?void 0:a.materials).target}:${t("10mm",a==null?void 0:a.materials).actual}`,"20mm":`${t("20mm",a==null?void 0:a.materials).target}:${t("20mm",a==null?void 0:a.materials).actual}`,Sand:`${t("sand",a==null?void 0:a.materials).target}:${t("sand",a==null?void 0:a.materials).actual}`,"Crush Sand":`${t("crush sand",a==null?void 0:a.materials).target}:${t("crush sand",a==null?void 0:a.materials).actual}`,"River Sand":`${t("river sand",a==null?void 0:a.materials).target}:${t("river sand",a==null?void 0:a.materials).actual}`,"Fly Ash":`${t("fly ash",a==null?void 0:a.materials).target}:${t("fly ash",a==null?void 0:a.materials).actual}`,"30mm":`${t("30mm",a==null?void 0:a.materials).target}:${t("30mm",a==null?void 0:a.materials).actual}`,Water:`${t("water",a==null?void 0:a.materials).target}:${t("water",a==null?void 0:a.materials).actual}`,Admix:`${t("admix",a==null?void 0:a.materials).target}:${t("admix",a==null?void 0:a.materials).actual}`}}))||[];R(x)},[i]);const M=r=>{if(!r&&!r.length>0)return;let t=[];for(let x=0;x<r.length;x++)if(r[x].startsWith("Product:")){const a=r[x],L=r[x+1]||"",D=a.match(/Product:\s*(.*?)\s*Target.*:\s*(\d+)/),Y=L.match(/Achieved.*:\s*(\d+)/);D&&t.push({product:D[1],target:Number(D[2]),achieved:Y?Number(Y[1]):0})}return t},h=["Batch No","Date","Start Time","Operator","Recipe Name","Cubic Meter","Cycle","End Time","Total Target","Total Achieved","Water","Admix"],c=r=>{if(!r&&!r.length>0)return;let t={};return r.forEach(x=>{h.forEach(a=>{var L;if(x.includes(a)){const Y=((L=x.split(/[:\-](.+)/)[1])==null?void 0:L.trim())||"";t[a]=Y}})}),t};g.useEffect(()=>{if(console.log("bacth reports data11",u),u&&u.length>0){let r=u.map(t=>{let x=M((t==null?void 0:t.parts)||[]),a=c((t==null?void 0:t.parts)||[]);return{productArr:x,generalKeyInfo:a,imei:t==null?void 0:t.deviceId}});r&&r.length>0?b(r):b([]),console.log("formatted arr",r)}},[u]),g.useEffect(()=>{if(l&&l.length>0){let r=l.map(t=>({...t,label:t.group_name,value:t.id}));N(r)}},[l,p,A]),g.useEffect(()=>{S||s(Z())},[]);function y(r){console.log("value changed",r),s(Ce(r))}function B(r){console.log("value",r),s(De(r))}const W=async()=>{const r=`${v} 00:00`,t=`${d} 23:59`;if(!G())return;s(Oe({imei:S,startDate:r,endDate:t}))},G=()=>!v||!d||S==="all"?(P.error("Please select start date, end date, and vehicle."),!1):!0,$=f==="All"?p:p.filter(r=>r.vehicle_group===f);return e.jsxs(_,{sx:{width:"100%",m:"auto"},children:[e.jsx(_,{sx:{ml:"10px"},children:e.jsx(Le,{handleBack:V,downloadData:O})}),e.jsxs(_,{children:[e.jsxs(E,{size:"large",value:f,showSearch:!0,style:{width:200,margin:"10px"},placeholder:"Select vehicle group",optionFilterProp:"children",onChange:y,filterOption:(r,t)=>{var x;return typeof((x=t==null?void 0:t.props)==null?void 0:x.children)=="string"&&t.props.children.toLowerCase().indexOf(r.toLowerCase())>=0},children:[e.jsx(E.Option,{value:"All",children:"All"}),j.map((r,t)=>e.jsx(E.Option,{value:r.value,children:r.label},t))]}),e.jsxs(E,{size:"large",value:S,showSearch:!0,style:{width:200,margin:"10px"},placeholder:"Select vehicle",optionFilterProp:"children",onChange:B,filterOption:(r,t)=>{var x;return typeof((x=t==null?void 0:t.props)==null?void 0:x.children)=="string"&&t.props.children.toLowerCase().indexOf(r.toLowerCase())>=0},children:[e.jsx(E.Option,{value:"all",children:"None"},"all"),$&&$.length>0&&$.map((r,t)=>{var x;return e.jsx(E.Option,{value:(x=r.imei[0])==null?void 0:x.mac_id,children:r.registration_id},t)})]}),e.jsx(Ve,{setStartDate:T,setEndDate:o,selectedDate:!1,startDate:v,endDate:d}),e.jsx(X,{variant:"contained",style:{width:200,marginLeft:"10px",backgroundColor:"#43556C"},onClick:W,disabled:!S,children:"Generate report"})]}),C&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1050},children:e.jsx(_e,{})}),i&&i.length>0&&e.jsx(_,{ml:1.5,children:e.jsx(Xe,{tableData:i||[]})})]})}function ue({children:V,value:T,index:v}){return e.jsx("div",{role:"tabpanel",hidden:T!==v,children:T===v&&e.jsx(_,{p:2,children:V})})}function Je({showCard:V,setReportType:T,reportType:v}){k(f=>f.dashboard),k(f=>f.liveMap);const{startDate:o,endDate:d,tabValue:s}=k(f=>f.report),[l,p]=g.useState(!0);g.useState({}),g.useState(!1);let i=F();g.useEffect(()=>{},[d]),g.useEffect(()=>{i(he()),i(xe())},[]);const u=()=>{i(Z()),i(he()),i(xe()),i(T(null))},C=(f,S)=>{i(Ie(S))};return e.jsx(e.Fragment,{children:e.jsx(_,{sx:{},children:e.jsxs(_,{children:[e.jsxs(ze,{value:s,onChange:C,children:[e.jsx(pe,{label:"Vehicle Report"}),e.jsx(pe,{label:"Batch data report"})]}),e.jsx(ue,{value:s,index:0,children:e.jsx(Ue,{handleBack:u,selectedDate:l,setEndDate:ge,setStartDate:fe,startDate:o,endDate:d})}),e.jsx(ue,{value:s,index:1,children:e.jsx(Ze,{handleBack:u,selectedDate:l,setEndDate:ge,setStartDate:fe,startDate:o,endDate:d})})]})})})}function aa(){const{mode:V,showVehicles:T,selectedVehicleGroup:v}=k(j=>j.dashboard),{w_customer_id:o}=k(j=>j.auth),{reportType:d}=k(j=>j.report),[s,l]=g.useState([]),[p,i]=g.useState(!0),[u,C]=g.useState(!1),f=Fe(V);let S=F();g.useEffect(()=>{A()},[]);const A=async()=>{try{let j=[],N=[];const O=await S($e({w_customer_id:o}));if(Array.isArray(O.payload)){O.payload.forEach(b=>{var z,I;Array.isArray(b.imei)&&b.imei.length>0?(j.push({id:b.id,label:b.registration_id,value:(z=b==null?void 0:b.imei[0])==null?void 0:z.mac_id,workShop:b==null?void 0:b.workshop,vehicle_group:b==null?void 0:b.vehicle_group}),N.push((I=b.imei[0])==null?void 0:I.mac_id)):console.error("IMEI data not found for item:",b)});const R="one",m=N;N.length>0&&(S(Re({type:R,imei:m})),S(me(m))),l(j),S(Me({w_customer_id:o})),S(Ye({}))}else console.error("Unexpected data format:",O),P.error("Unexpected data format:")}catch(j){console.error("Error fetching vehicle data:",j),P.error(`Error fetching vehicle data: ${j}`)}};return s.filter(j=>Object.keys(v).length===0||j.vehicle_group===v.id),e.jsxs("div",{className:"app",children:[e.jsx(Ge,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:f.grey[100]},children:[e.jsx(Be,{title:"Report",setShowVehiclesGroup:C,showVehiclesGroup:u,reportType:d}),e.jsx(We,{setShowVehiclesGroup:C,showVehiclesGroup:u}),e.jsxs(_,{style:{display:"flex",width:"100%",height:"95vh",background:f.grey[200]},children:[e.jsx(_,{style:{display:"flex",width:"100%",overflowY:"auto",height:"95vh"},children:e.jsx(_,{style:{width:"100%"},children:e.jsx(Je,{showCard:p,setReportType:Pe,reportType:d})})}),!1]})]})]})}export{aa as default};
