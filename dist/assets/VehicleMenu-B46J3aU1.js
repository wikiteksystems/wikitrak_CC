import{x as k,y as v,b as n,j as r,F as x,D as A,H as B,Y as M,C,aC as I,aD as E}from"./index-DFIULFn2.js";import{t as L}from"./Search-CmDiKBSd.js";import{R as F}from"./RegionSelector-B4r2ybWx.js";import{S as G}from"./SearchTab-BWfhXvQc.js";import{B as a,C as N}from"./CircularProgress-CWnAPB2N.js";import{T as Y}from"./index-Pb7O91MQ.js";const H=({vehicleData:f})=>{const D=["Engine RPM","Engine coolant temperature","Battery Potential"],l=k(),{selectedVehicle:g,loading:m}=v(e=>e.liveMap),{startDate:O,endDate:W,mode:w,selectedVehicleGroup:y,showVehicles:S}=v(e=>e.dashboard),[j,R]=n.useState(""),[c,T]=n.useState(""),i=L(w),s=n.useRef(null),p=n.useRef(0),d=f.length>0&&f.filter(e=>{var t,o;return((t=e==null?void 0:e.label)==null?void 0:t.toLowerCase().includes(j.toLowerCase()))&&(c===""||((o=e==null?void 0:e.workShop)==null?void 0:o.region)===c)}).sort((e,t)=>e.label.localeCompare(t.label)),V=async e=>{var b;s.current&&(p.current=s.current.scrollTop),l(B(!S)),l(M({imei:e.value,reg_id:e.label})),e.value,C().subtract(5,"day"),C();let t=e.label;const o=await l(I({registration_id:t}));let u=[];if(o&&o.payload.length>0&&((b=o.payload)==null||b.map(h=>{h.ivn_parameter.length>0&&u.push(h.ivn_parameter[0])})),u.length>0){let h=u.filter(P=>D.includes(P.pid_description));l(E(h))}else l(E([]));setTimeout(()=>{s.current&&(s.current.scrollTop=p.current)},0)};n.useEffect(()=>{s.current&&(s.current.scrollTop=p.current)},[m,d,g]);const _=e=>{console.log("clicked btn region",e),T(e)};return r.jsx(r.Fragment,{children:m?r.jsx("div",{children:r.jsx(a,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:r.jsx(N,{})})}):r.jsxs("div",{ref:s,style:{overflowY:"auto",height:"90vh"},children:[r.jsx(G,{searchTerm:j,setSearchedTerm:R}),r.jsx(F,{region:c,handleRegion:_}),Object.keys(y).length>0&&r.jsx(a,{sx:{align:"center",my:"8px",ml:"20px"},children:r.jsxs(x,{variant:"outlined",sx:{width:"90%",color:i.grey[400],"&:hover":{color:"#DAE0EE"}},children:["VGroup: ",y.group_name]})}),r.jsx(a,{sx:{align:"center",my:"8px",ml:"20px"},children:r.jsxs(x,{variant:"outlined",sx:{width:"90%",color:i.grey[400],"&:hover":{color:"#DAE0EE"}},children:["Total Vehicle: ",d.length]})}),d.length>0?d.map((e,t)=>r.jsx(a,{sx:{align:"center",my:"8px",ml:"20px"},children:r.jsx(x,{variant:"outlined",onClick:()=>V(e),sx:{width:"90%",bgcolor:e.label===g.reg_id?A.bgColor:"undefined",color:e.label===g.reg_id?"#DAE0EE":i.grey[400]},children:e.label})},t)):r.jsx(a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:r.jsxs(Y,{style:{textAlign:"center",color:i.grey[400]},children:["Sorry! No vehicles in"," ",r.jsx("span",{style:{fontWeight:"bold"},children:c})," region"]})})]})})},U=H;export{U as V};
