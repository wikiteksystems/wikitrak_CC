import{a$ as g,j as s,bF as O,a_ as k,b as h,ht as G,bl as $,bp as C,hu as P,bq as R,br as T,bs as W,aW as q,bt as z,bu as F,b5 as H,bw as U,b7 as j,bx as X,by as Z,bz as J,bA as Y,c4 as K}from"./index-UbXh4sGW.js";const Q="/assets/Crane-BC9ZOj91.png",ss="/assets/indoPowerLogo-BcdOgXeX.png",es=({title:r,value:c,unit:d})=>s.jsxs("div",{className:"info-card",children:[s.jsx("p",{className:"info-title",children:r}),s.jsxs("div",{className:"info-value-row",children:[s.jsx("h2",{className:"info-value",children:c}),d&&s.jsx("span",{className:"info-unit",children:d})]})]}),as=({title:r,value:c,unit:d})=>s.jsxs("div",{className:"top-info-card",children:[s.jsx("p",{className:"info-title",children:r}),s.jsxs("div",{className:"info-value-row",children:[s.jsx("h2",{className:"info-value",children:c}),d&&s.jsx("span",{className:"info-unit",children:d})]})]}),os=({title:r,value:c,unit:d})=>s.jsxs("div",{className:"bottom-info-card",children:[s.jsx("p",{className:"info-title",children:r}),s.jsxs("div",{className:"info-value-row",children:[s.jsx("h2",{className:"info-value",children:c}),d&&s.jsx("span",{className:"info-unit",children:d})]})]}),rs=()=>{const{sliParameter:r}=g(n=>n.sli);console.log(r,"sliParameter:>>>");const c={2702:"float1",2703:"float2",2700:"float3",2701:"float4"},d=[2704,2705,2706,2707,2709],x=[2720,2721,2722,2723,2711];return s.jsxs("div",{className:"dashboard-wrapper",children:[s.jsxs("div",{className:"dashboard-grid",children:[s.jsx(O,{sx:{borderRadius:"15px",padding:"20px",boxShadow:"1px 0px 10px 8px rgba(0, 0, 0, 0.1)"},children:s.jsxs("div",{className:"left-section",children:[s.jsx("div",{className:"logo-box",children:s.jsx("img",{src:ss,alt:"Logo",className:"logo-img"})}),s.jsxs("div",{className:"crane-container",children:[Object.keys(c).map(n=>s.jsx("div",{className:`float-card ${c[n]}`,children:s.jsx(as,{title:r[n].name,value:r[n].value,unit:r[n].unit})},n)),s.jsx("img",{src:Q,alt:"Crane",className:"crane-img"})]})]})}),s.jsx("div",{className:"right-section",children:d.map(n=>s.jsx(es,{title:r[n].name,value:r[n].value,unit:r[n].unit},n))})]}),s.jsx("div",{className:"bottom-row",children:x.map(n=>s.jsx(os,{title:r[n].name,value:r[n].value,unit:r[n].unit},n))})]})},is="https://cc.wikitrak.in/proxy-3031",ws=()=>{const r=k(),{w_customer_id:c,collapsed:d}=g(a=>a.auth),{sliParameter:x}=g(a=>a.sli),{mode:n,selectedTripData:ns,selectedVehicleGroup:ls,showVehicles:m,vehicleZone:ts,vehicles_details:cs,overdueCount:ds,completedCount:hs,serviceSoonCount:fs,parametersConfiguration:us,ivnParameterConfiguration:gs,j1939ParameterConfiguration:xs,analogVoltage:vs,parameterCodes:ps,latestPacketDetail:js,loading:ms}=g(a=>a.dashboard),{selectedVehicle:l,vehicleList:f,onlineVehicle:bs,locationData:v,loading:Ns}=g(a=>a.liveMap),[u,S]=h.useState({}),E=H(n),[p,b]=h.useState(!1),[N,y]=h.useState(!1),[D,M]=h.useState([]),V=async()=>{try{let a=[],i=[];const o=await r(U({w_customer_id:c}));if(Array.isArray(o.payload)){o.payload.forEach(e=>{var _,I,A;Array.isArray(e.imei)&&e.imei.length>0?(a.push({id:e.id,label:e.registration_id,value:(_=e==null?void 0:e.imei[0])==null?void 0:_.mac_id,vehilce_type:e==null?void 0:e.segment,sell_date:e==null?void 0:e.sell_date,workShop:e==null?void 0:e.workshop,vehicle_group:e==null?void 0:e.vehicle_group,customer_name:e==null?void 0:e.customer_name,vehicle_model:(I=e==null?void 0:e.vehicle_model)==null?void 0:I.name,chassis_no:e==null?void 0:e.chassis_no,segment:e==null?void 0:e.segment}),i.push((A=e.imei[0])==null?void 0:A.mac_id),e.registration_id):(console.error("IMEI data not found for item:",e),j.error(`IMEI Number not found for the vehicle: ${e==null?void 0:e.registration_id}`,{duration:2e3}))});const t="one",w=i;i.length>0&&(r(X({type:t,imei:w})),r(Z(w))),M(a),r(J(a)),r(Y({w_customer_id:c}))}else console.error("Unexpected data format:",o),j.error("Unexpected data format:")}catch(a){console.error("Error fetching vehicle data:",a),j.error(`Error fetching vehicle data: ${a}`)}};h.useEffect(()=>{V()},[]);const B=async(a,i)=>i==null?void 0:i.find(o=>{var t;return((t=o==null?void 0:o.latestDocument)==null?void 0:t.imei)==a});console.log(v,"locationData in sli page:>>>");const L=async()=>{try{const i=Object.keys(x).map(String).filter(Boolean);if(i.length===0){console.warn("No valid PIDs to query.");return}const{data:o}=await K.post(`${is}/api/ivn-pid/latest`,{imei:l==null?void 0:l.imei,pids:i}),t=o==null?void 0:o.pids;t&&Array.isArray(t)&&(t.length>0?r(P(t)):console.log("No relevant PIDs found in the received data."))}catch{}finally{}};return h.useEffect(()=>{if(!(l!=null&&l.imei))return;(async()=>{var i;try{const o=await B(l.imei,v);console.log(o,"Check Ignition >>>"),((i=o==null?void 0:o.latestDocument)==null?void 0:i.ignition)===!0&&L()}catch(o){console.error("Ignition check failed:",o)}})()},[v,l]),h.useEffect(()=>{const a=f.find(i=>{var o;return((o=i==null?void 0:i.imei[0])==null?void 0:o.mac_id)==(l==null?void 0:l.imei)});r(G()),S(a)},[l,f]),h.useEffect(()=>{var a,i,o;Object.keys(l).length===0&&f.length>0&&r($({imei:(i=(a=f[0])==null?void 0:a.imei[0])==null?void 0:i.mac_id,reg_id:(o=f[0])==null?void 0:o.registration_id}))},[l,f]),h.useEffect(()=>(C.on("j193PidInfo",a=>{var o,t;if(console.log("PacketRecived",a),!(a!=null&&a.deviceId)||a.deviceId!==((t=(o=u==null?void 0:u.imei)==null?void 0:o[0])==null?void 0:t.mac_id))return;const i=a==null?void 0:a.pids;i&&Array.isArray(i)&&(i.length>0?r(P(i)):console.log("No relevant PIDs found in the received data."))}),()=>{C.off("j193PidInfo")}),[u==null?void 0:u.imei]),s.jsxs("div",{className:"app",style:{maxWidth:"100vw",minHeight:"100vh",overflow:"auto"},children:[s.jsx(R,{}),s.jsxs("main",{style:{width:"100%",height:"100vh"},children:[s.jsx(T,{title:"Dashboard",setShowNotification:b,showNotification:p,setShowVehiclesGroup:y,showVehiclesGroup:N}),s.jsx(W,{setShowVehiclesGroup:y,showVehiclesGroup:N}),s.jsx(rs,{}),m&&s.jsx(q,{sx:{position:"fixed",width:{xs:"100%",md:"18%"},top:70,right:{xs:0,md:"0px"},height:{xs:"auto",md:"90vh"},zIndex:9999,backgroundColor:E.grey[100],overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin",maxWidth:"100vw"},children:s.jsx(z,{vehicleData:D,showVehicles:m})}),p&&s.jsx(F,{showNotification:p,setShowNotification:b})]})]})};export{ws as default};
