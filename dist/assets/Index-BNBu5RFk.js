import{p as m,o as J,r as t,j as a,B as d,eT as z,eU as G,G as F,eV as H,eD as I,A as K,eW as Q,eX as Y,J as Z,a5 as ee,dc as ae,am as A,a0 as se,a1 as te,a3 as re,a4 as oe,V as N,U as le,X as ne,v as ie}from"./index-D58bEPpO.js";import{V as ce}from"./VehicleMenu-DmcPzaQ-.js";import"./Loader-wlkYlbAq.js";import{P as de}from"./Parameters-BXmKGo2p.js";/* empty css           */import"./index.esm-W-7zsHkT.js";import{S as he}from"./ServiceJobCardTable-DZcNjmbs.js";import{B as pe}from"./BreakDownJobCardTable-C4hy09c9.js";import{S as ue}from"./ServicesTopBar-50FpmEjd.js";import"./Autocomplete-dSkUzWNC.js";import"./TextField-DenrDSLS.js";import"./Card-DhsXIvNU.js";import"./CardContent-BUgEzqNd.js";import"./ServiceJobCard-szyzfs7L.js";import"./formik.esm-BJdXKJ3s.js";import"./Remove-6EWqKD1K.js";import"./excelUtils-CIqDKLZ-.js";import"./Edit-DBn3Jx3n.js";function L(o){const{children:h,value:b,index:i,...p}=o;return a.jsx("div",{role:"tabpanel",hidden:b!==i,id:`simple-tabpanel-${i}`,"aria-labelledby":`simple-tab-${i}`,...p,children:b===i&&a.jsx(d,{sx:{p:3},children:h})})}L.propTypes={children:I.node,index:I.number.isRequired,value:I.number.isRequired};function $(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function ge(){const{selectedTabValue:o}=m(f=>f.inspection),h=J(),[b,i]=t.useState(0),p=(f,j)=>{h(F("")),h(H(j))};return a.jsxs(d,{sx:{width:"100%"},children:[a.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(z,{value:o,onChange:p,"aria-label":"basic tabs example",children:[a.jsx(G,{label:"Breakdowns",...$(0)}),a.jsx(G,{label:"Services",...$(1)})]})}),a.jsx(L,{value:o,index:0,children:a.jsx(pe,{isInspection:!0})}),a.jsx(L,{value:o,index:1,children:a.jsx(he,{isInspection:!0})})]})}function Ge(){const{locationData:o,selectedVehicle:h,selectedParameterList:b}=m(s=>s.liveMap),{mode:i,selectedVehicleGroup:p}=m(s=>s.dashboard),f=ie(i),[j,M]=t.useState([]),{w_customer_id:S}=m(s=>s.auth),[U,_]=t.useState(),[v,C]=t.useState(!1),[y,R]=t.useState(!1),[V,w]=t.useState([]),[fe,xe]=t.useState(!0),[B,E]=t.useState(!1),[q,P]=t.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let r=J();K(),t.useEffect(()=>{r(Q()),r(Y())},[]),t.useEffect(()=>{O(),r(Z()),r(ee(S)),r(ae())},[]),t.useEffect(()=>{w([]),r(A([{reg_id:"",imei:"",params:[]}]))},[h]);const O=async()=>{try{P(!0);let s=[],n=[];const u=await r(se({w_customer_id:S}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var g,c,k,l;Array.isArray(e.imei)&&e.imei.length>0&&((g=e.imei[0])!=null&&g.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(c=e.imei[0])==null?void 0:c.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(k=e==null?void 0:e.vehicle_model)==null?void 0:k.name,vehicle_group:e==null?void 0:e.vehicle_group}),n.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const D="one",T=n;n.length>0&&r(te({type:D,imei:T})),M(s),r(re(s)),P(!1),r(oe({w_customer_id:S}))}else P(!1),console.error("Unexpected data format:",u),N.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),N.error(`Error fetching vehicle data: ${s}`)}},X=async s=>{const{label:n,imei:u,id:D,reg_id:T,checked:e}=s;_(l=>l.map(x=>x.id===D?{...x,checked:!e}:x));let g=[...V],c=[...V];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(g.push({label:n,value:l.latestDocument[n==="maininputvoltage"?"mainInputVoltage":n]}),c=g,w(g))});else{let l=V.filter(x=>x.label!==n);c=l,w(l)}console.log("tempParamList",c),r(A([{reg_id:T,imei:u,params:c}]))},W=j.filter(s=>Object.keys(p).length===0||s.vehicle_group===p.id);return a.jsxs("div",{className:"app",children:[a.jsx(le,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:C,showVehicles:v,setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsx(ne,{setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(d,{style:{width:v||y?"80%":"100%"},children:a.jsx(ge,{})}),v&&a.jsx(d,{style:{width:"20%",backgroundColor:f.grey[100]},children:a.jsx(ce,{vehicleData:W,title:"Inspections",setParameterData:_,loadingVehicle:q,setShowVehicles:C,showVehicles:v,showParameters:y,setShowParameters:R})}),y&&a.jsx(d,{style:{width:"20%",backgroundColor:f.grey[100]},children:a.jsx(de,{parametersData:U,setParameterData:_,handleParameterChange:X})})]})]})]})}export{Ge as default};
