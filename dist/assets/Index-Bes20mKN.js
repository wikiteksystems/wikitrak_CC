import{n as Se,j as e,b0 as I,r as l,a$ as ne,fl as Pe,fr as Te,fs as Le,ft as Ae,b8 as X,bl as ge,aX as A,eu as v,dP as F,bd as ee,bZ as Ve,T as he,aZ as se,f3 as be,f4 as je,f5 as me,R as ye,fh as $e,bn as U,fi as oe,bg as Ie,da as pe,ch as Re,dY as qe,dZ as Fe,d_ as Oe,d$ as _e,e0 as b,e1 as Ee,f7 as Me,ei as We,dg as Ne,eO as Ye,eP as xe,fc as He,fd as Je,fj as ze,bJ as ve,bx as Ge,by as Ze,bA as De,br as Qe,b4 as Xe}from"./index-B9W9A0YN.js";import{V as Ke}from"./VehicleMenu-CCajfBdm.js";import{P as Be}from"./Parameters-B4utlfqr.js";/* empty css           */import{c as ke,d as Ue,a as w,f as we}from"./index.esm-R3Gd3xrx.js";import{u as es}from"./formik.esm-D-reUPUz.js";import{A as ie}from"./Autocomplete-XJJmeDcA.js";import{R as ss,A as ts,D as as}from"./Remove-CXcyEgiF.js";import{a as rs,S as ns}from"./ServiceJobCardTable-B4Iea_yd.js";import{T as cs,d as is}from"./excelUtils-CKXoEBjl.js";import{T as ls,E as os}from"./Edit-jq5htzrK.js";import{S as us}from"./ServicesTopBar-BAE5mNsR.js";import"./xlsx-DrgRuPKf.js";const ds=Se(e.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Ce=({UpdatedBreakdownData:n,setOpen:u})=>{var y,T,N,Y;const{w_customer_id:f}=I(t=>t.auth),[m,V]=l.useState(null),{vehicleList:S}=I(t=>t.liveMap),{vendorList:K,segMentList:O,loading:B}=I(t=>t.services),{technicianList:P}=I(t=>t.breakdown),{sparePartList:$}=I(t=>t.inspection),R=ne(),[E,Z]=l.useState([]),[D,Q]=l.useState([]),[k,M]=l.useState(!1),[ce,te]=l.useState(null);console.log("update service data",n),l.useEffect(()=>{},[P]);let W=n==null?void 0:n.service_parts.map(t=>{var c;return{spare_parts:(c=t==null?void 0:t.spare_parts)==null?void 0:c.id,quantity:t==null?void 0:t.quantity}});const a=es({initialValues:{start_date:(n==null?void 0:n.start_date)||Pe(new Date),vehicle:((y=n==null?void 0:n.vehicle)==null?void 0:y.id)||"",service_type:(n==null?void 0:n.service_type)||"",technician:((T=n==null?void 0:n.technician)==null?void 0:T.id)||"",mob_no:(n==null?void 0:n.mob_no)||"",attachment:(n==null?void 0:n.attachment)||"",location:(n==null?void 0:n.location)||"",contact_person:(n==null?void 0:n.contact_person)||"",service_parts:W||[],status:"Pending",user:f},validationSchema:ke({start_date:we().required("Submission Date is required"),vehicle:w().required("Vehicle is required"),service_type:w().required("Service type is required"),technician:w().required("Technician is required"),mob_no:w().matches(/^\d{10,11}$/,"Mobile number must be 10-11 digits").required("Mobile number is required"),location:w().required("Location is required"),contact_person:w().required("Contact Person is required"),attachment:Ue()}),onSubmit:async t=>{console.log("values",t);let c;if(n?((t==null?void 0:t.attachment)instanceof File||typeof(t==null?void 0:t.attachment)=="string"&&(t.attachment=""),c=await R(Te({payload:t,id:n.id}))):c=await R(Le(t)),c.payload){console.log(c.payload),console.log("values",t.service_parts);const{id:h}=c.payload,{service_parts:g}=t;await R(Ae({service:h,parts:g})),X.success("Service created successfully"),a.resetForm(),V(null),R(ge()),u(!1)}}}),ae=["Routine","Overdue","Emergency"];l.useEffect(()=>{let t=S.map(c=>({label:c.registration_id,value:c.id}));Z(t)},[S]),l.useEffect(()=>{let t=O.map(c=>({label:c.segment_name,value:c.id}));Q(t)},[O]);const _=async()=>{M(!0),navigator.geolocation?navigator.geolocation.getCurrentPosition(async t=>{const{latitude:c,longitude:h}=t.coords;try{const g=await getReadableAddress(c,h);a.setFieldValue("location",g)}catch{X.error("Failed to convert coordinates to address.")}finally{M(!1)}},()=>{X.error("Failed to retrieve location."),M(!1)}):(X.error("Geolocation not supported."),M(!1))};return e.jsx(A,{sx:{p:3,maxWidth:"100%",margin:"auto"},children:e.jsx("form",{onSubmit:a.handleSubmit,children:e.jsxs(v,{container:!0,spacing:2,children:[e.jsx(v,{item:!0,xs:12,sm:6,children:e.jsx(F,{label:"Start date",name:"start_date",type:"datetime-local",value:a.values.start_date,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.start_date&&!!a.errors.start_date,helperText:a.touched.start_date&&a.errors.start_date,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!0})}),e.jsx(v,{item:!0,xs:12,sm:6,children:e.jsx(ie,{options:S,getOptionLabel:t=>t.registration_id||"",value:S.find(t=>t.id===a.values.vehicle)||null,onChange:(t,c)=>a.setFieldValue("vehicle",(c==null?void 0:c.id)||""),renderInput:t=>e.jsx(F,{...t,label:"Vehicle",error:a.touched.vehicle&&!!a.errors.vehicle,helperText:a.touched.vehicle&&a.errors.vehicle})})}),e.jsx(v,{item:!0,xs:12,sm:6,children:e.jsx(ie,{options:ae,getOptionLabel:t=>t,value:a.values.service_type,onChange:(t,c)=>a.setFieldValue("service_type",c||""),renderInput:t=>e.jsx(F,{...t,label:"Service Type",error:a.touched.service_type&&!!a.errors.service_type,helperText:a.touched.service_type&&a.errors.service_type})})}),e.jsx(v,{item:!0,xs:12,sm:6,children:e.jsx(ie,{options:P,getOptionLabel:t=>`${t.first_name} ${t.last_name}`||"",value:P.find(t=>t.id===a.values.technician)||null,onChange:(t,c)=>a.setFieldValue("technician",(c==null?void 0:c.id)||""),renderInput:t=>e.jsx(F,{...t,label:"Assign technician",error:a.touched.technician&&!!a.errors.technician,helperText:a.touched.technician&&a.errors.technician})})}),e.jsx(v,{item:!0,xs:12,sm:6,children:e.jsx(F,{label:"Contact Person Name*",name:"contact_person",value:a.values.contact_person,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.contact_person&&!!a.errors.contact_person,helperText:a.touched.contact_person&&a.errors.contact_person,fullWidth:!0})}),e.jsx(v,{item:!0,xs:12,sm:6,children:e.jsx(F,{label:"Contact Person Mobile No*",name:"mob_no",value:a.values.mob_no,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.mob_no&&!!a.errors.mob_no,helperText:a.touched.mob_no&&a.errors.mob_no,fullWidth:!0})}),e.jsxs(v,{item:!0,xs:12,sm:6,children:[e.jsx(F,{label:"Location",name:"location",value:a.values.location,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.location&&!!a.errors.location,helperText:a.touched.location&&a.errors.location,fullWidth:!0}),e.jsx(ee,{size:"small",onClick:_,disabled:k,sx:{mt:1},children:k?e.jsx(Ve,{size:16}):"Use Current Location"})]}),e.jsxs(v,{item:!0,xs:12,children:[e.jsx(he,{variant:"h6",gutterBottom:!0,children:"Parts Requirement*(If any information available)"}),(Y=(N=a==null?void 0:a.values)==null?void 0:N.service_parts)==null?void 0:Y.map((t,c)=>{var p;const h=(p=a.values)==null?void 0:p.service_parts.map(i=>i.spare_parts).filter((i,C)=>C!==c),g=$.filter(i=>!h.includes(i.id));return e.jsxs(v,{container:!0,spacing:2,marginTop:"0px",alignItems:"center",children:[e.jsx(v,{item:!0,xs:12,md:6,children:e.jsx(ie,{options:g,getOptionLabel:i=>i.description,value:$.find(i=>i.id===t.spare_parts)||null,onChange:(i,C)=>a.setFieldValue(`service_parts[${c}].spare_parts`,(C==null?void 0:C.id)||""),renderInput:i=>e.jsx(F,{...i,label:"Spare Part",fullWidth:!0})})}),e.jsx(v,{item:!0,xs:8,md:4,children:e.jsxs(A,{display:"flex",alignItems:"center",children:[e.jsx(se,{onClick:()=>a.setFieldValue(`service_parts[${c}].quantity`,Math.max(1,t.quantity-1)),children:e.jsx(ss,{})}),e.jsx(F,{value:t.quantity,type:"number",inputProps:{min:1},onChange:i=>a.setFieldValue(`service_parts[${c}].quantity`,parseInt(i.target.value,10)),sx:{width:90,mx:1,textAlign:"center"}}),e.jsx(se,{onClick:()=>a.setFieldValue(`service_parts[${c}].quantity`,t.quantity+1),children:e.jsx(ts,{})})]})}),e.jsx(v,{item:!0,xs:4,md:2,children:e.jsx(se,{color:"error",onClick:()=>{var C;const i=[...(C=a.values)==null?void 0:C.service_parts];i.splice(c,1),a.setFieldValue("service_parts",i)},children:e.jsx(as,{})})})]},c)}),e.jsx(ee,{variant:"outlined",onClick:()=>{var h,g,p;const t=(g=(h=a.values)==null?void 0:h.service_parts)==null?void 0:g.map(i=>i.spare_parts);if($.filter(i=>!(t!=null&&t.includes(i.id))).length===0){X.error("All available spare parts have already been added.");return}a.setFieldValue("service_parts",[...(p=a.values)==null?void 0:p.service_parts,{spare_parts:"",quantity:1}])},sx:{mt:2},children:"+ Add Spare Part"})]}),e.jsxs(v,{item:!0,xs:6,children:[e.jsxs(ee,{variant:"outlined",component:"label",fullWidth:!0,children:["Upload File",e.jsx("input",{type:"file",hidden:!0,onChange:t=>{const c=t.currentTarget.files[0];c&&a.setFieldValue("attachment",c)}})]}),a.values.attachment&&e.jsxs(v,{container:!0,spacing:1,mt:1,alignItems:"center",children:[e.jsx(v,{item:!0,children:e.jsxs(he,{variant:"body2",children:[e.jsx("b",{children:"Attachment:"})," ",typeof a.values.attachment=="string"?a.values.attachment.split("/").pop():a.values.attachment.name]})}),e.jsx(v,{item:!0,children:e.jsx(ee,{size:"small",variant:"text",onClick:()=>{const t=typeof a.values.attachment=="string"?a.values.attachment:URL.createObjectURL(a.values.attachment);window.open(t,"_blank")},children:"View File"})})]})]}),e.jsx(v,{item:!0,xs:12,children:e.jsx(ee,{variant:"contained",type:"submit",fullWidth:!0,disabled:B,children:n?"Update Service request":"Raise Service request"})})]})})})};function hs({open:n,setOpen:u,data:f,isInspection:m}){const V=()=>u(!1);return e.jsxs(be,{open:n,onClose:V,maxWidth:"xl",fullWidth:!0,scroll:"paper",children:[e.jsxs(je,{children:["Update service entry",e.jsx(se,{"aria-label":"close",onClick:()=>u(!1),sx:{position:"absolute",right:8,top:8},children:e.jsx(ds,{})})]}),e.jsx(me,{dividers:!0,children:e.jsx(Ce,{UpdatedBreakdownData:f,setOpen:u})})]})}const fe=[{id:"service_record_id",label:"Service Record ID"},{id:"registration_id",label:"Registration ID"},{id:"service_type",label:"Service Type"},{id:"user_name",label:"Created by"},{id:"technician_name",label:"Technician Name"},{id:"contact_person",label:"Contact Person"},{id:"mob_no",label:"Mobile No"},{id:"start_date",label:"Start Date"},{id:"start_time",label:"Start Time"},{id:"status",label:"Status"}],ps=()=>{const{servicesData:n}=I(s=>s.services),{searchTerm:u}=I(s=>s.inspection),f=ne(),[m,V]=l.useState("asc"),[S,K]=l.useState("BDID"),[O,B]=l.useState(0),[P,$]=l.useState(8),[R,E]=l.useState(!1),[Z,D]=l.useState(!1),[Q,k]=l.useState(null),[M,ce]=ye.useState(null),[te,W]=l.useState({service_record_id:"",registration_id:"",service_type:"",user_name:"",technician_name:"",contact_person:"",mob_no:"",start_date:"",start_time:"",status:""}),[a,ae]=l.useState("service_record_id");l.useEffect(()=>{f($e({})),f(ge())},[]);const _=s=>{V(S===s&&m==="asc"?"desc":"asc"),K(s)},y=(s,x)=>{B(x)},T=s=>{$(parseInt(s.target.value,10)),B(0)},N=(s,x,j)=>!x||!j?s:s.filter(r=>(()=>{var o,L,H,J,z,G,q,le,re;switch(x){case"service_record_id":return((r==null?void 0:r.service_record_id)||"").toString();case"registration_id":return((o=r==null?void 0:r.vehicle)==null?void 0:o.registration_id)||"";case"service_type":return(r==null?void 0:r.service_type)||"";case"user_name":return`${((H=(L=r==null?void 0:r.user)==null?void 0:L.us_user)==null?void 0:H.first_name)||""} ${((z=(J=r==null?void 0:r.user)==null?void 0:J.us_user)==null?void 0:z.last_name)||""}`;case"technician_name":return`${((q=(G=r==null?void 0:r.technician)==null?void 0:G.us_user)==null?void 0:q.first_name)||""} ${((re=(le=r==null?void 0:r.technician)==null?void 0:le.us_user)==null?void 0:re.last_name)||""}`;case"contact_person":return(r==null?void 0:r.contact_person)||"";case"mob_no":return(r==null?void 0:r.mob_no)||"";case"start_date":return r!=null&&r.start_date?U(r.start_date).format("YYYY-MM-DD"):"";case"start_time":return r!=null&&r.start_date?U(r.start_date).format("HH:mm A"):"";case"status":return(r==null?void 0:r.status)||"";default:return""}})().toLowerCase().includes(j.toLowerCase())),Y=(s,x,j,r)=>{if(r==="User"){const d=`${s.user.us_user.first_name} ${s.user.us_user.last_name}`.toLowerCase(),o=`${x.user.us_user.first_name} ${x.user.us_user.last_name}`.toLowerCase();return j==="asc"?d.localeCompare(o):o.localeCompare(d)}if(r==="WorkshopGroup"){const d=s.workshop_group.group_name.toLowerCase(),o=x.workshop_group.group_name.toLowerCase();return j==="asc"?d.localeCompare(o):o.localeCompare(d)}if(r==="BDID"){const d=parseInt(s.service_record_id.replace("BD-",""),10),o=parseInt(x.service_record_id.replace("BD-",""),10);return j==="asc"?d-o:o-d}if(r==="SubmissionDate"){const d=new Date(s.submission_date),o=new Date(x.submission_date);return j==="asc"?d-o:o-d}if(r==="Status"){const d={Open:1,Close:2,Rejected:3},o=d[s.status]||0,L=d[x.status]||0;return j==="asc"?o-L:L-o}return 0},t=N((n==null?void 0:n.slice())||[],a,u).sort((s,x)=>Y(s,x,m,S)),c=t.slice(O*P,O*P+P),h={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"},g=s=>{D(!Z),ce(s)},p=t&&t.map(s=>{var j,r,d,o,L,H,J,z,G;const x=s!=null&&s.service_parts&&(s==null?void 0:s.service_parts.length)>0?s==null?void 0:s.service_parts.map((q,le)=>{var re;return`${(re=q==null?void 0:q.spare_parts)==null?void 0:re.description}: Qty ${q==null?void 0:q.quantity}`}).join(";"):"N/A";return{"Service Record ID":(s==null?void 0:s.service_record_id)||"","Registration ID":((j=s==null?void 0:s.vehicle)==null?void 0:j.registration_id)||"","Service Type":(s==null?void 0:s.service_type)||"","User Name":`${((d=(r=s==null?void 0:s.user)==null?void 0:r.us_user)==null?void 0:d.first_name)||""} ${((L=(o=s==null?void 0:s.user)==null?void 0:o.us_user)==null?void 0:L.last_name)||""}`,"Technician Name":`${((J=(H=s==null?void 0:s.technician)==null?void 0:H.us_user)==null?void 0:J.first_name)||""} ${((G=(z=s==null?void 0:s.technician)==null?void 0:z.us_user)==null?void 0:G.last_name)||""}`,"Contact Person":(s==null?void 0:s.contact_person)||"","Mobile No":(s==null?void 0:s.mob_no)||"","Start Date":s!=null&&s.start_date?U(s.start_date).format("YYYY-MM-DD"):"","Start Time":s!=null&&s.start_date?U(s.start_date).format("HH:mm A"):"",Status:(s==null?void 0:s.status)||"","Spare parts":x}});let i=oe("Service"),C=oe("Job Card");const ue=(C==null?void 0:C.includes("Create"))||C==="Read-Write-Only",de=(i==null?void 0:i.includes("Update"))||i==="Read-Write-Only";return e.jsxs(A,{sx:{m:"10px"},children:[e.jsxs(A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(cs,{columns:fe,selectedColumn:a,onColumnChange:ae,searchTerm:u,onSearchChange:s=>f(Ie(s))}),e.jsx(pe,{variant:"contained",color:"success",onClick:()=>is(p,"service-ticket.xlsx"),children:"Download Excel"})]}),e.jsxs(Re,{children:[e.jsx(qe,{sx:{height:"73vh",bgcolor:"white",borderRadius:"10px"},children:e.jsxs(Fe,{stickyHeader:!0,children:[e.jsx(Oe,{children:e.jsxs(_e,{children:[fe.map(s=>e.jsx(b,{sx:h,children:e.jsx(ls,{active:S===s.id,direction:S===s.id?m:"asc",onClick:()=>_(s.id),children:s.label})},s.id)),de&&e.jsx(b,{sx:h,children:"Action"}),ue&&e.jsx(b,{sx:h,children:"Job card"})]})}),e.jsx(Ee,{children:c.map((s,x)=>{var j,r,d,o,L,H,J,z,G;return e.jsxs(_e,{children:[e.jsx(b,{children:s==null?void 0:s.service_record_id}),e.jsx(b,{children:(j=s==null?void 0:s.vehicle)==null?void 0:j.registration_id}),e.jsx(b,{children:s==null?void 0:s.service_type}),e.jsx(b,{children:`${(d=(r=s==null?void 0:s.user)==null?void 0:r.us_user)==null?void 0:d.first_name} ${(L=(o=s==null?void 0:s.user)==null?void 0:o.us_user)==null?void 0:L.last_name}`}),e.jsx(b,{children:`${((J=(H=s==null?void 0:s.technician)==null?void 0:H.us_user)==null?void 0:J.first_name)||""} ${((G=(z=s==null?void 0:s.technician)==null?void 0:z.us_user)==null?void 0:G.last_name)||""}`}),e.jsx(b,{children:s==null?void 0:s.contact_person}),e.jsx(b,{children:s==null?void 0:s.mob_no}),e.jsx(b,{children:(s==null?void 0:s.start_date)&&U(s.start_date).format("YYYY-MM-DD")||"N/A"}),e.jsx(b,{children:(s==null?void 0:s.start_date)&&U(s.start_date).format("HH:mm A")||"N/A"}),e.jsx(b,{sx:{color:s.status==="Open"?"blue":s.status==="Completed"?"green":"red"},children:s.status}),de&&e.jsx(b,{children:e.jsx(se,{onClick:()=>g(s),color:"primary",disabled:(s==null?void 0:s.status.toLowerCase())==="completed","aria-label":"edit record",children:e.jsx(os,{})})}),ue&&e.jsx(b,{children:e.jsx(pe,{variant:"outlined",onClick:()=>{E(!0),k(s)},disabled:s==null?void 0:s.jobcard,children:"Create job card"})})]},x)})})]})}),e.jsx(Me,{component:"div",count:t.length,page:O,onPageChange:y,rowsPerPage:P,onRowsPerPageChange:T,rowsPerPageOptions:[5,10,15]}),e.jsx(rs,{rowData:Q,open:R,handleClose:()=>E(!1),isTechnician:!0})]}),e.jsx(hs,{open:Z,setOpen:D,data:M})]})};function _s(){const[n,u]=ye.useState(!1);ne();const f=()=>u(!0),m=()=>u(!1);return e.jsxs("div",{children:[e.jsx(ee,{variant:"outlined",onClick:f,children:"+ Add New Entry"}),e.jsxs(be,{open:n,onClose:m,maxWidth:"xl",fullWidth:!0,scroll:"paper",children:[e.jsxs(je,{children:["+ Add new service entry",e.jsx(se,{"aria-label":"close",onClick:m,sx:{position:"absolute",right:8,top:8},children:e.jsx(We,{})})]}),e.jsx(me,{dividers:!0,children:e.jsx(Ce,{setOpen:u})})]})]})}function xs(){const[n]=Ne(),u=n.get("tab"),[f,m]=l.useState(0);l.useEffect(()=>{u&&m(Number(u))},[]);const V=(S,K)=>{m(K)};return e.jsxs(A,{sx:{width:"100%"},children:[e.jsx(A,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Ye,{value:f,onChange:V,"aria-label":"Breakdown Tabs",children:[e.jsx(xe,{label:"Service Tickets"}),e.jsx(xe,{label:"Service Job Cards"})]})}),e.jsxs(A,{sx:{mt:2},children:[f===0&&e.jsx(ps,{isInspection:!1}),f===1&&e.jsx(ns,{isInspection:!1})]})]})}const vs=()=>{const n=ne();l.useEffect(()=>{n(He()),n(Je()),n(ze())},[]);let u=oe("Service");const f=(u==null?void 0:u.includes("Create"))||u==="Read-Write-Only";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",height:"70px"},children:[e.jsx("div",{style:{margin:"10px"},children:e.jsx("h3",{children:"Service Record"})}),f&&e.jsx("div",{style:{margin:"10px",marginTop:"20px"},children:e.jsx(_s,{})}),"      "]}),e.jsxs("div",{children:[e.jsx("hr",{}),e.jsx("div",{style:{margin:"10px"},children:e.jsx(xs,{})})]})]})};function $s(){const{locationData:n,selectedVehicle:u,selectedParameterList:f}=I(_=>_.liveMap),{mode:m}=I(_=>_.dashboard),V=Xe(m),[S,K]=l.useState([]),{w_customer_id:O}=I(_=>_.auth),[B,P]=l.useState(),[$,R]=l.useState(!1),[E,Z]=l.useState(!1),[D,Q]=l.useState([]),[k,M]=l.useState(!0),[ce,te]=l.useState(!1);let W=ne();l.useEffect(()=>{a()},[]),l.useEffect(()=>{Q([]),W(ve([{reg_id:"",imei:"",params:[]}]))},[u]);const a=async()=>{try{te(!0);let _=[],y=[];const T=await W(Ge({w_customer_id:O}));if(Array.isArray(T.payload)){T.payload.forEach(t=>{var c,h,g,p;Array.isArray(t.imei)&&t.imei.length>0&&((c=t.imei[0])!=null&&c.mac_id)?(_.push({id:t.id,label:t.registration_id,value:(h=t.imei[0])==null?void 0:h.mac_id,vehilce_type:t==null?void 0:t.segment,chassis_no:t==null?void 0:t.chassis_no,engine_no:t==null?void 0:t.engine_no,workShop:t==null?void 0:t.workshop,registration_id:t==null?void 0:t.registration_id,sell_date:t==null?void 0:t.sell_date,customer_name:t==null?void 0:t.customer_name,vehicle_model:(g=t==null?void 0:t.vehicle_model)==null?void 0:g.name}),y.push((p=t.imei[0])==null?void 0:p.mac_id)):console.error("IMEI data not found for item:",t)});const N="one",Y=y;y.length>0&&W(Ze({type:N,imei:Y})),K(_),W(De(_)),te(!1)}else te(!1),console.error("Unexpected data format:",T),X.error("Unexpected data format:")}catch(_){console.error("Error fetching vehicle data:",_),X.error(`Error fetching vehicle data: ${_}`)}},ae=async _=>{const{label:y,imei:T,id:N,reg_id:Y,checked:t}=_;P(p=>p.map(i=>i.id===N?{...i,checked:!t}:i));let c=[...D],h=[...D];if(!t)n.forEach(p=>{p.latestDocument.imei===T&&(c.push({label:y,value:p.latestDocument[y==="maininputvoltage"?"mainInputVoltage":y]}),h=c,Q(c))});else{let p=D.filter(i=>i.label!==y);h=p,Q(p)}console.log("tempParamList",h),W(ve([{reg_id:Y,imei:T,params:h}]))};return e.jsxs("div",{className:"app",children:[e.jsx(Qe,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(us,{title:"services",setShowVehicles:R,showVehicles:$,showParameters:E,setShowParameters:Z,setShowCard:M,showCard:k}),e.jsxs(A,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(A,{style:{width:$||E?"80%":"100%"},children:e.jsx(vs,{})}),$&&e.jsx(A,{style:{width:"20%",backgroundColor:V.grey[100]},children:e.jsx(Ke,{vehicleData:S,title:"Inspections",setParameterData:P,loadingVehicle:ce,setShowVehicles:R,showVehicles:$,showParameters:E,setShowParameters:Z})}),E&&e.jsx(A,{style:{width:"20%",backgroundColor:V.grey[100]},children:e.jsx(Be,{parametersData:B,setParameterData:P,handleParameterChange:ae})})]})]})]})}export{$s as default};
