import{n as pe,j as e,p as je,dK as _,R as V,aW as c,a$ as re,b as j,a_ as K,bb as ue,bY as be,T,ej as $,aY as U,eq as xe,bc as J,ba as M,er as ve,dL as te,dM as ne,dN as oe,dP as Q,es as ie,et as me,eu as ye,c4 as ke,ev as Ce,ew as he,ex as Pe,b7 as ae}from"./index-Do9GuRKh.js";import{F as X}from"./formik.esm-tfZNoQWw.js";import{c as Z,a as S,b as ge}from"./index.esm-sU6AXznI.js";import{u as Y}from"./useMediaQuery-Dore0SwB.js";const z=pe(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),H=pe(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),Se=je(_)`
  input {
    text-align: center;
  }
`,Te={TextFieldStyled:Se},_e=t=>e.jsx(Te.TextFieldStyled,{...t}),B={left:"ArrowLeft",right:"ArrowRight",backspace:"Backspace",home:"Home",end:"End"};function Ae(t,l){return t<=0?[]:Array.from({length:t},l)}function Fe(t,l,p){return t.map((d,m)=>l===m?p:d)}function le(t){return t.join("")}function de(t,l){return[...t,l]}function We(t,l,p){return t.reduce((d,m,a)=>{const{characters:h,restArrayMerged:i}=d;if(a<p)return{restArrayMerged:i,characters:de(h,m)};const[b,...u]=i;return{restArrayMerged:u,characters:de(h,b||"")}},{restArrayMerged:l,characters:[]}).characters}function qe(t){return t.split("")}function ce(t){const l=V.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return V.useInsertionEffect(()=>{l.current=t}),V.useCallback((...p)=>{var d;return(d=l.current)==null?void 0:d.call(l,...p)},[])}const Ie=()=>!0,Re=V.forwardRef((t,l)=>{const{value:p="",length:d=4,autoFocus:m=!1,onChange:a,TextFieldsProps:h,onComplete:i,validateChar:b=Ie,className:u,onBlur:A,...E}=t,D=V.useRef(p),N=ce(i),F=ce(s=>{const r=s.slice(0,d);return{isCompleted:r.length===d,finalValue:r}});V.useEffect(()=>{const{isCompleted:s,finalValue:r}=F(D.current);s&&N(r)},[d,N,F]);const k=Ae(d,(s,r)=>({character:p[r]||"",inputRef:V.createRef()})),v=s=>k.findIndex(({inputRef:r})=>r.current===s),q=()=>k.map(({character:s})=>s),x=(s,r)=>{const g=Fe(q(),s,r);return le(g)},n=s=>{var r,g;(g=(r=k[s])==null?void 0:r.inputRef.current)==null||g.focus()},o=s=>{var r,g;(g=(r=k[s])==null?void 0:r.inputRef.current)==null||g.select()},y=s=>{s+1!==d&&(k[s+1].character?o(s+1):n(s+1))},C=(s,r)=>typeof b!="function"?!0:b(s,r),ee=s=>{const r=v(s.target);if(r===0&&s.target.value.length>1){const{finalValue:L,isCompleted:O}=F(s.target.value);a==null||a(L),O&&(i==null||i(L)),o(L.length-1);return}const g=s.target.value[0]||"";let P=g;P&&!C(P,r)&&(P="");const f=x(r,P);a==null||a(f);const{isCompleted:R,finalValue:W}=F(f);R&&(i==null||i(W)),P!==""?f.length-1<r?o(f.length):y(r):g===""&&f.length<=r&&o(r-1)},I=s=>{const r=s.target,g=r.selectionStart,P=r.selectionEnd,f=v(r),R=g===0&&P===0;if(r.value===s.key)s.preventDefault(),y(f);else if(B.backspace===s.key){if(!r.value)s.preventDefault(),o(f-1);else if(R){s.preventDefault();const W=x(f,"");a==null||a(W),W.length<=f&&o(f-1)}}else B.left===s.key?(s.preventDefault(),o(f-1)):B.right===s.key?(s.preventDefault(),o(f+1)):B.home===s.key?(s.preventDefault(),o(0)):B.end===s.key&&(s.preventDefault(),o(k.length-1))},G=s=>{const r=s.clipboardData.getData("text/plain"),g=s.target,P=k.findIndex(({character:w,inputRef:se})=>w===""||se.current===g),f=q(),R=We(f,qe(r),P).map((w,se)=>C(w,se)?w:""),W=le(R);a==null||a(W);const{isCompleted:L,finalValue:O}=F(W);L?(i==null||i(O),o(d-1)):o(W.length)},we=s=>{if(!k.some(({inputRef:r})=>r.current===s.relatedTarget)){const{isCompleted:r,finalValue:g}=F(p);A==null||A(g,r)}};return e.jsx(c,{display:"flex",gap:"20px",alignItems:"center",ref:l,className:`MuiOtpInput-Box ${u||""}`,...E,children:k.map(({character:s,inputRef:r},g)=>{const{onPaste:P,onFocus:f,onKeyDown:R,className:W,onBlur:L,...O}=typeof h=="function"?h(g)||{}:h||{};return e.jsx(_e,{autoFocus:m?g===0:!1,autoComplete:"one-time-code",value:s,inputRef:r,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${g+1} ${W||""}`,onPaste:w=>{w.preventDefault(),G(w),P==null||P(w)},onFocus:w=>{w.preventDefault(),w.target.select(),f==null||f(w)},onChange:ee,onKeyDown:w=>{I(w),R==null||R(w)},onBlur:w=>{L==null||L(w),we(w)},...O},g)})})}),Le="https://cc.wikitrak.in/api-proxy/api/v1",Xe=()=>{const{w_userToken:t,isOtpSection:l,isLogin:p,isForgot:d,isSignUp:m,loading:a}=re(u=>u.auth);Y("(min-width:600px)");const[h,i]=j.useState();re(u=>u.dashboard),K();const b=ue();return j.useEffect(()=>{t&&b("/dashboard")},[t]),e.jsxs(c,{sx:{border:"1px solid #ebeae8",width:"65%",px:"45px",py:!m&&"30px",borderRadius:5},children:[a&&e.jsx(be,{style:{position:"absolute",left:"50%",top:"45%",zIndex:9999}}),p&&e.jsx($e,{w_userToken:t}),m&&e.jsx(Ue,{}),d&&e.jsx(ze,{setEmail:i}),l&&e.jsx(He,{email:h})]})},fe=/^((\+[1-9]{1,4}[ -]?)|(\([0-9]{2,3}\)[ -]?)|([0-9]{2,4})[ -]?)*?[0-9]{3,4}[ -]?[0-9]{3,4}$/,Me=Z().shape({first_name:S().required("required"),last_name:S().required("required"),email:S().email("invalid email").required("required"),mobile:S().matches(fe,"Phone number is not valid").required("required"),password:S().required("Password is required").min(8,"Password must be at least 8 characters"),confirmPassword:S().oneOf([ge("password"),null],"Passwords must match").required("Confirm password is required"),workshop:S().required("Workshop is required"),workshopGroup:S().required("Workshop Group is required")}),Ee=Z().shape({mobile:S().matches(fe,"Phone number is not valid").required("required"),password:S().required("Password is required")}),Ve=Z().shape({email:S().email("invalid email").required("required")}),Ne=Z().shape({new_password:S().required("Password is required").min(8,"Password must be at least 8 characters"),confirmPassword:S().oneOf([ge("new_password"),null],"Passwords must match").required("Confirm password is required")}),De={first_name:"",last_name:"",email:"",mobile:"",password:"",confirmPassword:"",serial_number:"1234",device_type:"android",mac_id:"1234567890",workshop:"",workshopGroup:""},Ge={mobile:"",password:""},Oe={email:""},Be={new_password:"",confirmPassword:""},$e=()=>{const t=K(),l=Y("(min-width:600px)"),[p,d]=j.useState(!1),m=a=>{t(ye(a))};return e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(T,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Login"}),e.jsxs(T,{variant:"p",sx:{textAlign:"center",fontSize:"12px"},children:["Enter your credential to login the platform"," "]})]}),e.jsx(X,{onSubmit:m,initialValues:Ge,validationSchema:Ee,children:({values:a,errors:h,touched:i,handleBlur:b,handleChange:u,handleSubmit:A})=>e.jsxs("form",{onSubmit:A,children:[e.jsxs(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:l?void 0:"span 4"}},marginTop:"20px",children:[e.jsx(_,{fullWidth:!0,variant:"outlined",type:"text",label:"Mobile Number *",onBlur:b,onChange:u,value:a.mobile,name:"mobile",error:!!i.mobile&&!!h.mobile,helperText:i.mobile&&h.mobile,sx:{gridColumn:"span 4"}}),e.jsx(_,{fullWidth:!0,variant:"outlined",type:p?"text":"password",label:"Password *",onBlur:b,onChange:u,value:a.password,name:"password",error:!!i.password&&!!h.password,helperText:i.password&&h.password,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx($,{position:"end",children:e.jsx(U,{"aria-label":"toggle password visibility",onClick:()=>{d(!p)},edge:"end",children:p?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsx(c,{display:"flex",justifyContent:"flex-end",sx:{gridColumn:"span 4"},children:e.jsx(T,{variant:"body2",style:{fontSize:"12px",color:"#666666"},children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>{t(xe())},children:"Forgot Password ?"})})})]}),e.jsx(c,{display:"flex",justifyContent:"end",mt:"30px",children:e.jsx(J,{type:"submit",sx:{background:M.bgColor,width:"100%",p:"10px","&:hover":{background:M.bgShadow,color:"black"}},variant:"contained",children:"Log In"})}),e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsxs(T,{variant:"body2",children:["Didn't have an account?"," ",e.jsx("span",{style:{color:M.bgColor,cursor:"pointer"},onClick:()=>{t(ve())},children:"Sign Up"})]})})]})})]})},Ue=()=>{const t=K(),l=Y("(min-width:600px)"),[p,d]=j.useState(!1),[m,a]=j.useState(!1),[h,i]=j.useState([]),[b,u]=j.useState([]),[A,E]=j.useState(""),[D,N]=j.useState(!0),[F,k]=j.useState(null);j.useEffect(()=>{(async()=>{try{console.log("Fetching workshop list...");const{data:n}=await ke.get(`${Le}/workshop/group/`);console.log("Workshop list response data:",n==null?void 0:n.results),i(n==null?void 0:n.results)}catch(n){console.error("Error fetching workshop list:",n),k(n.message)}finally{N(!1)}})()},[]);const v=(x,n)=>{const o=x.target.value;E(o),n(x);const y=h.find(C=>C.group_name===o);u(y?y.workshop:[])};if(D)return e.jsx("div",{children:"Loading..."});if(F)return e.jsxs("div",{children:["Error: ",F]});const q=x=>{console.log("values",x),t(Ce(x))};return e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(T,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Sign Up"}),e.jsxs(T,{variant:"p",sx:{textAlign:"center",fontSize:"12px"},children:["Enter your credential to sign up the platform"," "]})]}),e.jsx(X,{onSubmit:q,initialValues:De,validationSchema:Me,children:({values:x,errors:n,touched:o,handleBlur:y,handleChange:C,handleSubmit:ee})=>e.jsxs("form",{onSubmit:ee,children:[e.jsxs(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:l?void 0:"span 4"}},marginTop:"20px",children:[e.jsx(_,{fullWidth:!0,variant:"outlined",type:"text",label:"First Name*",onBlur:y,onChange:C,value:x.first_name,name:"first_name",error:!!o.first_name&&!!n.first_name,helperText:o.first_name&&n.first_name,sx:{gridColumn:"span 2"}}),e.jsx(_,{fullWidth:!0,variant:"outlined",type:"text",label:"Last Name *",onBlur:y,onChange:C,value:x.last_name,name:"last_name",error:!!o.last_name&&!!n.last_name,helperText:o.last_name&&n.last_name,sx:{gridColumn:"span 2"}}),e.jsx(_,{fullWidth:!0,variant:"outlined",type:"email",label:"Email *",onBlur:y,onChange:C,value:x.email,name:"email",error:!!o.email&&!!n.email,helperText:o.email&&n.email,sx:{gridColumn:"span 4"}}),e.jsx(_,{fullWidth:!0,variant:"outlined",type:"text",label:"Mobile Number *",onBlur:y,onChange:C,value:x.mobile,name:"mobile",error:!!o.mobile&&!!n.mobile,helperText:o.mobile&&n.mobile,sx:{gridColumn:"span 4"}}),e.jsx(_,{fullWidth:!0,variant:"outlined",type:p?"text":"password",label:"Password *",onBlur:y,onChange:C,value:x.password,name:"password",error:!!o.password&&!!n.password,helperText:o.password&&n.password,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx($,{position:"end",children:e.jsx(U,{"aria-label":"toggle password visibility",onClick:()=>{d(!p)},edge:"end",children:p?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsx(_,{fullWidth:!0,variant:"outlined",type:m?"text":"password",label:"Confirm Password *",onBlur:y,onChange:C,value:x.confirmPassword,name:"confirmPassword",error:!!o.confirmPassword&&!!n.confirmPassword,helperText:o.confirmPassword&&n.confirmPassword,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx($,{position:"end",children:e.jsx(U,{"aria-label":"toggle password visibility",onClick:()=>{a(!m)},edge:"end",children:m?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsxs(te,{variant:"outlined",fullWidth:!0,sx:{gridColumn:"span 4"},error:!!o.workshopGroup&&!!n.workshopGroup,children:[e.jsx(ne,{id:"workshop-group-label",children:"Select Workshop Group"}),e.jsxs(oe,{labelId:"workshop-group-label",id:"workshopGroup",name:"workshopGroup",value:x.workshopGroup,onChange:I=>v(I,C),onBlur:y,children:[e.jsx(Q,{value:"",children:e.jsx("em",{children:"None"})}),h.map((I,G)=>e.jsx(Q,{value:I.group_name,children:I.group_name},G))]}),o.workshopGroup&&n.workshopGroup&&e.jsx(ie,{children:n.workshopGroup})]}),e.jsxs(te,{variant:"outlined",fullWidth:!0,sx:{gridColumn:"span 4"},error:!!o.workshop&&!!n.workshop,disabled:!A,children:[e.jsx(ne,{id:"workshop-label",children:"Select Workshop"}),e.jsxs(oe,{labelId:"workshop-label",id:"workshop",name:"workshop",value:x.workshop,onChange:C,onBlur:y,children:[e.jsx(Q,{value:"",children:e.jsx("em",{children:"None"})}),b.map((I,G)=>e.jsx(Q,{value:I.id,children:I.name},G))]}),o.workshop&&n.workshop&&e.jsx(ie,{children:n.workshop})]})]}),e.jsx(c,{display:"flex",justifyContent:"end",mt:"30px",children:e.jsx(J,{type:"submit",sx:{background:M.bgColor,width:"100%",p:"10px","&:hover":{background:M.bgShadow,color:"black"}},variant:"contained",children:"Sign Up"})}),e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsxs(T,{variant:"p",children:["Already User ?"," ",e.jsx("span",{style:{color:"orange",cursor:"pointer"},onClick:()=>t(me()),children:"Login"})]})})]})})]})},ze=({setEmail:t})=>{const l=K(),p=Y("(min-width:600px)"),d=m=>{t(m.email),l(he(m))};return e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(T,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Forgot Password"}),e.jsx(T,{variant:"p",sx:{textAlign:"center",fontSize:"12px"},children:"Enter your registered email to create the new password"})]}),e.jsx(X,{onSubmit:d,initialValues:Oe,validationSchema:Ve,children:({values:m,errors:a,touched:h,handleBlur:i,handleChange:b,handleSubmit:u})=>e.jsxs("form",{onSubmit:u,children:[e.jsx(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:p?void 0:"span 4"}},marginTop:"20px",children:e.jsx(_,{fullWidth:!0,variant:"outlined",type:"text",label:"Email Address *",onBlur:i,onChange:b,value:m.email,name:"email",error:!!h.email&&!!a.email,helperText:h.email&&a.email,sx:{gridColumn:"span 4"}})}),e.jsx(c,{display:"flex",justifyContent:"end",mt:"30px",children:e.jsx(J,{type:"submit",sx:{background:M.bgColor,width:"100%",p:"10px","&:hover":{background:M.bgShadow,color:"black"}},variant:"contained",children:"Submit"})}),e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsxs(T,{variant:"p",children:["Back to Login ?"," ",e.jsx("span",{style:{cursor:"pointer",color:"orange"},onClick:()=>{l(me())},children:"Login"})]})})]})})]})},He=({email:t})=>{const l=K();ue();const p=Y("(min-width:600px)"),[d,m]=j.useState(!1),[a,h]=j.useState(!1),[i,b]=j.useState(0),[u,A]=j.useState(10),[E,D]=j.useState("");j.useEffect(()=>{t||l(xe())},[]);const N=v=>{D(v)},F=v=>{t?E?(v.otp=E,v.email=t,l(Pe(v))):ae.error("please enter otp "):ae.error("Please enter your email address",{id:"clipboard"})},k=()=>{l(he({email:t})),b(0),A(10)};return j.useEffect(()=>{const v=setInterval(()=>{u>0&&A(u-1),u===0&&(i===0?clearInterval(v):(A(59),b(i-1)))},1e3);return()=>{clearInterval(v)}},[u]),e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(T,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Verify OTP"}),e.jsxs(T,{variant:"p",sx:{textAlign:"center",fontSize:"12px",width:"30%"},children:["Enter OTP to authenticate yourself, sent to ",t]})]}),e.jsx(c,{margin:"30px",children:e.jsx(Re,{length:4,value:E,onChange:N})}),e.jsx(X,{onSubmit:F,initialValues:Be,validationSchema:Ne,children:({values:v,errors:q,touched:x,handleBlur:n,handleChange:o,handleSubmit:y})=>e.jsxs("form",{onSubmit:y,children:[e.jsxs(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:p?void 0:"span 4"}},marginTop:"20px",children:[e.jsx(_,{fullWidth:!0,variant:"outlined",type:d?"text":"password",label:"New  Password *",onBlur:n,onChange:o,value:v.new_password,name:"new_password",error:!!x.new_password&&!!q.new_password,helperText:x.new_password&&q.new_password,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx($,{position:"end",children:e.jsx(U,{"aria-label":"toggle password visibility",onClick:()=>m(!d),edge:"end",children:d?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsx(_,{fullWidth:!0,variant:"outlined",type:a?"text":"password",label:"Confirm Password *",onBlur:n,onChange:o,value:v.confirmPassword,name:"confirmPassword",error:!!x.confirmPassword&&!!q.confirmPassword,helperText:x.confirmPassword&&q.confirmPassword,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx($,{position:"end",children:e.jsx(U,{"aria-label":"toggle password visibility",onClick:()=>h(!a),edge:"end",children:a?e.jsx(H,{}):e.jsx(z,{})})})}})]}),e.jsx(c,{sx:{my:"29px"},children:e.jsx(J,{type:"submit",sx:{background:M.bgColor,width:"100%",p:"10px","&:hover":{background:M.bgShadow,color:"black"}},variant:"contained",children:"submit"})})]})}),e.jsx(c,{mt:"35px",children:e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsx(T,{variant:"p",children:e.jsx("span",{children:u>0||i>0?e.jsxs("p",{children:["Resend OTP in: ",i<10?`0${i}`:i,":",u<10?`0${u}`:u]}):e.jsxs("p",{children:["Didn't receive code ?",e.jsxs("span",{style:{color:"blue",cursor:"pointer"},onClick:k,children:[" ","Resend OTP"]})]})})})})})]})};export{Xe as F,H as V,z as a};
