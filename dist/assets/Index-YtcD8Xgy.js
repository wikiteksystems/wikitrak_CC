import{a8 as fe,j as e,y as A,b as c,x as T,ab as he,B as _,D as E,T as k,F as N,ax as ge,av as ft,aw as mt,ay as wt,az as jt,aA as te,aB as bt,K as Je,a5 as yt,$ as vt,a0 as St,a2 as Ct}from"./index-DFIULFn2.js";import{P as At,Q as kt,S as Rt,L as Dt}from"./LeftSideBar2-BAj_2RA3.js";import{r as me}from"./createSvgIcon-CmZwwv7a.js";import{d as It}from"./NotificationsNone-LILx6Kr3.js";import{d as Te}from"./Close-DB4tUmP-.js";import{B as a,C as Ot}from"./CircularProgress-CWnAPB2N.js";import{T as pe}from"./Tooltip-BUyYvv4R.js";import{I as ue}from"./IconButton-Cmqcb3WR.js";import{V as Lt}from"./VehicleMenu-B46J3aU1.js";import{m as Et}from"./menu2-vKyyp5to.js";import{t as V}from"./Search-CmDiKBSd.js";import{V as Ve,a as Ke}from"./Form-sb5hZEDh.js";import{F as Pt}from"./formik.esm-CquBk7-6.js";import{c as _t,a as Ye,b as Nt}from"./index.esm-CCFnS3Ep.js";import{u as Ft}from"./useMediaQuery-Bz4DfMtY.js";import{T as Qe}from"./TextField-DfFByDYP.js";import{I as qe}from"./InputAdornment-CNWd5Q-r.js";import{m as oe}from"./motorbike-Ci4voNFa.js";import{u as Mt,G as Gt,C as Wt,P as zt,M as Bt}from"./esm-oBE-rW4D.js";import{S as xe}from"./Switch-DdCMDESO.js";import{I as Xt}from"./Select-DJyKKsKH.js";/* empty css           */import"./proj-XQwXs9DQ.js";import"./OutlinedInput-BSR0DPbh.js";import"./Paper-omF3doHZ.js";import"./RegionSelector-B4r2ybWx.js";import"./SearchTab-BWfhXvQc.js";import"./index-Pb7O91MQ.js";import"./roundedArrow-BeMxvjWC.js";import"./TextArea-C45RluEo.js";import"./MenuItem-CxQ8Tzra.js";var we={},Ut=fe;Object.defineProperty(we,"__esModule",{value:!0});var $e=we.default=void 0,Ht=Ut(me()),Jt=e;$e=we.default=(0,Ht.default)((0,Jt.jsx)("path",{d:"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonOutlined");var je={},Tt=fe;Object.defineProperty(je,"__esModule",{value:!0});var et=je.default=void 0,Vt=Tt(me()),Kt=e;et=je.default=(0,Vt.default)((0,Kt.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff");const Ze="https://cc.wikitrak.in/proxy-3031",Yt=()=>{const{selectedVehicle:t}=A(i=>i.liveMap);A(i=>i.geofence);const{mode:x}=A(i=>i.dashboard),n=V(x),[h,l]=c.useState([]),[f,b]=c.useState(null),[d,w]=c.useState(!1),[y,S]=c.useState(10),p=c.useRef(null);let R=T();c.useEffect(()=>{v()},[R,t]),c.useEffect(()=>{p.current&&(p.current.scrollTop=0)},[h]);const v=async()=>{var i,s,u;if(Object.keys(t).length>0){let j={imei:t==null?void 0:t.imei};try{w(!0);const L=await he.post(`${Ze}/ccServer/location/getNotifications`,j);((s=(i=L==null?void 0:L.data)==null?void 0:i.notifications)==null?void 0:s.length)>0?l((u=L==null?void 0:L.data)==null?void 0:u.notifications):_.error("No Geofence Alert For Selected Vehicle."),w(!1)}catch(L){console.log("error while getting gfAlertHistory",L),_.error(`Geofence ${L==null?void 0:L.message}`),w(!1)}}},O=async i=>{try{const s=await he.post(`${Ze}/ccServer/location/updateNotifications`,{_id:i==null?void 0:i._id});v()}catch(s){console.log("error while getting gfAlertHistory",s),_.error(`Geofence ${s==null?void 0:s.message}`),w(!1)}},D=()=>{S(i=>i+10)};return e.jsxs(a,{sx:{padding:"15px",display:"flex",flexDirection:"column",gap:"15px",color:n.grey[400],backgroundColor:n.grey[100],height:"86vh",overflowY:"auto",scrollBehavior:"smooth"},ref:p,children:[d&&e.jsx(a,{style:{width:"100%",margin:"auto",display:"flex",justifyContent:"center"},children:e.jsx(Ot,{style:{color:E.bgColor}})}),!d&&h.length===0&&e.jsx(k,{style:{width:"100%",margin:"auto",color:n.grey[400],textAlign:"center"},children:"No Alerts"}),!d&&h.length>0&&h.slice(0,y).map((i,s)=>{var u;return e.jsxs(a,{sx:{position:"relative"},onMouseEnter:()=>b(s),onMouseLeave:()=>b(null),children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",color:n.grey[400]},children:[e.jsx(k,{children:e.jsx("b",{children:i==null?void 0:i.type})}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:(u=i==null?void 0:i.createdAt)==null?void 0:u.slice(0,10)}),e.jsx("span",{style:{paddingLeft:"15px"},children:new Date(i==null?void 0:i.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]}),e.jsxs(a,{sx:{display:"flex",border:"1px solid #686868",padding:"5px",borderRadius:"5px",color:"#686868","&:hover":{background:E.bgShadow,color:"black"}},children:[e.jsx("img",{style:{width:"30px",height:"30px",borderRadius:"5px",marginRight:"15px",alignItems:"center",marginTop:"15px"},src:Et,alt:"logo"}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column"},children:[e.jsxs(k,{sx:{fontSize:"15px",width:"100%"},children:["Your Vehicle No."," ",Object.keys(t).length>0?t.reg_id:"XXX"]}),e.jsx(k,{children:i==null?void 0:i.msg})]})]}),f===s&&e.jsx(et,{onClick:()=>{O(i)},sx:{position:"absolute",top:"35%",left:"84.4%",transform:"translate(-50%, -50%)",fontWeight:"600",color:"black",cursor:"pointer"}})]},s)}),!d&&y<h.length&&e.jsx(a,{sx:{display:"flex",justifyContent:"center",marginTop:"15px"},children:e.jsx(N,{variant:"outlined",onClick:D,sx:{border:`1px solid ${E.bgShadow}`,color:n.grey[400],"&:hover":{background:E.bgColor,color:"white",border:`1px solid ${E.bgShadow}`}},children:"Load More"})})]})},tt="/assets/4W-zFlpw5ld.png",Qt="/assets/preet_tractor-2erNEHvu.png",qt="/assets/3W-DS7zfQvi.png";var be={},Zt=fe;Object.defineProperty(be,"__esModule",{value:!0});var ot=be.default=void 0,$t=Zt(me()),eo=e;ot=be.default=(0,$t.default)((0,eo.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Place");const to=({title:t,setShowContent:x,showContent:n,showMap:h,setShowMap:l,setShowGfBar:f,showGfBar:b,setShowGfAlert:d,showGfAlert:w})=>{const{collapsed:y}=A(s=>s.auth),{selectedVehicle:S,tractorIcon:p}=A(s=>s.liveMap),{vehicleSideBar:R}=A(s=>s.geofence);c.useState(!1);const{mode:v}=A(s=>s.dashboard);JSON.parse(localStorage.getItem("w_userDetails"));const O=T(),D=()=>{O(mt(!y))},i=()=>{x({...n,vehicle:!n.vehicle}),f(!1),d(!1),O(ge({data:!R}))};return e.jsxs(a,{display:"flex",justifyContent:"space-between",p:1,sx:{bgcolor:E.bgColor,border:"1px solid white",borderRadius:"4px",height:"55px"},children:[e.jsxs(a,{style:{display:"flex",justifyContent:"space-between",gap:"10px",alignItems:"center"},children:[y?e.jsx(N,{onClick:D,sx:{color:"white"},children:e.jsx(At,{style:{width:"30px",height:"30px"}})}):e.jsx(N,{onClick:D,sx:{color:"white"},children:e.jsx(kt,{style:{width:"30px",height:"30px"}})}),e.jsx("img",{src:Rt,alt:"wikitrak logo"})]}),e.jsx(a,{children:e.jsx(k,{variant:"h6",color:"white",fontWeight:"bold",sx:{ml:"15px",mt:"15px"},children:Object.keys(S).length>0&&h?`${t} - Geofence (${S.reg_id})`:e.jsxs(e.Fragment,{children:[t," ",Object.keys(S).length>0&&S.reg_id]})})}),e.jsxs(a,{sx:{display:"flex"},children:[e.jsxs(N,{variant:"outlined",size:"small",sx:{color:n.vehicle?"white":"black",backgroundColor:n.vehicle?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:i,children:[n.vehicle&&e.jsx(Te,{style:{marginRight:"5px",fontWeight:"bold"}}),e.jsx("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",style:{marginRight:"5px"},children:e.jsx("path",{d:p.path1})}),Object.keys(S).length>0?S.reg_id:"Vehicles"]}),h&&e.jsx(a,{children:e.jsxs(N,{variant:"outlined",size:"small",sx:{color:b?"white":"black",backgroundColor:b?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{d(!1),f(!b),O(ge({data:!1}))},children:[b&&e.jsx(Te,{style:{marginRight:"5px",fontWeight:"bold"}}),"Geofence"]})}),e.jsx(a,{sx:{color:"white",mr:"10px"},children:e.jsxs(a,{sx:{display:"flex",marginTop:"14px",gap:"10px"},children:[e.jsx(a,{onClick:()=>{f(!1),d(!w),O(ge({data:!1}))},children:e.jsx(pe,{title:"Notifications",children:e.jsx(It,{sx:{cursor:"pointer",width:"30px",height:"30px"}})})}),e.jsx(a,{onClick:()=>{x({...n,user:!n.user}),l(!1)},children:n.user?e.jsx(pe,{title:"Geofence setting",children:e.jsx(ot,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}})}):e.jsx(pe,{title:"User setting",children:e.jsx($e,{sx:{mr:"2px",cursor:"pointer",width:"30px",height:"30px"}})})})]})}),e.jsx(ue,{onClick:()=>{O(ft(!v))},sx:{color:"white"}})]})]})},oo=to,so=()=>{const t=T(),x=Ft("(min-width:600px)"),[n,h]=c.useState(!1),[l,f]=c.useState(!1),{mode:b}=A(p=>p.dashboard),d=V(b),w={new_password:"",confirmPassword:""},y=_t().shape({new_password:Ye().required("Password is required").min(8,"Password must be at least 8 characters"),confirmPassword:Ye().oneOf([Nt("new_password"),null],"Passwords must match").required("Confirm password is required")}),S=p=>{console.log("values",p);let R=p.confirmPassword;t(wt({new_password:R}))};return e.jsx(a,{sx:{display:"flex",justifyContent:"center"},children:e.jsxs(a,{sx:{width:"30%"},children:[e.jsx(a,{sx:{align:"center"},children:e.jsx(k,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",align:"center",color:d.grey[400]},children:"Change Password"})}),e.jsx(Pt,{onSubmit:S,initialValues:w,validationSchema:y,children:({values:p,errors:R,touched:v,handleBlur:O,handleChange:D,handleSubmit:i})=>e.jsxs("form",{onSubmit:i,children:[e.jsxs(a,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:x?void 0:"span 4"}},marginTop:"20px",children:[e.jsx(Qe,{fullWidth:!0,variant:"outlined",type:n?"text":"password",label:"New Password",onBlur:O,onChange:D,value:p.new_password,name:"new_password",error:!!v.new_password&&!!R.new_password,helperText:v.new_password&&R.new_password,sx:{gridColumn:"span 4",backgroundColor:"white",borderRadius:"5px"},InputProps:{endAdornment:e.jsx(qe,{position:"end",children:e.jsx(ue,{"aria-label":"toggle password visibility",onClick:()=>h(!n),edge:"end",children:n?e.jsx(Ve,{}):e.jsx(Ke,{})})})}}),e.jsx(Qe,{fullWidth:!0,variant:"outlined",type:l?"text":"password",label:"Confirm Password",onBlur:O,onChange:D,value:p.confirmPassword,name:"confirmPassword",error:!!v.confirmPassword&&!!R.confirmPassword,helperText:v.confirmPassword&&R.confirmPassword,sx:{gridColumn:"span 4",backgroundColor:"white",borderRadius:"5px"},InputProps:{endAdornment:e.jsx(qe,{position:"end",children:e.jsx(ue,{"aria-label":"toggle password visibility",onClick:()=>f(!l),edge:"end",children:l?e.jsx(Ve,{}):e.jsx(Ke,{})})})}})]}),e.jsx(a,{sx:{my:"29px"},children:e.jsx(N,{type:"submit",sx:{background:E.bgColor,width:"100%",p:"10px","&:hover":{background:E.bgShadow,color:d.grey[100]}},variant:"contained",children:"submit"})})]})})]})})};let ao="https://admin.wikitrak.in";const ro=()=>{var l,f;const t=JSON.parse(localStorage.getItem("w_userDetails")),{mode:x}=A(b=>b.dashboard),n=V(x),h=()=>{window.open(ao,"_blank")};return e.jsxs(a,{children:[e.jsxs(a,{sx:{backgroundColor:n.grey[200],m:"10px",borderRadius:"5px",height:"150px"},children:[e.jsx(a,{sx:{pl:"20px",pt:"10px",mb:"10px",color:`${n.grey[400]}`},children:e.jsx("b",{children:"User Settings"})}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderRadius:"8px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(a,{sx:{ml:"23px",mt:"11px",height:"70px",width:"70px",backgroundColor:"white",borderRadius:"50%",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.1)"}}),e.jsxs(a,{sx:{height:"80px",width:"200px",display:"flex",justifyContent:"center",flexDirection:"column",ml:3,color:n.grey[400]},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"1.2rem"},children:t&&e.jsxs(e.Fragment,{children:[t.first_name.charAt(0).toUpperCase()+t.first_name.slice(1).toLowerCase()," ",t.last_name.charAt(0).toUpperCase()+t.last_name.slice(1).toLowerCase()]})}),e.jsx(a,{children:t&&((l=t==null?void 0:t.new_role)==null?void 0:l.name)})]})]}),(t==null?void 0:t.role)&&jt.includes((f=t==null?void 0:t.new_role)==null?void 0:f.name)&&e.jsx(a,{children:e.jsx(N,{variant:"contained",sx:{backgroundColor:"white",color:n.grey[300],textTransform:"none",fontWeight:"bold","&:hover":{backgroundColor:"black",color:"white"}},onClick:h,children:"Go to admin page"})})]})]}),e.jsx(a,{sx:{marginTop:"9%",alignContent:"center",textAlign:"center"},children:e.jsx(so,{})})]})},no=ro,lo="/assets/3W-KvFQeYgh.jpeg",io="data:image/png;base64,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";function co({shapeType:t,setShapeType:x}){const n=h=>{console.log("selectedType",h),x(h)};return e.jsxs(a,{children:[e.jsx(N,{onClick:()=>{n("circular")},style:{background:t==="circular"?E.bgColor:"transparent",color:t==="circular"?"white":te[400],margin:"0 5px"},children:"Circle"}),e.jsx(N,{onClick:()=>{n("polygon")},style:{background:t==="polygon"?E.bgColor:"transparent",color:t==="polygon"?"white":te[400],margin:"0 5px"},children:"Polygon"})]})}function go({shapeType:t,center:x,radius:n,active:h,setActive:l,setInward:f,inward:b,setSpeedLimit:d,speedLimit:w,setSpeedValue:y,handleGeofence:S,speedValue:p,setRadius:R}){var i,s;const{selectedVehicle:v,locationData:O,tractorIcon:D}=A(u=>u.liveMap);return e.jsxs(a,{sx:{display:"flex",padding:"15px",flexDirection:"column",gap:"10px",color:te[600]},children:[e.jsx(k,{sx:{fontWeight:"bold",fontSize:"16px"},children:"Geofence Setting"}),e.jsxs(k,{sx:{fontWeight:"400",fontSize:"14px",textTransform:"capitalize"},children:["Type: ",t]}),t==="circular"&&e.jsxs(e.Fragment,{children:[e.jsx(k,{sx:{color:"#686868"},children:"Centered At "}),e.jsxs(k,{sx:{color:"#686868"},children:["Lat: ",(i=x==null?void 0:x.lat)==null?void 0:i.toFixed(2)]}),e.jsxs(k,{sx:{color:"#686868"},children:["Lng: ",(s=x==null?void 0:x.lng)==null?void 0:s.toFixed(2)]}),e.jsxs(k,{sx:{color:"#686868",border:"1px solid #686868",borderRadius:"4px",padding:"8px"},children:["Radius ( ",(n/1e3).toFixed(2)," in km) ",e.jsx("input",{type:"text",value:n/1e3,onChange:u=>{R(u.target.value*1e3)},placeholder:"enter radius"})," in KM"]})]}),e.jsxs(a,{display:"flex",alignItems:"center",children:[e.jsx(k,{variant:"body1",component:"b",children:h?"Active":"Inactive"}),e.jsx(xe,{defaultChecked:h,onChange:()=>{l(!h)},color:"primary",inputProps:{"aria-label":"toggle active state"}})]}),e.jsxs(a,{display:"flex",alignItems:"center",children:[e.jsx(k,{variant:"body1",component:"b",children:b?"Inward":"Outward"}),e.jsx(xe,{checked:b,onChange:()=>{f(!b)},color:"primary",inputProps:{"aria-label":"toggle direction"}})]}),e.jsxs(a,{display:"flex",alignItems:"center",children:[e.jsx(xe,{checked:w,onChange:()=>{d(!w)},color:"primary",inputProps:{"aria-label":"toggle direction"}}),e.jsx(k,{variant:"body1",component:"b",children:"Speed Limit"})]}),w&&e.jsx(a,{sx:{},children:e.jsx(Xt,{sx:{width:"100%",color:te[600],border:"none","&:focus":{outline:"none"}},value:p,placeholder:"Enter Speed Limit",type:"number",onChange:u=>{const j=Math.max(0,parseInt(u.target.value));y(j)}})}),e.jsx(N,{disabled:Object.keys(v).length===0&&!1,variant:"outlined",size:"small",sx:{color:"white",backgroundColor:E.bgColor,mt:"6px",mx:"5px",border:"1px solid white",height:"40px",width:"100%","&:hover":{color:"black",background:E.bgShadow,border:"1px solid black"},letterSpacing:"1.5px",fontSize:"16px"},onClick:()=>{if(Object.keys(v).length===0)return _.error("please select a vehicle.");S()},children:"SUBMIT"})]})}const po="https://cc.wikitrak.in/proxy-3031",xo="AIzaSyD8TrUWS9FRTu-MRP339mJF_iWlORvEGUA",ho=({showGfBar:t,showGfAlert:x})=>{const{isLoaded:n,loadError:h}=Mt({googleMapsApiKey:`${xo}`}),{selectedVehicle:l,locationData:f,tractorIcon:b}=A(r=>r.liveMap),{geofence:d,vehicleSideBar:w}=A(r=>r.geofence),{mode:y,styles:S,vehicles_details:p}=A(r=>r.dashboard),{collapsed:R}=A(r=>r.auth),[v,O]=c.useState(null),[D,i]=c.useState(null),[s,u]=c.useState(1e3),[j,L]=c.useState([]),[K,g]=c.useState(!0),[z,B]=c.useState(!1),[F,se]=c.useState(!1),[I,X]=c.useState({lat:18.516726,lng:73.856255}),[ae,re]=c.useState(50),[P,ne]=c.useState("circular"),[ye,U]=c.useState([{lat:I.lat+.01,lng:I.lng},{lat:I.lat-.01,lng:I.lng-.01},{lat:I.lat-.01,lng:I.lng+.01}]),[le,ie]=c.useState(!1),st=c.useRef(null),ce=c.useRef(!1),Y=c.useRef(null);let at=T();c.useEffect(()=>{rt()},[l]),c.useEffect(()=>{le&&U([{lat:I.lat+.01,lng:I.lng},{lat:I.lat-.01,lng:I.lng-.01},{lat:I.lat-.01,lng:I.lng+.01}])},[le]),c.useEffect(()=>{var r,m,C,M,G,Q,q,Z;if(f.length>0&&Object.keys(l).length>0){let W=f==null?void 0:f.filter(ee=>{var $;return(($=ee.latestDocument)==null?void 0:$.imei)===l.imei});L(W),X({lat:(m=(r=W[0])==null?void 0:r.latestDocument)==null?void 0:m.lat,lng:(M=(C=W[0])==null?void 0:C.latestDocument)==null?void 0:M.lng});let H=(Q=(G=W[0])==null?void 0:G.latestDocument)==null?void 0:Q.lat,J=(Z=(q=W[0])==null?void 0:q.latestDocument)==null?void 0:Z.lng;le&&U([{lat:H+.01,lng:J},{lat:H-.01,lng:J-.01},{lat:H-.01,lng:J+.01}])}},[l,f,P]),c.useEffect(()=>{v&&D&&v.fitBounds(D)},[v,D]);const rt=async()=>{var r,m,C,M,G,Q,q,Z,W,H,J,ee,$,Se,Ce,Ae,ke,Re,De,Ie,Oe,Le,Ee,Pe,_e,Ne,Fe,Me,Ge,We,ze,Be,Xe,Ue,He;if(Object.keys(l).length>0)try{const o=await he.get(`${po}/api/get/geofance/${l==null?void 0:l.imei}`);if(console.log(o.data.geofenceData,"result"),((m=(r=o==null?void 0:o.data)==null?void 0:r.geofenceData)==null?void 0:m.area_type)==="circular")if(ne("circular"),ie(!0),(M=(C=o==null?void 0:o.data)==null?void 0:C.geofenceData)!=null&&M.lat)X({lat:(Q=(G=o==null?void 0:o.data)==null?void 0:G.geofenceData)==null?void 0:Q.lat,lng:(Z=(q=o==null?void 0:o.data)==null?void 0:q.geofenceData)==null?void 0:Z.long}),u((H=(W=o==null?void 0:o.data)==null?void 0:W.geofenceData)==null?void 0:H.radius),g((ee=(J=o==null?void 0:o.data)==null?void 0:J.geofenceData)==null?void 0:ee.isActive_Geofance),B(((Se=($=o==null?void 0:o.data)==null?void 0:$.geofenceData)==null?void 0:Se.type)==="inward"),se((Ae=(Ce=o==null?void 0:o.data)==null?void 0:Ce.geofenceData)==null?void 0:Ae.isActive_Speed),re((Re=(ke=o==null?void 0:o.data)==null?void 0:ke.geofenceData)==null?void 0:Re.speed);else return _.success("No Geofence For Selected Vehicle",{id:"getting geofence"});else((Ie=(De=o==null?void 0:o.data)==null?void 0:De.geofenceData)==null?void 0:Ie.area_type)==="polygon"&&(ie(!1),ne("polygon"),console.log("get for polygon",(Oe=o==null?void 0:o.data)==null?void 0:Oe.geofenceData),U((Ee=(Le=o==null?void 0:o.data)==null?void 0:Le.geofenceData)==null?void 0:Ee.polygon_points),re((_e=(Pe=o==null?void 0:o.data)==null?void 0:Pe.geofenceData)==null?void 0:_e.speed),g((Fe=(Ne=o==null?void 0:o.data)==null?void 0:Ne.geofenceData)==null?void 0:Fe.isActive_Geofance),B(((Ge=(Me=o==null?void 0:o.data)==null?void 0:Me.geofenceData)==null?void 0:Ge.type)==="inward"),X({lat:(ze=(We=o==null?void 0:o.data)==null?void 0:We.geofenceData)==null?void 0:ze.lat,lng:(Xe=(Be=o==null?void 0:o.data)==null?void 0:Be.geofenceData)==null?void 0:Xe.long}),se((He=(Ue=o==null?void 0:o.data)==null?void 0:Ue.geofenceData)==null?void 0:He.isActive_Speed))}catch(o){ie(!0),console.log("vehicleDetail",j),console.log(o,"error while getting geofence"),_.error("No geofence has been set for this vehicle.",{id:"getting geofence"})}},nt=r=>{O(r)},lt=()=>{if(Object.keys(l).length>0){let r;P==="circular"?r={imei:l.imei,area_type:P,type:z?"inward":"outward",lat:I.lat,long:I.lng,radius:s,isActive_Geofance:K,isActive_Speed:!!F,speed:F?ae:5}:P==="polygon"&&(r={imei:l.imei,area_type:P,type:z?"inward":"outward",polygon_points:ye,isActive_Geofance:K,isActive_Speed:!!F,speed:F?ae:50}),at(bt({data:r})),_.success("Successful Saved",{id:"geofence"})}else _.error("Please Select Vehicle",{id:"geofence"})},it=()=>{if(!ce.current){ce.current=!0;const r=de.getRadius();console.log("newRadius",r),u(r),ce.current=!1}},ct=r=>{console.log("New Center:",r.toJSON()),X(r.toJSON())},dt=()=>{if(Y.current&&Y.current.getPath){const m=Y.current.getPath().getArray().map(C=>({lat:C.lat(),lng:C.lng()}));U(m),console.log("newVertices",m)}},gt=r=>{Y.current=r},pt=r=>{const m=p&&(p==null?void 0:p.length)>0&&p.find(C=>String(C==null?void 0:C.value)===String(r)&&(C==null?void 0:C.vehilce_type));return console.log("vehicle: ",m),m?m.vehilce_type:null},ve={paths:ye,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0}};if(h)return"Error loading maps";if(!n)return"Loading maps";const xt={width:"100%",height:"86.8vh"};let de;const ht=r=>{const m={lat:r.latLng.lat(),lng:r.latLng.lng()};if(P!=="circular"){let C=[{lat:m.lat+.01,lng:m.lng},{lat:m.lat-.01,lng:m.lng-.01},{lat:m.lat-.01,lng:m.lng+.01}];U(C),X(m)}else X(m)},ut=()=>{var m,C,M;let r=(M=(C=(m=Y.current)==null?void 0:m.getPath())==null?void 0:C.getArray())==null?void 0:M.map(G=>({lat:G.lat(),lng:G.lng()}));U(r)};return e.jsxs(e.Fragment,{children:[e.jsx(co,{setShapeType:ne,shapeType:P}),e.jsxs(a,{sx:{display:"flex",flexDirection:"row"},children:[e.jsxs(Gt,{ref:st,mapContainerStyle:xt,zoom:15,center:I,onClick:ht,onLoad:nt,options:{mapTypeControl:!1,styles:y?S:""},children:[P==="circular"&&e.jsx(Wt,{center:I,radius:s,options:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!0,editable:!0},onLoad:r=>{de=r,de.addListener("radius_changed",it)},onDragEnd:r=>ct(r.latLng)}),P==="polygon"&&e.jsx(zt,{paths:ve.paths,options:ve.options,draggable:!0,editable:!0,onDragEnd:dt,onLoad:gt,onMouseUp:r=>ut()}),j&&j.length>0&&j.map((r,m)=>{const C=pt(r.latestDocument.imei);return e.jsx(Bt,{position:{lat:r.latestDocument.lat,lng:r.latestDocument.lng},icon:{url:(()=>{switch(C){case"2W":return oe;case"3W":return qt;case"4W":return tt;case"Tractor":return Qt;default:return oe}})(),fillColor:"red",fillOpacity:2,strokeWeight:1,size:new window.google.maps.Size(55,55),scaledSize:new window.google.maps.Size(55,55),scale:2}},m)})]}),t&&!x&&!w&&I&&e.jsx(a,{sx:{width:R?"25%":"20%"},children:e.jsx(go,{shapeType:P,center:I,radius:s,active:K,setActive:g,setInward:B,inward:z,setSpeedLimit:se,speedLimit:F,setSpeedValue:re,handleGeofence:lt,speedValue:ae,setRadius:u})})]})]})},uo=({findTypeVehicle:t,statusVehicle:x})=>{var b,d,w;const{selectedVehicle:n}=A(y=>y.liveMap),{mode:h}=A(y=>y.dashboard),l=V(h),f=[{label:"Reg Number",value:(n==null?void 0:n.reg_id)||"NA"},{label:"IMEI Number",value:(n==null?void 0:n.imei)||"NA"},{label:"Chassis Number",value:(t==null?void 0:t.chassis_no)||"NA"},{label:"Engine Number",value:(t==null?void 0:t.engine_no)||"NA"},{label:"Date of Sell",value:(t==null?void 0:t.sell_date)||"NA"},{label:"Workshop Name",value:((b=t==null?void 0:t.workShop)==null?void 0:b.name)+`(City:${(w=(d=t==null?void 0:t.workShop)==null?void 0:d.city)==null?void 0:w.name})`||"NA"},{label:"Customer Name",value:(t==null?void 0:t.customer_name)||"NA"},{label:"Status",value:x?"On":"Off"}];return e.jsx(a,{sx:{padding:"20px"},children:e.jsx(Je,{container:!0,spacing:2,children:f.map((y,S)=>e.jsx(Je,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(a,{sx:{padding:"20px",borderRadius:"8px",boxShadow:"rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 2px 6px 2px",textAlign:"center"},children:[e.jsx(k,{sx:{fontWeight:"bold",color:l.grey[600]},children:y.label}),e.jsx(k,{sx:{color:l.grey[300]},children:Object.keys(n).length>0?y.value:"Please select vehicle"})]})},S))})})},fo=({showMap:t,setShowMap:x,showGfBar:n,showGfAlert:h})=>{const{selectedVehicle:l,onlineVehicle:f}=A(s=>s.liveMap),{mode:b,vehicles_details:d}=A(s=>s.dashboard),w=V(b),[y,S]=c.useState(!1),[p,R]=c.useState();let v=T();c.useEffect(()=>{console.log("onlineVehicle",f),console.log("selectedVehicle",l);let s=f.find(u=>u==l.imei);console.log("isActive",s),s?S(!0):(S(!1),console.log("Vehicle is not active"))},[f,l]),c.useEffect(()=>{if(v(yt({})),Object.keys(l).length>0){let s=D(l==null?void 0:l.imei);R(s)}},[l]);const O=s=>{const u=d&&(d==null?void 0:d.length)>0&&d.find(j=>(j==null?void 0:j.value)===s&&(j==null?void 0:j.vehilce_type));return u?u.vehilce_type:null},D=s=>{const u=d&&(d==null?void 0:d.length)>0&&d.find(j=>(j==null?void 0:j.value)===s&&j);return u||null},i=Object.keys(l).length>0?O(l.imei):null;return`${w.grey[300]}`,w.grey[300],e.jsx(e.Fragment,{children:t?e.jsx(ho,{showGfBar:n,showGfAlert:h}):e.jsxs(e.Fragment,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",background:w.grey[200],margin:"10px",padding:"10px",borderRadius:"8px"},children:[e.jsxs(a,{sx:{},children:[e.jsx(k,{sx:{fontWeight:"bold",fontSize:"16px",margin:"4px",color:w.grey[400]},children:"Vehicle Settings"}),e.jsx(a,{sx:{display:"flex"},children:e.jsx(a,{sx:{border:"2px solid white",padding:"10px",borderRadius:"5px",background:"white",marginRight:"5px"},children:e.jsx("img",{src:(()=>{switch(i){case"2W":return oe;case"3W":return lo;case"4W":return tt;default:return oe}})(),alt:"vehicleIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}})})})]}),e.jsxs(a,{onClick:()=>{x(!t)},sx:{cursor:"pointer",marginTop:"50px"},children:[e.jsx("img",{src:io,alt:"tractorIcon",style:{width:"80px",height:"75px",borderRadius:"5px",marginRight:"20px"}}),e.jsx(k,{sx:{fontSize:"12px",color:w.grey[400]},children:"Set Geofence"})]})]}),e.jsx(uo,{findTypeVehicle:p,statusVehicle:y})]})})};function Ko(){const{w_customer_id:t}=A(s=>s.auth),{vehicleSideBar:x}=A(s=>s.geofence),{collapsed:n}=A(s=>s.auth),{mode:h}=A(s=>s.dashboard),l=V(h),[f,b]=c.useState([]);c.useState([]);const[d,w]=c.useState({user:!0,vehicle:!1}),[y,S]=c.useState(!1),[p,R]=c.useState(!1),[v,O]=c.useState(!1);let D=T();c.useEffect(()=>{i()},[]);const i=async()=>{try{let s=[],u=[];const j=await D(vt({w_customer_id:t}));if(j.payload&&Array.isArray(j.payload)){j.payload.forEach(g=>{var z,B,F;g.imei&&Array.isArray(g.imei)&&g.imei.length>0&&((z=g.imei[0])!=null&&z.mac_id)?(s.push({id:g.id,label:g.registration_id,value:(B=g.imei[0])==null?void 0:B.mac_id,vehilce_type:g==null?void 0:g.segment,chassis_no:g==null?void 0:g.chassis_no,engine_no:g==null?void 0:g.engine_no,workShop:g==null?void 0:g.workshop,registration_id:g==null?void 0:g.registration_id,sell_date:g==null?void 0:g.sell_date}),u.push((F=g.imei[0])==null?void 0:F.mac_id)):console.error("IMEI data not found for item:",g)});const L="one",K=u;u.length>0&&D(St({type:L,imei:K})),b(s),D(Ct(s))}else console.error("Unexpected data format or empty payload:",j),_.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),_.error(`Error fetching vehicle data: ${s}`)}};return e.jsxs("div",{className:"app",children:[e.jsx(Dt,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:l.grey[100]},children:[e.jsx(oo,{title:"Settings",setShowContent:w,showContent:d,showMap:y,setShowMap:S,showGfBar:p,setShowGfBar:R,showGfAlert:v,setShowGfAlert:O}),e.jsxs(a,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(a,{style:{width:x?"80%":"100%",border:`1px solid ${l.grey[800]}`,borderRadius:"2px"},children:d.user?e.jsx(no,{}):e.jsx(fo,{showMap:y,setShowMap:S,showGfBar:p,showGfAlert:v})}),!v&&!p&&x&&e.jsx(a,{style:{width:"20%"},children:e.jsx(Lt,{vehicleData:f,title:"Setting"})}),v&&!p&&!x&&e.jsx(a,{sx:{width:n?"25%":"20%"},children:e.jsx(Yt,{})})]})]})]})}export{Ko as default};
