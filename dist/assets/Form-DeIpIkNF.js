import{c as pe,j as e,R as M,B as c,s as je,p as re,r as j,o as K,A as ue,ad as be,T as _,cO as U,m as $,cU as xe,C as Y,z as E,cV as ve,cf as te,cg as ne,ch as oe,ci as X,cW as me,cX as ye,ak as ke,cY as Ce,cZ as he,c_ as Pe,V as ie}from"./index-rJKC5kjD.js";import{F as Z}from"./formik.esm-qVM3QrQ9.js";import{c as J,a as T,b as ge}from"./index.esm-CEVXtRC0.js";import{T as A,F as ae}from"./TextField-W0cXux5x.js";import{u as Q}from"./useMediaQuery-C6ptf1OC.js";const z=pe(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),H=pe(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),Se=je(A)`
  input {
    text-align: center;
  }
`,Te={TextFieldStyled:Se},_e=t=>e.jsx(Te.TextFieldStyled,{...t}),B={left:"ArrowLeft",right:"ArrowRight",backspace:"Backspace",home:"Home",end:"End"};function Ae(t,l){return t<=0?[]:Array.from({length:t},l)}function Fe(t,l,p){return t.map((d,x)=>l===x?p:d)}function le(t){return t.join("")}function de(t,l){return[...t,l]}function We(t,l,p){return t.reduce((d,x,a)=>{const{characters:m,restArrayMerged:i}=d;if(a<p)return{restArrayMerged:i,characters:de(m,x)};const[y,...h]=i;return{restArrayMerged:h,characters:de(m,y||"")}},{restArrayMerged:l,characters:[]}).characters}function qe(t){return t.split("")}function ce(t){const l=M.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return M.useInsertionEffect(()=>{l.current=t}),M.useCallback((...p)=>{var d;return(d=l.current)==null?void 0:d.call(l,...p)},[])}const Ie=()=>!0,Re=M.forwardRef((t,l)=>{const{value:p="",length:d=4,autoFocus:x=!1,onChange:a,TextFieldsProps:m,onComplete:i,validateChar:y=Ie,className:h,onBlur:k,...L}=t,G=M.useRef(p),D=ce(i),F=ce(s=>{const r=s.slice(0,d);return{isCompleted:r.length===d,finalValue:r}});M.useEffect(()=>{const{isCompleted:s,finalValue:r}=F(G.current);s&&D(r)},[d,D,F]);const C=Ae(d,(s,r)=>({character:p[r]||"",inputRef:M.createRef()})),b=s=>C.findIndex(({inputRef:r})=>r.current===s),q=()=>C.map(({character:s})=>s),u=(s,r)=>{const g=Fe(q(),s,r);return le(g)},n=s=>{var r,g;(g=(r=C[s])==null?void 0:r.inputRef.current)==null||g.focus()},o=s=>{var r,g;(g=(r=C[s])==null?void 0:r.inputRef.current)==null||g.select()},v=s=>{s+1!==d&&(C[s+1].character?o(s+1):n(s+1))},P=(s,r)=>typeof y!="function"?!0:y(s,r),ee=s=>{const r=b(s.target);if(r===0&&s.target.value.length>1){const{finalValue:V,isCompleted:O}=F(s.target.value);a==null||a(V),O&&(i==null||i(V)),o(V.length-1);return}const g=s.target.value[0]||"";let S=g;S&&!P(S,r)&&(S="");const f=u(r,S);a==null||a(f);const{isCompleted:R,finalValue:W}=F(f);R&&(i==null||i(W)),S!==""?f.length-1<r?o(f.length):v(r):g===""&&f.length<=r&&o(r-1)},I=s=>{const r=s.target,g=r.selectionStart,S=r.selectionEnd,f=b(r),R=g===0&&S===0;if(r.value===s.key)s.preventDefault(),v(f);else if(B.backspace===s.key){if(!r.value)s.preventDefault(),o(f-1);else if(R){s.preventDefault();const W=u(f,"");a==null||a(W),W.length<=f&&o(f-1)}}else B.left===s.key?(s.preventDefault(),o(f-1)):B.right===s.key?(s.preventDefault(),o(f+1)):B.home===s.key?(s.preventDefault(),o(0)):B.end===s.key&&(s.preventDefault(),o(C.length-1))},N=s=>{const r=s.clipboardData.getData("text/plain"),g=s.target,S=C.findIndex(({character:w,inputRef:se})=>w===""||se.current===g),f=q(),R=We(f,qe(r),S).map((w,se)=>P(w,se)?w:""),W=le(R);a==null||a(W);const{isCompleted:V,finalValue:O}=F(W);V?(i==null||i(O),o(d-1)):o(W.length)},we=s=>{if(!C.some(({inputRef:r})=>r.current===s.relatedTarget)){const{isCompleted:r,finalValue:g}=F(p);k==null||k(g,r)}};return e.jsx(c,{display:"flex",gap:"20px",alignItems:"center",ref:l,className:`MuiOtpInput-Box ${h||""}`,...L,children:C.map(({character:s,inputRef:r},g)=>{const{onPaste:S,onFocus:f,onKeyDown:R,className:W,onBlur:V,...O}=typeof m=="function"?m(g)||{}:m||{};return e.jsx(_e,{autoFocus:x?g===0:!1,autoComplete:"one-time-code",value:s,inputRef:r,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${g+1} ${W||""}`,onPaste:w=>{w.preventDefault(),N(w),S==null||S(w)},onFocus:w=>{w.preventDefault(),w.target.select(),f==null||f(w)},onChange:ee,onKeyDown:w=>{I(w),R==null||R(w)},onBlur:w=>{V==null||V(w),we(w)},...O},g)})})}),Ve="https://cc.wikitrak.in/api-proxy/api/v1",Je=()=>{const{w_userToken:t,isOtpSection:l,isLogin:p,isForgot:d,isSignUp:x,loading:a}=re(k=>k.auth);Q("(min-width:600px)");const[m,i]=j.useState(),{mode:y}=re(k=>k.dashboard);K();const h=ue();return j.useEffect(()=>{t&&h("/dashboard")},[t]),e.jsxs(c,{sx:{border:"1px solid #ebeae8",width:"65%",px:"45px",py:!x&&"30px",borderRadius:5},children:[a&&e.jsx(be,{style:{position:"absolute",left:"50%",top:"45%",zIndex:9999}}),p&&e.jsx(Ue,{w_userToken:t}),x&&e.jsx($e,{}),d&&e.jsx(ze,{setEmail:i}),l&&e.jsx(He,{email:m})]})},fe=/^((\+[1-9]{1,4}[ -]?)|(\([0-9]{2,3}\)[ -]?)|([0-9]{2,4})[ -]?)*?[0-9]{3,4}[ -]?[0-9]{3,4}$/,Ee=J().shape({first_name:T().required("required"),last_name:T().required("required"),email:T().email("invalid email").required("required"),mobile:T().matches(fe,"Phone number is not valid").required("required"),password:T().required("Password is required").min(8,"Password must be at least 8 characters"),confirmPassword:T().oneOf([ge("password"),null],"Passwords must match").required("Confirm password is required"),workshop:T().required("Workshop is required"),workshopGroup:T().required("Workshop Group is required")}),Le=J().shape({mobile:T().matches(fe,"Phone number is not valid").required("required"),password:T().required("Password is required")}),Me=J().shape({email:T().email("invalid email").required("required")}),De=J().shape({new_password:T().required("Password is required").min(8,"Password must be at least 8 characters"),confirmPassword:T().oneOf([ge("new_password"),null],"Passwords must match").required("Confirm password is required")}),Ge={first_name:"",last_name:"",email:"",mobile:"",password:"",confirmPassword:"",serial_number:"1234",device_type:"android",mac_id:"1234567890",workshop:"",workshopGroup:""},Ne={mobile:"",password:""},Oe={email:""},Be={new_password:"",confirmPassword:""},Ue=()=>{const t=K(),l=Q("(min-width:600px)"),[p,d]=j.useState(!1),x=a=>{t(ye(a))};return e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(_,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Login"}),e.jsxs(_,{variant:"p",sx:{textAlign:"center",fontSize:"12px"},children:["Enter your credential to login the platform"," "]})]}),e.jsx(Z,{onSubmit:x,initialValues:Ne,validationSchema:Le,children:({values:a,errors:m,touched:i,handleBlur:y,handleChange:h,handleSubmit:k})=>e.jsxs("form",{onSubmit:k,children:[e.jsxs(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:l?void 0:"span 4"}},marginTop:"20px",children:[e.jsx(A,{fullWidth:!0,variant:"outlined",type:"text",label:"Mobile Number *",onBlur:y,onChange:h,value:a.mobile,name:"mobile",error:!!i.mobile&&!!m.mobile,helperText:i.mobile&&m.mobile,sx:{gridColumn:"span 4"}}),e.jsx(A,{fullWidth:!0,variant:"outlined",type:p?"text":"password",label:"Password *",onBlur:y,onChange:h,value:a.password,name:"password",error:!!i.password&&!!m.password,helperText:i.password&&m.password,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx(U,{position:"end",children:e.jsx($,{"aria-label":"toggle password visibility",onClick:()=>{d(!p)},edge:"end",children:p?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsx(c,{display:"flex",justifyContent:"flex-end",sx:{gridColumn:"span 4"},children:e.jsx(_,{variant:"body2",style:{fontSize:"12px",color:"#666666"},children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>{t(xe())},children:"Forgot Password ?"})})})]}),e.jsx(c,{display:"flex",justifyContent:"end",mt:"30px",children:e.jsx(Y,{type:"submit",sx:{background:E.bgColor,width:"100%",p:"10px","&:hover":{background:E.bgShadow,color:"black"}},variant:"contained",children:"Log In"})}),e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsxs(_,{variant:"body2",children:["Didn't have an account?"," ",e.jsx("span",{style:{color:E.bgColor,cursor:"pointer"},onClick:()=>{t(ve())},children:"Sign Up"})]})})]})})]})},$e=()=>{const t=K(),l=Q("(min-width:600px)"),[p,d]=j.useState(!1),[x,a]=j.useState(!1),[m,i]=j.useState([]),[y,h]=j.useState([]),[k,L]=j.useState(""),[G,D]=j.useState(!0),[F,C]=j.useState(null);j.useEffect(()=>{(async()=>{try{console.log("Fetching workshop list...");const{data:n}=await ke.get(`${Ve}/workshop/group/`);console.log("Workshop list response data:",n==null?void 0:n.results),i(n==null?void 0:n.results)}catch(n){console.error("Error fetching workshop list:",n),C(n.message)}finally{D(!1)}})()},[]);const b=(u,n)=>{const o=u.target.value;L(o),n(u);const v=m.find(P=>P.group_name===o);h(v?v.workshop:[])};if(G)return e.jsx("div",{children:"Loading..."});if(F)return e.jsxs("div",{children:["Error: ",F]});const q=u=>{console.log("values",u),t(Ce(u))};return e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(_,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Sign Up"}),e.jsxs(_,{variant:"p",sx:{textAlign:"center",fontSize:"12px"},children:["Enter your credential to sign up the platform"," "]})]}),e.jsx(Z,{onSubmit:q,initialValues:Ge,validationSchema:Ee,children:({values:u,errors:n,touched:o,handleBlur:v,handleChange:P,handleSubmit:ee})=>e.jsxs("form",{onSubmit:ee,children:[e.jsxs(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:l?void 0:"span 4"}},marginTop:"20px",children:[e.jsx(A,{fullWidth:!0,variant:"outlined",type:"text",label:"First Name*",onBlur:v,onChange:P,value:u.first_name,name:"first_name",error:!!o.first_name&&!!n.first_name,helperText:o.first_name&&n.first_name,sx:{gridColumn:"span 2"}}),e.jsx(A,{fullWidth:!0,variant:"outlined",type:"text",label:"Last Name *",onBlur:v,onChange:P,value:u.last_name,name:"last_name",error:!!o.last_name&&!!n.last_name,helperText:o.last_name&&n.last_name,sx:{gridColumn:"span 2"}}),e.jsx(A,{fullWidth:!0,variant:"outlined",type:"email",label:"Email *",onBlur:v,onChange:P,value:u.email,name:"email",error:!!o.email&&!!n.email,helperText:o.email&&n.email,sx:{gridColumn:"span 4"}}),e.jsx(A,{fullWidth:!0,variant:"outlined",type:"text",label:"Mobile Number *",onBlur:v,onChange:P,value:u.mobile,name:"mobile",error:!!o.mobile&&!!n.mobile,helperText:o.mobile&&n.mobile,sx:{gridColumn:"span 4"}}),e.jsx(A,{fullWidth:!0,variant:"outlined",type:p?"text":"password",label:"Password *",onBlur:v,onChange:P,value:u.password,name:"password",error:!!o.password&&!!n.password,helperText:o.password&&n.password,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx(U,{position:"end",children:e.jsx($,{"aria-label":"toggle password visibility",onClick:()=>{d(!p)},edge:"end",children:p?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsx(A,{fullWidth:!0,variant:"outlined",type:x?"text":"password",label:"Confirm Password *",onBlur:v,onChange:P,value:u.confirmPassword,name:"confirmPassword",error:!!o.confirmPassword&&!!n.confirmPassword,helperText:o.confirmPassword&&n.confirmPassword,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx(U,{position:"end",children:e.jsx($,{"aria-label":"toggle password visibility",onClick:()=>{a(!x)},edge:"end",children:x?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsxs(te,{variant:"outlined",fullWidth:!0,sx:{gridColumn:"span 4"},error:!!o.workshopGroup&&!!n.workshopGroup,children:[e.jsx(ne,{id:"workshop-group-label",children:"Select Workshop Group"}),e.jsxs(oe,{labelId:"workshop-group-label",id:"workshopGroup",name:"workshopGroup",value:u.workshopGroup,onChange:I=>b(I,P),onBlur:v,children:[e.jsx(X,{value:"",children:e.jsx("em",{children:"None"})}),m.map((I,N)=>e.jsx(X,{value:I.group_name,children:I.group_name},N))]}),o.workshopGroup&&n.workshopGroup&&e.jsx(ae,{children:n.workshopGroup})]}),e.jsxs(te,{variant:"outlined",fullWidth:!0,sx:{gridColumn:"span 4"},error:!!o.workshop&&!!n.workshop,disabled:!k,children:[e.jsx(ne,{id:"workshop-label",children:"Select Workshop"}),e.jsxs(oe,{labelId:"workshop-label",id:"workshop",name:"workshop",value:u.workshop,onChange:P,onBlur:v,children:[e.jsx(X,{value:"",children:e.jsx("em",{children:"None"})}),y.map((I,N)=>e.jsx(X,{value:I.id,children:I.name},N))]}),o.workshop&&n.workshop&&e.jsx(ae,{children:n.workshop})]})]}),e.jsx(c,{display:"flex",justifyContent:"end",mt:"30px",children:e.jsx(Y,{type:"submit",sx:{background:E.bgColor,width:"100%",p:"10px","&:hover":{background:E.bgShadow,color:"black"}},variant:"contained",children:"Sign Up"})}),e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsxs(_,{variant:"p",children:["Already User ?"," ",e.jsx("span",{style:{color:"orange",cursor:"pointer"},onClick:()=>t(me()),children:"Login"})]})})]})})]})},ze=({setEmail:t})=>{const l=K(),p=Q("(min-width:600px)"),d=x=>{t(x.email),l(he(x))};return e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(_,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Forgot Password"}),e.jsx(_,{variant:"p",sx:{textAlign:"center",fontSize:"12px"},children:"Enter your registered email to create the new password"})]}),e.jsx(Z,{onSubmit:d,initialValues:Oe,validationSchema:Me,children:({values:x,errors:a,touched:m,handleBlur:i,handleChange:y,handleSubmit:h})=>e.jsxs("form",{onSubmit:h,children:[e.jsx(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:p?void 0:"span 4"}},marginTop:"20px",children:e.jsx(A,{fullWidth:!0,variant:"outlined",type:"text",label:"Email Address *",onBlur:i,onChange:y,value:x.email,name:"email",error:!!m.email&&!!a.email,helperText:m.email&&a.email,sx:{gridColumn:"span 4"}})}),e.jsx(c,{display:"flex",justifyContent:"end",mt:"30px",children:e.jsx(Y,{type:"submit",sx:{background:E.bgColor,width:"100%",p:"10px","&:hover":{background:E.bgShadow,color:"black"}},variant:"contained",children:"Submit"})}),e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsxs(_,{variant:"p",children:["Back to Login ?"," ",e.jsx("span",{style:{cursor:"pointer",color:"orange"},onClick:()=>{l(me())},children:"Login"})]})})]})})]})},He=({email:t})=>{const l=K();ue();const p=Q("(min-width:600px)"),[d,x]=j.useState(!1),[a,m]=j.useState(!1),[i,y]=j.useState(0),[h,k]=j.useState(10),[L,G]=j.useState("");j.useEffect(()=>{t||l(xe())},[]);const D=b=>{G(b)},F=b=>{t?L?(b.otp=L,b.email=t,l(Pe(b))):ie.error("please enter otp "):ie.error("Please enter your email address",{id:"clipboard"})},C=()=>{l(he({email:t})),y(0),k(10)};return j.useEffect(()=>{const b=setInterval(()=>{h>0&&k(h-1),h===0&&(i===0?clearInterval(b):(k(59),y(i-1)))},1e3);return()=>{clearInterval(b)}},[h]),e.jsxs(c,{children:[e.jsxs(c,{sx:{textAlign:"center"},children:[e.jsx(_,{variant:"h5",sx:{mt:"25px",my:"",fontWeight:"bold",textAlign:"center"},children:"Verify OTP"}),e.jsxs(_,{variant:"p",sx:{textAlign:"center",fontSize:"12px",width:"30%"},children:["Enter OTP to authenticate yourself, sent to ",t]})]}),e.jsx(c,{margin:"30px",children:e.jsx(Re,{length:4,value:L,onChange:D})}),e.jsx(Z,{onSubmit:F,initialValues:Be,validationSchema:De,children:({values:b,errors:q,touched:u,handleBlur:n,handleChange:o,handleSubmit:v})=>e.jsxs("form",{onSubmit:v,children:[e.jsxs(c,{display:"grid",gap:"15px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:p?void 0:"span 4"}},marginTop:"20px",children:[e.jsx(A,{fullWidth:!0,variant:"outlined",type:d?"text":"password",label:"New  Password *",onBlur:n,onChange:o,value:b.new_password,name:"new_password",error:!!u.new_password&&!!q.new_password,helperText:u.new_password&&q.new_password,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx(U,{position:"end",children:e.jsx($,{"aria-label":"toggle password visibility",onClick:()=>x(!d),edge:"end",children:d?e.jsx(H,{}):e.jsx(z,{})})})}}),e.jsx(A,{fullWidth:!0,variant:"outlined",type:a?"text":"password",label:"Confirm Password *",onBlur:n,onChange:o,value:b.confirmPassword,name:"confirmPassword",error:!!u.confirmPassword&&!!q.confirmPassword,helperText:u.confirmPassword&&q.confirmPassword,sx:{gridColumn:"span 4"},InputProps:{endAdornment:e.jsx(U,{position:"end",children:e.jsx($,{"aria-label":"toggle password visibility",onClick:()=>m(!a),edge:"end",children:a?e.jsx(H,{}):e.jsx(z,{})})})}})]}),e.jsx(c,{sx:{my:"29px"},children:e.jsx(Y,{type:"submit",sx:{background:E.bgColor,width:"100%",p:"10px","&:hover":{background:E.bgShadow,color:"black"}},variant:"contained",children:"submit"})})]})}),e.jsx(c,{mt:"35px",children:e.jsx(c,{sx:{mt:"25px",textAlign:"center"},children:e.jsx(_,{variant:"p",children:e.jsx("span",{children:h>0||i>0?e.jsxs("p",{children:["Resend OTP in: ",i<10?`0${i}`:i,":",h<10?`0${h}`:h]}):e.jsxs("p",{children:["Didn't receive code ?",e.jsxs("span",{style:{color:"blue",cursor:"pointer"},onClick:C,children:[" ","Resend OTP"]})]})})})})})]})};export{Je as F,H as V,z as a};
