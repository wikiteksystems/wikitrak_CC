import{j as s,F as R,x as V,y as P,b as c,bz as K,bA as Q,bd as X,ab as Z,B as $,b0 as w,be as ee,L as O}from"./index-DUOvzgoN.js";import{D as se,a as ae,b as te,c as ne}from"./DialogTitle-DZcEyy-W.js";import{D as oe}from"./DialogContentText-DD73ccaQ.js";import{B as Y}from"./CircularProgress-pwhYdd0J.js";import{I as ie}from"./IconButton-CXNJcYw0.js";import{E as re,T as F}from"./Edit-BX6yNRCo.js";import{P as le}from"./Paper-B1lO8R0B.js";import{T as ce,a as de,b as ue,c as H,d as i,e as he}from"./TableRow-BmSylAaQ.js";import{T as pe}from"./TablePagination-DzmmSPab.js";const be=({open:o,onClose:n,onConfirm:r})=>s.jsxs(se,{open:o,onClose:n,children:[s.jsx(ae,{children:"Confirm Deletion"}),s.jsx(te,{children:s.jsxs(oe,{children:["Are you sure you want to delete this vehicle data?"," ",s.jsx("span",{style:{color:"red"},children:"This action cannot be undone."})]})}),s.jsxs(ne,{children:[s.jsx(R,{onClick:n,color:"primary",children:"Cancel"}),s.jsx(R,{onClick:r,color:"secondary",children:"Delete"})]})]}),xe="https://cc.wikitrak.in/api-proxy/api/v1",ge={display:"flex",alignItems:"left",justifyContent:"left",gap:"8px"},fe=({inspectionData:o,status:n})=>{const r=V(),{isUpdateInspection:u}=P(d=>d.inspection),[j,C]=c.useState(!1),h=()=>{localStorage.getItem("role"),r(K(!u)),r(Q(o)),r(X(o))},T=async()=>{console.log("Vehicle data deleting");try{await Z.delete(`${xe}/vehicles/delete/${vehicleData.id}/`),$.success("Vehicle data deleted successfully!"),r(w())}catch(d){console.error("Error deleting vehicle data:",d),$.error("Failed to delete vehicle data. Please try again.")}C(!1)},p=()=>{C(!1)};return s.jsxs(Y,{sx:ge,children:[s.jsx(ie,{onClick:h,color:"primary","aria-label":"edit record",disabled:(n==null?void 0:n.toLowerCase())==="rejected"||(n==null?void 0:n.toLowerCase())==="close",children:s.jsx(re,{})}),s.jsx(be,{open:j,onClose:p,onConfirm:T})]})},je=[{id:"BDID",label:"BDID"},{id:"Vehicle",label:"Vehicle"},{id:"User",label:"User"},{id:"SubmissionDate",label:"Submission Date"},{id:"SubmissionTime",label:"Submission Time"},{id:"WorkshopGroup",label:"Workshop Group"},{id:"Status",label:"Status"}],Ce=({where:o})=>{P(e=>e.breakdown);const n=V(),{searchTerm:r,inspectionHistory:u}=P(e=>e.inspection),[j,C]=c.useState("asc"),[h,T]=c.useState("BDID"),[p,d]=c.useState(0),[_,N]=c.useState(7),[W,_e]=c.useState({id:"",status:"",workshop:"",user:""});c.useEffect(()=>{n(ee({}))},[]);const q=e=>{C(h===e&&j==="asc"?"desc":"asc"),T(e)},z=(e,t)=>{d(t)},G=e=>{N(parseInt(e.target.value,10)),d(0)},L=((e,t,b)=>e.filter(a=>{var x,g,f,B,I,A,E,U,M;const l=b.toLowerCase(),D=(g=(x=a==null?void 0:a.breakdown)==null?void 0:x.breakdown_id)==null?void 0:g.toLowerCase().includes(l),k=`${(B=(f=a==null?void 0:a.submitted_by)==null?void 0:f.us_user)==null?void 0:B.first_name} ${(A=(I=a==null?void 0:a.submitted_by)==null?void 0:I.us_user)==null?void 0:A.last_name}`.toLowerCase().includes(l),m=(E=a==null?void 0:a.status)==null?void 0:E.toLowerCase().includes(l),y=(U=a==null?void 0:a.workshop_group)==null?void 0:U.group_name.toLowerCase().includes(l),S=(M=a==null?void 0:a.vehicle.registration_id)==null?void 0:M.toLowerCase().includes(l);return!(b&&!(D||k||m||y||S)||t.id&&!a.breakdown_id.includes(t.id)||t.status&&a.status!==t.status||t.workshop&&a.workshop_group.group_name!==t.workshop||t.user&&!a.user.us_user.first_name.toLowerCase().includes(t.user.toLowerCase())&&!a.user.us_user.last_name.toLowerCase().includes(t.user.toLowerCase()))}))((u==null?void 0:u.slice())||[],W,r),J=L.slice(p*_,p*_+_),v={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"};return s.jsx(Y,{sx:{m:o!=="inspection report"&&"10px",width:o==="inspection report"?"60%":"99%"},children:s.jsxs(le,{children:[s.jsx(ce,{sx:{height:o==="inspection report"?"50vh":"65vh",bgcolor:"white",borderRadius:"10px"},children:s.jsxs(de,{stickyHeader:!0,children:[s.jsx(ue,{children:s.jsxs(H,{children:[je.map(e=>s.jsx(i,{sx:v,children:s.jsx(F,{active:h===e.id,direction:h===e.id?j:"asc",onClick:()=>q(e.id),children:e.label})},e.id)),o!=="inspection report"&&s.jsx(i,{sx:v,children:s.jsx(F,{children:"Actions"})})]})}),s.jsx(he,{children:J.map((e,t)=>{var b,a,l,D,k,m,y,S,x,g,f;return s.jsxs(H,{children:[s.jsx(i,{children:((b=e==null?void 0:e.breakdown)==null?void 0:b.breakdown_id)||"N/A"}),s.jsx(i,{children:(a=e==null?void 0:e.vehicle)==null?void 0:a.registration_id}),s.jsx(i,{children:`${(D=(l=e==null?void 0:e.submitted_by)==null?void 0:l.us_user)==null?void 0:D.first_name} ${(m=(k=e==null?void 0:e.submitted_by)==null?void 0:k.us_user)==null?void 0:m.last_name}`}),s.jsx(i,{children:((y=e==null?void 0:e.breakdown)==null?void 0:y.submission_date)&&O.utc((S=e==null?void 0:e.breakdown)==null?void 0:S.submission_date).local().format("YYYY-MM-DD")||"N/A"}),s.jsx(i,{children:((x=e==null?void 0:e.breakdown)==null?void 0:x.submission_date)&&O.utc((g=e==null?void 0:e.breakdown)==null?void 0:g.submission_date).local().format("HH:mm A")||"N/A"}),s.jsx(i,{children:(f=e==null?void 0:e.workshop_group)==null?void 0:f.group_name}),s.jsx(i,{sx:{color:e.status==="Open"?"blue":e.status==="Close"?"green":"red"},children:e.status}),o!=="inspection report"&&s.jsx(i,{children:s.jsx(fe,{inspectionData:e,status:e==null?void 0:e.status})})]},t)})})]})}),s.jsx(pe,{component:"div",count:L.length,page:p,onPageChange:z,rowsPerPage:_,onRowsPerPageChange:G,rowsPerPageOptions:[5,10,15]})]})})},Ie=Ce;export{Ie as I};
