import{p as v,o as $,r,j as a,B as d,dG as Y,dH as C,dI as I,K as z,dJ as F,D as Q,dK as W,dL as X,N as Z,a8 as ee,dc as ae,ae as G,a3 as se,a4 as re,a6 as te,a7 as oe,y as A,Y as le,$ as ne,w as ce}from"./index-DEjL_ux7.js";import{V as ie}from"./VehicleMenu-DW08gx83.js";import{P as de}from"./Parameters-BAmCkyx7.js";/* empty css           */import"./InspectionsTable-IZ6jNwQW.js";import"./index.esm-CVnqYht4.js";import"./ServiceRecordTable-C2fEltAT.js";import{S as he}from"./ServiceJobCardTable-V9NW2O15.js";import{B as pe}from"./BreakDownJobCardTable-BpP413jK.js";import{S as ue}from"./ServicesTopBar-Cjy0iPaL.js";import"./Autocomplete-Dixf9GFs.js";import"./DialogContentText-BopKYA68.js";import"./Edit-2cfH9LPZ.js";import"./formik.esm-DM9rwmRT.js";import"./excelUtils-CWirCKt9.js";function k(o){const{children:h,value:f,index:n,...p}=o;return a.jsx("div",{role:"tabpanel",hidden:f!==n,id:`simple-tabpanel-${n}`,"aria-labelledby":`simple-tab-${n}`,...p,children:f===n&&a.jsx(d,{sx:{p:3},children:h})})}k.propTypes={children:I.node,index:I.number.isRequired,value:I.number.isRequired};function N(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function ge(){const{selectedTabValue:o}=v(n=>n.inspection),h=$();r.useState(0);const f=(n,p)=>{h(z("")),h(F(p))};return a.jsxs(d,{sx:{width:"100%"},children:[a.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(Y,{value:o,onChange:f,"aria-label":"basic tabs example",children:[a.jsx(C,{label:"Breakdowns",...N(0)}),a.jsx(C,{label:"Services",...N(1)})]})}),a.jsx(k,{value:o,index:0,children:a.jsx(pe,{isInspection:!0})}),a.jsx(k,{value:o,index:1,children:a.jsx(he,{isInspection:!0})})]})}function Le(){const{locationData:o,selectedVehicle:h,selectedParameterList:f}=v(s=>s.liveMap),{mode:n,selectedVehicleGroup:p}=v(s=>s.dashboard),L=ce(n),[J,M]=r.useState([]),{w_customer_id:m}=v(s=>s.auth),[R,j]=r.useState(),[b,T]=r.useState(!1),[S,q]=r.useState(!1),[_,y]=r.useState([]);r.useState(!0);const[B,E]=r.useState(!1),[K,w]=r.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let t=$();Q(),r.useEffect(()=>{t(W()),t(X())},[]),r.useEffect(()=>{O(),t(Z()),t(ee(m)),t(ae())},[]),r.useEffect(()=>{y([]),t(G([{reg_id:"",imei:"",params:[]}]))},[h]);const O=async()=>{try{w(!0);let s=[],c=[];const u=await t(se({w_customer_id:m}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var g,i,D,l;Array.isArray(e.imei)&&e.imei.length>0&&((g=e.imei[0])!=null&&g.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(i=e.imei[0])==null?void 0:i.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(D=e==null?void 0:e.vehicle_model)==null?void 0:D.name,vehicle_group:e==null?void 0:e.vehicle_group}),c.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const V="one",P=c;c.length>0&&t(re({type:V,imei:P})),M(s),t(te(s)),w(!1),t(oe({w_customer_id:m}))}else w(!1),console.error("Unexpected data format:",u),A.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),A.error(`Error fetching vehicle data: ${s}`)}},U=async s=>{const{label:c,imei:u,id:V,reg_id:P,checked:e}=s;j(l=>l.map(x=>x.id===V?{...x,checked:!e}:x));let g=[..._],i=[..._];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(g.push({label:c,value:l.latestDocument[c==="maininputvoltage"?"mainInputVoltage":c]}),i=g,y(g))});else{let l=_.filter(x=>x.label!==c);i=l,y(l)}console.log("tempParamList",i),t(G([{reg_id:P,imei:u,params:i}]))},H=J.filter(s=>Object.keys(p).length===0||s.vehicle_group===p.id);return a.jsxs("div",{className:"app",children:[a.jsx(le,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:T,showVehicles:b,setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsx(ne,{setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(d,{style:{width:b||S?"80%":"100%"},children:a.jsx(ge,{})}),b&&a.jsx(d,{style:{width:"20%",backgroundColor:L.grey[100]},children:a.jsx(ie,{vehicleData:H,title:"Inspections",setParameterData:j,loadingVehicle:K,setShowVehicles:T,showVehicles:b,showParameters:S,setShowParameters:q})}),S&&a.jsx(d,{style:{width:"20%",backgroundColor:L.grey[100]},children:a.jsx(de,{parametersData:R,setParameterData:j,handleParameterChange:U})})]})]})]})}export{Le as default};
