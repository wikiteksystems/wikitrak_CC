import{b as h,_ as os,x as de,y as N,j as e,D as qe,F as re,av as ns,aw as ls,T as is,bU as Rt,bV as cs,bW as ds,bX as us,bY as ps,bZ as xs,b_ as hs,b$ as gs,c0 as fs,c1 as ms,a8 as ge,c2 as _e,c3 as Qe,c4 as bs,c5 as ys,c6 as Cs,c7 as _s,c8 as vs,c9 as js,ca as nt,cb as lt,cc as ne,ab as le,B as G,cd as Tt,ce as ue,cf as Dt,cg as At,ch as it,ci as Ot,cj as rt,L as Te,ck as It,cl as Ss,cm as $t,cn as Pt,$ as Es,a2 as ks,co as ws,cp as Rs}from"./index-DUOvzgoN.js";import{a as Ts,af as Ds,q as Ge,e as Lt,_ as As,b as et,ag as ct,r as Os,v as Is,G as $s,y as Ft,x as Ps,z as Ls,p as Fs,ah as Bs,ai as Ns,P as Us,Q as Ms,S as Hs,L as Gs}from"./LeftSideBar2-DwdeqG_U.js";import{B as n}from"./CircularProgress-pwhYdd0J.js";import{a as Ws,T as zs}from"./index-Dfoq6bp-.js";import{I as ye}from"./IconButton-CXNJcYw0.js";import{t as ae,d as ve}from"./Search-C3xeStNn.js";import{C as Ys,I as Yt,d as Ks}from"./InfoOutlined-B0wzMQm8.js";import{r as fe}from"./createSvgIcon-CSwWvHWL.js";import{N as we}from"./NewLoader-DtO7dbNi.js";import{F as je,b as Se,O as Ee}from"./OutlinedInput-BQvSmIVE.js";import{I as ke}from"./InputAdornment-pp30ybW3.js";import{C as qs}from"./Card-U6osRfmo.js";import{C as Qs}from"./CardContent-DAG-Od2x.js";import"./proj-XQwXs9DQ.js";import{C as Xs}from"./SearchOutlined-BfAwyEgC.js";import{d as Js}from"./ContentCopy-DGI1Ujxi.js";import{B as Vs}from"./button-Dbk0gHw0.js";import{SinoCastalTerminal as Zs,SinoCastalReadDTC as er,SinoCastalLiveParameter as tr}from"./Index-CDi45yfz.js";import"./index.esm-DzEF8I5z.js";import"./menu2-B2WYPpUD.js";import"./Paper-B1lO8R0B.js";import"./Tooltip-BvmMBhhW.js";import"./roundedArrow-B9Up5jaN.js";import"./TextArea-CPI3Mgl5.js";import"./TextField-J34J46C1.js";import"./Select-TIUm2W7I.js";var sr={percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1,gapPosition:"bottom"},rr=function(){var s=h.useRef([]),r=h.useRef(null);return h.useEffect(function(){var a=Date.now(),i=!1;s.current.forEach(function(E){if(E){i=!0;var l=E.style;l.transitionDuration=".3s, .3s, .3s, .06s",r.current&&a-r.current<100&&(l.transitionDuration="0s, 0s")}}),i&&(r.current=Date.now())}),s.current},Bt=0,ar=Ds();function or(){var t;return ar?(t=Bt,Bt+=1):t="TEST_OR_SSR",t}const nr=function(t){var s=h.useState(),r=Ts(s,2),a=r[0],i=r[1];return h.useEffect(function(){i("rc_progress_".concat(or()))},[]),t||a};var Nt=function(s){var r=s.bg,a=s.children;return h.createElement("div",{style:{width:"100%",height:"100%",background:r}},a)};function Ut(t,s){return Object.keys(t).map(function(r){var a=parseFloat(r),i="".concat(Math.floor(a*s),"%");return"".concat(t[r]," ").concat(i)})}var lr=h.forwardRef(function(t,s){var r=t.prefixCls,a=t.color,i=t.gradientId,E=t.radius,l=t.style,u=t.ptg,v=t.strokeLinecap,o=t.strokeWidth,O=t.size,U=t.gapDegree,k=a&&Ge(a)==="object",b=k?"#FFF":void 0,D=O/2,R=h.createElement("circle",{className:"".concat(r,"-circle-path"),r:E,cx:D,cy:D,stroke:b,strokeLinecap:v,strokeWidth:o,opacity:u===0?0:1,style:l,ref:s});if(!k)return R;var C="".concat(i,"-conic"),S=U?"".concat(180+U/2,"deg"):"0deg",w=Ut(a,(360-U)/360),L=Ut(a,1),f="conic-gradient(from ".concat(S,", ").concat(w.join(", "),")"),j="linear-gradient(to ".concat(U?"bottom":"top",", ").concat(L.join(", "),")");return h.createElement(h.Fragment,null,h.createElement("mask",{id:C},R),h.createElement("foreignObject",{x:0,y:0,width:O,height:O,mask:"url(#".concat(C,")")},h.createElement(Nt,{bg:j},h.createElement(Nt,{bg:f}))))}),We=100,at=function(s,r,a,i,E,l,u,v,o,O){var U=arguments.length>10&&arguments[10]!==void 0?arguments[10]:0,k=a/100*360*((360-l)/360),b=l===0?0:{bottom:0,top:180,left:90,right:-90}[u],D=(100-i)/100*r;o==="round"&&i!==100&&(D+=O/2,D>=r&&(D=r-.01));var R=We/2;return{stroke:typeof v=="string"?v:void 0,strokeDasharray:"".concat(r,"px ").concat(s),strokeDashoffset:D+U,transform:"rotate(".concat(E+k+b,"deg)"),transformOrigin:"".concat(R,"px ").concat(R,"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s",fillOpacity:0}},ir=["id","prefixCls","steps","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor","percent"];function Mt(t){var s=t??[];return Array.isArray(s)?s:[s]}var cr=function(s){var r=Lt(Lt({},sr),s),a=r.id,i=r.prefixCls,E=r.steps,l=r.strokeWidth,u=r.trailWidth,v=r.gapDegree,o=v===void 0?0:v,O=r.gapPosition,U=r.trailColor,k=r.strokeLinecap,b=r.style,D=r.className,R=r.strokeColor,C=r.percent,S=As(r,ir),w=We/2,L=nr(a),f="".concat(L,"-gradient"),j=w-l/2,P=Math.PI*2*j,m=o>0?90+o/2:-90,I=P*((360-o)/360),d=Ge(E)==="object"?E:{count:E,space:2},F=d.count,p=d.space,_=Mt(C),T=Mt(R),c=T.find(function(Y){return Y&&Ge(Y)==="object"}),x=c&&Ge(c)==="object",y=x?"butt":k,A=at(P,I,0,100,m,o,O,U,y,l),$=rr(),B=function(){var M=0;return _.map(function(H,z){var K=T[z]||T[T.length-1],q=at(P,I,M,H,m,o,O,K,y,l);return M+=H,h.createElement(lr,{key:z,color:K,ptg:H,radius:j,prefixCls:i,gradientId:f,style:q,strokeLinecap:y,strokeWidth:l,gapDegree:o,ref:function(ie){$[z]=ie},size:We})}).reverse()},g=function(){var M=Math.round(F*(_[0]/100)),H=100/F,z=0;return new Array(F).fill(null).map(function(K,q){var se=q<=M-1?T[0]:U,ie=se&&Ge(se)==="object"?"url(#".concat(f,")"):void 0,W=at(P,I,z,H,m,o,O,se,"butt",l,p);return z+=(I-W.strokeDashoffset+p)*100/I,h.createElement("circle",{key:q,className:"".concat(i,"-circle-path"),r:j,cx:w,cy:w,stroke:ie,strokeWidth:l,opacity:1,style:W,ref:function(V){$[q]=V}})})};return h.createElement("svg",os({className:et("".concat(i,"-circle"),D),viewBox:"0 0 ".concat(We," ").concat(We),style:b,id:a,role:"presentation"},S),!F&&h.createElement("circle",{className:"".concat(i,"-circle-trail"),r:j,cx:w,cy:w,stroke:U,strokeLinecap:y,strokeWidth:u||l,style:A}),F?g():B())};function be(t){return!t||t<0?0:t>100?100:t}function Xe(t){let{success:s,successPercent:r}=t,a=r;return s&&"progress"in s&&(a=s.progress),s&&"percent"in s&&(a=s.percent),a}const dr=t=>{let{percent:s,success:r,successPercent:a}=t;const i=be(Xe({success:r,successPercent:a}));return[i,be(be(s)-i)]},ur=t=>{let{success:s={},strokeColor:r}=t;const{strokeColor:a}=s;return[a||ct.green,r||null]},tt=(t,s,r)=>{var a,i,E,l;let u=-1,v=-1;if(s==="step"){const o=r.steps,O=r.strokeWidth;typeof t=="string"||typeof t>"u"?(u=t==="small"?2:14,v=O??8):typeof t=="number"?[u,v]=[t,t]:[u=14,v=8]=t,u*=o}else if(s==="line"){const o=r==null?void 0:r.strokeWidth;typeof t=="string"||typeof t>"u"?v=o||(t==="small"?6:8):typeof t=="number"?[u,v]=[t,t]:[u=-1,v=8]=t}else(s==="circle"||s==="dashboard")&&(typeof t=="string"||typeof t>"u"?[u,v]=t==="small"?[60,60]:[120,120]:typeof t=="number"?[u,v]=[t,t]:(u=(i=(a=t[0])!==null&&a!==void 0?a:t[1])!==null&&i!==void 0?i:120,v=(l=(E=t[0])!==null&&E!==void 0?E:t[1])!==null&&l!==void 0?l:120));return[u,v]},pr=3,xr=t=>pr/t*100,hr=t=>{const{prefixCls:s,trailColor:r=null,strokeLinecap:a="round",gapPosition:i,gapDegree:E,width:l=120,type:u,children:v,success:o,size:O=l}=t,[U,k]=tt(O,"circle");let{strokeWidth:b}=t;b===void 0&&(b=Math.max(xr(U),6));const D={width:U,height:k,fontSize:U*.15+6},R=h.useMemo(()=>{if(E||E===0)return E;if(u==="dashboard")return 75},[E,u]),C=i||u==="dashboard"&&"bottom"||void 0,S=Object.prototype.toString.call(t.strokeColor)==="[object Object]",w=ur({success:o,strokeColor:t.strokeColor}),L=et(`${s}-inner`,{[`${s}-circle-gradient`]:S}),f=h.createElement(cr,{percent:dr(t),strokeWidth:b,trailWidth:b,strokeColor:w,strokeLinecap:a,trailColor:r,prefixCls:s,gapDegree:R,gapPosition:C});return h.createElement("div",{className:L,style:D},U<=20?h.createElement(Ws,{title:v},h.createElement("span",null,f)):h.createElement(h.Fragment,null,f,v))},gr=hr,Je="--progress-line-stroke-color",Kt="--progress-percent",Ht=t=>{const s=t?"100%":"-100%";return new Ps(`antProgress${t?"RTL":"LTR"}Active`,{"0%":{transform:`translateX(${s}) scaleX(0)`,opacity:.1},"20%":{transform:`translateX(${s}) scaleX(0)`,opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}})},fr=t=>{const{componentCls:s,iconCls:r}=t;return{[s]:Object.assign(Object.assign({},$s(t)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:t.fontSize},[`${s}-outer`]:{display:"inline-block",width:"100%"},[`&${s}-show-info`]:{[`${s}-outer`]:{marginInlineEnd:`calc(-2em - ${Ft(t.marginXS)})`,paddingInlineEnd:`calc(2em + ${Ft(t.paddingXS)})`}},[`${s}-inner`]:{position:"relative",display:"inline-block",width:"100%",overflow:"hidden",verticalAlign:"middle",backgroundColor:t.remainingColor,borderRadius:t.lineBorderRadius},[`${s}-inner:not(${s}-circle-gradient)`]:{[`${s}-circle-path`]:{stroke:t.defaultColor}},[`${s}-success-bg, ${s}-bg`]:{position:"relative",background:t.defaultColor,borderRadius:t.lineBorderRadius,transition:`all ${t.motionDurationSlow} ${t.motionEaseInOutCirc}`},[`${s}-bg`]:{overflow:"hidden","&::after":{content:'""',background:{_multi_value_:!0,value:["inherit",`var(${Je})`]},height:"100%",width:`calc(1 / var(${Kt}) * 100%)`,display:"block"}},[`${s}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:t.colorSuccess},[`${s}-text`]:{display:"inline-block",width:"2em",marginInlineStart:t.marginXS,color:t.colorText,lineHeight:1,whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[r]:{fontSize:t.fontSize}},[`&${s}-status-active`]:{[`${s}-bg::before`]:{position:"absolute",inset:0,backgroundColor:t.colorBgContainer,borderRadius:t.lineBorderRadius,opacity:0,animationName:Ht(),animationDuration:t.progressActiveMotionDuration,animationTimingFunction:t.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${s}-rtl${s}-status-active`]:{[`${s}-bg::before`]:{animationName:Ht(!0)}},[`&${s}-status-exception`]:{[`${s}-bg`]:{backgroundColor:t.colorError},[`${s}-text`]:{color:t.colorError}},[`&${s}-status-exception ${s}-inner:not(${s}-circle-gradient)`]:{[`${s}-circle-path`]:{stroke:t.colorError}},[`&${s}-status-success`]:{[`${s}-bg`]:{backgroundColor:t.colorSuccess},[`${s}-text`]:{color:t.colorSuccess}},[`&${s}-status-success ${s}-inner:not(${s}-circle-gradient)`]:{[`${s}-circle-path`]:{stroke:t.colorSuccess}}})}},mr=t=>{const{componentCls:s,iconCls:r}=t;return{[s]:{[`${s}-circle-trail`]:{stroke:t.remainingColor},[`&${s}-circle ${s}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${s}-circle ${s}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:t.circleTextColor,fontSize:t.circleTextFontSize,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[r]:{fontSize:t.circleIconFontSize}},[`${s}-circle&-status-exception`]:{[`${s}-text`]:{color:t.colorError}},[`${s}-circle&-status-success`]:{[`${s}-text`]:{color:t.colorSuccess}}},[`${s}-inline-circle`]:{lineHeight:1,[`${s}-inner`]:{verticalAlign:"bottom"}}}},br=t=>{const{componentCls:s}=t;return{[s]:{[`${s}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:t.progressStepMinWidth,marginInlineEnd:t.progressStepMarginInlineEnd,backgroundColor:t.remainingColor,transition:`all ${t.motionDurationSlow}`,"&-active":{backgroundColor:t.defaultColor}}}}}},yr=t=>{const{componentCls:s,iconCls:r}=t;return{[s]:{[`${s}-small&-line, ${s}-small&-line ${s}-text ${r}`]:{fontSize:t.fontSizeSM}}}},Cr=t=>({circleTextColor:t.colorText,defaultColor:t.colorInfo,remainingColor:t.colorFillSecondary,lineBorderRadius:100,circleTextFontSize:"1em",circleIconFontSize:`${t.fontSize/t.fontSizeSM}em`}),_r=Os("Progress",t=>{const s=t.calc(t.marginXXS).div(2).equal(),r=Is(t,{progressStepMarginInlineEnd:s,progressStepMinWidth:s,progressActiveMotionDuration:"2.4s"});return[fr(r),mr(r),br(r),yr(r)]},Cr);var vr=function(t,s){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&s.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(t);i<a.length;i++)s.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(t,a[i])&&(r[a[i]]=t[a[i]]);return r};const jr=t=>{let s=[];return Object.keys(t).forEach(r=>{const a=parseFloat(r.replace(/%/g,""));isNaN(a)||s.push({key:a,value:t[r]})}),s=s.sort((r,a)=>r.key-a.key),s.map(r=>{let{key:a,value:i}=r;return`${i} ${a}%`}).join(", ")},Sr=(t,s)=>{const{from:r=ct.blue,to:a=ct.blue,direction:i=s==="rtl"?"to left":"to right"}=t,E=vr(t,["from","to","direction"]);if(Object.keys(E).length!==0){const u=jr(E),v=`linear-gradient(${i}, ${u})`;return{background:v,[Je]:v}}const l=`linear-gradient(${i}, ${r}, ${a})`;return{background:l,[Je]:l}},Er=t=>{const{prefixCls:s,direction:r,percent:a,size:i,strokeWidth:E,strokeColor:l,strokeLinecap:u="round",children:v,trailColor:o=null,success:O}=t,U=l&&typeof l!="string"?Sr(l,r):{[Je]:l,background:l},k=u==="square"||u==="butt"?0:void 0,b=i??[-1,E||(i==="small"?6:8)],[D,R]=tt(b,"line",{strokeWidth:E}),C={backgroundColor:o||void 0,borderRadius:k},S=Object.assign(Object.assign({width:`${be(a)}%`,height:R,borderRadius:k},U),{[Kt]:be(a)/100}),w=Xe(t),L={width:`${be(w)}%`,height:R,borderRadius:k,backgroundColor:O==null?void 0:O.strokeColor},f={width:D<0?"100%":D,height:R};return h.createElement(h.Fragment,null,h.createElement("div",{className:`${s}-outer`,style:f},h.createElement("div",{className:`${s}-inner`,style:C},h.createElement("div",{className:`${s}-bg`,style:S}),w!==void 0?h.createElement("div",{className:`${s}-success-bg`,style:L}):null)),v)},kr=Er,wr=t=>{const{size:s,steps:r,percent:a=0,strokeWidth:i=8,strokeColor:E,trailColor:l=null,prefixCls:u,children:v}=t,o=Math.round(r*(a/100)),U=s??[s==="small"?2:14,i],[k,b]=tt(U,"step",{steps:r,strokeWidth:i}),D=k/r,R=new Array(r);for(let C=0;C<r;C++){const S=Array.isArray(E)?E[C]:E;R[C]=h.createElement("div",{key:C,className:et(`${u}-steps-item`,{[`${u}-steps-item-active`]:C<=o-1}),style:{backgroundColor:C<=o-1?S:l,width:D,height:b}})}return h.createElement("div",{className:`${u}-steps-outer`},R,v)},Rr=wr;var Tr=function(t,s){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&s.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(t);i<a.length;i++)s.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(t,a[i])&&(r[a[i]]=t[a[i]]);return r};const Dr=["normal","exception","active","success"],Ar=h.forwardRef((t,s)=>{const{prefixCls:r,className:a,rootClassName:i,steps:E,strokeColor:l,percent:u=0,size:v="default",showInfo:o=!0,type:O="line",status:U,format:k,style:b}=t,D=Tr(t,["prefixCls","className","rootClassName","steps","strokeColor","percent","size","showInfo","type","status","format","style"]),R=h.useMemo(()=>{var T,c;const x=Xe(t);return parseInt(x!==void 0?(T=x??0)===null||T===void 0?void 0:T.toString():(c=u??0)===null||c===void 0?void 0:c.toString(),10)},[u,t.success,t.successPercent]),C=h.useMemo(()=>!Dr.includes(U)&&R>=100?"success":U||"normal",[U,R]),{getPrefixCls:S,direction:w,progress:L}=h.useContext(Ls),f=S("progress",r),[j,P,m]=_r(f),I=h.useMemo(()=>{if(!o)return null;const T=Xe(t);let c;const x=k||(A=>`${A}%`),y=O==="line";return k||C!=="exception"&&C!=="success"?c=x(be(u),be(T)):C==="exception"?c=y?h.createElement(Bs,null):h.createElement(Xs,null):C==="success"&&(c=y?h.createElement(Ys,null):h.createElement(Ns,null)),h.createElement("span",{className:`${f}-text`,title:typeof c=="string"?c:void 0},c)},[o,u,R,C,O,f,k]),d=Array.isArray(l)?l[0]:l,F=typeof l=="string"||Array.isArray(l)?l:void 0;let p;O==="line"?p=E?h.createElement(Rr,Object.assign({},t,{strokeColor:F,prefixCls:f,steps:E}),I):h.createElement(kr,Object.assign({},t,{strokeColor:d,prefixCls:f,direction:w}),I):(O==="circle"||O==="dashboard")&&(p=h.createElement(gr,Object.assign({},t,{strokeColor:d,prefixCls:f,progressStatus:C}),I));const _=et(f,`${f}-status-${C}`,`${f}-${O==="dashboard"&&"circle"||E&&"steps"||O}`,{[`${f}-inline-circle`]:O==="circle"&&tt(v,"circle")[0]<=20,[`${f}-show-info`]:o,[`${f}-${v}`]:typeof v=="string",[`${f}-rtl`]:w==="rtl"},L==null?void 0:L.className,a,i,P,m);return j(h.createElement("div",Object.assign({ref:s,style:Object.assign(Object.assign({},L==null?void 0:L.style),b),className:_,role:"progressbar","aria-valuenow":R},Fs(D,["trailColor","strokeWidth","width","gapDegree","gapPosition","strokeLinecap","success","successPercent"])),p))}),Gt=Ar;function Or({title:t,setShowVehicles:s,showVehicles:r,showParams:a,setShowParams:i}){const E=de(),{collapsed:l}=N(L=>L.auth),{isLiveParameter:u,isWriteParameter:v,isActuator:o,isRoutineTest:O,isFlashing:U,isJ1939:k,selectedVehicle:b}=N(L=>L.diagnostics),{tractorIcon:D}=N(L=>L.liveMap);JSON.parse(localStorage.getItem("w_userDetails"));const{mode:R,selectedVehicleGroup:C}=N(L=>L.dashboard),S=()=>{E(ls(!l))},w={fontSize:"26px",fontWeight:500,lineHeight:"18.38px",color:"#fff",textAlign:"center",paddingTop:"5px",fontFamily:"ubuntu"};return e.jsxs(n,{style:{display:"flex",justifyContent:"space-between",paddingRight:"20px",backgroundColor:qe.bgColor,alignItems:"center",textAlign:"center",height:"60px",color:"white"},children:[e.jsxs(n,{style:{display:"flex",justifyContent:"space-between",gap:"10px",alignItems:"center",width:"50%"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[l?e.jsx(re,{onClick:S,sx:{color:"white"},children:e.jsx(Us,{style:{width:"30px",height:"30px"}})}):e.jsx(re,{onClick:S,sx:{color:"white"},children:e.jsx(Ms,{style:{width:"30px",height:"30px"}})}),e.jsx("img",{src:Hs,alt:"wikitrak logo"})]}),e.jsx(n,{children:e.jsx(zs,{style:w,children:t})})]}),e.jsxs(n,{style:{display:"flex",gap:"5px"},children:[e.jsxs(re,{variant:"outlined",size:"small",sx:{color:r?"white":"black",backgroundColor:r?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{s(!r),i(!1)},children:[e.jsx("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",style:{marginRight:"5px"},children:e.jsx("path",{d:D.path1})}),Object.keys(b).length>0?b.reg_id:"Vehicles"]}),(u||v||o||O||U||k)&&e.jsxs(re,{variant:"outlined",size:"small",sx:{color:a?"blue":"white",backgroundColor:a?"white":"undefined",mt:"6px",mx:"5px",border:"1px solid white",height:"40px"},onClick:()=>{s(!1),i(!a)},children:[u&&"Live Parameter",v&&"Write Parameter",o&&"Actuator Test",O&&"Routine Test",U&&"Flashing",k&&"J1939 Parameter"]}),e.jsx(ye,{onClick:()=>{E(ns(!R))},sx:{color:"white"}})]})]})}const Ir=({vehicleData:t,handleChange:s})=>{const{selectedVehicle:r}=N(v=>v.diagnostics),[a,i]=h.useState(""),{mode:E}=N(v=>v.dashboard),l=ae(E),u=t&&t.length>0&&t.filter(v=>v.label.toLowerCase().includes(a));return e.jsxs(e.Fragment,{children:[e.jsx(Yt,{style:{width:"85%",margin:"8px 20px",padding:"10px"},placeholder:"Search vehicle",onChange:v=>i(v.target.value)}),u.length>0?u.map((v,o)=>e.jsx(n,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(re,{variant:"outlined",onClick:()=>{s(v)},sx:{width:"90%",bgcolor:v.label===(r==null?void 0:r.reg_id)?qe.bgColor:"undefined",color:v.label===(r==null?void 0:r.reg_id)?"white":l.grey[400],border:`1px solid ${qe.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:qe.bgShadow}},children:v.label})},o)):e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsx(is,{sx:{textAlign:"center",color:l.grey[400]},children:"Sorry! No vehicles"})})]})},$r=({options:t})=>{const{selectedMenu:s,selectedVehicle:r}=N(u=>u.diagnostics),a=de(),{mode:i}=N(u=>u.dashboard),E=ae(i),l=u=>{switch(Rt(u),a(Rt(u)),u){case"Terminal Application":a(ms());break;case"Write Parameters":a(fs());break;case"Read DTC":a(gs());break;case"Live Parameters":a(hs());break;case"Actuator Test":a(xs());break;case"Routine Test":a(ps());break;case"ECU Information":a(us());break;case"Flashing":a(ds());break;case"J1939 Parameters":a(cs());break}};return e.jsx(e.Fragment,{children:e.jsx("div",{children:t.length>0&&t.map((u,v)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsxs(n,{sx:{border:s!==u.label?"1px solid #E8E8E8":"",p:"8px",borderRadius:"5px",m:"10px",display:"flex",cursor:"pointer",color:s===u.label?"white":E.grey[400],backgroundColor:s===u.label?"#8DA6C6":void 0},onClick:()=>{l(u.label)},children:[e.jsx(n,{sx:{mx:"5px"},children:u.icon}),e.jsx(n,{sx:{mx:"5px",fontSize:"16px"},children:e.jsx("span",{children:u.label})})]})},v))})})};var dt={},Pr=ge;Object.defineProperty(dt,"__esModule",{value:!0});var qt=dt.default=void 0,Lr=Pr(fe()),Fr=e;qt=dt.default=(0,Lr.default)((0,Fr.jsx)("path",{d:"M20 4H4c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2m0 14H4V8h16zm-2-1h-6v-2h6zM7.5 17l-1.41-1.41L8.67 13l-2.59-2.59L7.5 9l4 4z"}),"Terminal");var ut={},Br=ge;Object.defineProperty(ut,"__esModule",{value:!0});var Qt=ut.default=void 0,Nr=Br(fe()),Ur=e;Qt=ut.default=(0,Nr.default)((0,Ur.jsx)("path",{d:"M21 4H3c-1.1 0-2 .9-2 2v13c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2M3 19V6h8v13zm18 0h-8V6h8zm-7-9.5h6V11h-6zm0 2.5h6v1.5h-6zm0 2.5h6V16h-6z"}),"ChromeReaderModeOutlined");var pt={},Mr=ge;Object.defineProperty(pt,"__esModule",{value:!0});var Xt=pt.default=void 0,Hr=Mr(fe()),Ue=e;Xt=pt.default=(0,Hr.default)([(0,Ue.jsx)("circle",{cx:"20",cy:"12",r:"2"},"0"),(0,Ue.jsx)("circle",{cx:"4",cy:"12",r:"2"},"1"),(0,Ue.jsx)("circle",{cx:"12",cy:"20",r:"2"},"2"),(0,Ue.jsx)("path",{d:"m13.943 8.6191 4.4044-4.392 1.4122 1.4162-4.4043 4.392zM8.32 9.68l.31.32 1.42-1.41-4.02-4.04h-.01l-.31-.32-1.42 1.41 4.02 4.05zm7.09 4.26L14 15.35l3.99 4.01.35.35 1.42-1.41-3.99-4.01zm-6.82.01-4.03 4.01-.32.33 1.41 1.41 4.03-4.02.33-.32z"},"3"),(0,Ue.jsx)("circle",{cx:"12",cy:"4",r:"2"},"4")],"StreamOutlined");var xt={},Gr=ge;Object.defineProperty(xt,"__esModule",{value:!0});var Jt=xt.default=void 0,Wr=Gr(fe()),zr=e;Jt=xt.default=(0,Wr.default)((0,zr.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM5.92 19H5v-.92l9.06-9.06.92.92zM20.71 5.63l-2.34-2.34c-.2-.2-.45-.29-.71-.29s-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41"}),"CreateOutlined");var ht={},Yr=ge;Object.defineProperty(ht,"__esModule",{value:!0});var Vt=ht.default=void 0,Kr=Yr(fe()),qr=e;Vt=ht.default=(0,Kr.default)((0,qr.jsx)("path",{d:"M5 2c0-.55-.45-1-1-1s-1 .45-1 1v4H1v10c0 1.3.84 2.4 2 2.82V23h2v-4.18C6.16 18.4 7 17.3 7 16V6H5zM4 17c-.55 0-1-.45-1-1v-2h2v2c0 .55-.45 1-1 1m-1-5V8h2v4zM13 2c0-.55-.45-1-1-1s-1 .45-1 1v4H9v10c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.42 2-1.52 2-2.82V6h-2zm-1 15c-.55 0-1-.45-1-1v-2h2v2c0 .55-.45 1-1 1m-1-5V8h2v4zm10-6V2c0-.55-.45-1-1-1s-1 .45-1 1v4h-2v10c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.42 2-1.52 2-2.82V6zm-1 11c-.55 0-1-.45-1-1v-2h2v2c0 .55-.45 1-1 1m-1-5V8h2v4z"}),"SettingsInputComponentOutlined");var gt={},Qr=ge;Object.defineProperty(gt,"__esModule",{value:!0});var Zt=gt.default=void 0,Xr=Qr(fe()),Wt=e;Zt=gt.default=(0,Xr.default)([(0,Wt.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,Wt.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime");var ft={},Jr=ge;Object.defineProperty(ft,"__esModule",{value:!0});var es=ft.default=void 0,Vr=Jr(fe()),Zr=e;es=ft.default=(0,Vr.default)((0,Zr.jsx)("path",{d:"M7 3v9c0 .55.45 1 1 1h2v7.15c0 .51.67.69.93.25l5.19-8.9c.39-.67-.09-1.5-.86-1.5H13l2.49-6.65c.25-.65-.23-1.35-.93-1.35H8c-.55 0-1 .45-1 1"}),"FlashOnRounded");var mt={},ea=ge;Object.defineProperty(mt,"__esModule",{value:!0});var ts=mt.default=void 0,ta=ea(fe()),sa=e;ts=mt.default=(0,ta.default)((0,sa.jsx)("path",{d:"M22 11h-4.17l3.24-3.24-1.41-1.42L15 11h-2V9l4.66-4.66-1.42-1.41L13 6.17V2h-2v4.17L7.76 2.93 6.34 4.34 11 9v2H9L4.34 6.34 2.93 7.76 6.17 11H2v2h4.17l-3.24 3.24 1.41 1.42L9 13h2v2l-4.66 4.66 1.42 1.41L11 17.83V22h2v-4.17l3.24 3.24 1.42-1.41L13 15v-2h2l4.66 4.66 1.41-1.42L17.83 13H22z"}),"AcUnitOutlined");const he={fontSize:"25px"},ra=[{key:0,type:"input",label:"Terminal Application",icon:e.jsx(qt,{style:he}),value:"terminalApp",allowedDevice:["RetroFotax","Sinocastel"]},{key:1,type:"input",label:"Read DTC",icon:e.jsx(Qt,{style:he}),value:"readDtc",allowedDevice:["RetroFotax","Sinocastel"]},{key:2,type:"input",label:"Live Parameters",icon:e.jsx(Xt,{style:he}),value:"liveParam",allowedDevice:["RetroFotax","Sinocastel"]},{key:8,type:"input",label:"J1939 Parameters",icon:e.jsx(ts,{style:he}),value:"liveParam",allowedDevice:["RetroFotax"]},{key:3,type:"input",label:"Write Parameters",icon:e.jsx(Jt,{style:he}),value:"writeParam",allowedDevice:["RetroFotax"]},{key:4,type:"input",label:"Actuator Test",icon:e.jsx(Vt,{style:he}),value:"actuatorTest",allowedDevice:["RetroFotax"]},{key:5,type:"input",label:"Routine Test",icon:e.jsx(Zt,{style:he}),value:"routineTest",allowedDevice:["RetroFotax"]},{key:6,type:"input",label:"ECU Information",icon:e.jsx(Ks,{style:he}),value:"ecuInfo",allowedDevice:["RetroFotax"]},{key:7,type:"input",label:"Flashing",icon:e.jsx(es,{style:he}),value:"flashing",allowedDevice:["RetroFotax"]}],ee=(t,s,r)=>{const a=s.length/2,i=("000"+a.toString(16)).slice(-3),E=("0000"+aa(s,a).toString(16)).slice(-4),l=t+i+r+s+E;return console.log(l),l==null?void 0:l.toLowerCase()},aa=(t,s)=>{let r=65535;for(let a=0;a<s;a++){const i=parseInt(t.slice(a*2,a*2+2),16);r^=i<<8;for(let E=0;E<8;E++)r&32768?r=r<<1^4129:r<<=1}return r&65535},zt=t=>{let s="";switch(t){case"10":s="ECUERROR GENERALREJECT";break;case"11":s="ECUERROR SERVICENOTSUPPORTED";break;case"12":s="ECUERROR SUBFUNCTIONNOTSUPPORTED";break;case"13":s="ECUERROR INVALIDFORMAT";break;case"14":s="ECUERROR RESPONSETOOLONG";break;case"21":s="ECUERROR BUSYREPEATREQUEST";break;case"22":s="ECUERROR CONDITIONSNOTCORRECT";break;case"24":s="ECUERROR REQUESTSEQUENCEERROR";break;case"31":s="ECUERROR REQUESTOUTOFRANGE";break;case"33":s="ECUERROR SECURITYACCESSDENIED";break;case"35":s="ECUERROR INVALIDKEY";break;case"36":s="ECUERROR EXCEEDEDNUMBEROFATTEMPTS";break;case"37":s="ECUERROR REQUIREDTIMEDELAYNOTEXPIRED";break;case"70":s="ECUERROR UPLOADDOWNLOADNOTACCEPTED";break;case"71":s="ECUERROR TRANSFERDATASUSPENDED";break;case"72":s="ECUERROR_GENERALPROGRAMMINGFAILURE";break;case"73":s="ECUERROR WRONGBLOCKSEQCOUNTER";break;case"7E":s="ECUERROR SUBFNNOTSUPPORTEDINACTIVESESSION";break;case"7F":s="ECUERROR SERVICENOTSUPPORTEDINACTIVESESSION";break;case"81":s="ECUERROR RPMTOOHIGH";break;case"82":s="ECUERROR RPMTOOLOW";break;case"83":s="ECUERROR ENGINEISRUNNING";break;case"84":s="ECUERROR ENGINEISNOTRUNNING";break;case"85":s="ECUERROR ENGINERUNTIMETOOLOW";break;case"86":s="ECUERROR TEMPTOOHIGH";break;case"87":s="ECUERROR TEMPTOOLOW";break;case"88":s="ECUERROR VEHSPEEDTOOHIGH";break;case"89":s="ECUERROR VEHSPEEDTOOLOW";break;case"8A":s="ECUERROR THROTTLETOOHIGH";break;case"8B":s="ECUERROR THROTTLETOOLOW";break;case"8C":s="ECUERROR TRANSMISSIONRANGENOTINNEUTRAL";break;case"8D":s="ECUERROR TRANSMISSIONRANGENOTINGEAR";break;case"8F":s="ECUERROR BRKPEDALNOTPRESSED";break;case"90":s="ECUERROR SHIFTERLEVERNOTINPARK";break;case"91":s="ECUERROR TRQCONVERTERCLUTCHLOCKED";break;case"92":s="ECUERROR VOLTAGETOOHIGH";break;case"93":s="ECUERROR VOLTAGETOOLOW";break}return console.log("status: ",s),s};function ss(t){t=t.slice(1);let s=t.slice(0,3),r=parseInt(s,16),a=5;return t.slice(a,a+r*2)}function Ve(t){const s=t.match(/.{1,2}/g);let r="";for(let a=0;a<s.length;a++){const i=parseInt(s[a],16);r+=String.fromCharCode(i)}return r}function Ze(t){return parseInt(t,16)}function oa(t){return t.toString(16)}const rs="https://cc.wikitrak.in/proxy-3031",na=({deviceType:t})=>{var P,m,I;const s=de(),{liveParameters:r,isLiveParameter:a,isWriteParameter:i,isActuator:E,isRoutineTest:l,isFlashing:u,loading:v,isDtcLoader:o,isJ1939:O,j1939Parameters:U}=N(d=>d.diagnostics),{vehicleList:k,selectedVehicle:b}=N(d=>d.liveMap);N(d=>d.dashboard);let R=(I=(m=(P=((k||[]).find(d=>{var F;return((F=d==null?void 0:d.imei[0])==null?void 0:F.mac_id)===(b==null?void 0:b.imei)})||{}).sub_model)==null?void 0:P.ecus[0])==null?void 0:m.ecu[0])==null?void 0:I.file;R=(R==null?void 0:R.map(d=>({...d,label:d.sw_part_no})))||[];const C=(d,F)=>{let p=r.map((_,T)=>(_.label,{..._,checked:_.label===F?d.target.checked:_.checked}));s(_e(p))},S=(d,F)=>{let p=U.map((_,T)=>(_.label,{..._,checked:_.label===F?d.target.checked:_.checked}));s(Qe(p))},w=d=>{s(bs(d.label)),s(ys(d))},L=d=>{s(Cs(d.label)),s(_s(d))},f=d=>{s(vs(d.label)),s(js(d))},j=d=>{s(nt(d.label)),s(lt(d))};return e.jsxs("div",{children:[o&&e.jsx(we,{}),a&&e.jsx(la,{handleLiveParameter:C,deviceType:t}),i&&e.jsx(ia,{handleWriteParameter:w}),E&&e.jsx(ca,{handleActuatorTest:L}),l&&e.jsx(da,{handleRoutineTest:f}),u&&e.jsx(ua,{handleFlashing:j}),O&&e.jsx(pa,{handleJ1939Parameter:S})]})},la=({handleLiveParameter:t,deviceType:s})=>{const r=de(),{liveParameters:a,liveParameterGroupList:i,selectedVehicle:E}=N(m=>m.diagnostics),{mode:l}=N(m=>m.dashboard),u=ae(l);N(m=>m.liveMap);const[v,o]=h.useState(""),[O,U]=h.useState(""),[k,b]=h.useState(!1);h.useState(!1);const D=a.length>0&&a.filter(m=>m.label.toLowerCase().includes(v.toLowerCase())),R=i.length>0&&i.filter(m=>m.label.toLowerCase().includes(O.toLowerCase())),C=(m,I)=>{I==="group"&&U(m.target.value),I==="one"&&o(m.target.value)};function S(m){return m.match(/../g).reverse().join("")}function w(m,I){const{pidArray:d,frames:F}=m,p=F[F.length-1];let _=0;for(const T of d){const x=T.toLowerCase().padStart(4,"0").match(/../g).reverse().join(""),y=a.find(Y=>Y.code===x);if(!y||!Array.isArray(y.pi_code_variable)||y.pi_code_variable.length===0){console.warn(`Invalid or missing pi_code_variable for PID: ${x}`);continue}const A=y.pi_code_variable[0];if(!A||typeof A.length!="number"||!A.message_type||A.length<=0){console.warn(`Invalid byte definition for PID: ${x}`,A);continue}const $=A.length,B=$*2,g=p.slice(_*2,_*2+B);if(T===I){const{resolution:Y=1,offset:M=0,message_type:H}=A,z=S(g);let K=null;switch(H){case"CONTINUOUS":K=Ze(z)*Y+M;break;case"ASCII":K=Ve(z);break;case"eNUM":case"bcd-hex":K=z;break;default:return{pid:I,error:`Unknown message_type: ${H}`}}return{pidCheck:x,valueHex:g,valueHexLE:z,decimalValue:K}}_+=$}return{pid:I,error:"PID not found or byte definition missing"}}const L=async()=>{var I;const m=a.filter(d=>d.checked);if(s==="Sinocastel"){r(ne(!0));try{const F=m.map(c=>c.code).map(c=>c.toLowerCase().padStart(4,"0").match(/../g).reverse().join("")),{data:p}=await le.post(`${rs}/api/packet/latest`,{imei:E.imei,pid:F}),_=(I=p==null?void 0:p.results)!=null&&I.length?p.results.filter(c=>c==null?void 0:c.packet).map(c=>w(c.packet,c.pid)):[],T=a.map(c=>{const x=_.find(y=>y.pidCheck===c.code);return console.log("match",x,x==null?void 0:x.decimalValue),{...c,dataByte:x?x.decimalValue:""}});r(_e(T)),r(ne(!1))}catch(d){r(ne(!1)),console.error("Error in Sinocastel flow:",d),G.error("Failed to read parameter data")}}else try{r(ne(!0));const d=m.map(c=>({command:ee("4",c.code,"00"),id:c.id})),F=d.map(c=>c.command),p=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:E.imei,commands:`{${F}}`}),_=p==null?void 0:p.data;if(!(_!=null&&_.success)||!Array.isArray(_.commands))throw new Error("Invalid API response");let T=[...a];_.commands.forEach((c,x)=>{var y;try{const A=ss(c),{id:$}=d[x]||{};if(!$)return;const B=T.find(H=>H.id===$),g=(y=B==null?void 0:B.pi_code_variable)==null?void 0:y[0];if(!g||!A.startsWith("62")){g!=null&&g.short_name&&G.error(`Negative response from ECU for ${g.short_name}`);return}let Y=A.toLowerCase().replace(B.code.toLowerCase().slice(2),"").slice(2),M;switch(g.message_type){case"CONTINUOUS":M=Ze(Y)*g.resolution+g.offset;break;case"ASCII":M=Ve(Y);break;case"eNUM":case"bcd-hex":M=Y;break;default:return}T=T.map(H=>H.id===$?{...H,dataByte:M}:H)}catch(A){console.error("Error decoding command:",A)}}),r(_e(T))}catch(d){console.error("Error in handleSubmit:",d),G.error("Response timeout")}finally{r(ne(!1))}},f=()=>{b(!k)},j=(m,I)=>{const d=m.target.checked;console.log("ischeckd",d);const F=i.find(_=>_.id===I);if(!F)return;const p=a.map(_=>{var c,x,y;const T=(y=(x=(c=_.pi_code_variable)==null?void 0:c[0])==null?void 0:x.group)==null?void 0:y.some(A=>A.id===F.id);return console.log("belongsToGroup",T),T?{..._,checked:d}:_});r(_e(p))},P=m=>{if(m.target.checked){let I=a.map(d=>({...d,checked:!0}));r(_e(I))}else{let I=a.map(d=>({...d,checked:!1}));r(_e(I))}};return e.jsxs(e.Fragment,{children:[e.jsxs(n,{children:[!k&&e.jsxs(e.Fragment,{children:[e.jsxs(je,{sx:{width:"75%",mt:"15px",mx:"15px",backgroundColor:u.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(Se,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:u.grey[400]},children:"Search"}),e.jsx(Ee,{onChange:m=>{C(m,"one")},inputProps:{style:{padding:7,color:u.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ke,{position:"end",children:e.jsx(ye,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(ve,{})})}),label:"Search"})]}),e.jsx("input",{type:"checkbox",style:{marginTop:"25px"},onChange:P})]}),k&&e.jsx(e.Fragment,{children:e.jsxs(je,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:u.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(Se,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:u.grey[400]},children:"Search"}),e.jsx(Ee,{onChange:m=>{C(m,"group")},inputProps:{style:{padding:7,color:u.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ke,{position:"end",children:e.jsx(ye,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(ve,{})})}),label:"Search"})]})})]}),!k&&e.jsxs("div",{style:{height:"67vh",overflow:"auto"},children:[D.length>0&&D.map((m,I)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},title:m.label,children:e.jsxs(n,{sx:{border:"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:u.grey[400]},children:[e.jsx(n,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:m.label.length<=25?m.label:`${m.label.substring(0,25)}...`})}),e.jsx(n,{sx:{fontSize:"16px",position:"relative",right:"2px"},children:e.jsx("input",{type:"checkbox",onChange:d=>{t(d,m.label)},checked:m.checked,style:{width:"20px",padding:0}})})]})},I)),!(D.length>0)&&e.jsx("h3",{children:"No Data"})]}),k&&e.jsx("div",{style:{height:"67vh",overflow:"auto"},children:R.length>0&&R.map((m,I)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},title:m.label,children:e.jsxs(n,{sx:{border:"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:u.grey[400]},children:[e.jsx(n,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:m.label.length<=25?m.label:`${m.label.substring(0,20)}...`})}),e.jsx(n,{sx:{fontSize:"16px",position:"relative",right:"2px"},children:e.jsx("input",{type:"checkbox",onChange:d=>{j(d,m.id)},checked:m.checked,style:{width:"20px",padding:0}})})]})},I))}),e.jsx(n,{sx:{mt:"25px"},children:e.jsx(re,{variant:"contained",sx:{width:"90%",mx:"10px",backgroundColor:"#8DA6C6"},onClick:L,children:"Submit"})}),e.jsx(n,{sx:{mt:"10px"},children:e.jsx(re,{variant:"contained",sx:{width:"90%",mx:"10px",backgroundColor:"white",color:"black"},onClick:f,children:k?"Select Parameter":"Select Group"})})]})},ia=({handleWriteParameter:t})=>{const{writeParameter:s,activeWriteParameter:r}=N(o=>o.diagnostics),{mode:a}=N(o=>o.dashboard),i=ae(a),[E,l]=h.useState(""),u=s.length>0&&s.filter(o=>o.label.toLowerCase().includes(E.toLowerCase())),v=o=>{l(o.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsxs(je,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:i.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(Se,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:i.grey[400]},children:"Search"}),e.jsx(Ee,{onChange:v,inputProps:{style:{padding:7,color:i.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ke,{position:"end",children:e.jsx(ye,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(ve,{})})}),label:"Search"})]})}),u.length>0&&u.map((o,O)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(n,{sx:{p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",border:r===o.label?"1px solid #8DA6C6":"1px solid #E8E8E8",color:r===o.label?"white":i.grey[400],backgroundColor:r===o.label?"#8DA6C6":void 0},onClick:()=>{t(o)},children:e.jsx(n,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:o.label.length<=25?o.label:`${o.label.substring(0,25)}...`})})})},O))]})},ca=({handleActuatorTest:t})=>{const{liveParameters:s,writeParameter:r,actuatorTestList:a,routineTestList:i,isLiveParameter:E,isWriteParameter:l,isActuator:u,activeWriteParameter:v,activeActuatorTest:o,activeRoutineTest:O,activeFlashingFile:U,isRoutineTest:k,isFlashing:b}=N(f=>f.diagnostics),{mode:D}=N(f=>f.dashboard),R=ae(D),[C,S]=h.useState(""),w=a.length>0&&a.filter(f=>f.label.toLowerCase().includes(C.toLowerCase())),L=f=>{S(f.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsxs(je,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:R.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(Se,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:R.grey[400]},children:"Search"}),e.jsx(Ee,{onChange:L,inputProps:{style:{padding:7,color:R.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ke,{position:"end",children:e.jsx(ye,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(ve,{})})}),label:"Search"})]})}),w.length>0&&w.map((f,j)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(n,{sx:{border:o===f.label?"1px solid #8DA6C6":"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:o===f.label?"white":R.grey[400],backgroundColor:o===f.label?"#8DA6C6":void 0},onClick:()=>{t(f)},children:e.jsx(n,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:f.label.length<=25?f.label:`${f.label.substring(0,25)}...`})})})},j))]})},da=({handleRoutineTest:t})=>{const{routineTestList:s,activeRoutineTest:r}=N(o=>o.diagnostics),{mode:a}=N(o=>o.dashboard),i=ae(a),[E,l]=h.useState(""),u=s.length>0&&s.filter(o=>o.label.toLowerCase().includes(E.toLowerCase())),v=o=>{l(o.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsxs(je,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:i.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(Se,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:i.grey[400]},children:"Search"}),e.jsx(Ee,{onChange:v,inputProps:{style:{padding:7,color:i.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ke,{position:"end",children:e.jsx(ye,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(ve,{})})}),label:"Search"})]})}),u.length>0&&u.map((o,O)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(n,{sx:{border:r===o.label?"1px solid #8DA6C6":"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:r===o.label?"white":i.grey[400],backgroundColor:r===o.label?"#8DA6C6":void 0},onClick:()=>{t(o)},children:e.jsx(n,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:o.label.length<=25?o.label:`${o.label.substring(0,25)}...`})})})},O)),!s.length>0&&e.jsx("div",{style:{marginTop:"40%",textAlign:"center",color:i.grey[400]},children:e.jsx("h3",{children:"Routine test not available"})})]})},ua=({handleFlashing:t})=>{const{activeFlashingFile:s,fotaFiles:r}=N(o=>o.diagnostics),{mode:a}=N(o=>o.dashboard),i=ae(a),[E,l]=h.useState(""),u=r.length>0&&r.filter(o=>o.label.toLowerCase().includes(E.toLowerCase())),v=o=>{l(o.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsxs(je,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:i.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(Se,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:i.grey[400]},children:"Search"}),e.jsx(Ee,{onChange:v,inputProps:{style:{padding:7,color:i.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ke,{position:"end",children:e.jsx(ye,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(ve,{})})}),label:"Search"})]})}),e.jsx("div",{style:{height:"90vh",overflow:"auto"},children:u.length>0&&u.map((o,O)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(n,{sx:{border:s===o.label?"1px solid #8DA6C6":"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:s===o.label?"white":i.grey[400],backgroundColor:s===o.label?"#8DA6C6":i.grey[100]},onClick:()=>{t(o)},children:e.jsx(n,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:o.label.length<=25?o.label:`${o.label.substring(0,25)}...`})})})},O))})]})},pa=({handleJ1939Parameter:t})=>{const s=de(),{j1939Parameters:r,selectedVehicle:a}=N(C=>C.diagnostics),{mode:i}=N(C=>C.dashboard),E=ae(i);N(C=>C.liveMap);const[l,u]=h.useState(""),[v,o]=h.useState(!1);h.useState(!1);const O=r.length>0&&r.filter(C=>C.label.toLowerCase().includes(l.toLowerCase())),U=(C,S)=>{S==="group"&&setSearchText2(C.target.value),S==="one"&&u(C.target.value)};function k(C){return C.match(/../g).reverse().join("")}function b(C,S){const{pidArray:w,frames:L}=C;L[L.length-1];for(const f of w){f.toLowerCase().padStart(4,"0");const j=f,P=r.find(d=>{var F;return((F=d==null?void 0:d.pgn)==null?void 0:F.toLowerCase())===(j==null?void 0:j.toLowerCase())});if(!P||!Array.isArray(P.spn)||P.spn.length===0){console.warn(`Invalid or missing pi_code_variable for PID: ${j}`);continue}const m=P.spn[0];if(!m||typeof m.no_of_bytes!="number"||!m.message_type||m.no_of_bytes<=0){console.warn(`Invalid byte definition for PID: ${j}`,m);continue}m.no_of_bytes;const I=L[w.indexOf(f)];if(f===S){const{resolution:d=1,offset:F=0,message_type:p,start_byte:_,start_bit:T,no_of_bit:c,endian:x,bitcoded:y,no_of_bytes:A}=m,$=(_-1)*2,B=$+A*2;let g=I.slice($,B),Y;y?Y=parseInt(g,16).toString(2).padStart(A*8,"0").slice(T-1,T-1+c):Y=g;let M;x.toLowerCase()==="big"?M=Y:M=k(Y);let H=null;switch(p){case"CONTINUOUS":H=Ze(M)*d+F;break;case"ASCII":H=Ve(M);break;case"eNUM":case"bcd-hex":H=M;break;default:return{pid:S,error:`Unknown message_type: ${p}`}}return{pidCheck:j,valueHex:I,decimalValue:H}}}return{pid:S,error:"PID not found or byte definition missing"}}const D=async()=>{var C;s(ne(!0));try{const w=r.filter(P=>P.checked).map(P=>P.pgn),{data:L}=await le.post(`${rs}/api/packet/latest`,{imei:a.imei,pid:w}),f=(C=L==null?void 0:L.results)!=null&&C.length?L.results.filter(P=>P==null?void 0:P.packet).map(P=>b(P.packet,P.pid)):[];console.log("pidArray",f);const j=r.map(P=>{const m=f.find(I=>I.pidCheck===P.pgn);return console.log("match",m,m==null?void 0:m.decimalValue),{...P,dataByte:m?m.decimalValue:""}});s(Qe(j)),s(ne(!1))}catch(S){s(ne(!1)),console.error("Error in Sinocastel flow:",S),G.error("Failed to read parameter data")}},R=C=>{if(C.target.checked){let S=r.map(w=>({...w,checked:!0}));s(Qe(S))}else{let S=r.map(w=>({...w,checked:!1}));s(Qe(S))}};return e.jsxs(e.Fragment,{children:[e.jsx(n,{children:!v&&e.jsxs(e.Fragment,{children:[e.jsxs(je,{sx:{width:"75%",mt:"15px",mx:"15px",backgroundColor:E.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(Se,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:E.grey[400]},children:"Search"}),e.jsx(Ee,{onChange:C=>{U(C,"one")},inputProps:{style:{padding:7,color:E.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(ke,{position:"end",children:e.jsx(ye,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(ve,{})})}),label:"Search"})]}),e.jsx("input",{type:"checkbox",style:{marginTop:"25px"},onChange:R})]})}),!v&&e.jsxs("div",{style:{height:"67vh",overflow:"auto"},children:[O.length>0&&O.map((C,S)=>e.jsx(n,{sx:{align:"center",my:"8px",color:"grey"},title:C.label,children:e.jsxs(n,{sx:{border:"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:E.grey[400]},children:[e.jsx(n,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:C.label.length<=25?C.label:`${C.label.substring(0,25)}...`})}),e.jsx(n,{sx:{fontSize:"16px",position:"relative",right:"2px"},children:e.jsx("input",{type:"checkbox",onChange:w=>{t(w,C.label)},checked:C.checked,style:{width:"20px",padding:0}})})]})},S)),!(O.length>0)&&e.jsx("h3",{children:"No Data"})]}),e.jsx(n,{sx:{mt:"25px"},children:e.jsx(re,{variant:"contained",sx:{width:"90%",mx:"10px",backgroundColor:"#8DA6C6"},onClick:D,children:"Submit"})})]})},xa=()=>{var m,I,d,F,p,_,T;const t=de(),{vehicleList:s}=N(c=>c.liveMap),{terminalAppLogs:r,dtcDataset:a,loading:i,isDtcLoader:E,selectedVehicle:l}=N(c=>c.diagnostics),{mode:u}=N(c=>c.dashboard),v=ae(u),[o,O]=h.useState(0),[U,k]=h.useState(""),[b,D]=h.useState([]),[R,C]=h.useState(!1),S=(s||[]).find(c=>{var x;return((x=c==null?void 0:c.imei[0])==null?void 0:x.mac_id)===(l==null?void 0:l.imei)})||{};console.log("active vehilce ",S,l),console.log("vehicle list",s),h.useEffect(()=>{var c,x,y,A,$,B;if(((c=Object.keys(S))==null?void 0:c.length)>0&&((y=(x=S==null?void 0:S.sub_model)==null?void 0:x.ecus)==null?void 0:y.length)>0){let g=(B=($=(A=S==null?void 0:S.sub_model)==null?void 0:A.ecus[0])==null?void 0:$.datasets[0])==null?void 0:B.id;t(Tt({id:g}))}},[]);const w=(c,x)=>{var H,z;O(x);let y=(z=(H=S==null?void 0:S.sub_model)==null?void 0:H.ecus[x].datasets[0])==null?void 0:z.id;t(Tt({id:y}));const{tx_header:A,rx_header:$,protocol:B}=c,g=`02${B.autopeepal},04${A},06${$}`;switch(S.sub_model.ecus[x].read_dtc_fn_index.value.split("_")[0]){case"GENERICOBD":{const K=ee("4","03","00"),q=ee("4","07","00");G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:K})),G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:q}));let se={imei:l.imei,commands:`{${K}, ${q}}`,tranCmd:`{${K}, ${q}}`};t(ue(se));break}case"UDS":{g||G.error("Please click again");let K,q=g.split(","),se=q==null?void 0:q.map(ie=>{if((q==null?void 0:q.length)%2===0){G.error("The Tx Frame format is not right. Must be odd length.");return}return K=ee("2",ie,"00"),K});if(se){G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:se}));let ie={imei:l.imei,commands:`{${se}}`,tranCmd:se};t(ue(ie))}break}case"KWP":{const K=ee("4","1800AF","00");G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:K}));let q={imei:l.imei,commands:`{${K}}`,tranCmd:`{${K}}`};t(ue(q));break}default:{C(!1);break}}},L=async(c,x,y)=>{var A,$;if(C(!0),y==="clear")try{k("");let B;B=ee(4,x,"00");const g=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:l.imei,commands:`{${B}}`});if(g!=null&&g.data&&C(!1),!((A=g==null?void 0:g.data)!=null&&A.success)){C(!1),k("Time Response is out");return}if((($=g==null?void 0:g.data)==null?void 0:$.commands.filter(M=>M.toLowerCase()==="400000ffff")).length>0){k("No response from ECU");return}k("Ecu is clear dtc Success");return}catch{k("Time Response is out")}else if(y==="read"){k("");try{k("");let B;B=ee(4,x,"00");const g=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:l.imei,commands:`{${B}}`});return g!=null&&g.data&&C(!1),g==null?void 0:g.data}catch{return{success:!1}}}},f=async()=>{if(C(!0),o===null)return G.error("Please select the tab");const c=S.sub_model.ecus[o].read_dtc_fn_index.value;if(c==="KWP_2BYTE_DTC"||c==="UDS_2BYTE12_DTC"||c==="UDS_2BYTE_DTC"||c==="UDS_2BYTE13_DTC"||c==="UDS_3BYTE_DTC"){let x=null,y=!1;if(c==="KWP_2BYTE_DTC"){let $=null;$=await L(4,"1800FFFF","read"),$.success?(x=$.commands[0],y=!0):y=!1}else{let $=null;$=await L(3,"1902FF","read"),$.success?(x=$.commands[0],y=!0):y=!1}y&&x==="400000ffff"?k("No response from ECU"):y||k("Time Response Out");let A=[];if(c!=="KWP_2BYTE_DTC"){x=x==null?void 0:x.slice(6),x=x==null?void 0:x.slice(6),x=x==null?void 0:x.slice(0,-4),console.log(x);const $=[];for(let g=0;g<(x==null?void 0:x.length);g+=8)$.push(x==null?void 0:x.slice(g,g+8));const B=(g,Y)=>((g&Y)>>6).toString(16).padStart(2,"0");A=$.map(g=>{let Y=0,M="",H="",z=g.slice(0,2),K=B(z,192);if(K==="00"?M="P":K==="01"?M="C":K==="02"?M="B":K==="03"&&(M="U"),c!=="KWP_2BYTE_DTC"){z=g.slice(0,-2);let q=B(z,129);switch(q){case"00":Y="Inactive:LampOff";break;case"01":Y="Active:LampOff";break;case"80":Y="Inactive:LampOn";break;case"81":Y="Active:LampOn";break}switch(c){case"UDS_3BYTE_DTC":z=g.slice(0,2),q=B(z,63),H=`${M}${q}${g.slice(2,4)}-${g.slice(4,6)}`;break}}return{type:H,value:Y}}),D(A)}}},j=async()=>{var x;if(o===null)return G.error("Please select the tab");const c=(x=S==null?void 0:S.sub_model)==null?void 0:x.ecus[o].clear_dtc_fn_index.value;if(c==="GENERICOBD"){const y=ee("4","04","00");G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:y})),t(ue(l.imei,`{${y}}`))}else{let y=c,A=null,$=0;return y==="UDS_4BYTES"?($=4,A=L($,"14FFFFFF","clear")):y==="UDS_3BYTES"?($=3,A=L($,"14FFFF","clear")):y==="GENERIC_OBD"?($=1,A=L($,"04","clear")):y==="KWP_PRIMITIVE"&&($=1,A=L($,"14","clear")),A}},P=c=>{var y;let x=[];return x=a.filter(A=>(A==null?void 0:A.code)===c),(x==null?void 0:x.length)>0?(y=x[0])==null?void 0:y.description:"Description is Not found"};return e.jsxs(n,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[(i||E||R)&&e.jsx(we,{}),e.jsx(n,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((m=Object.keys(S))==null?void 0:m.length)>0&&((I=S==null?void 0:S.sub_model)==null?void 0:I.ecus.length)>0&&((d=S==null?void 0:S.sub_model)==null?void 0:d.ecus.map((c,x)=>e.jsx(n,{children:e.jsx(n,{variant:"contained",sx:{color:o===x?"#333333":v.grey[400],mt:"20px",backgroundColor:o===x?"#D5E1FE":v.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{w(c,x)},children:e.jsx("b",{children:c.name})})})))}),e.jsx(n,{children:b&&b.length>0?e.jsx(n,{sx:{height:"65vh",overflow:"auto"},children:b&&b.length>0&&b.map((c,x)=>e.jsx(qs,{sx:{minWidth:275,mx:4,my:2,display:"flex",backgroundColor:v.grey[100],color:v.grey[400]},children:e.jsxs(Qs,{sx:{display:"flex"},children:[e.jsxs(n,{sx:{width:"35vw"},children:[e.jsx(n,{sx:{fontSize:"15px"},children:c==null?void 0:c.type}),e.jsx(n,{sx:{fontSize:"15px"},children:P(c==null?void 0:c.type)})]}),e.jsx(n,{children:e.jsx(re,{variant:"contained",sx:{color:"white",height:"25px",mt:"20px",ml:"50px",fontSize:"13px",backgroundColor:"#8DA6C6"},children:"Troubleshoot"})}),e.jsxs(n,{sx:{ml:"20px"},children:[e.jsx(n,{sx:{textAlign:"center"},children:"Status"}),e.jsxs(n,{children:[" ",e.jsx(re,{variant:"contained",sx:{color:"white",height:"25px",width:"150px",fontSize:"13px",backgroundColor:"#8DA6C6"},children:c==null?void 0:c.value})]})]})]})},x))}):e.jsx(n,{children:U.length>0?e.jsx(n,{sx:{textAlign:"center",marginTop:"20%"},children:U}):e.jsx(n,{sx:{textAlign:"center",marginTop:"20%",color:v.grey[400]},children:"Wait!, Your request is in progress..."})})}),r&&r.length>0&&r[r.length-1].color==="green"&&r.length>0&&((F=r[r.length-1].log)==null?void 0:F.length)>0&&((p=r[r.length-1].log[0])==null?void 0:p.toLowerCase())==="20010000e1f0"&&((_=r[r.length-1].log[1])==null?void 0:_.toLowerCase())==="20010000e1f0"&&((T=r[r.length-1].log[2])==null?void 0:T.toLowerCase())==="20010000e1f0"&&e.jsxs(n,{sx:{display:"flex",position:"fixed",top:"85%",left:"38%"},children:[e.jsx(n,{sx:{mx:"20px"},children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:f,children:"Read Dtc"})}),e.jsx(n,{children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:()=>{j()},children:"Clear Dtc"})})]})]})},ha=()=>{var C,S,w,L,f;const t=de(),{vehicleList:s}=N(j=>j.liveMap),{selectedVehicle:r}=N(j=>j.diagnostics),{liveParameters:a,loading:i,isDtcLoader:E}=N(j=>j.diagnostics),{mode:l}=N(j=>j.dashboard),u=ae(l),[v,o]=h.useState(0),[O,U]=h.useState(!1),k=(s||[]).find(j=>{var P;return((P=j==null?void 0:j.imei[0])==null?void 0:P.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var j,P,m,I,d,F;if(((j=Object.keys(k))==null?void 0:j.length)>0&&((m=(P=k==null?void 0:k.sub_model)==null?void 0:P.ecus)==null?void 0:m.length)>0){let p=(F=(d=(I=k==null?void 0:k.sub_model)==null?void 0:I.ecus[v])==null?void 0:d.pid_datasets[0])==null?void 0:F.id;t(Dt({pid:p})),t(At({pid:p}))}},[]);const b=(j,P)=>{var c,x;o(P);let m=(x=(c=k==null?void 0:k.sub_model)==null?void 0:c.ecus[P].pid_datasets[0])==null?void 0:x.id;t(Dt({pid:m})),t(At({pid:m}));const{tx_header:I,rx_header:d,protocol:F}=j,p=`02${F.autopeepal},04${I},06${d}`;switch(k.sub_model.ecus[P].read_dtc_fn_index.value.split("_")[0]){case"GENERICOBD":{const y=ee("4","03","00"),A=ee("4","07","00");G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:y})),G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:A}));let $={imei:r.imei,commands:`{${y}, ${A}}`,tranCmd:`{${y}, ${A}}`};t(ue($));break}case"UDS":{p||G.error("Please click again");let y,A=p.split(","),$=A==null?void 0:A.map(B=>{if((A==null?void 0:A.length)%2===0){G.error("The Tx Frame format is not right. Must be odd length.");return}return y=ee("2",B,"00"),y});if($){G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:$}));let B={imei:r.imei,commands:`{${$}}`,tranCmd:$};t(ue(B))}break}case"KWP":{const y=ee("4","1800AF","00");G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:y}));let A={imei:r.imei,commands:`{${y}}`,tranCmd:`{${y}}`};t(ue(A));break}}};function D(j){return parseInt(j,16)}const R=async()=>{var d,F;let j=[],P=[];a.filter(p=>p.checked).forEach(p=>{const _=ee("4",p.code,"00");j.push(_),P.push({command:_,id:p==null?void 0:p.id})}),G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:j.join(",")}));const m=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:r.imei,commands:`{${j}}`});let I;if((d=m==null?void 0:m.data)!=null&&d.success){let p=a;(F=m==null?void 0:m.data)==null||F.commands.forEach((_,T)=>{var g,Y;I="62100d02520970",I.slice(0,2)!=="62"&&G.error("Error From Device"),I=I==null?void 0:I.slice(6),I=I==null?void 0:I.slice(0,-4);let x=(g=P[T])==null?void 0:g.id,y=(Y=a.filter(M=>M.id===x)[0])==null?void 0:Y.pi_code_variable[0],A=(y==null?void 0:y.byte_position)-1,$=(y==null?void 0:y.length)*2,B=I.slice(A,$);if((y==null?void 0:y.message_type)==="CONTINUOUS"){let M=D(B),H=y==null?void 0:y.resolution,z=y==null?void 0:y.offset,K=M*H+z;p=p.map(q=>x===q.id?{...q,dataByt:K}:{...q})}else if((y==null?void 0:y.message_type)==="ASCII"){let M=hexToAscii(B);p=p.map(H=>x===H.id?{...H,dataByt:M}:{...H})}else(y==null?void 0:y.message_type)==="eNUM"?p=p.map(M=>x===M.id?{...M,dataByt:B}:{...M}):(y==null?void 0:y.message_type)==="bcd-hex"&&(p=p.map(M=>x===M.id?{...M,dataByt:B}:{...M}));t(_e(p))})}};return console.log("ecus",k),e.jsxs(n,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[(i||E||O)&&e.jsx(we,{}),e.jsx(n,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((C=Object.keys(k))==null?void 0:C.length)>0&&((S=k==null?void 0:k.sub_model)==null?void 0:S.ecus.length)>0&&((w=k==null?void 0:k.sub_model)==null?void 0:w.ecus.map((j,P)=>e.jsx(n,{children:e.jsx(n,{variant:"contained",sx:{color:v===P?"#333333":u.grey[400],mt:"20px",backgroundColor:v===P?"#D5E1FE":u.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{b(j,P)},children:e.jsx("b",{children:j.name})})})))}),e.jsxs(n,{children:[e.jsx(n,{sx:{ml:"30px",mt:"20px",color:u.grey[400]},children:e.jsx("span",{children:e.jsx("b",{children:v!==null&&((f=(L=k==null?void 0:k.sub_model)==null?void 0:L.ecus[v])==null?void 0:f.name)})})}),e.jsx("div",{style:{height:"60vh",overflow:"auto"},children:e.jsx(n,{sx:{mt:"20px"},children:a.filter(j=>j.checked).map((j,P)=>e.jsxs(n,{sx:{border:"1px solid grey",display:"flex",mx:"30px",mb:"10px",borderRadius:"5px",padding:"15px",color:u.grey[400]},children:[e.jsx(n,{sx:{width:"95%"},children:j.label}),e.jsxs(n,{children:[" ",j&&(j==null?void 0:j.dataByte)&&j.dataByte,j.pi_code_variable[0].unit]})]}))})}),e.jsx(n,{children:e.jsx(n,{sx:{display:"flex",mt:"20px",mx:"20px"},children:e.jsx(n,{children:e.jsx(re,{variant:"contained",sx:{background:"#8DA6C6"},onClick:R,children:"Refresh"})})})})]})]})},ga=()=>{var K,q,se,ie;const t=de(),{vehicleList:s}=N(W=>W.liveMap),{selectedVehicle:r}=N(W=>W.diagnostics);let a=JSON.parse(localStorage.getItem("w_userDetails"));const i={headers:{"Content-Type":"application/json",Authorization:`JWT ${(K=a==null?void 0:a.token)==null?void 0:K.access}`}},{mode:E}=N(W=>W.dashboard),l=ae(E),{selectedFlashingFile:u,ecuFotaId:v,fotaFiles:o}=N(W=>W.diagnostics),[O,U]=h.useState(0),[k,b]=h.useState(0),[D,R]=h.useState(0),[C,S]=h.useState(""),[w,L]=h.useState(""),[f,j]=h.useState(!1),[P,m]=h.useState(!1),[I,d]=h.useState(!1),[F,p]=h.useState(!1),[_,T]=h.useState(),[c,x]=h.useState(),[y,A]=h.useState({created_at:"",updated_at:""}),[$,B]=h.useState({created_at:"",updated_at:""}),g=(s||[]).find(W=>{var Z;return((Z=W==null?void 0:W.imei[0])==null?void 0:Z.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var W,Z,V,Q,X,J,te,oe,ce;if(((W=Object.keys(g))==null?void 0:W.length)>0&&((V=(Z=g==null?void 0:g.sub_model)==null?void 0:Z.ecus)==null?void 0:V.length)>0){let Ce=(J=(X=(Q=g==null?void 0:g.sub_model)==null?void 0:Q.ecus[O])==null?void 0:X.pid_datasets[0])==null?void 0:J.id;t(it({pid:Ce}));let pe=(ce=(oe=(te=g==null?void 0:g.sub_model)==null?void 0:te.ecus[O])==null?void 0:oe.ecu[0])==null?void 0:ce.file;pe=(pe==null?void 0:pe.map(me=>({...me,label:me.sw_part_no})))||[],t(Ot(pe))}},[g]),h.useEffect(()=>{var W,Z,V,Q;if(r&&(r!=null&&r.imei)&&((W=g==null?void 0:g.sub_model)!=null&&W.ecus)&&((Z=g==null?void 0:g.sub_model)==null?void 0:Z.ecus.length)>0){let X=(Q=(V=g==null?void 0:g.sub_model)==null?void 0:V.ecus[O])==null?void 0:Q.id;Y(X)}},[r]),h.useEffect(()=>{},[u]);const Y=W=>{if(r&&(r!=null&&r.imei)){let Z={created_by:JSON.parse(localStorage.getItem("w_userDetails")).user_id,imei:r.imei,ecu:W};le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/latest/ecu-fota/",Z).then(Q=>{var oe,ce,Ce,pe,me,De,Ae,Oe,Ie,$e,Pe,Le,Fe,Be;let X=(oe=Q==null?void 0:Q.data)==null?void 0:oe.flashing_attempts,J=(ce=Q==null?void 0:Q.data)==null?void 0:ce.download_attempts;t(rt((Ce=Q==null?void 0:Q.data)==null?void 0:Ce.id)),t(nt((pe=Q==null?void 0:Q.data)==null?void 0:pe.server_sw));let te=(Ae=(De=(me=g.sub_model)==null?void 0:me.ecus[O])==null?void 0:De.ecu[0])==null?void 0:Ae.file;if(te&&te.length>0){let ze=te.find(Ye=>{var Ne;return Ye.sw_part_no===((Ne=Q==null?void 0:Q.data)==null?void 0:Ne.server_sw)});t(lt(ze))}J&&(J==null?void 0:J.length)>0&&(T(J[0].id),b(J[0].latest_percentage),S(J[0].status),A({created_at:Te(new Date((Oe=J[0])==null?void 0:Oe.created)).format("DD-MM-YYYY HH:mm:ss"),updated_at:Te(new Date((Ie=J[0])==null?void 0:Ie.modified)).format("DD-MM-YYYY HH:mm:ss")}),J[0].latest_percentage<100&&J[0].status!=="Completed"&&J[0].status!=="Aborted"&&(d(!0),m(!0),p(!1),j(!1))),X&&(X==null?void 0:X.length)>0&&(R(($e=X[0])==null?void 0:$e.latest_percentage),x((Pe=X[0])==null?void 0:Pe.id),L((Le=X[0])==null?void 0:Le.status),B({created_at:Te(new Date((Fe=X[0])==null?void 0:Fe.created)).format("DD-MM-YYYY HH:mm:ss"),updated_at:Te(new Date((Be=X[0])==null?void 0:Be.modified)).format("DD-MM-YYYY HH:mm:ss")}),X[0].latest_percentage<100&&X[0].status!=="Completed"&&X[0].status!=="Aborted"&&(d(!1),m(!1),p(!0),j(!0)))}).catch(Q=>{T(),x(),t(rt("")),b(0),R(0),t(nt("")),t(lt({})),d(!1),m(!1),p(!1),j(!1)})}};h.useEffect(()=>{const W=setInterval(()=>{I&&P&&le.get("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/ecufota/downloadattempt/list/?id="+_,i).then(V=>{var X,J,te,oe;const Q=parseInt(V.data.results[0].latest_percentage);b(Q),S(V.data.results[0].status),A({created_at:Te(new Date((X=V.data.results[0])==null?void 0:X.created)).format("DD-MM-YYYY HH:mm:ss"),updated_at:Te(new Date((J=V.data.results[0])==null?void 0:J.modified)).format("DD-MM-YYYY HH:mm:ss")}),(Q=="100"||V.data.results[0].status==="Completed"||V.data.results[0].status==="Aborted")&&(clearInterval(W),m(!1),d(!1),Y((oe=(te=g==null?void 0:g.sub_model)==null?void 0:te.ecus[O])==null?void 0:oe.id))}),F&&f&&le.get("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/ecufota/flashingattempt/list/?id="+c,i).then(V=>{var X,J;const Q=parseInt(V.data.results[0].latest_percentage);R(Q),L(V.data.results[0].status),(Q=="100"||V.data.results[0].status==="Completed"||V.data.results[0].status==="Aborted")&&(clearInterval(W),j(!1),Y((J=(X=g==null?void 0:g.sub_model)==null?void 0:X.ecus[O])==null?void 0:J.id))})},1e3);return()=>{clearInterval(W)}},[f,I,F,P,c,_]);const M=(W,Z)=>{var X,J,te,oe;U(Z);let V=(X=g==null?void 0:g.sub_model)==null?void 0:X.ecus[Z].id,Q=(oe=(te=(J=g.sub_model)==null?void 0:J.ecus[Z])==null?void 0:te.ecu[0])==null?void 0:oe.file;Q=(Q==null?void 0:Q.map(ce=>({...ce,label:ce.sw_part_no})))||[],t(Ot(Q)),Y(V)},H=()=>{var Z,V,Q;if(u&&!Object.keys(u).length>0)return G.error("Please select the flashing file");m(!P),S(""),d(!1),b(0),j(!1),console.log("selected file",u);let W={};if(W.current_ws="null",W.server_sw=u==null?void 0:u.sw_part_no,W.status="OPEN",W.ecu=(V=(Z=g==null?void 0:g.sub_model)==null?void 0:Z.ecus[O])==null?void 0:V.id,W.imei=r.imei,W.created_by=JSON.parse(localStorage.getItem("w_userDetails")).user_id,!P)try{le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/create_ecufota/",W,i).then(J=>{let te={};te.ecu_fota=J.data.id,t(rt(J.data.id)),te.latest_percentage="0",te.created_by=W.created_by,te.status="New",le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/create/ecufota/downloadattempt/",te,i).then(ce=>{d(!0),p(!1),T(ce.data.id)})}).catch(J=>{var te;if(m(!1),d(!1),((te=J==null?void 0:J.response)==null?void 0:te.status)===401)return console.log("Session expired, dispatching logout"),t(It()),G.error("Session Expired",{id:"clipboard"});J.message?G.error("Error occurred while downloading"):G.error("Internal server error")})}catch(X){if(m(!1),d(!1),((Q=X==null?void 0:X.response)==null?void 0:Q.status)===401)return console.log("Session expired, dispatching logout"),t(It()),G.error("Session Expired",{id:"clipboard"});X.message?G.error("Error occurred while downloading"):G.error("Internal server error")}},z=()=>{if(u&&!Object.keys(u).length>0)return G.error("Please select the flashing file");if(!v)return G.error("Fota id missing. Please download the file first");if(k!="100"&&C!=="Aborted")return G.error("Start the download operation before proceeding");m(!1),j(!f),p(!1),R(0);let W={};if(W.ecu_fota=v,W.latest_percentage="0",W.created_by=u.created_by,W.status="New",W.latest_response="OK",!f)try{le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/create/ecufota/flashingattempt/",W,i).then(V=>{d(!1),p(!0),x(V.data.id)}).catch(V=>{j(!1),p(!1),j(!f),V.message?G.error("error occurred while flashing"):G.error("Internal server error")})}catch{j(!1),p(!1),j(!f)}};return e.jsxs(n,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[e.jsx(n,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((q=Object.keys(g))==null?void 0:q.length)>0&&((se=g==null?void 0:g.sub_model)==null?void 0:se.ecus.length)>0&&((ie=g==null?void 0:g.sub_model)==null?void 0:ie.ecus.map((W,Z)=>e.jsx(n,{children:e.jsx(n,{variant:"contained",sx:{color:O===Z?"#333333":l.grey[400],mt:"20px",backgroundColor:O===Z?"#D5E1FE":l.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{M(W,Z)},children:e.jsx("b",{children:W.name})})})))}),e.jsx(n,{children:e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-evenly",mt:"15px"},children:[e.jsxs("div",{children:["ECU Fota id :",v," "]}),e.jsxs("div",{children:["Download Status:",C," "]}),e.jsxs("div",{children:["Flashing Status :",w," "]})]}),e.jsx(n,{sx:{mt:"50px",color:l.grey[400]},children:e.jsx("h2",{style:{textAlign:"center"},children:(P||"flashinBtn")&&"Start : Downloading"})}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-around"},children:[e.jsxs(n,{children:[e.jsx(n,{sx:{my:"50px",color:"white",textAlign:"center"},children:e.jsx(Gt,{type:"circle",percent:k,size:180,strokeColor:"#8DA6C6",trailColor:"#d1d1d1",format:()=>e.jsxs("div",{style:{color:l.grey[400]},children:[k,"%"]})})}),e.jsx(n,{sx:{textAlign:"center"},children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:H,children:P?"Stop Downloading":"Start Downloading"})}),e.jsxs(n,{sx:{textAlign:"left"},children:[e.jsxs("p",{children:["Start Time: ",y.created_at]}),e.jsxs("p",{children:["Last Updated Time: ",y.updated_at]})]})]}),e.jsxs(n,{children:[e.jsx(n,{sx:{my:"50px",textAlign:"center"},children:e.jsx(Gt,{type:"circle",percent:D,size:180,trailColor:"#d1d1d1",strokeColor:"#8DA6C6",format:()=>e.jsxs("div",{style:{color:l.grey[400]},children:[D,"%"]})})}),e.jsx(n,{sx:{textAlign:"center"},children:e.jsxs(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:z,disabled:I,children:[" ",f?"Stop Flashing...":"Start Flashing"]})}),e.jsxs(n,{sx:{textAlign:"left"},children:[e.jsxs("p",{children:["Start Time: ",$.created_at]}),e.jsxs("p",{children:["Last Updated Time: ",$.updated_at]})]})]})]})]})})]})},fa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALySURBVHgB7Zi/bxJhGMefOw6O6a4LnUpjUjrVoa1TnWwX6yKd7CIYE3VRE1EX/gIGNTFRFzVpog6CS3GxLoILdKk6wGSHJjDBAkxQNPh+X3sEz+NAkub10veTXODe97n3eb7Pj2uDQoxUKnVK8/u3iJRFdjtF/zk96m3/7HYTyWTyQPkdfOAreSBwG40f3cMl1acFHpP3ggdTml/fUhWFouRZeosqeZsprwsgKUA0UoBopADRSAGikQJEIwWI5uQK0HX9WO3HZSIBpxcW6Patm2QYxlj29+/dpTPLy3QcaKMMkLn5SIR/bzabVKlW+3vToRCZTESz1aIWuyKROQrqQWp32lSr1fmaBcSGZ2ao0+lQrV7nz7bZd8sGe1jHvpvPfxYQj12mYDDIA9L1AL16/aa/t7a2yj9zuTx3fGF9nTlskWka1G63uS3Wwfx8hGZnw+ycGm1n39PGRpRKpTIVikWehM3NS5ROZ3iwgz7xG0Q6824yATjYNE36sPORyuXyX/tvmcPBLD95+ox/Tk+HWBAxmg2H6fv+Pl/b2/vCgx1FCFVlPrNMpPWsG64C0BqVSpVl9jwr6RwVCkVeZifQIuhzZBplB4EJBrd11I7R6MV+hQaTZGfkEKczGV5ywzApHo/xXnXi7MoKD/4Ta6dCcfePPauN7Di9mWD7/MVL2mFVR8tdYT7d3mAjBSDgSqVCuXye36M3m9bghWd45nHBCR9Q1uO47EHBFoOLC2BWrDWDtcygKPgssZZF6+LeesaJkTOA4bJAO9XqNe4cQWJoAYa4uFukjWiUbly/1rc/PMo8+n919RyvINoBGc7lc9wea5ZIYDj4dHsLKQ8ePuqRC8iAVUJ7L1p/B+yvSydb65xxznDzaWfkaxSZGdbDTocPczjsHCd7N5925D9zopECRCMFiEYKEI0UIBopQDRSgGggoEEehglQvpFH6fUoq2o+5Sp5sAqKojT8mnpHTSQSB5pPXYIa8gAInMX62acqS4j9F+WkUOZ/3jqMAAAAAElFTkSuQmCC";var bt={},ma=ge;Object.defineProperty(bt,"__esModule",{value:!0});var as=bt.default=void 0,ba=ma(fe()),ya=e;as=bt.default=(0,ba.default)((0,ya.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh");const Ca=()=>{N(b=>b.liveMap);const{terminalAppLogs:t,loading:s,selectedVehicle:r}=N(b=>b.diagnostics),{mode:a}=N(b=>b.dashboard),i=ae(!a),E=[5,2,4],l=de(),[u,v]=h.useState(5),[o,O]=h.useState();h.useEffect(()=>{Object.keys(r).length>0&&l(ue({imei:`${r==null?void 0:r.imei}`,commands:"{500a0047568afe56214e238000ffc3}",tranCmd:"500a0047568afe56214e238000ffc3"}))},[r]);const U=()=>{if(!o)return G.error("Please enter value");let b=o.split(","),D,R=!1;if(b=b.map(C=>{if((C==null?void 0:C.length)%2!==0){R=!0,G.error("The Tx Frame format is not right. Must be even length.");return}return D=ee(u,C,"00"),D}),!R)if(Object.keys(r).length>0){let C={imei:r.imei,commands:`{${b}}`,tranCmd:b};l(ue(C))}else G.error("Please Select Vehicle",{id:"clipBoard"})},k=()=>{G.success("Copied to clipboard!");let b=[];b=t.map(R=>R.timestamp+" "+R.log);const D=document.createElement("textarea");D.value=b.length===0?" ":b.join(`
`),document.body.appendChild(D),D.select(),document.execCommand("copy"),document.body.removeChild(D)};return e.jsxs(n,{children:[s&&e.jsx(we,{}),e.jsxs(n,{children:[e.jsxs(n,{children:[e.jsx(n,{sx:{display:"flex",justifyContent:"space-around"},children:E.map((b,D)=>e.jsxs("button",{style:{textAlign:"center",padding:"10px 20px",borderRadius:"5px",cursor:"pointer",width:"165px",margin:"20px",border:"1px solid #8DA6C6",backgroundColor:b===u?"#8DA6C6":"white",color:b===u?"white":"#8DA6C6"},onClick:R=>{v(b)},children:[b,"0"]}))}),e.jsxs(n,{sx:{display:"flex"},children:[e.jsx(Yt,{name:"txFrame",type:"text",value:o,style:{width:"75%",height:"45px",border:"1px solid #8DA6C6",borderRadius:5,background:"#8DA6C6",color:"white",marginLeft:"9%"},pattern:"[A-Fa-f0-9,]+",onChange:b=>O(b.target.value),placeholder:"ENTER VALUE",className:"white-placeholder"}),e.jsx(Vs,{onClick:U,style:{margin:"5px"},children:"Send"}),e.jsx("img",{src:fa,style:{height:"44px",marginLeft:"15px",cursor:"pointer"}})]})]}),e.jsxs(n,{style:{background:i.grey[100],width:"90%",minHeight:"68vh",borderRadius:"2px",display:"flex",justifyContent:"space-between",flexDirection:"row",margin:"30px 60px",overflowY:"auto",color:i.grey[400]},children:[t&&e.jsx("div",{style:{textTransform:"uppercase",fontSize:"12px",padding:"20px"},children:t.map(b=>e.jsxs("p",{style:{display:"flex"},children:[e.jsx("span",{style:{marginLeft:"5px"},children:b.timestamp}),e.jsx("span",{style:{height:"15px",width:"15px",backgroundColor:b.color,borderRadius:"50%",marginLeft:"5px"}}),e.jsx("span",{style:{marginLeft:"5px"},children:b.log})]}))}),e.jsxs(n,{style:{display:"flex",justifyContent:"flex-end",padding:"20px",gap:"10px"},children:[e.jsx(as,{style:{cursor:"pointer"},onClick:()=>l(Ss())}),e.jsx(Js,{style:{cursor:"pointer"},onClick:()=>k()})]})]})]})]})};let Me={Sanitas_BOSCH_BS6_PROD:"01",Sanitas_ADVANTEK_BS6_PROD:"02",Sanitas_ADVANTEK_BS4_PROD:"03",KOEL_BOSCH_BS4:"04",FLASH_KOEL_BOSCH_F6_CPCB4:"05",GREAVES_BOSCH_BS6_PROD:"02",ATUL_ADVANTEK_BS6_A46:"04",TVS_ADVANTEK_BS6_A46:"05",GREAVES_SEDEMAC_BL_BS6:"07",GREAVES_SEDEMAC_APP_BS6:"08",SEEDKEYALGO_VECV_BOSCH_BS6_01:"11",KOEL_AUTO_BS4:"12",KOEL_CPCB4_LOW_HP_ECU:"13",KOEL_CPCB4_HIGH_HP_ECU:"14",KOEL_CPCB4_MID_HP_ECU:"15",TATA_DNOX:"31"},He=t=>{let s="";return t==="SML_BOSCH_BS6_PROD"||t==="KOEL_BOSCH_BS4"?s="08":t==="SEEDKEYALGO_VECV_DELPHI_BS6"||t==="SEEDKEYALGO_VECV_AMT_BS6"?s="04":t==="SEEDKEYALGO_VECV_DELPHI_TCIC"?s="02":t==="GREAVES_BOSCH_BS6_PROD"||t==="GREAVES_BOSCH_BS6_DEV"?s="04":t==="Sanitas_BOSCH_BS6_PROD"||t==="KOEL_BOSCH_BS4"?s="08":t==="SEEDKEYALGO_VECV_DELPHI_BS6"||t==="SEEDKEYALGO_VECV_AMT_BS6"?s="04":t==="SEEDKEYALGO_VECV_DELPHI_TCIC"||t==="SEEDKEYALGO_VECV_DELPHI_TCIC"?s="02":t==="GREAVES_BOSCH_BS6_PROD"||t==="GREAVES_BOSCH_BS6_DEV"?s="04":s="16",s};const _a=()=>{var d,F,p;const t=de(),{vehicleList:s}=N(_=>_.liveMap),{selectedVehicle:r}=N(_=>_.diagnostics),{mode:a}=N(_=>_.dashboard),i=ae(a),{activeWriteParameter:E,selectedWriteParam:l,loading:u,isDtcLoader:v}=N(_=>_.diagnostics),[o,O]=h.useState(0),[U,k]=h.useState(null),[b,D]=h.useState(null),[R,C]=h.useState("");let S;const w=(s||[]).find(_=>{var T;return((T=_==null?void 0:_.imei[0])==null?void 0:T.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var _,T,c,x,y,A;if(((_=Object.keys(w))==null?void 0:_.length)>0&&((c=(T=w==null?void 0:w.sub_model)==null?void 0:T.ecus)==null?void 0:c.length)>0){let $=(A=(y=(x=w==null?void 0:w.sub_model)==null?void 0:x.ecus[o])==null?void 0:y.pid_datasets[0])==null?void 0:A.id;t($t({pid:$}))}},[]);const L={padding:"10px 10px",width:"28.5vw",borderRadius:"5px",border:"1px solid grey",backgroundColor:"white",color:"black"},f=(_,T)=>{var Y,M;O(T);let c=(M=(Y=w==null?void 0:w.sub_model)==null?void 0:Y.ecus[T].pid_datasets[0])==null?void 0:M.id;t($t({pid:c}));const{tx_header:x,rx_header:y,protocol:A}=_,$=`02${A.autopeepal},04${x},06${y}`;switch(w.sub_model.ecus[T].read_dtc_fn_index.value.split("_")[0]){case"GENERICOBD":{const H=ee("4","03","00"),z=ee("4","07","00");G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:H})),G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:z}));let K={imei:r.imei,commands:`{${H}, ${z}}`,tranCmd:`{${H}, ${z}}`};t(ue(K));break}case"UDS":{$||G.error("Please click again");let H,z=$.split(","),K=z==null?void 0:z.map(q=>{if((z==null?void 0:z.length)%2===0){G.error("The Tx Frame format is not right. Must be odd length.");return}return H=ee("2",q,"00"),H});if(K){G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:K}));let q={imei:r.imei,commands:`{${K}}`,tranCmd:K};t(ue(q))}break}case"KWP":{const H=ee("4","1800AF","00");G.success(e.jsx("span",{style:{wordBreak:"break-all"},children:H}));let z={imei:r.imei,commands:`{${H}}`,tranCmd:`{${H}}`};t(ue(z));break}}};function j(_,T){if(_.length>=T)return _;{const c=T-_.length;return"0".repeat(c)+_}}function P(_,T,c){return c<0?T+_:c>=_.length?_+T:(_.slice(c,c+T.length),_.slice(0,c)+T+_.slice(c+T.length))}const m=async()=>{var g,Y,M,H,z,K,q,se,ie,W,Z,V,Q,X,J,te,oe,ce,Ce,pe,me,De,Ae,Oe,Ie,$e,Pe,Le,Fe,Be,ze,Ye,Ne,yt,Ct,_t,vt,jt,St;if(Object.keys(l).length===0)return G.error("Please select a write parameter");if(!U)return G.error("Please enter a write value");t(ne(!0));let _="",T,c,x=l==null?void 0:l.pi_code_variable[0];console.log("element",x.message_type);let y=oa(parseInt(U)),A=j(String(y),((g=l==null?void 0:l.pi_code_variable[0])==null?void 0:g.length)*2),$=0;((Y=l==null?void 0:l.pi_code_variable[0])==null?void 0:Y.byte_position)===1?$=0:((M=l==null?void 0:l.pi_code_variable[0])==null?void 0:M.byte_position)===2?$=2:$=((H=l==null?void 0:l.pi_code_variable[0])==null?void 0:H.byte_position)*2,S=P(_,A,$),S=`2E${l==null?void 0:l.write_pid}${S}`,S=ee(4,S,"00");const B=w.sub_model.ecus;((K=(z=w.sub_model.ecus[o])==null?void 0:z.write_data_fn_index)==null?void 0:K.value)==="UDS_DS1003_SK090A"?(c=ee(4,"1003","00"),T=`32${Me[(se=(q=B[o])==null?void 0:q.seedkeyalgo_fn_index)==null?void 0:se.value]}${He((W=(ie=B[0])==null?void 0:ie.seedkeyalgo_fn_index)==null?void 0:W.value)}02270902270A`):((V=(Z=w.sub_model.ecus[o])==null?void 0:Z.write_data_fn_index)==null?void 0:V.value)==="UDS_DS1003_SK0102"?(c=ee(4,"1003","00"),T=`32${Me[(X=(Q=B[o])==null?void 0:Q.seedkeyalgo_fn_index)==null?void 0:X.value]}${He((te=(J=B[0])==null?void 0:J.seedkeyalgo_fn_index)==null?void 0:te.value)}022701022702`):((ce=(oe=w.sub_model.ecus[o])==null?void 0:oe.write_data_fn_index)==null?void 0:ce.value)==="UDS_DS1003_SK0B0C"?(c=ee(4,"1003","00"),T=`32${Me[(pe=(Ce=B[o])==null?void 0:Ce.seedkeyalgo_fn_index)==null?void 0:pe.value]}${He((De=(me=B[0])==null?void 0:me.seedkeyalgo_fn_index)==null?void 0:De.value)}02270B02270C`):((Oe=(Ae=w.sub_model.ecus[o])==null?void 0:Ae.write_data_fn_index)==null?void 0:Oe.value)==="UDS_DS1003_SK0304"?(c=ee(4,"1003","00"),T=`32${Me[($e=(Ie=B[o])==null?void 0:Ie.seedkeyalgo_fn_index)==null?void 0:$e.value]}${He((Le=(Pe=B[0])==null?void 0:Pe.seedkeyalgo_fn_index)==null?void 0:Le.value)}022703022704`):((Be=(Fe=w.sub_model.ecus[o])==null?void 0:Fe.write_data_fn_index)==null?void 0:Be.value)==="UDS_DS1003_SK0506"&&(c=ee(4,"1003","00"),T=`32${Me[(Ye=(ze=B[o])==null?void 0:ze.seedkeyalgo_fn_index)==null?void 0:Ye.value]}${He((yt=(Ne=B[0])==null?void 0:Ne.seedkeyalgo_fn_index)==null?void 0:yt.value)}022703022704`),T=ee(2,T,"00");try{const xe=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:r.imei,commands:`{${c},${T},${S}}`});if((Ct=xe==null?void 0:xe.data)!=null&&Ct.success){t(ne(!1));let Sa=xe.data.commands[0],Re="",Ea=0,st="";((vt=(_t=xe==null?void 0:xe.data)==null?void 0:_t.commands)==null?void 0:vt.length)>0&&((St=(jt=xe==null?void 0:xe.data)==null?void 0:jt.commands)==null||St.map(Ke=>{let Et=Ke.slice(6),kt=Et.slice(0,2);if(Ke.slice(0,2)==="40"&&(kt==="7f"?(st=zt(Et.slice(4,6)),Re="Negative Response"):kt==="ff"&&(Re="No response from ecu")),Ke.slice(0,2)==="20"){let wt=Ke.slice(6);wt.slice(0,2)==="01"&&(st=zt(wt.slice(4,6)),Re="Negative Response")}})),Re?(D(`${Re} ${st}`),G.error(Re)):(D("Positive response from ecu"),G.success("Positive response from ecu"))}}catch{t(ne(!1))}},I=async()=>{var c,x,y;t(ne(!0));let _=ee(4,l.code,"00"),T="";try{const A=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:r.imei,commands:`{${_}}`});if((c=A==null?void 0:A.data)!=null&&c.success){t(ne(!1)),T=(x=A==null?void 0:A.data)==null?void 0:x.commands[0];const $=ss(T);if(console.log("cmd val",$),!$.startsWith("62")){G.error(`Negative response from ecu for ${B==null?void 0:B.short_name}`);return}let B=l==null?void 0:l.pi_code_variable[0],g=l;const{byte_position:Y,length:M,resolution:H,offset:z,message_type:K}=B;let q=$==null?void 0:$.toLowerCase().replace((y=l==null?void 0:l.code)==null?void 0:y.toLowerCase().slice(2),"").slice(2);console.log("Decoded Data:",q);let se;switch(K){case"CONTINUOUS":se=Ze(q)*H+z;break;case"ASCII":se=Ve(q);break;case"eNUM":case"bcd-hex":se=q;break;default:return}C(se)}}catch{t(ne(!1))}};return e.jsxs(n,{sx:{border:"1px solid #dee0e3",height:"80vh",borderRadius:"5px",margin:"10px 20px"},children:[(u||v)&&e.jsx(we,{}),e.jsx(n,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((d=Object.keys(w))==null?void 0:d.length)>0&&((F=w==null?void 0:w.sub_model)==null?void 0:F.ecus.length)>0&&((p=w==null?void 0:w.sub_model)==null?void 0:p.ecus.map((_,T)=>e.jsx(n,{children:e.jsx(n,{variant:"contained",sx:{color:o===T?"#333333":i.grey[400],mt:"20px",backgroundColor:o===T?"#D5E1FE":i.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{f(_,T)},children:e.jsx("b",{children:_==null?void 0:_.name})})})))}),e.jsxs(n,{children:[e.jsx(n,{sx:{ml:"30px",my:"65px",color:i.grey[400],textAlign:"center",fontSize:"25px"},children:e.jsx("span",{children:e.jsx("b",{children:E||"Please select the parameter"})})}),e.jsx(n,{sx:{ml:"30px",color:E?"red":"green",textAlign:"center",fontSize:"15px"},children:e.jsx("span",{children:b})}),e.jsxs(n,{sx:{display:"flex",m:"20px",color:i.grey[400]},children:[e.jsxs(n,{children:[e.jsx("div",{style:{marginBottom:"5px"},children:e.jsx("b",{children:"Current value"})}),e.jsx("input",{style:L,value:R,disabled:!0}),e.jsx(n,{children:e.jsx(re,{variant:"contained",sx:{m:"10px",backgroundColor:"#8DA6C6"},onClick:I,children:"Read Here"})})]}),e.jsx(n,{sx:{m:"20px",color:i.grey[400]},children:e.jsx("div",{style:{marginTop:"5px"},children:e.jsx("b",{children:"UNIT"})})}),e.jsxs(n,{children:[e.jsx("div",{style:{marginBottom:"5px"},children:e.jsx("b",{children:"Write value"})}),e.jsx("input",{style:L,placeholder:"Enter here",value:U,onChange:_=>k(_.target.value)})]})]}),e.jsx(n,{children:e.jsx(n,{sx:{display:"flex",justifyContent:"center",mt:"30px"},children:e.jsx(n,{children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:m,children:"Submit"})})})})]})]})},ot=()=>{var U,k,b;const{mode:t}=N(D=>D.dashboard),s=ae(t),r=de(),{vehicleList:a}=N(D=>D.liveMap),{selectedVehicle:i}=N(D=>D.diagnostics),{ecuInfo:E,loading:l}=N(D=>D.diagnostics),[u,v]=h.useState(0),o=(a||[]).find(D=>{var R;return((R=D==null?void 0:D.imei[0])==null?void 0:R.mac_id)===(i==null?void 0:i.imei)})||{};h.useEffect(()=>{var D,R,C,S,w,L;if(((D=Object.keys(o))==null?void 0:D.length)>0&&((C=(R=o==null?void 0:o.sub_model)==null?void 0:R.ecus)==null?void 0:C.length)>0){let f=(L=(w=(S=o==null?void 0:o.sub_model)==null?void 0:S.ecus[0])==null?void 0:w.pid_datasets[0])==null?void 0:L.id;r(it({pid:f}))}},[]);const O=(D,R)=>{var S,w;v(R);let C=(w=(S=o==null?void 0:o.sub_model)==null?void 0:S.ecus[R].pid_datasets[0])==null?void 0:w.id;r(it({pid:C}))};return e.jsxs(n,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[l&&e.jsx(we,{}),e.jsx(n,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((U=Object.keys(o))==null?void 0:U.length)>0&&((k=o==null?void 0:o.sub_model)==null?void 0:k.ecus.length)>0&&((b=o==null?void 0:o.sub_model)==null?void 0:b.ecus.map((D,R)=>e.jsx(n,{children:e.jsx(n,{variant:"contained",sx:{color:u===R?"#333333":s.grey[400],mt:"20px",backgroundColor:u===R?"#D5E1FE":s.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{O(D,R)},children:e.jsx("b",{children:D.name})})})))}),e.jsx(n,{sx:{color:s.grey[400]},children:E&&(E==null?void 0:E.length)>0&&E.map((D,R)=>e.jsxs(n,{sx:{border:"1px solid grey",display:"flex",m:"30px",borderRadius:"5px",padding:"15px"},children:[e.jsx(n,{sx:{width:"95%"},children:D.label}),e.jsx(n,{children:D.pi_code_variable[0].unit})]}))})]})},va=()=>{var R,C,S,w,L;const t=de(),{vehicleList:s}=N(f=>f.liveMap),{selectedVehicle:r}=N(f=>f.diagnostics),{j1939Parameters:a,liveParameters:i,loading:E,isDtcLoader:l}=N(f=>f.diagnostics),{mode:u}=N(f=>f.dashboard),v=ae(u),[o,O]=h.useState(0),[U,k]=h.useState(!1),b=(s||[]).find(f=>{var j;return((j=f==null?void 0:f.imei[0])==null?void 0:j.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var f,j,P,m,I,d;if(((f=Object.keys(b))==null?void 0:f.length)>0&&((P=(j=b==null?void 0:b.sub_model)==null?void 0:j.ecus)==null?void 0:P.length)>0){let F=(d=(I=(m=b==null?void 0:b.sub_model)==null?void 0:m.ecus[o])==null?void 0:I.j1939_datasets[0])==null?void 0:d.id;t(Pt({pid:F}))}},[]);const D=(f,j)=>{var m,I;O(j);let P=(I=(m=b==null?void 0:b.sub_model)==null?void 0:m.ecus[j].j1939_datasets[0])==null?void 0:I.id;t(Pt({pid:P}))};return console.log("ecus",b),e.jsxs(n,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[(E||l||U)&&e.jsx(we,{}),e.jsx(n,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((R=Object.keys(b))==null?void 0:R.length)>0&&((C=b==null?void 0:b.sub_model)==null?void 0:C.ecus.length)>0&&((S=b==null?void 0:b.sub_model)==null?void 0:S.ecus.map((f,j)=>e.jsx(n,{children:e.jsx(n,{variant:"contained",sx:{color:o===j?"#333333":v.grey[400],mt:"20px",backgroundColor:o===j?"#D5E1FE":v.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{D(f,j)},children:e.jsx("b",{children:f.name})},f.id)})))}),e.jsxs(n,{children:[e.jsx(n,{sx:{ml:"30px",mt:"20px",color:v.grey[400]},children:e.jsx("span",{children:e.jsx("b",{children:o!==null&&((L=(w=b==null?void 0:b.sub_model)==null?void 0:w.ecus[o])==null?void 0:L.name)})})}),e.jsx("div",{style:{height:"60vh",overflow:"auto"},children:e.jsx(n,{sx:{mt:"20px"},children:a.filter(f=>f.checked).map((f,j)=>e.jsxs(n,{sx:{border:"1px solid grey",display:"flex",mx:"30px",mb:"10px",borderRadius:"5px",padding:"15px",color:v.grey[400]},children:[e.jsx(n,{sx:{width:"95%"},children:f.label}),e.jsxs(n,{children:[" ",f&&(f==null?void 0:f.dataByte)&&f.dataByte,f.spn[0].unit]})]}))})}),e.jsx(n,{children:e.jsx(n,{sx:{display:"flex",mt:"20px",mx:"20px"}})})]})]})};let ja=["RetroFotax","Sinocastel"];const Za=()=>{const t=de(),{isTerminal:s,isReadDtc:r,isLiveParameter:a,isWriteParameter:i,isActuator:E,isRoutineTest:l,isEcuInfo:u,isFlashing:v,selectedVehicle:o,isJ1939:O}=N(d=>d.diagnostics),{w_customer_id:U}=N(d=>d.auth),{mode:k}=N(d=>d.dashboard),[b,D]=h.useState(!1);h.useState(!0);const[R,C]=h.useState(!1),[S,w]=h.useState([]),[L,f]=h.useState(null),j=ae(k);h.useEffect(()=>{P()},[]);const P=async()=>{try{const d=await t(Es({w_customer_id:U}));if(!Array.isArray(d.payload)){G.error("Unexpected data format");return}const F=d.payload.filter(p=>{var _;return Array.isArray(p.imei)&&((_=p.imei[0])==null?void 0:_.mac_id)}).map(p=>{var _,T;return{...p,id:p.id,label:p.registration_id,value:(_=p.imei[0])==null?void 0:_.mac_id,vehilce_type:p==null?void 0:p.segment,chassis_no:p==null?void 0:p.chassis_no,engine_no:p==null?void 0:p.engine_no,workShop:p==null?void 0:p.workshop,registration_id:p==null?void 0:p.registration_id,sell_date:p==null?void 0:p.sell_date,customer_name:p==null?void 0:p.customer_name,vehicle_model:(T=p==null?void 0:p.vehicle_model)==null?void 0:T.name,user:p==null?void 0:p.user,vehicle_group:p==null?void 0:p.vehicle_group}});w(F),t(ks(F))}catch(d){console.error("Error fetching vehicle data:",d),G.error("Error fetching vehicle data")}},m=d=>{var p,_;const F=(_=(p=d==null?void 0:d.imei)==null?void 0:p[0])==null?void 0:_.device_typ;f(F),t(ws({imei:d.value,reg_id:d.label})),t(Rs(d)),D(!1),C(!1)},I=()=>L==="RetroFotax"?e.jsxs(e.Fragment,{children:[E&&e.jsx(ot,{}),u&&e.jsx(ot,{}),s&&e.jsx(Ca,{}),r&&e.jsx(xa,{}),i&&e.jsx(_a,{}),a&&e.jsx(ha,{}),l&&e.jsx(ot,{}),v&&e.jsx(ga,{}),O&&e.jsx(va,{})]}):L==="Sinocastel"?e.jsxs(e.Fragment,{children:[s&&e.jsx(Zs,{}),r&&e.jsx(er,{}),a&&e.jsx(tr,{})]}):e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",color:"grey",height:"90%"},children:e.jsx("h1",{children:!Object.keys(o).length>0?"Please select a vehicle.":"Diagnostic not available for this device"})});return e.jsxs("div",{className:"app",children:[e.jsx(Gs,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(Or,{title:"Diagnostics",setShowVehicles:D,showParams:R,setShowParams:C,showVehicles:b}),e.jsxs(n,{sx:{display:"flex",background:"#F5F5F5"},children:[e.jsx(n,{sx:{width:"80%",background:j.grey[100]},children:I()}),e.jsxs(n,{sx:{width:"20%",backgroundColor:j.grey[100],height:"90vh"},children:[b&&e.jsx(Ir,{vehicleData:S.filter(d=>{var F;return ja.includes((F=d==null?void 0:d.imei[0])==null?void 0:F.device_typ)}),handleChange:m}),!b&&!R&&e.jsx($r,{options:ra.filter(d=>d.allowedDevice.includes(L)),handleChange:()=>{},dota:!0,trip:!0}),R&&e.jsx(na,{deviceType:L})]})]})]})]})};export{Za as default};
