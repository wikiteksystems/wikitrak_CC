import{j as s,G as U,y as F,z as P,b as d,I as N,aC as V,bb as Y,bc as J,ba as K,C as y,ae as Q,a_ as X,bw as Z,P as ee}from"./index-DEfr00rT.js";import{D as se,a as ae,b as te,c as ne}from"./DialogTitle-Dw6CYN19.js";import{D as oe,E as re,T as $}from"./Edit-C1xfO7zP.js";import{B as H}from"./CircularProgress-DGapviGJ.js";import{T as le,a as ie,b as ce,c as O,d as i,e as de}from"./TableRow-SdbKpByj.js";import{T as ue}from"./TablePagination-DtBdca_S.js";const pe=({open:o,onClose:n,onConfirm:l})=>s.jsxs(se,{open:o,onClose:n,children:[s.jsx(ae,{children:"Confirm Deletion"}),s.jsx(te,{children:s.jsxs(oe,{children:["Are you sure you want to delete this vehicle data?"," ",s.jsx("span",{style:{color:"red"},children:"This action cannot be undone."})]})}),s.jsxs(ne,{children:[s.jsx(U,{onClick:n,color:"primary",children:"Cancel"}),s.jsx(U,{onClick:l,color:"secondary",children:"Delete"})]})]}),he="https://cc.wikitrak.in/api-proxy/api/v1",be={display:"flex",alignItems:"left",justifyContent:"left",gap:"8px"},xe=({inspectionData:o,status:n})=>{const l=F(),{isUpdateInspection:_}=P(r=>r.inspection),[b,x]=d.useState(!1),u=()=>{const r=localStorage.getItem("role");V.includes(r)?(l(Y(!_)),l(J(o)),l(K(o))):y.error(`Sorry! Your role is ${r}. You're not allowed to add, edit or delete the vehicle`)},k=async()=>{console.log("Vehicle data deleting");try{await Q.delete(`${he}/vehicles/delete/${vehicleData.id}/`),y.success("Vehicle data deleted successfully!"),l(X())}catch(r){console.error("Error deleting vehicle data:",r),y.error("Failed to delete vehicle data. Please try again.")}x(!1)},p=()=>{x(!1)};return s.jsxs(H,{sx:be,children:[s.jsx(N,{onClick:u,color:"primary","aria-label":"edit record",disabled:(n==null?void 0:n.toLowerCase())==="rejected"||(n==null?void 0:n.toLowerCase())==="close",children:s.jsx(re,{})}),s.jsx(pe,{open:b,onClose:p,onConfirm:k})]})},ge=[{id:"BDID",label:"BDID"},{id:"User",label:"User"},{id:"SubmissionDate",label:"Submission Date"},{id:"WorkshopGroup",label:"Workshop Group"},{id:"Status",label:"Status"}],fe=({where:o})=>{P(e=>e.breakdown);const n=F(),{searchTerm:l,inspectionHistory:_}=P(e=>e.inspection),[b,x]=d.useState("asc"),[u,k]=d.useState("BDID"),[p,r]=d.useState(0),[g,M]=d.useState(5),[w,je]=d.useState({id:"",status:"",workshop:"",user:""});d.useEffect(()=>{n(Z({}))},[]);const G=e=>{x(u===e&&b==="asc"?"desc":"asc"),k(e)},W=(e,t)=>{r(t)},q=e=>{M(parseInt(e.target.value,10)),r(0)},S=((e,t,h)=>e.filter(a=>{var I,L,v,B,m,A,E,R;const c=h.toLowerCase(),f=(L=(I=a==null?void 0:a.breakdown)==null?void 0:I.breakdown_id)==null?void 0:L.toLowerCase().includes(c),j=`${(B=(v=a==null?void 0:a.submitted_by)==null?void 0:v.us_user)==null?void 0:B.first_name} ${(A=(m=a==null?void 0:a.submitted_by)==null?void 0:m.us_user)==null?void 0:A.last_name}`.toLowerCase().includes(c),C=(E=a==null?void 0:a.status)==null?void 0:E.toLowerCase().includes(c),D=(R=a==null?void 0:a.workshop_group)==null?void 0:R.group_name.toLowerCase().includes(c);return!(h&&!(f||j||C||D)||t.id&&!a.breakdown_id.includes(t.id)||t.status&&a.status!==t.status||t.workshop&&a.workshop_group.group_name!==t.workshop||t.user&&!a.user.us_user.first_name.toLowerCase().includes(t.user.toLowerCase())&&!a.user.us_user.last_name.toLowerCase().includes(t.user.toLowerCase()))}))(_.slice(),w,l),z=S.slice(p*g,p*g+g),T={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"};return s.jsx(H,{sx:{m:o!=="inspection report"&&"10px",width:o==="inspection report"?"60%":"99%"},children:s.jsxs(ee,{children:[s.jsx(le,{sx:{height:o==="inspection report"?"50vh":"60vh",bgcolor:"white",borderRadius:"10px"},children:s.jsxs(ie,{stickyHeader:!0,children:[s.jsx(ce,{children:s.jsxs(O,{children:[ge.map(e=>s.jsx(i,{sx:T,children:s.jsx($,{active:u===e.id,direction:u===e.id?b:"asc",onClick:()=>G(e.id),children:e.label})},e.id)),o!=="inspection report"&&s.jsx(i,{sx:T,children:s.jsx($,{children:"Actions"})})]})}),s.jsx(de,{children:z.map((e,t)=>{var h,a,c,f,j,C,D;return s.jsxs(O,{children:[s.jsx(i,{children:((h=e==null?void 0:e.breakdown)==null?void 0:h.breakdown_id)||"N/A"}),s.jsx(i,{children:`${(c=(a=e==null?void 0:e.submitted_by)==null?void 0:a.us_user)==null?void 0:c.first_name} ${(j=(f=e==null?void 0:e.submitted_by)==null?void 0:f.us_user)==null?void 0:j.last_name}`}),s.jsx(i,{children:((C=e==null?void 0:e.breakdown)==null?void 0:C.submission_date)||"N/A"}),s.jsx(i,{children:(D=e==null?void 0:e.workshop_group)==null?void 0:D.group_name}),s.jsx(i,{sx:{color:e.status==="Open"?"blue":e.status==="Close"?"green":"red"},children:e.status}),o!=="inspection report"&&s.jsx(i,{children:s.jsx(xe,{inspectionData:e,status:e==null?void 0:e.status})})]},t)})})]})}),s.jsx(ue,{component:"div",count:S.length,page:p,onPageChange:W,rowsPerPage:g,onRowsPerPageChange:q,rowsPerPageOptions:[5,10,15]})]})})},Te=fe;export{Te as I};
