import{j as e,b as p,ax as G,y as T,x as K,B as O,a8 as y,J as v,z as g,T as Q,A as X,H as ee,C as R,a7 as le,D as te,aa as L}from"./index-BqPboWxx.js";import{S as se,R as re,t as ae}from"./SearchTab-BwUE7cJt.js";import{F as A,a as ne,B as f,C as oe}from"./menu2-DA9ICNjL.js";import{S as ie,M as m,T as ce}from"./TextField-CQFmxq9O.js";import{A as de}from"./Autocomplete-DJSMpKP4.js";function he({options:r,setOptions:o}){const i=x=>{o(x.target.value)};return e.jsx("div",{children:e.jsxs(A,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:[e.jsx(ne,{id:"demo-simple-select-standard-label",children:"Vehicle State Options"}),e.jsxs(ie,{labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard",value:r,onChange:i,label:"state-options",children:[e.jsx(m,{value:"",children:e.jsx("em",{children:"None"})}),e.jsx(m,{value:"offline",children:"Offline Vehicles"}),e.jsx(m,{value:"online",children:"Online Vehicles"}),e.jsx(m,{value:"running",children:"Running Vehicles"}),e.jsx(m,{value:"idling",children:"Idling Vehicles"})]})]})})}let ge="http://134.209.145.234/api/v1";function xe({state:r,setState:o}){const[i,x]=p.useState([]);p.useEffect(()=>{(async()=>{try{let{data:s}=await G.get(`${ge}/workshop/state/?country=1`);console.log("data: ",s),x((s==null?void 0:s.results)||[])}catch(s){console.error("Error while getting state data:",s)}})()},[]);const j=(t,s)=>{o((s==null?void 0:s.name)||""),console.log("Selected option:",s)};return e.jsx("div",{children:e.jsx(A,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:e.jsx(de,{options:i,getOptionLabel:t=>(t==null?void 0:t.name)||"",value:i.find(t=>(t==null?void 0:t.name)===r)||null,onChange:j,isOptionEqualToValue:(t,s)=>(t==null?void 0:t.name)===(s==null?void 0:s.name),renderInput:t=>e.jsx(ce,{...t,label:"State filter options",variant:"standard"})})})})}const ye=({vehicleData:r,title:o,setParameterData:i,loadingVehicle:x,setSearchedTerm:j,setOptions:t,setState:s,setRegion:I,searchTerm:E,region:S,state:M,options:B})=>{const{selectedVehicle:c,locationData:d,loading:F,onlineVehicle:ue}=T(l=>l.liveMap),{mode:W,showVehicles:N}=T(l=>l.dashboard),b=ae(W),u=p.useRef(null),C=p.useRef(0);let n=K();p.useEffect(()=>{u.current&&setTimeout(()=>{u.current.scrollTop=C.current},0)});const P=async l=>{var k,V;if(u.current&&(C.current=u.current.scrollTop),X(!N),(d==null?void 0:d.length)<=0)return v.error("Data not available for this vehicle",{id:"clipboard"});const a=d==null?void 0:d.filter(h=>h.latestDocument.imei===l.value);if(console.log("selected vehicle",a),(a==null?void 0:a.length)<=0)return v.error("Data not available for this vehicle",{id:"clipboard"});const{lat:D,lng:H}=((k=a==null?void 0:a[0])==null?void 0:k.latestDocument)??{},J={lat:D||L.lat,lng:H||L.lat};n(ee(J)),n(y(15)),n(R({imei:l.value,reg_id:l.label})),n(le(l.value));const U=l.label,Y=await n(te({w_registration_id:U})),_=[];let Z=0;(V=Y.payload)==null||V.map(h=>{h[h.parameter_type.toLowerCase()+"_parameter"].forEach(w=>{_.push({reg_id:l.label,imei:l.value,id:w.id,_id:h.id,key:Z++,label:h.parameter_type==="Telematic"&&w.short_name})})}),o==="Live Map"&&i(_)},$=()=>{n(y(5.8)),n(R({}))},q=l=>{I(l)},z={backgroundColor:b.grey[100],position:"relative",width:"100%",float:"right",height:"90vh",overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"};return e.jsx(e.Fragment,{children:e.jsx("div",{ref:u,style:z,children:F||x?e.jsx(f,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsx(se,{searchTerm:E,setSearchedTerm:j}),e.jsx(re,{region:S,handleRegion:q}),e.jsx(he,{options:B,setOptions:t}),e.jsx(xe,{state:M,setState:s}),o==="Live Map"&&e.jsx(f,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsxs(O,{variant:"outlined",onClick:()=>{if(Object.keys(c).length>0)$();else return n(y(5.8)),v.success("Already Selected To View All Vehicle Location.",{id:"already selected"})},sx:{width:"90%",bgcolor:Object.keys(c).length===0?g.bgColor:"undefined",color:Object.keys(c).length===0?"white":b.grey[400],border:`1px solid ${g.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:g.bgShadow}},children:["All Vehicles: ",r==null?void 0:r.length]})}),r.length>0?r.map((l,a)=>e.jsx(f,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(O,{disabled:l.label===c.reg_id,variant:"outlined",onClick:()=>{P(l)},sx:{width:"90%",bgcolor:l.label===c.reg_id?g.bgColor:"undefined",color:l.label===c.reg_id?"white":b.grey[400],border:`1px solid ${g.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:g.bgShadow}},children:l.label})},a)):e.jsx(f,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsxs(Q,{sx:{textAlign:"center",color:b.grey[400]},children:["Sorry! No vehicles in"," ",e.jsx("span",{style:{fontWeight:"bold"},children:S})," region"]})})]})})})};export{ye as V};
