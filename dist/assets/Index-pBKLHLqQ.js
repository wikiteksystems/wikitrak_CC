import{r as v,o as ft,i as vt,p as bt,_ as ct,a as C,j as e,q as K,c as lt,bL as Xt,bM as Qt,w as A,g as ht,bN as Z,bO as Zt,n as St,bP as Jt,bQ as Pt,bR as Mt,bS as Kt,bT as zt,bU as Et,a$ as wt,b0 as J,bV as ta,bW as aa,bX as it,bn as ot,aX as B,b4 as Vt,bY as ea,bZ as oa,T as q,bd as nt,bb as ra,b_ as sa,bG as Gt,b$ as na,c0 as ia,c1 as la,c2 as Dt,c3 as ca,c4 as da,c5 as kt,c6 as At,c7 as Wt,c8 as pa,c9 as ua,ca as ga,b9 as Tt,cb as xa,bm as fa,bx as va,by as ba,bB as ha,b8 as _t,br as ya,bt as Ca}from"./index-B9W9A0YN.js";import{L as ma}from"./LiveMapTopBar-qHPxFZ_f.js";import{V as ja}from"./VehicleMenu-CCajfBdm.js";import{T as $a}from"./TripMap-CIWHUaB1.js";import"./DateTimePicker-BNThd0qL.js";/* empty css           */import"./Autocomplete-XJJmeDcA.js";import"./EllipsisOutlined-ClQxNqqV.js";function Da(t){return v.Children.toArray(t).filter(a=>v.isValidElement(a))}function Ba(t){return vt("MuiButtonGroup",t)}const _=ft("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Ra=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],Pa=(t,a)=>{const{ownerState:o}=t;return[{[`& .${_.grouped}`]:a.grouped},{[`& .${_.grouped}`]:a[`grouped${A(o.orientation)}`]},{[`& .${_.grouped}`]:a[`grouped${A(o.variant)}`]},{[`& .${_.grouped}`]:a[`grouped${A(o.variant)}${A(o.orientation)}`]},{[`& .${_.grouped}`]:a[`grouped${A(o.variant)}${A(o.color)}`]},{[`& .${_.firstButton}`]:a.firstButton},{[`& .${_.lastButton}`]:a.lastButton},{[`& .${_.middleButton}`]:a.middleButton},a.root,a[o.variant],o.disableElevation===!0&&a.disableElevation,o.fullWidth&&a.fullWidth,o.orientation==="vertical"&&a.vertical]},Ma=t=>{const{classes:a,color:o,disabled:i,disableElevation:g,fullWidth:x,orientation:j,variant:c}=t,b={root:["root",c,j==="vertical"&&"vertical",x&&"fullWidth",g&&"disableElevation"],grouped:["grouped",`grouped${A(j)}`,`grouped${A(c)}`,`grouped${A(c)}${A(j)}`,`grouped${A(c)}${A(o)}`,i&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return ht(b,Ba,a)},ka=K("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Pa})(({theme:t,ownerState:a})=>C({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},a.variant==="contained"&&{boxShadow:(t.vars||t).shadows[2]},a.disableElevation&&{boxShadow:"none"},a.fullWidth&&{width:"100%"},a.orientation==="vertical"&&{flexDirection:"column"},{[`& .${_.grouped}`]:C({minWidth:40,"&:hover":C({},a.variant==="contained"&&{boxShadow:"none"})},a.variant==="contained"&&{boxShadow:"none"}),[`& .${_.firstButton},& .${_.middleButton}`]:C({},a.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},a.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},a.variant==="text"&&a.orientation==="horizontal"&&{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${_.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="text"&&a.orientation==="vertical"&&{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${_.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="text"&&a.color!=="inherit"&&{borderColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / 0.5)`:Z(t.palette[a.color].main,.5)},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"transparent"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"transparent"},a.variant==="contained"&&a.orientation==="horizontal"&&{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${_.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="contained"&&a.orientation==="vertical"&&{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${_.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},a.variant==="contained"&&a.color!=="inherit"&&{borderColor:(t.vars||t).palette[a.color].dark},{"&:hover":C({},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"currentColor"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${_.lastButton},& .${_.middleButton}`]:C({},a.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},a.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},a.variant==="outlined"&&a.orientation==="horizontal"&&{marginLeft:-1},a.variant==="outlined"&&a.orientation==="vertical"&&{marginTop:-1})})),Aa=v.forwardRef(function(a,o){const i=bt({props:a,name:"MuiButtonGroup"}),{children:g,className:x,color:j="primary",component:c="div",disabled:b=!1,disableElevation:u=!1,disableFocusRipple:N=!1,disableRipple:G=!1,fullWidth:I=!1,orientation:R="horizontal",size:d="medium",variant:z="outlined"}=i,L=ct(i,Ra),P=C({},i,{color:j,component:c,disabled:b,disableElevation:u,disableFocusRipple:N,disableRipple:G,fullWidth:I,orientation:R,size:d,variant:z}),$=Ma(P),T=v.useMemo(()=>({className:$.grouped,color:j,disabled:b,disableElevation:u,disableFocusRipple:N,disableRipple:G,fullWidth:I,size:d,variant:z}),[j,b,u,N,G,I,d,z,$.grouped]),f=Da(g),E=f.length,O=S=>{const M=S===0,h=S===E-1;return M&&h?"":M?$.firstButton:h?$.lastButton:$.middleButton};return e.jsx(ka,C({as:c,role:"group",className:lt($.root,x),ref:o,ownerState:P},L,{children:e.jsx(Xt.Provider,{value:T,children:f.map((S,M)=>e.jsx(Qt.Provider,{value:O(M),children:S},M))})}))});function Ta(t){return vt("MuiCardActions",t)}ft("MuiCardActions",["root","spacing"]);const _a=["disableSpacing","className"],Ia=t=>{const{classes:a,disableSpacing:o}=t;return ht({root:["root",!o&&"spacing"]},Ta,a)},La=K("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:o}=t;return[a.root,!o.disableSpacing&&a.spacing]}})(({ownerState:t})=>C({display:"flex",alignItems:"center",padding:8},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Na=v.forwardRef(function(a,o){const i=bt({props:a,name:"MuiCardActions"}),{disableSpacing:g=!1,className:x}=i,j=ct(i,_a),c=C({},i,{disableSpacing:g}),b=Ia(c);return e.jsx(La,C({className:lt(b.root,x),ownerState:c,ref:o},j))});function Oa(t){return vt("MuiPagination",t)}ft("MuiPagination",["root","ul","outlined","text"]);const Sa=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function za(t={}){const{boundaryCount:a=1,componentName:o="usePagination",count:i=1,defaultPage:g=1,disabled:x=!1,hideNextButton:j=!1,hidePrevButton:c=!1,onChange:b,page:u,showFirstButton:N=!1,showLastButton:G=!1,siblingCount:I=1}=t,R=ct(t,Sa),[d,z]=Zt({controlled:u,default:g,name:o,state:"page"}),L=(h,W)=>{u||z(W),b&&b(h,W)},P=(h,W)=>{const dt=W-h+1;return Array.from({length:dt},(yt,U)=>h+U)},$=P(1,Math.min(a,i)),T=P(Math.max(i-a+1,a+1),i),f=Math.max(Math.min(d-I,i-a-I*2-1),a+2),E=Math.min(Math.max(d+I,a+I*2+2),T.length>0?T[0]-2:i-1),O=[...N?["first"]:[],...c?[]:["previous"],...$,...f>a+2?["start-ellipsis"]:a+1<i-a?[a+1]:[],...P(f,E),...E<i-a-1?["end-ellipsis"]:i-a>a?[i-a]:[],...T,...j?[]:["next"],...G?["last"]:[]],S=h=>{switch(h){case"first":return 1;case"previous":return d-1;case"next":return d+1;case"last":return i;default:return null}},M=O.map(h=>typeof h=="number"?{onClick:W=>{L(W,h)},type:"page",page:h,selected:h===d,disabled:x,"aria-current":h===d?"true":void 0}:{onClick:W=>{L(W,S(h))},type:h,page:S(h),selected:!1,disabled:x||h.indexOf("ellipsis")===-1&&(h==="next"||h==="last"?d>=i:d<=1)});return C({items:M},R)}function Ea(t){return vt("MuiPaginationItem",t)}const Y=ft("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),It=St(e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),Lt=St(e.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),wa=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],Ft=(t,a)=>{const{ownerState:o}=t;return[a.root,a[o.variant],a[`size${A(o.size)}`],o.variant==="text"&&a[`text${A(o.color)}`],o.variant==="outlined"&&a[`outlined${A(o.color)}`],o.shape==="rounded"&&a.rounded,o.type==="page"&&a.page,(o.type==="start-ellipsis"||o.type==="end-ellipsis")&&a.ellipsis,(o.type==="previous"||o.type==="next")&&a.previousNext,(o.type==="first"||o.type==="last")&&a.firstLast]},Va=t=>{const{classes:a,color:o,disabled:i,selected:g,size:x,shape:j,type:c,variant:b}=t,u={root:["root",`size${A(x)}`,b,j,o!=="standard"&&`color${A(o)}`,o!=="standard"&&`${b}${A(o)}`,i&&"disabled",g&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[c]],icon:["icon"]};return ht(u,Ea,a)},Ga=K("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Ft})(({theme:t,ownerState:a})=>C({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,height:"auto",[`&.${Y.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},a.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)})),Wa=K(Kt,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Ft})(({theme:t,ownerState:a})=>C({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,[`&.${Y.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Y.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Y.selected}`]:{backgroundColor:(t.vars||t).palette.action.selected,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Z(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${Y.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Z(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},[`&.${Y.disabled}`]:{opacity:1,color:(t.vars||t).palette.action.disabled,backgroundColor:(t.vars||t).palette.action.selected}}},a.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)},a.shape==="rounded"&&{borderRadius:(t.vars||t).shape.borderRadius}),({theme:t,ownerState:a})=>C({},a.variant==="text"&&{[`&.${Y.selected}`]:C({},a.color!=="standard"&&{color:(t.vars||t).palette[a.color].contrastText,backgroundColor:(t.vars||t).palette[a.color].main,"&:hover":{backgroundColor:(t.vars||t).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[a.color].main}},[`&.${Y.focusVisible}`]:{backgroundColor:(t.vars||t).palette[a.color].dark}},{[`&.${Y.disabled}`]:{color:(t.vars||t).palette.action.disabled}})},a.variant==="outlined"&&{border:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${Y.selected}`]:C({},a.color!=="standard"&&{color:(t.vars||t).palette[a.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / 0.5)`:Z(t.palette[a.color].main,.5)}`,backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / ${t.vars.palette.action.activatedOpacity})`:Z(t.palette[a.color].main,t.palette.action.activatedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Z(t.palette[a.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Y.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[a.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Z(t.palette[a.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity)}},{[`&.${Y.disabled}`]:{borderColor:(t.vars||t).palette.action.disabledBackground,color:(t.vars||t).palette.action.disabled}})})),Fa=K("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(t,a)=>a.icon})(({theme:t,ownerState:a})=>C({fontSize:t.typography.pxToRem(20),margin:"0 -8px"},a.size==="small"&&{fontSize:t.typography.pxToRem(18)},a.size==="large"&&{fontSize:t.typography.pxToRem(22)})),Ya=v.forwardRef(function(a,o){const i=bt({props:a,name:"MuiPaginationItem"}),{className:g,color:x="standard",component:j,components:c={},disabled:b=!1,page:u,selected:N=!1,shape:G="circular",size:I="medium",slots:R={},type:d="page",variant:z="text"}=i,L=ct(i,wa),P=C({},i,{color:x,disabled:b,selected:N,shape:G,size:I,type:d,variant:z}),$=Jt(),T=Va(P),E=($?{previous:R.next||c.next||Lt,next:R.previous||c.previous||It,last:R.first||c.first||Mt,first:R.last||c.last||Pt}:{previous:R.previous||c.previous||It,next:R.next||c.next||Lt,first:R.first||c.first||Mt,last:R.last||c.last||Pt})[d];return d==="start-ellipsis"||d==="end-ellipsis"?e.jsx(Ga,{ref:o,ownerState:P,className:lt(T.root,g),children:"â€¦"}):e.jsxs(Wa,C({ref:o,ownerState:P,component:j,disabled:b,className:lt(T.root,g)},L,{children:[d==="page"&&u,E?e.jsx(Fa,{as:E,ownerState:P,className:T.icon}):null]}))}),Ua=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],qa=t=>{const{classes:a,variant:o}=t;return ht({root:["root",o],ul:["ul"]},Oa,a)},Ha=K("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:o}=t;return[a.root,a[o.variant]]}})({}),Xa=K("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(t,a)=>a.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Qa(t,a,o){return t==="page"?`${o?"":"Go to "}page ${a}`:`Go to ${t} page`}const Za=v.forwardRef(function(a,o){const i=bt({props:a,name:"MuiPagination"}),{boundaryCount:g=1,className:x,color:j="standard",count:c=1,defaultPage:b=1,disabled:u=!1,getItemAriaLabel:N=Qa,hideNextButton:G=!1,hidePrevButton:I=!1,renderItem:R=M=>e.jsx(Ya,C({},M)),shape:d="circular",showFirstButton:z=!1,showLastButton:L=!1,siblingCount:P=1,size:$="medium",variant:T="text"}=i,f=ct(i,Ua),{items:E}=za(C({},i,{componentName:"Pagination"})),O=C({},i,{boundaryCount:g,color:j,count:c,defaultPage:b,disabled:u,getItemAriaLabel:N,hideNextButton:G,hidePrevButton:I,renderItem:R,shape:d,showFirstButton:z,showLastButton:L,siblingCount:P,size:$,variant:T}),S=qa(O);return e.jsx(Ha,C({"aria-label":"pagination navigation",className:lt(S.root,x),ownerState:O,ref:o},f,{children:e.jsx(Xa,{className:S.ul,ownerState:O,children:E.map((M,h)=>e.jsx("li",{children:R(C({},M,{color:j,"aria-label":N(M.type,M.page,M.selected),shape:d,size:$,variant:T}))},h))})}))});var Bt={},Ja=zt;Object.defineProperty(Bt,"__esModule",{value:!0});var Yt=Bt.default=void 0,Ka=Ja(Et()),Nt=e;Yt=Bt.default=(0,Ka.default)([(0,Nt.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,Nt.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");var Rt={},te=zt;Object.defineProperty(Rt,"__esModule",{value:!0});var Ut=Rt.default=void 0,ae=te(Et()),Ot=e;Ut=Rt.default=(0,ae.default)([(0,Ot.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,Ot.jsx)("circle",{cx:"12",cy:"12",r:"5"},"1")],"RadioButtonCheckedOutlined");const ee="https://cc.wikitrak.in/proxy-3031",oe=()=>{var gt,l,m,w;const t=wt(),{tripList:a,selectedTripData:o,loading:i,trips:g,activeIndex:x,searchText:j,mode:c,isNavigate:b,allTripList:u,trip_payload:N,page:G,total_page:I,total_trips:R}=J(r=>r.dashboard),{selectedVehicle:d,vehicleList:z}=J(r=>r.liveMap),{parametersConfiguration:L}=J(r=>r.tripMonitor),P=Vt(c),[$,T]=v.useState(!1),[f,E]=v.useState({}),[O,S]=v.useState(""),[M,h]=v.useState(null);v.useEffect(()=>{(g==null?void 0:g.length)>0},[g]),v.useEffect(()=>{const r=dt(u);t(ta(r))},[u]),v.useEffect(()=>{!(o.length>0)&&b&&x!==null&&U.length>0&&W(U[x])},[o,b]);const W=async r=>{var y;let s={imei:d.imei,startDate:r.startDate,endDate:r.endDate};const n=await aa(s);((y=n==null?void 0:n.data)==null?void 0:y.documents.length)>0?(t(b(!1)),t(it(n.data.documents[0].data))):(t(b(!1)),t(it([])))},dt=r=>{const s=new Set,n=[];return r.forEach(y=>{const p=ot(y.startTime).format("YYYY-MM-DD");s.has(p)||(s.add(p),n.push(p))}),n},yt=(r,s)=>{t(Dt(null)),t(ca(r)),t(da(!1)),O===r?(S(""),h(null)):(S(r),h(s))},U=O===""?u:u.filter(r=>ot(r.startTime).format("YYYY-MM-DD")===O),pt=async(r,s)=>{if(t(it(s.data)),t(Dt(r)),t(kt(s.tripAcreage)),Array.isArray(s==null?void 0:s.data)||s.data.length>5){const n={startDate:s.data[0].createdAt,endDate:s.data[s.data.length-1].createdAt,imei:s.imei};rt(n)}},rt=async r=>{var s,n,y,p,D,F;try{const V=z.find(k=>{var at,et;return((et=(at=k==null?void 0:k.imei)==null?void 0:at[0])==null?void 0:et.mac_id)===(d==null?void 0:d.imei)});if(!V){console.warn("No matching vehicle found for IMEI:",d==null?void 0:d.imei);return}const tt=((F=(D=(p=(y=(n=(s=V==null?void 0:V.sub_model)==null?void 0:s.model_modelecu)==null?void 0:n[0])==null?void 0:y.ecu)==null?void 0:p.pid_datasets)==null?void 0:D[0])==null?void 0:F.codes)||[];if(!L||!L.length>0)return;const X=L.filter(k=>k.checked);console.log("Selected Parameters:",X);const st=X.filter(k=>k.pid).map(k=>k.pid.toLowerCase().padStart(4,"0").match(/../g).reverse().join(""));if(st.length===0){console.warn("No valid PIDs found to fetch data.");return}const xt={pids:st,startDate:r.startDate,endDate:r.endDate,imei:r.imei};console.log("item",r);const Q=(await pa.post(`${ee}/pid-data`,xt)).data;if(console.log("Raw Response:",Q),console.log("pidSet",tt),Q&&typeof Q=="object"&&Object.keys(Q).length>0){const k={};for(const[at,et]of Object.entries(Q))if(Array.isArray(et)&&et.length>0){const qt=et.map(Ht=>ua(Ht,at,tt));k[at]=qt}else k[at]=[];console.log("Decoded Data:",k),t(ga(k))}else console.warn("Empty or invalid response received.")}catch(V){console.error("Error fetching PID data:",V)}},ut=r=>{E(r),T(!0)},H=()=>{T(!1),E({})},Ct=(r,s)=>{t(ia(s));const n={...N,page:s,limit:20};t(la(n))},mt=r=>{if(jt(),!Array.isArray(r)||r.length===0)return;const s=r.filter(D=>Array.isArray(D==null?void 0:D.data)&&D.data.length>0);if(s.length===0)return;const n=s.reduce((D,F)=>D+(F.tripAcreage||0),0);console.log("Total acreage",n),t(it([])),t(Dt("all")),t(kt(n));const y=s[s.length-1],p={startDate:y.data[y.data.length-1].createdAt,endDate:s[0].data[0].createdAt,imei:s[0].imei};console.log("pidRequestData",p),rt(p)},jt=()=>{const r=[...L].map(s=>({...s,value:0}));t(Wt(r))};return e.jsxs(e.Fragment,{children:[e.jsxs(B,{children:[e.jsxs(B,{sx:{m:"10px"},children:[e.jsx(B,{sx:{color:P.grey[400]},children:"Select Date"}),e.jsx(B,{sx:{mt:1},children:e.jsx(ea,{})})]}),i?e.jsx("div",{style:{width:"100%",margin:"38%"},children:e.jsx(oa,{})}):e.jsxs(e.Fragment,{children:[e.jsx(B,{children:e.jsx(B,{sx:{display:"flex",overflowX:"auto",gap:"10px",paddingBottom:"5px"},children:u&&(u==null?void 0:u.length)>0?e.jsx(e.Fragment,{}):e.jsx(q,{sx:{width:"100%",mt:"50%",textAlign:"center"},children:"Sorry! No Trips Found"})})}),u&&(u==null?void 0:u.length)>0&&e.jsx(B,{ml:2,display:"flex",gap:1,sx:{width:"90%"},children:e.jsxs(Aa,{variant:"outlined","aria-label":"Loading button group",sx:{width:"100%",color:"black"},children:[e.jsx(nt,{sx:{width:"50%",color:"#333333",border:"1px solid #C0C0C0"},children:"Total Trips"}),e.jsx(nt,{sx:{width:"50%",color:"white",border:"1px solid #C0C0C0",backgroundColor:"#C0C0C0"},children:R})]})}),u&&(u==null?void 0:u.length)>0&&e.jsx(Za,{page:G,count:I,sx:{m:2,width:"90%"},onChange:Ct}),e.jsxs(B,{sx:{height:"75vh",width:"100%",overflowY:"auto"},children:[e.jsx(B,{display:"flex",gap:1,marginLeft:2,children:g.map((r,s)=>e.jsx(B,{children:e.jsx(nt,{onClick:()=>{yt(r,s)},style:{backgroundColor:M===s?P.grey[300]:" #D5D5D5",color:"black",height:"35px",fontWeight:700,fontSize:"12px",width:"90px",marginTop:"10px"},children:r})},s))}),U&&U.length>0&&e.jsx(nt,{variant:x==="all"?"contained":"outlined",sx:{width:"92%",m:"10px 15px",p:1,backgroundColor:x==="all"?ra.bgColor:"transparent"},onClick:()=>{mt(U)},children:"Select All trips"})," ",U&&U.length>0&&U.map((r,s)=>{var p,D,F,V;const n=(D=(p=r==null?void 0:r.startLocation)==null?void 0:p.address)==null?void 0:D.address,y=(V=(F=r==null?void 0:r.endLocation)==null?void 0:F.address)==null?void 0:V.address;return n&&`${n.town||n.city||""}`,y&&`${y.town||y.city||""}`,e.jsx(re,{trip:r,index:s,openModal:ut,handleTripData:pt,activeIndex:x})})]})]})]}),e.jsx(sa,{open:$,onClose:H,children:e.jsxs(Gt,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"40%",bgcolor:"background.paper",boxShadow:24,p:4},children:[e.jsxs(na,{children:[e.jsx(q,{variant:"h6",component:"div",children:"Trip Details"}),e.jsxs(q,{sx:{mt:2},children:[e.jsx("strong",{children:"Start Location:"})," ",((l=(gt=f==null?void 0:f.startLocation)==null?void 0:gt.address)==null?void 0:l.display_name)||"N/A"]}),e.jsxs(q,{sx:{mt:2},children:[e.jsx("strong",{children:"End Location:"})," ",((w=(m=f==null?void 0:f.endLocation)==null?void 0:m.address)==null?void 0:w.display_name)||"N/A"]}),e.jsxs(q,{sx:{mt:2},children:[e.jsx("strong",{children:"Start Time:"})," ",f!=null&&f.startTime?ot(new Date(f.startTime).toISOString()).format("MMMM Do YYYY, h:mm:ss A"):"N/A"]}),e.jsxs(q,{sx:{mt:2},children:[e.jsx("strong",{children:"End Time:"})," ",f!=null&&f.endTime?ot(new Date(f.endTime).toISOString()).format("MMMM Do YYYY, h:mm:ss A"):"N/A"]})]}),e.jsx(Na,{children:e.jsx(nt,{onClick:H,children:"Close"})})]})})]})},re=({trip:t,index:a,openModal:o,handleTripData:i,activeIndex:g})=>e.jsxs(Gt,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",m:2,px:1,py:1,borderRadius:2,border:"1px solid #DDDDDD",cursor:"pointer",backgroundColor:g===a?"#e8edea":"undefined"},onClick:()=>i(a,t),children:[e.jsxs(B,{sx:{width:40,textAlign:"center"},children:[e.jsx(q,{variant:"caption",color:"text.secondary",children:"Trip"}),e.jsx(q,{variant:"subtitle2",fontWeight:"bold",children:a+1})]}),e.jsx(At,{orientation:"vertical",flexItem:!0}),e.jsxs(B,{sx:{flex:1,mx:2},children:[e.jsxs(B,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(Ut,{sx:{color:"#BFBEBE"}}),e.jsx(B,{sx:{flex:1,borderTop:"1px dashed #DDDDDD",mx:1.5}}),e.jsx(Yt,{sx:{color:"red"}})]}),e.jsxs(B,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(q,{variant:"caption",children:t.startTime?ot(t.startTime).format("HH:mm:ss A"):"NA"}),e.jsx(q,{variant:"caption",children:t.startTime?ot(t.endTime).format("HH:mm:ss A"):"NA"})]})]}),e.jsx(At,{orientation:"vertical",flexItem:!0}),e.jsx(B,{children:e.jsx(q,{variant:"body2",color:"primary",sx:{cursor:"pointer",m:1},onClick:()=>o(t),children:"See More"})})]},t.id);function ge(){const{w_customer_id:t}=J(l=>l.auth),{collapsed:a}=J(l=>l.auth),{mode:o,selectedVehicleGroup:i}=J(l=>l.dashboard),{vehicleList:g,selectedVehicle:x,onlineVehicle:j,locationData:c}=J(l=>l.liveMap),[b,u]=v.useState(!1),[N,G]=v.useState(!0),[I,R]=v.useState([]),[d,z]=v.useState(!0),[L,P]=v.useState(""),[$,T]=v.useState(""),[f,E]=v.useState(""),[O,S]=v.useState(""),[M,h]=v.useState([]),[W,dt]=v.useState({lat:18.516726,lng:73.856255}),[yt,U]=v.useState([]),[pt,rt]=v.useState(!1),ut=Vt(o);let H=wt();v.useEffect(()=>{H(it([])),Ct()},[]),v.useEffect(()=>{var w,r,s;const l=Tt().subtract(5,"day").startOf("day").toISOString(),m=Tt().endOf("day").toISOString();H(xa({startDate:l,endDate:m})),Object.keys(x).length===0&&g.length>0&&H(fa({imei:(r=(w=g[0])==null?void 0:w.imei[0])==null?void 0:r.mac_id,reg_id:(s=g[0])==null?void 0:s.registration_id}))},[x,g]),v.useEffect(()=>{var l,m,w,r;if(console.log("seletect vehicle trip monitor",x,g),x&&(x!=null&&x.imei)&&g&&g.length>0){let s=g.find(n=>{var y;return Array.isArray(n.imei)?((y=n.imei[0])==null?void 0:y.mac_id)===x.imei:null});if(s&&Array.isArray(s.imei)&&((m=(l=s.imei[0])==null?void 0:l.device_typ)==null?void 0:m.toLowerCase())==="sinocastel"){let y=((r=(w=s==null?void 0:s.sub_model)==null?void 0:w.model_modelecu[0])==null?void 0:r.pid_code).map(p=>{var D,F,V,tt,X;return{label:(D=p==null?void 0:p.pi_code_variable[0])==null?void 0:D.short_name,value:0,checked:!1,key:(V=(F=p==null?void 0:p.pi_code_variable[0])==null?void 0:F.widget_types)==null?void 0:V.value,pid:p==null?void 0:p.code,decodeConfig:p,unit:(X=(tt=p==null?void 0:p.pi_code_variable)==null?void 0:tt[0])==null?void 0:X.unit}});H(Wt(y))}}},[x]);const Ct=async()=>{try{let l=[],m=[];const w=await H(va({w_customer_id:t}));if(Array.isArray(w.payload)){w.payload.forEach(n=>{var y,p,D;Array.isArray(n.imei)&&n.imei.length>0&&((y=n.imei[0])!=null&&y.mac_id)?(l.push({id:n.id,label:n.registration_id,value:(p=n.imei[0])==null?void 0:p.mac_id,workShop:n==null?void 0:n.workshop,vehicle_group:n==null?void 0:n.vehicle_group}),m.push((D=n.imei[0])==null?void 0:D.mac_id)):console.error("IMEI data not found for item:",n)});const r="one",s=m;m.length>0&&H(ba({type:r,imei:s})),H(ha({w_customer_id:t})),R(l)}else console.error("Unexpected data format:",w),_t.error("Unexpected data format:")}catch(l){console.error("Error fetching vehicle data:",l),_t.error(`Error fetching vehicle data: ${l}`)}},mt=l=>c==null?void 0:c.some(m=>String(m.latestDocument.imei)===String(l)&&m.latestDocument.speed>0&&(m.latestDocument.ignition===!0||m.latestDocument.ignition===1)),jt=l=>c==null?void 0:c.some(m=>String(m.latestDocument.imei)===String(l)&&m.latestDocument.speed<=0&&(m.latestDocument.ignition===!0||m.latestDocument.ignition===1)),gt=I.filter(l=>{var X,st,xt,$t,Q;if(!(Object.keys(i).length===0||l.vehicle_group===i.id))return!1;const w=(X=l==null?void 0:l.label)==null?void 0:X.toLowerCase().includes(L.toLowerCase()),r=O===""||((st=l==null?void 0:l.workShop)==null?void 0:st.region)===O,s=f===""||(($t=(xt=l==null?void 0:l.workShop)==null?void 0:xt.state)==null?void 0:$t.toLowerCase())===(((Q=f==null?void 0:f.toString())==null?void 0:Q.toLowerCase())||""),n=l.value,y=String(l.value).toLowerCase(),p=j.some(k=>String(k).toLowerCase()===y),D=!j.some(k=>String(k).toLowerCase()===y),F=p&&mt(n),V=p&&jt(n);return w&&r&&s&&($==="online"?p:$==="offline"?D:$==="running"?F:$==="idling"?V:!0)}).sort((l,m)=>l.label.localeCompare(m.label));return e.jsxs("div",{className:"app",children:[e.jsx(ya,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(ma,{title:"Trip Monitor",setShowVehicles:u,showVehicles:b,setShowCard:G,showCard:N,sideBarTrip:d,setSideBarTrip:z,setShowVehiclesGroup:rt,showVehiclesGroup:pt}),e.jsx(Ca,{setShowVehiclesGroup:rt,showVehiclesGroup:pt,where:"tripmonitor"}),e.jsxs(B,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(B,{sx:{width:b||d?"80%":"100%",height:"50px"},children:e.jsx($a,{center:W,showCard:N})}),b&&e.jsx(B,{style:{width:"20%",backgroundColor:ut.grey[100]},children:e.jsx(ja,{vehicleData:gt,setShowVehicles:u,showVehicles:b,title:"Live Monitor",setSearchedTerm:P,setOptions:T,setState:E,setRegion:S,searchTerm:L,options:$,state:f,region:O,setSideBarTrip:z})}),e.jsx(B,{style:{width:a?"22%":"20%",display:d?"block":"none",backgroundColor:ut.grey[100]},children:e.jsx(oe,{})})]})]})]})}export{ge as default};
