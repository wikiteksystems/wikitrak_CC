import{v as R,j as e,bH as E,bI as K,bJ as Q,bL as p,aj as y,U as v,e as m,ao as X,w as V,B as j,ah as ee,d3 as se,d4 as te,J as T,G as h,T as le,z as re,L as ae,C as I,A as ne,ai as oe,d2 as ie,aq as O}from"./index-Diq4l7Dq.js";import{A as ce}from"./Autocomplete-DEa_thwn.js";import{T as de}from"./TextField-qTbTcyyL.js";function he({options:r,setOptions:n}){const o=R(),g=x=>{o(y(5.8)),o(v({})),n(x.target.value)};return e.jsx("div",{children:e.jsxs(E,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:[e.jsx(K,{id:"demo-simple-select-standard-label",children:"Vehicle State Options"}),e.jsxs(Q,{labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard",value:r,onChange:g,label:"state-options",children:[e.jsx(p,{value:"",children:e.jsx("em",{children:"None"})}),e.jsx(p,{value:"offline",children:"Offline Vehicles"}),e.jsx(p,{value:"online",children:"Online Vehicles"}),e.jsx(p,{value:"running",children:"Running Vehicles"}),e.jsx(p,{value:"idling",children:"Idling Vehicles"})]})]})})}let ge="https://cc.wikitrak.in/api-proxy/api/v1";function xe({state:r,setState:n}){const[o,g]=m.useState([]);m.useEffect(()=>{(async()=>{try{let{data:l}=await X.get(`${ge}/workshop/state/?country=1`);g((l==null?void 0:l.results)||[])}catch(l){console.error("Error while getting state data:",l)}})()},[]);const x=(t,l)=>{n((l==null?void 0:l.name)||""),console.log("Selected option:",l)};return e.jsx("div",{children:e.jsx(E,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:e.jsx(ce,{options:o,getOptionLabel:t=>(t==null?void 0:t.name)||"",value:o.find(t=>(t==null?void 0:t.name)===r)||null,onChange:x,isOptionEqualToValue:(t,l)=>(t==null?void 0:t.name)===(l==null?void 0:l.name),renderInput:t=>e.jsx(de,{...t,label:"State filter options",variant:"standard"})})})})}const fe=({vehicleData:r,title:n,setParameterData:o,loadingVehicle:g,setSearchedTerm:x,setOptions:t,setState:l,setRegion:A,searchTerm:M,region:S,state:B,options:F})=>{const{selectedVehicle:u,locationData:i,loading:W,onlineVehicle:ue}=V(s=>s.liveMap),{mode:N,showVehicles:P}=V(s=>s.dashboard),f=re(N),b=m.useRef(null),C=m.useRef(0);let c=R();m.useEffect(()=>{b.current&&setTimeout(()=>{b.current.scrollTop=C.current},0)});const $=async s=>{var k,w;if(b.current&&(C.current=b.current.scrollTop),ae(!P),!i||(i==null?void 0:i.length)<=0)return I.error("Data not available for this vehicle",{id:"clipboard"});const a=i==null?void 0:i.filter(d=>d.latestDocument.imei===s.value);if(console.log("selected vehicle",a),(a==null?void 0:a.length)<=0)return I.error("Data not available for this vehicle",{id:"clipboard"});const{lat:z,lng:G}=((k=a==null?void 0:a[0])==null?void 0:k.latestDocument)??{},H={lat:z||O.lat,lng:G||O.lat};c(ne(H)),c(y(15)),c(v({imei:s.value,reg_id:s.label})),c(oe(s.value));const Y=s.label,Z=await c(ie({w_registration_id:Y})),_=[];let D=0;(w=Z.payload)==null||w.map(d=>{d[d.parameter_type.toLowerCase()+"_parameter"].forEach(L=>{_.push({reg_id:s.label,imei:s.value,id:L.id,_id:d.id,key:D++,label:d.parameter_type==="Telematic"&&L.short_name})})}),n==="Live Map"&&o(_)},q=()=>{c(y(5.8)),c(v({}))},J=s=>{A(s)},U={backgroundColor:f.grey[100],position:"relative",width:"100%",float:"right",height:"90vh",overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"};return e.jsx(e.Fragment,{children:e.jsx("div",{ref:b,style:U,children:W||g?e.jsx(j,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:e.jsx(ee,{})}):e.jsxs(e.Fragment,{children:[e.jsx(se,{searchTerm:M,setSearchedTerm:x}),e.jsx(te,{region:S,handleRegion:J}),e.jsx(he,{options:F,setOptions:t}),e.jsx(xe,{state:B,setState:l}),(n==="Live Map"||n==="Live Monitor")&&e.jsx(j,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsxs(T,{variant:"outlined",onClick:()=>{q()},sx:{width:"90%",bgcolor:Object.keys(u).length===0?h.bgColor:"undefined",color:Object.keys(u).length===0?"white":f.grey[400],border:`1px solid ${h.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:h.bgShadow}},children:["All Vehicles: ",r==null?void 0:r.length]})}),r.length>0?r.map((s,a)=>e.jsx(j,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(T,{disabled:s.label===u.reg_id,variant:"outlined",onClick:()=>{$(s)},sx:{width:"90%",bgcolor:s.label===u.reg_id?h.bgColor:"undefined",color:s.label===u.reg_id?"white":f.grey[400],border:`1px solid ${h.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:h.bgShadow}},children:s.label})},a)):e.jsx(j,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsxs(le,{sx:{textAlign:"center",color:f.grey[400]},children:["Sorry! No vehicles in"," ",e.jsx("span",{style:{fontWeight:"bold"},children:S})," region"]})})]})})})};export{fe as V};
