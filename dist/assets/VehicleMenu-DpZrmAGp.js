import{x as I,j as e,aa as y,Y as v,b,ab as K,y as R,F as T,D as h,T as Q,H as X,B as L,A as ee,a9 as te,aC as re,ad as O}from"./index-rbA0Q-Xp.js";import{t as se}from"./Search-Cc3XJ5pb.js";import{R as le}from"./RegionSelector-euzt4v3e.js";import{S as oe}from"./SearchTab-B1nfao6r.js";import{F as E,b as ae}from"./OutlinedInput-ByT_sKc2.js";import{S as ne}from"./Select-DenE5wn1.js";import{M as u}from"./MenuItem-hxkdb1t9.js";import{A as ie}from"./Autocomplete-X6MqkHZ0.js";import{T as ce}from"./TextField-CsoCYGBz.js";import{B as j,C as de}from"./CircularProgress-B3myESuV.js";function he({options:l,setOptions:a}){const n=I(),g=m=>{n(y(5.8)),n(v({})),a(m.target.value)};return e.jsx("div",{children:e.jsxs(E,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:[e.jsx(ae,{id:"demo-simple-select-standard-label",children:"Vehicle State Options"}),e.jsxs(ne,{labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard",value:l,onChange:g,label:"state-options",children:[e.jsx(u,{value:"",children:e.jsx("em",{children:"None"})}),e.jsx(u,{value:"offline",children:"Offline Vehicles"}),e.jsx(u,{value:"online",children:"Online Vehicles"}),e.jsx(u,{value:"running",children:"Running Vehicles"}),e.jsx(u,{value:"idling",children:"Idling Vehicles"})]})]})})}let ge="https://cc.wikitrak.in/api-proxy/api/v1";function me({state:l,setState:a}){const[n,g]=b.useState([]);b.useEffect(()=>{(async()=>{try{let{data:s}=await K.get(`${ge}/workshop/state/?country=1`);g((s==null?void 0:s.results)||[])}catch(s){console.error("Error while getting state data:",s)}})()},[]);const m=(r,s)=>{a((s==null?void 0:s.name)||""),console.log("Selected option:",s)};return e.jsx("div",{children:e.jsx(E,{variant:"standard",sx:{m:0,minWidth:240,ml:2.85,mb:1},children:e.jsx(ie,{options:n,getOptionLabel:r=>(r==null?void 0:r.name)||"",value:n.find(r=>(r==null?void 0:r.name)===l)||null,onChange:m,isOptionEqualToValue:(r,s)=>(r==null?void 0:r.name)===(s==null?void 0:s.name),renderInput:r=>e.jsx(ce,{...r,label:"State filter options",variant:"standard"})})})})}const ke=({vehicleData:l,title:a,setParameterData:n,loadingVehicle:g,setSearchedTerm:m,setOptions:r,setState:s,setRegion:M,searchTerm:A,region:S,state:F,options:B})=>{const{selectedVehicle:x,locationData:i,loading:W,onlineVehicle:xe}=R(t=>t.liveMap),{mode:N,showVehicles:P}=R(t=>t.dashboard),f=se(N),p=b.useRef(null),C=b.useRef(0);let c=I();b.useEffect(()=>{p.current&&setTimeout(()=>{p.current.scrollTop=C.current},0)});const $=async t=>{var k,w;if(p.current&&(C.current=p.current.scrollTop),X(!P),!i||(i==null?void 0:i.length)<=0)return L.error("Data not available for this vehicle",{id:"clipboard"});const o=i==null?void 0:i.filter(d=>d.latestDocument.imei===t.value);if(console.log("selected vehicle",o),(o==null?void 0:o.length)<=0)return L.error("Data not available for this vehicle",{id:"clipboard"});const{lat:H,lng:U}=((k=o==null?void 0:o[0])==null?void 0:k.latestDocument)??{},Z={lat:H||O.lat,lng:U||O.lat};c(ee(Z)),c(y(15)),c(v({imei:t.value,reg_id:t.label})),c(te(t.value));const z=t.label,G=await c(re({w_registration_id:z})),_=[];let J=0;(w=G.payload)==null||w.map(d=>{d[d.parameter_type.toLowerCase()+"_parameter"].forEach(V=>{_.push({reg_id:t.label,imei:t.value,id:V.id,_id:d.id,key:J++,label:d.parameter_type==="Telematic"&&V.short_name})})}),a==="Live Map"&&n(_)},Y=()=>{c(y(5.8)),c(v({}))},q=t=>{M(t)},D={backgroundColor:f.grey[100],position:"relative",width:"100%",float:"right",height:"90vh",overflowY:"auto",scrollBehavior:"smooth",scrollbarWidth:"thin"};return e.jsx(e.Fragment,{children:e.jsx("div",{ref:p,style:D,children:W||g?e.jsx(j,{sx:{display:"flex",justifyContent:"center",height:"88vh",alignItems:"center"},children:e.jsx(de,{})}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{searchTerm:A,setSearchedTerm:m}),e.jsx(le,{region:S,handleRegion:q}),e.jsx(he,{options:B,setOptions:r}),e.jsx(me,{state:F,setState:s}),(a==="Live Map"||a==="Live Monitor")&&e.jsx(j,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsxs(T,{variant:"outlined",onClick:()=>{Y()},sx:{width:"90%",bgcolor:Object.keys(x).length===0?h.bgColor:"undefined",color:Object.keys(x).length===0?"white":f.grey[400],border:`1px solid ${h.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:h.bgShadow}},children:["All Vehicles: ",l==null?void 0:l.length]})}),l.length>0?l.map((t,o)=>e.jsx(j,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(T,{disabled:t.label===x.reg_id,variant:"outlined",onClick:()=>{$(t)},sx:{width:"90%",bgcolor:t.label===x.reg_id?h.bgColor:"undefined",color:t.label===x.reg_id?"white":f.grey[400],border:`1px solid ${h.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:h.bgShadow}},children:t.label})},o)):e.jsx(j,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsxs(Q,{sx:{textAlign:"center",color:f.grey[400]},children:["Sorry! No vehicles in"," ",e.jsx("span",{style:{fontWeight:"bold"},children:S})," region"]})})]})})})};export{ke as V};
