import{b0 as m,a$ as J,r as t,j as s,aX as d,eO as F,eP as A,bg as H,fb as K,aU as T,bc as Q,fc as W,fd as Y,bi as Z,bC as ee,fe as se,bJ as G,bx as ae,by as te,bA as re,bB as oe,b8 as $,br as le,bt as ne,b4 as ce}from"./index-B9W9A0YN.js";import{V as ie}from"./VehicleMenu-CCajfBdm.js";import{P as de}from"./Parameters-B4utlfqr.js";/* empty css           */import"./index.esm-R3Gd3xrx.js";import{S as he}from"./ServiceJobCardTable-B4Iea_yd.js";import{B as pe}from"./BreakDownJobCardTable-BpuPZF35.js";import{S as ue}from"./ServicesTopBar-BAE5mNsR.js";import"./Autocomplete-XJJmeDcA.js";import"./formik.esm-D-reUPUz.js";import"./Remove-CXcyEgiF.js";import"./excelUtils-CKXoEBjl.js";import"./xlsx-DrgRuPKf.js";import"./Edit-jq5htzrK.js";function C(o){const{children:h,value:x,index:c,...p}=o;return s.jsx("div",{role:"tabpanel",hidden:x!==c,id:`simple-tabpanel-${c}`,"aria-labelledby":`simple-tab-${c}`,...p,children:x===c&&s.jsx(d,{sx:{p:3},children:h})})}C.propTypes={children:T.node,index:T.number.isRequired,value:T.number.isRequired};function N(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function be(){const{selectedTabValue:o}=m(f=>f.inspection),h=J(),[x,c]=t.useState(0),p=(f,j)=>{h(H("")),h(K(j))};return s.jsxs(d,{sx:{width:"100%"},children:[s.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:s.jsxs(F,{value:o,onChange:p,"aria-label":"basic tabs example",children:[s.jsx(A,{label:"Breakdowns",...N(0)}),s.jsx(A,{label:"Services",...N(1)})]})}),s.jsx(C,{value:o,index:0,children:s.jsx(pe,{isInspection:!0})}),s.jsx(C,{value:o,index:1,children:s.jsx(he,{isInspection:!0})})]})}function Ce(){const{locationData:o,selectedVehicle:h,selectedParameterList:x}=m(a=>a.liveMap),{mode:c,selectedVehicleGroup:p}=m(a=>a.dashboard),f=ce(c),[j,M]=t.useState([]),{w_customer_id:S}=m(a=>a.auth),[O,_]=t.useState(),[v,L]=t.useState(!1),[y,R]=t.useState(!1),[w,V]=t.useState([]),[fe,ge]=t.useState(!0),[B,E]=t.useState(!1),[U,P]=t.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let r=J();Q(),t.useEffect(()=>{r(W()),r(Y())},[]),t.useEffect(()=>{q(),r(Z()),r(ee(S)),r(se())},[]),t.useEffect(()=>{V([]),r(G([{reg_id:"",imei:"",params:[]}]))},[h]);const q=async()=>{try{P(!0);let a=[],n=[];const u=await r(ae({w_customer_id:S}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var b,i,I,l;Array.isArray(e.imei)&&e.imei.length>0&&((b=e.imei[0])!=null&&b.mac_id)?(a.push({id:e.id,label:e.registration_id,value:(i=e.imei[0])==null?void 0:i.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(I=e==null?void 0:e.vehicle_model)==null?void 0:I.name,vehicle_group:e==null?void 0:e.vehicle_group}),n.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const D="one",k=n;n.length>0&&r(te({type:D,imei:k})),M(a),r(re(a)),P(!1),r(oe({w_customer_id:S}))}else P(!1),console.error("Unexpected data format:",u),$.error("Unexpected data format:")}catch(a){console.error("Error fetching vehicle data:",a),$.error(`Error fetching vehicle data: ${a}`)}},X=async a=>{const{label:n,imei:u,id:D,reg_id:k,checked:e}=a;_(l=>l.map(g=>g.id===D?{...g,checked:!e}:g));let b=[...w],i=[...w];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(b.push({label:n,value:l.latestDocument[n==="maininputvoltage"?"mainInputVoltage":n]}),i=b,V(b))});else{let l=w.filter(g=>g.label!==n);i=l,V(l)}console.log("tempParamList",i),r(G([{reg_id:k,imei:u,params:i}]))},z=j.filter(a=>Object.keys(p).length===0||a.vehicle_group===p.id);return s.jsxs("div",{className:"app",children:[s.jsx(le,{}),s.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[s.jsx(ue,{title:"Inspections",setShowVehicles:L,showVehicles:v,setShowVehiclesGroup:E,showVehiclesGroup:B}),s.jsx(ne,{setShowVehiclesGroup:E,showVehiclesGroup:B}),s.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[s.jsx(d,{style:{width:v||y?"80%":"100%"},children:s.jsx(be,{})}),v&&s.jsx(d,{style:{width:"20%",backgroundColor:f.grey[100]},children:s.jsx(ie,{vehicleData:z,title:"Inspections",setParameterData:_,loadingVehicle:U,setShowVehicles:L,showVehicles:v,showParameters:y,setShowParameters:R})}),y&&s.jsx(d,{style:{width:"20%",backgroundColor:f.grey[100]},children:s.jsx(de,{parametersData:O,setParameterData:_,handleParameterChange:X})})]})]})]})}export{Ce as default};
