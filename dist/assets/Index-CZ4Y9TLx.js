import{b0 as v,a$ as N,b as t,j as a,aX as d,eJ as z,eK as E,aU as I,bg as F,f6 as H,bc as Q,f7 as W,f8 as Y,bi as Z,bC as ee,f9 as ae,bI as A,bx as se,by as te,bA as re,bB as oe,b8 as G,br as le,bt as ne,b6 as ce}from"./index-Cdz_WO7e.js";import{V as ie}from"./VehicleMenu-Bb_QK7kZ.js";import{P as de}from"./Parameters-D3uQRPbI.js";/* empty css           */import"./index.esm-6HYcfm54.js";import{S as he}from"./ServiceJobCardTable-B2tOUiKT.js";import{B as pe}from"./BreakDownJobCardTable-ChB6WS-3.js";import{S as ue}from"./ServicesTopBar-Dyf29pnT.js";import"./Autocomplete-q70qGIR8.js";import"./formik.esm-CJx2oNMs.js";import"./Remove-ULGzt9ai.js";import"./excelUtils-DbWtlSl0.js";import"./xlsx-D5JNrnKm.js";import"./Edit-BwwMGs94.js";function k(o){const{children:h,value:f,index:n,...p}=o;return a.jsx("div",{role:"tabpanel",hidden:f!==n,id:`simple-tabpanel-${n}`,"aria-labelledby":`simple-tab-${n}`,...p,children:f===n&&a.jsx(d,{sx:{p:3},children:h})})}k.propTypes={children:I.node,index:I.number.isRequired,value:I.number.isRequired};function $(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function be(){const{selectedTabValue:o}=v(n=>n.inspection),h=N();t.useState(0);const f=(n,p)=>{h(F("")),h(H(p))};return a.jsxs(d,{sx:{width:"100%"},children:[a.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(z,{value:o,onChange:f,"aria-label":"basic tabs example",children:[a.jsx(E,{label:"Breakdowns",...$(0)}),a.jsx(E,{label:"Services",...$(1)})]})}),a.jsx(k,{value:o,index:0,children:a.jsx(pe,{isInspection:!0})}),a.jsx(k,{value:o,index:1,children:a.jsx(he,{isInspection:!0})})]})}function ke(){const{locationData:o,selectedVehicle:h,selectedParameterList:f}=v(s=>s.liveMap),{mode:n,selectedVehicleGroup:p}=v(s=>s.dashboard),T=ce(n),[J,M]=t.useState([]),{w_customer_id:m}=v(s=>s.auth),[R,j]=t.useState(),[x,L]=t.useState(!1),[S,U]=t.useState(!1),[_,y]=t.useState([]);t.useState(!0);const[B,C]=t.useState(!1),[q,w]=t.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let r=N();Q(),t.useEffect(()=>{r(W()),r(Y())},[]),t.useEffect(()=>{O(),r(Z()),r(ee(m)),r(ae())},[]),t.useEffect(()=>{y([]),r(A([{reg_id:"",imei:"",params:[]}]))},[h]);const O=async()=>{try{w(!0);let s=[],c=[];const u=await r(se({w_customer_id:m}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var b,i,D,l;Array.isArray(e.imei)&&e.imei.length>0&&((b=e.imei[0])!=null&&b.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(i=e.imei[0])==null?void 0:i.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(D=e==null?void 0:e.vehicle_model)==null?void 0:D.name,vehicle_group:e==null?void 0:e.vehicle_group}),c.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const V="one",P=c;c.length>0&&r(te({type:V,imei:P})),M(s),r(re(s)),w(!1),r(oe({w_customer_id:m}))}else w(!1),console.error("Unexpected data format:",u),G.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),G.error(`Error fetching vehicle data: ${s}`)}},K=async s=>{const{label:c,imei:u,id:V,reg_id:P,checked:e}=s;j(l=>l.map(g=>g.id===V?{...g,checked:!e}:g));let b=[..._],i=[..._];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(b.push({label:c,value:l.latestDocument[c==="maininputvoltage"?"mainInputVoltage":c]}),i=b,y(b))});else{let l=_.filter(g=>g.label!==c);i=l,y(l)}console.log("tempParamList",i),r(A([{reg_id:P,imei:u,params:i}]))},X=J.filter(s=>Object.keys(p).length===0||s.vehicle_group===p.id);return a.jsxs("div",{className:"app",children:[a.jsx(le,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:L,showVehicles:x,setShowVehiclesGroup:C,showVehiclesGroup:B}),a.jsx(ne,{setShowVehiclesGroup:C,showVehiclesGroup:B}),a.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(d,{style:{width:x||S?"80%":"100%"},children:a.jsx(be,{})}),x&&a.jsx(d,{style:{width:"20%",backgroundColor:T.grey[100]},children:a.jsx(ie,{vehicleData:X,title:"Inspections",setParameterData:j,loadingVehicle:q,setShowVehicles:L,showVehicles:x,showParameters:S,setShowParameters:U})}),S&&a.jsx(d,{style:{width:"20%",backgroundColor:T.grey[100]},children:a.jsx(de,{parametersData:R,setParameterData:j,handleParameterChange:K})})]})]})]})}export{ke as default};
