import{y as b,x as N,b as r,j as a,I as F,S as H,E as K,b9 as W,ba as X,U as Y,a4 as Z,aQ as ee,ac as C,$ as ae,a0 as se,a2 as re,a3 as te,B as G}from"./index-B5aO5-3M.js";import{V as oe}from"./VehicleMenu-BjJRc2UX.js";import{t as ie}from"./Search-CSqd9aEB.js";import"./Loader-CgU9DPym.js";import"./LiveMapServices-BQnBWtbM.js";import"./Socket-DLjvxrzW.js";import{P as le}from"./Parameters-DOayMwo-.js";/* empty css           */import"./proj-XQwXs9DQ.js";import{L as ne}from"./LeftSideBar2-BCsHrNIj.js";import"./InspectionsTable-BFE65JHl.js";import"./index.esm-DAKUgSuu.js";import{V as ce}from"./VehicleGroups-CMv38Bn6.js";import{P as I}from"./index-BU2sDMV1.js";import"./ServiceRecordTable-B-iNtLMm.js";import{S as pe}from"./ServiceJobCardTable-BUl0gSLc.js";import{B as de}from"./BreakDownJobCardTable-D5Fu5UG2.js";import{B as p}from"./CircularProgress-CjHKMZJO.js";import{T as he,a as A}from"./Tabs-BL7RrYrW.js";import{S as ue}from"./ServicesTopBar-69r90B3n.js";import"./RegionSelector-CaPsGXws.js";import"./SearchTab-DJMEwZfw.js";import"./OutlinedInput-Pp-d-9jE.js";import"./IconButton-D-UN0Mj3.js";import"./InputAdornment-UiuQ1oI1.js";import"./Select-B3xCQ8c6.js";import"./Paper-DoBoVvcV.js";import"./MenuItem-CzdKe1ex.js";import"./menu2-gypHyKoT.js";import"./Autocomplete-CIeaT7yK.js";import"./Tooltip-Bl0hPFn3.js";import"./usePreviousProps-C7EYvWVQ.js";import"./TextField-CZWDmGXe.js";import"./createSvgIcon-DsBawmhq.js";import"./Card-C2IirYtS.js";import"./CardContent-cYF5dkK-.js";import"./DialogTitle-DuIYW7FA.js";import"./DialogContentText-Cnevu746.js";import"./Edit-CbmCJeaL.js";import"./TableRow-D_IWnEIg.js";import"./TablePagination-CDiTBofL.js";import"./formik.esm-B7-zPVDg.js";import"./Close-C5HYBR3U.js";import"./NewLoader-BpbJ36UJ.js";import"./excelUtils-Bks7O97f.js";import"./button-h-4JHXPz.js";import"./index-C-Qr_kcW.js";import"./roundedArrow-DAhbUsjQ.js";import"./TextArea-CPSt_V00.js";function T(o){const{children:d,value:f,index:l,...h}=o;return a.jsx("div",{role:"tabpanel",hidden:f!==l,id:`simple-tabpanel-${l}`,"aria-labelledby":`simple-tab-${l}`,...h,children:f===l&&a.jsx(p,{sx:{p:3},children:d})})}T.propTypes={children:I.node,index:I.number.isRequired,value:I.number.isRequired};function $(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function me(){const{selectedTabValue:o}=b(l=>l.inspection),d=N();r.useState(0);const f=(l,h)=>{d(F("")),d(H(h))};return a.jsxs(p,{sx:{width:"100%"},children:[a.jsx(p,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(he,{value:o,onChange:f,"aria-label":"basic tabs example",children:[a.jsx(A,{label:"Breakdowns",...$(0)}),a.jsx(A,{label:"Services",...$(1)})]})}),a.jsx(T,{value:o,index:0,children:a.jsx(de,{isInspection:!0})}),a.jsx(T,{value:o,index:1,children:a.jsx(pe,{isInspection:!0})})]})}function pa(){const{locationData:o,selectedVehicle:d,selectedParameterList:f}=b(s=>s.liveMap),{mode:l,selectedVehicleGroup:h}=b(s=>s.dashboard),k=ie(l),[M,J]=r.useState([]),{w_customer_id:v}=b(s=>s.auth),[R,j]=r.useState(),[x,L]=r.useState(!1),[S,U]=r.useState(!1),[_,y]=r.useState([]);r.useState(!0);const[B,E]=r.useState(!1),[q,w]=r.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let t=N();K(),r.useEffect(()=>{t(W()),t(X())},[]),r.useEffect(()=>{O(),t(Y()),t(Z(v)),t(ee())},[]),r.useEffect(()=>{y([]),t(C([{reg_id:"",imei:"",params:[]}]))},[d]);const O=async()=>{try{w(!0);let s=[],n=[];const u=await t(ae({w_customer_id:v}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var m,c,D,i;Array.isArray(e.imei)&&e.imei.length>0&&((m=e.imei[0])!=null&&m.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(c=e.imei[0])==null?void 0:c.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(D=e==null?void 0:e.vehicle_model)==null?void 0:D.name,vehicle_group:e==null?void 0:e.vehicle_group}),n.push((i=e.imei[0])==null?void 0:i.mac_id)):console.error("IMEI data not found for item:",e)});const V="one",P=n;n.length>0&&t(se({type:V,imei:P})),J(s),t(re(s)),w(!1),t(te({w_customer_id:v}))}else w(!1),console.error("Unexpected data format:",u),G.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),G.error(`Error fetching vehicle data: ${s}`)}},Q=async s=>{const{label:n,imei:u,id:V,reg_id:P,checked:e}=s;j(i=>i.map(g=>g.id===V?{...g,checked:!e}:g));let m=[..._],c=[..._];if(!e)o.forEach(i=>{i.latestDocument.imei===u&&(m.push({label:n,value:i.latestDocument[n==="maininputvoltage"?"mainInputVoltage":n]}),c=m,y(m))});else{let i=_.filter(g=>g.label!==n);c=i,y(i)}console.log("tempParamList",c),t(C([{reg_id:P,imei:u,params:c}]))},z=M.filter(s=>Object.keys(h).length===0||s.vehicle_group===h.id);return a.jsxs("div",{className:"app",children:[a.jsx(ne,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:L,showVehicles:x,setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsx(ce,{setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsxs(p,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(p,{style:{width:x||S?"80%":"100%"},children:a.jsx(me,{})}),x&&a.jsx(p,{style:{width:"20%",backgroundColor:k.grey[100]},children:a.jsx(oe,{vehicleData:z,title:"Inspections",setParameterData:j,loadingVehicle:q,setShowVehicles:L,showVehicles:x,showParameters:S,setShowParameters:U})}),S&&a.jsx(p,{style:{width:"20%",backgroundColor:k.grey[100]},children:a.jsx(le,{parametersData:R,setParameterData:j,handleParameterChange:Q})})]})]})]})}export{pa as default};
