import{n as ye,j as e,b0 as I,b as l,a$ as ne,fg as Se,fm as Ce,fn as Pe,fo as Te,b8 as X,bl as ve,aX as A,eq as f,dL as O,bd as ee,bZ as Le,T as ue,aZ as se,e_ as fe,e$ as ge,f0 as be,R as je,fc as Ae,bn as U,fd as le,bg as Ve,d5 as de,cg as $e,dU as Ie,dV as Re,dW as qe,dX as he,dY as j,dZ as Fe,f2 as Oe,ee as Ee,db as Me,eJ as We,eK as pe,f7 as Ne,f8 as Ye,fe as He,bI as _e,bx as Je,by as ze,bA as Ge,br as Ze,b6 as De}from"./index-JOrDSKTq.js";import{V as Xe}from"./VehicleMenu-Bxf_8cBL.js";import{P as Ke}from"./Parameters-DaoIyyp6.js";/* empty css           */import{c as Qe,f as Be,a as w,e as ke}from"./index.esm-bfW88Llv.js";import{u as Ue}from"./formik.esm-9XFGCbko.js";import{A as ce}from"./Autocomplete-BFMr6ukq.js";import{R as we,A as es,D as ss}from"./Remove-CLubsI8k.js";import{a as ts,S as as}from"./ServiceJobCardTable-CD9ucH4F.js";import{T as rs,d as ns}from"./excelUtils-QVBTzrFL.js";import{T as cs,E as is}from"./Edit-B2fx2uqC.js";import{S as ls}from"./ServicesTopBar-DXBDZU5h.js";import"./xlsx-D5JNrnKm.js";const os=ye(e.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),me=({UpdatedBreakdownData:c,setOpen:h})=>{var k,_,S,T;const{w_customer_id:g}=I(a=>a.auth),[y,V]=l.useState(null),{vehicleList:C}=I(a=>a.liveMap),{vendorList:K,segMentList:E,loading:Q}=I(a=>a.services),{technicianList:P}=I(a=>a.breakdown),{sparePartList:$}=I(a=>a.inspection),R=ne(),[M,G]=l.useState([]),[Z,D]=l.useState([]),[B,W]=l.useState(!1);l.useState(null),console.log("update service data",c),l.useEffect(()=>{},[P]);let te=c==null?void 0:c.service_parts.map(a=>{var i;return{spare_parts:(i=a==null?void 0:a.spare_parts)==null?void 0:i.id,quantity:a==null?void 0:a.quantity}});const t=Ue({initialValues:{start_date:(c==null?void 0:c.start_date)||Se(new Date),vehicle:((k=c==null?void 0:c.vehicle)==null?void 0:k.id)||"",service_type:(c==null?void 0:c.service_type)||"",technician:((_=c==null?void 0:c.technician)==null?void 0:_.id)||"",mob_no:(c==null?void 0:c.mob_no)||"",attachment:(c==null?void 0:c.attachment)||"",location:(c==null?void 0:c.location)||"",contact_person:(c==null?void 0:c.contact_person)||"",service_parts:te||[],status:"Pending",user:g},validationSchema:Qe({start_date:Be().required("Submission Date is required"),vehicle:w().required("Vehicle is required"),service_type:w().required("Service type is required"),technician:w().required("Technician is required"),mob_no:w().matches(/^\d{10,11}$/,"Mobile number must be 10-11 digits").required("Mobile number is required"),location:w().required("Location is required"),contact_person:w().required("Contact Person is required"),attachment:ke()}),onSubmit:async a=>{console.log("values",a);let i;if(c?((a==null?void 0:a.attachment)instanceof File||typeof(a==null?void 0:a.attachment)=="string"&&(a.attachment=""),i=await R(Ce({payload:a,id:c.id}))):i=await R(Pe(a)),i.payload){console.log(i.payload),console.log("values",a.service_parts);const{id:n}=i.payload,{service_parts:x}=a;await R(Te({service:n,parts:x})),X.success("Service created successfully"),t.resetForm(),V(null),R(ve()),h(!1)}}}),q=["Routine","Overdue","Emergency"];l.useEffect(()=>{let a=C.map(i=>({label:i.registration_id,value:i.id}));G(a)},[C]),l.useEffect(()=>{let a=E.map(i=>({label:i.segment_name,value:i.id}));D(a)},[E]);const ae=async()=>{W(!0),navigator.geolocation?navigator.geolocation.getCurrentPosition(async a=>{const{latitude:i,longitude:n}=a.coords;try{const x=await getReadableAddress(i,n);t.setFieldValue("location",x)}catch{X.error("Failed to convert coordinates to address.")}finally{W(!1)}},()=>{X.error("Failed to retrieve location."),W(!1)}):(X.error("Geolocation not supported."),W(!1))};return e.jsx(A,{sx:{p:3,maxWidth:"100%",margin:"auto"},children:e.jsx("form",{onSubmit:t.handleSubmit,children:e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(O,{label:"Start date",name:"start_date",type:"datetime-local",value:t.values.start_date,onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.start_date&&!!t.errors.start_date,helperText:t.touched.start_date&&t.errors.start_date,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!0})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(ce,{options:C,getOptionLabel:a=>a.registration_id||"",value:C.find(a=>a.id===t.values.vehicle)||null,onChange:(a,i)=>t.setFieldValue("vehicle",(i==null?void 0:i.id)||""),renderInput:a=>e.jsx(O,{...a,label:"Vehicle",error:t.touched.vehicle&&!!t.errors.vehicle,helperText:t.touched.vehicle&&t.errors.vehicle})})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(ce,{options:q,getOptionLabel:a=>a,value:t.values.service_type,onChange:(a,i)=>t.setFieldValue("service_type",i||""),renderInput:a=>e.jsx(O,{...a,label:"Service Type",error:t.touched.service_type&&!!t.errors.service_type,helperText:t.touched.service_type&&t.errors.service_type})})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(ce,{options:P,getOptionLabel:a=>`${a.first_name} ${a.last_name}`||"",value:P.find(a=>a.id===t.values.technician)||null,onChange:(a,i)=>t.setFieldValue("technician",(i==null?void 0:i.id)||""),renderInput:a=>e.jsx(O,{...a,label:"Assign technician",error:t.touched.technician&&!!t.errors.technician,helperText:t.touched.technician&&t.errors.technician})})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(O,{label:"Contact Person Name*",name:"contact_person",value:t.values.contact_person,onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.contact_person&&!!t.errors.contact_person,helperText:t.touched.contact_person&&t.errors.contact_person,fullWidth:!0})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(O,{label:"Contact Person Mobile No*",name:"mob_no",value:t.values.mob_no,onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.mob_no&&!!t.errors.mob_no,helperText:t.touched.mob_no&&t.errors.mob_no,fullWidth:!0})}),e.jsxs(f,{item:!0,xs:12,sm:6,children:[e.jsx(O,{label:"Location",name:"location",value:t.values.location,onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.location&&!!t.errors.location,helperText:t.touched.location&&t.errors.location,fullWidth:!0}),e.jsx(ee,{size:"small",onClick:ae,disabled:B,sx:{mt:1},children:B?e.jsx(Le,{size:16}):"Use Current Location"})]}),e.jsxs(f,{item:!0,xs:12,children:[e.jsx(ue,{variant:"h6",gutterBottom:!0,children:"Parts Requirement*(If any information available)"}),(T=(S=t==null?void 0:t.values)==null?void 0:S.service_parts)==null?void 0:T.map((a,i)=>{var b;const n=(b=t.values)==null?void 0:b.service_parts.map(o=>o.spare_parts).filter((o,u)=>u!==i),x=$.filter(o=>!n.includes(o.id));return e.jsxs(f,{container:!0,spacing:2,marginTop:"0px",alignItems:"center",children:[e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(ce,{options:x,getOptionLabel:o=>o.description,value:$.find(o=>o.id===a.spare_parts)||null,onChange:(o,u)=>t.setFieldValue(`service_parts[${i}].spare_parts`,(u==null?void 0:u.id)||""),renderInput:o=>e.jsx(O,{...o,label:"Spare Part",fullWidth:!0})})}),e.jsx(f,{item:!0,xs:8,md:4,children:e.jsxs(A,{display:"flex",alignItems:"center",children:[e.jsx(se,{onClick:()=>t.setFieldValue(`service_parts[${i}].quantity`,Math.max(1,a.quantity-1)),children:e.jsx(we,{})}),e.jsx(O,{value:a.quantity,type:"number",inputProps:{min:1},onChange:o=>t.setFieldValue(`service_parts[${i}].quantity`,parseInt(o.target.value,10)),sx:{width:90,mx:1,textAlign:"center"}}),e.jsx(se,{onClick:()=>t.setFieldValue(`service_parts[${i}].quantity`,a.quantity+1),children:e.jsx(es,{})})]})}),e.jsx(f,{item:!0,xs:4,md:2,children:e.jsx(se,{color:"error",onClick:()=>{var u;const o=[...(u=t.values)==null?void 0:u.service_parts];o.splice(i,1),t.setFieldValue("service_parts",o)},children:e.jsx(ss,{})})})]},i)}),e.jsx(ee,{variant:"outlined",onClick:()=>{var n,x,b;const a=(x=(n=t.values)==null?void 0:n.service_parts)==null?void 0:x.map(o=>o.spare_parts);if($.filter(o=>!(a!=null&&a.includes(o.id))).length===0){X.error("All available spare parts have already been added.");return}t.setFieldValue("service_parts",[...(b=t.values)==null?void 0:b.service_parts,{spare_parts:"",quantity:1}])},sx:{mt:2},children:"+ Add Spare Part"})]}),e.jsxs(f,{item:!0,xs:6,children:[e.jsxs(ee,{variant:"outlined",component:"label",fullWidth:!0,children:["Upload File",e.jsx("input",{type:"file",hidden:!0,onChange:a=>{const i=a.currentTarget.files[0];i&&t.setFieldValue("attachment",i)}})]}),t.values.attachment&&e.jsxs(f,{container:!0,spacing:1,mt:1,alignItems:"center",children:[e.jsx(f,{item:!0,children:e.jsxs(ue,{variant:"body2",children:[e.jsx("b",{children:"Attachment:"})," ",typeof t.values.attachment=="string"?t.values.attachment.split("/").pop():t.values.attachment.name]})}),e.jsx(f,{item:!0,children:e.jsx(ee,{size:"small",variant:"text",onClick:()=>{const a=typeof t.values.attachment=="string"?t.values.attachment:URL.createObjectURL(t.values.attachment);window.open(a,"_blank")},children:"View File"})})]})]}),e.jsx(f,{item:!0,xs:12,children:e.jsx(ee,{variant:"contained",type:"submit",fullWidth:!0,disabled:Q,children:c?"Update Service request":"Raise Service request"})})]})})})};function us({open:c,setOpen:h,data:g,isInspection:y}){const V=()=>h(!1);return e.jsxs(fe,{open:c,onClose:V,maxWidth:"xl",fullWidth:!0,scroll:"paper",children:[e.jsxs(ge,{children:["Update service entry",e.jsx(se,{"aria-label":"close",onClick:()=>h(!1),sx:{position:"absolute",right:8,top:8},children:e.jsx(os,{})})]}),e.jsx(be,{dividers:!0,children:e.jsx(me,{UpdatedBreakdownData:g,setOpen:h})})]})}const xe=[{id:"service_record_id",label:"Service Record ID"},{id:"registration_id",label:"Registration ID"},{id:"service_type",label:"Service Type"},{id:"user_name",label:"Created by"},{id:"technician_name",label:"Technician Name"},{id:"contact_person",label:"Contact Person"},{id:"mob_no",label:"Mobile No"},{id:"start_date",label:"Start Date"},{id:"start_time",label:"Start Time"},{id:"status",label:"Status"}],ds=()=>{const{servicesData:c}=I(s=>s.services),{searchTerm:h}=I(s=>s.inspection),g=ne(),[y,V]=l.useState("asc"),[C,K]=l.useState("BDID"),[E,Q]=l.useState(0),[P,$]=l.useState(8),[R,M]=l.useState(!1),[G,Z]=l.useState(!1),[D,B]=l.useState(null),[W,te]=je.useState(null);l.useState({service_record_id:"",registration_id:"",service_type:"",user_name:"",technician_name:"",contact_person:"",mob_no:"",start_date:"",start_time:"",status:""});const[t,q]=l.useState("service_record_id");l.useEffect(()=>{g(Ae({})),g(ve())},[]);const ae=s=>{V(C===s&&y==="asc"?"desc":"asc"),K(s)},k=(s,v)=>{Q(v)},_=s=>{$(parseInt(s.target.value,10)),Q(0)},S=(s,v,m)=>!v||!m?s:s.filter(r=>(()=>{var d,L,Y,H,J,z,F,ie,re;switch(v){case"service_record_id":return((r==null?void 0:r.service_record_id)||"").toString();case"registration_id":return((d=r==null?void 0:r.vehicle)==null?void 0:d.registration_id)||"";case"service_type":return(r==null?void 0:r.service_type)||"";case"user_name":return`${((Y=(L=r==null?void 0:r.user)==null?void 0:L.us_user)==null?void 0:Y.first_name)||""} ${((J=(H=r==null?void 0:r.user)==null?void 0:H.us_user)==null?void 0:J.last_name)||""}`;case"technician_name":return`${((F=(z=r==null?void 0:r.technician)==null?void 0:z.us_user)==null?void 0:F.first_name)||""} ${((re=(ie=r==null?void 0:r.technician)==null?void 0:ie.us_user)==null?void 0:re.last_name)||""}`;case"contact_person":return(r==null?void 0:r.contact_person)||"";case"mob_no":return(r==null?void 0:r.mob_no)||"";case"start_date":return r!=null&&r.start_date?U(r.start_date).format("YYYY-MM-DD"):"";case"start_time":return r!=null&&r.start_date?U(r.start_date).format("HH:mm A"):"";case"status":return(r==null?void 0:r.status)||"";default:return""}})().toLowerCase().includes(m.toLowerCase())),T=(s,v,m,r)=>{if(r==="User"){const p=`${s.user.us_user.first_name} ${s.user.us_user.last_name}`.toLowerCase(),d=`${v.user.us_user.first_name} ${v.user.us_user.last_name}`.toLowerCase();return m==="asc"?p.localeCompare(d):d.localeCompare(p)}if(r==="WorkshopGroup"){const p=s.workshop_group.group_name.toLowerCase(),d=v.workshop_group.group_name.toLowerCase();return m==="asc"?p.localeCompare(d):d.localeCompare(p)}if(r==="BDID"){const p=parseInt(s.service_record_id.replace("BD-",""),10),d=parseInt(v.service_record_id.replace("BD-",""),10);return m==="asc"?p-d:d-p}if(r==="SubmissionDate"){const p=new Date(s.submission_date),d=new Date(v.submission_date);return m==="asc"?p-d:d-p}if(r==="Status"){const p={Open:1,Close:2,Rejected:3},d=p[s.status]||0,L=p[v.status]||0;return m==="asc"?d-L:L-d}return 0},a=S((c==null?void 0:c.slice())||[],t,h).sort((s,v)=>T(s,v,y,C)),i=a.slice(E*P,E*P+P),n={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"},x=s=>{Z(!G),te(s)},b=a&&a.map(s=>{var m,r,p,d,L,Y,H,J,z;const v=s!=null&&s.service_parts&&(s==null?void 0:s.service_parts.length)>0?s==null?void 0:s.service_parts.map((F,ie)=>{var re;return`${(re=F==null?void 0:F.spare_parts)==null?void 0:re.description}: Qty ${F==null?void 0:F.quantity}`}).join(";"):"N/A";return{"Service Record ID":(s==null?void 0:s.service_record_id)||"","Registration ID":((m=s==null?void 0:s.vehicle)==null?void 0:m.registration_id)||"","Service Type":(s==null?void 0:s.service_type)||"","User Name":`${((p=(r=s==null?void 0:s.user)==null?void 0:r.us_user)==null?void 0:p.first_name)||""} ${((L=(d=s==null?void 0:s.user)==null?void 0:d.us_user)==null?void 0:L.last_name)||""}`,"Technician Name":`${((H=(Y=s==null?void 0:s.technician)==null?void 0:Y.us_user)==null?void 0:H.first_name)||""} ${((z=(J=s==null?void 0:s.technician)==null?void 0:J.us_user)==null?void 0:z.last_name)||""}`,"Contact Person":(s==null?void 0:s.contact_person)||"","Mobile No":(s==null?void 0:s.mob_no)||"","Start Date":s!=null&&s.start_date?U(s.start_date).format("YYYY-MM-DD"):"","Start Time":s!=null&&s.start_date?U(s.start_date).format("HH:mm A"):"",Status:(s==null?void 0:s.status)||"","Spare parts":v}});let o=le("Service"),u=le("Job Card");const N=(u==null?void 0:u.includes("Create"))||u==="Read-Write-Only",oe=(o==null?void 0:o.includes("Update"))||o==="Read-Write-Only";return e.jsxs(A,{sx:{m:"10px"},children:[e.jsxs(A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(rs,{columns:xe,selectedColumn:t,onColumnChange:q,searchTerm:h,onSearchChange:s=>g(Ve(s))}),e.jsx(de,{variant:"contained",color:"success",onClick:()=>ns(b,"service-ticket.xlsx"),children:"Download Excel"})]}),e.jsxs($e,{children:[e.jsx(Ie,{sx:{height:"73vh",bgcolor:"white",borderRadius:"10px"},children:e.jsxs(Re,{stickyHeader:!0,children:[e.jsx(qe,{children:e.jsxs(he,{children:[xe.map(s=>e.jsx(j,{sx:n,children:e.jsx(cs,{active:C===s.id,direction:C===s.id?y:"asc",onClick:()=>ae(s.id),children:s.label})},s.id)),oe&&e.jsx(j,{sx:n,children:"Action"}),N&&e.jsx(j,{sx:n,children:"Job card"})]})}),e.jsx(Fe,{children:i.map((s,v)=>{var m,r,p,d,L,Y,H,J,z;return e.jsxs(he,{children:[e.jsx(j,{children:s==null?void 0:s.service_record_id}),e.jsx(j,{children:(m=s==null?void 0:s.vehicle)==null?void 0:m.registration_id}),e.jsx(j,{children:s==null?void 0:s.service_type}),e.jsx(j,{children:`${(p=(r=s==null?void 0:s.user)==null?void 0:r.us_user)==null?void 0:p.first_name} ${(L=(d=s==null?void 0:s.user)==null?void 0:d.us_user)==null?void 0:L.last_name}`}),e.jsx(j,{children:`${((H=(Y=s==null?void 0:s.technician)==null?void 0:Y.us_user)==null?void 0:H.first_name)||""} ${((z=(J=s==null?void 0:s.technician)==null?void 0:J.us_user)==null?void 0:z.last_name)||""}`}),e.jsx(j,{children:s==null?void 0:s.contact_person}),e.jsx(j,{children:s==null?void 0:s.mob_no}),e.jsx(j,{children:(s==null?void 0:s.start_date)&&U(s.start_date).format("YYYY-MM-DD")||"N/A"}),e.jsx(j,{children:(s==null?void 0:s.start_date)&&U(s.start_date).format("HH:mm A")||"N/A"}),e.jsx(j,{sx:{color:s.status==="Open"?"blue":s.status==="Completed"?"green":"red"},children:s.status}),oe&&e.jsx(j,{children:e.jsx(se,{onClick:()=>x(s),color:"primary",disabled:(s==null?void 0:s.status.toLowerCase())==="completed","aria-label":"edit record",children:e.jsx(is,{})})}),N&&e.jsx(j,{children:e.jsx(de,{variant:"outlined",onClick:()=>{M(!0),B(s)},disabled:s==null?void 0:s.jobcard,children:"Create job card"})})]},v)})})]})}),e.jsx(Oe,{component:"div",count:a.length,page:E,onPageChange:k,rowsPerPage:P,onRowsPerPageChange:_,rowsPerPageOptions:[5,10,15]}),e.jsx(ts,{rowData:D,open:R,handleClose:()=>M(!1),isTechnician:!0})]}),e.jsx(us,{open:G,setOpen:Z,data:W})]})};function hs(){const[c,h]=je.useState(!1);ne();const g=()=>h(!0),y=()=>h(!1);return e.jsxs("div",{children:[e.jsx(ee,{variant:"outlined",onClick:g,children:"+ Add New Entry"}),e.jsxs(fe,{open:c,onClose:y,maxWidth:"xl",fullWidth:!0,scroll:"paper",children:[e.jsxs(ge,{children:["+ Add new service entry",e.jsx(se,{"aria-label":"close",onClick:y,sx:{position:"absolute",right:8,top:8},children:e.jsx(Ee,{})})]}),e.jsx(be,{dividers:!0,children:e.jsx(me,{setOpen:h})})]})]})}function ps(){const[c]=Me(),h=c.get("tab"),[g,y]=l.useState(0);l.useEffect(()=>{h&&y(Number(h))},[]);const V=(C,K)=>{y(K)};return e.jsxs(A,{sx:{width:"100%"},children:[e.jsx(A,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(We,{value:g,onChange:V,"aria-label":"Breakdown Tabs",children:[e.jsx(pe,{label:"Service Tickets"}),e.jsx(pe,{label:"Service Job Cards"})]})}),e.jsxs(A,{sx:{mt:2},children:[g===0&&e.jsx(ds,{isInspection:!1}),g===1&&e.jsx(as,{isInspection:!1})]})]})}const _s=()=>{const c=ne();l.useEffect(()=>{c(Ne()),c(Ye()),c(He())},[]);let h=le("Service");const g=(h==null?void 0:h.includes("Create"))||h==="Read-Write-Only";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",height:"70px"},children:[e.jsx("div",{style:{margin:"10px"},children:e.jsx("h3",{children:"Service Record"})}),g&&e.jsx("div",{style:{margin:"10px",marginTop:"20px"},children:e.jsx(hs,{})}),"      "]}),e.jsxs("div",{children:[e.jsx("hr",{}),e.jsx("div",{style:{margin:"10px"},children:e.jsx(ps,{})})]})]})},xs=_s;function Vs(){const{locationData:c,selectedVehicle:h,selectedParameterList:g}=I(_=>_.liveMap),{mode:y}=I(_=>_.dashboard),V=De(y),[C,K]=l.useState([]),{w_customer_id:E}=I(_=>_.auth),[Q,P]=l.useState(),[$,R]=l.useState(!1),[M,G]=l.useState(!1),[Z,D]=l.useState([]),[B,W]=l.useState(!0),[te,t]=l.useState(!1);let q=ne();l.useEffect(()=>{ae()},[]),l.useEffect(()=>{D([]),q(_e([{reg_id:"",imei:"",params:[]}]))},[h]);const ae=async()=>{try{t(!0);let _=[],S=[];const T=await q(Je({w_customer_id:E}));if(Array.isArray(T.payload)){T.payload.forEach(n=>{var x,b,o,u;Array.isArray(n.imei)&&n.imei.length>0&&((x=n.imei[0])!=null&&x.mac_id)?(_.push({id:n.id,label:n.registration_id,value:(b=n.imei[0])==null?void 0:b.mac_id,vehilce_type:n==null?void 0:n.segment,chassis_no:n==null?void 0:n.chassis_no,engine_no:n==null?void 0:n.engine_no,workShop:n==null?void 0:n.workshop,registration_id:n==null?void 0:n.registration_id,sell_date:n==null?void 0:n.sell_date,customer_name:n==null?void 0:n.customer_name,vehicle_model:(o=n==null?void 0:n.vehicle_model)==null?void 0:o.name}),S.push((u=n.imei[0])==null?void 0:u.mac_id)):console.error("IMEI data not found for item:",n)});const a="one",i=S;S.length>0&&q(ze({type:a,imei:i})),K(_),q(Ge(_)),t(!1)}else t(!1),console.error("Unexpected data format:",T),X.error("Unexpected data format:")}catch(_){console.error("Error fetching vehicle data:",_),X.error(`Error fetching vehicle data: ${_}`)}},k=async _=>{const{label:S,imei:T,id:a,reg_id:i,checked:n}=_;P(u=>u.map(N=>N.id===a?{...N,checked:!n}:N));let x=[...Z],b=[...Z];if(!n)c.forEach(u=>{u.latestDocument.imei===T&&(x.push({label:S,value:u.latestDocument[S==="maininputvoltage"?"mainInputVoltage":S]}),b=x,D(x))});else{let u=Z.filter(N=>N.label!==S);b=u,D(u)}console.log("tempParamList",b),q(_e([{reg_id:i,imei:T,params:b}]))};return e.jsxs("div",{className:"app",children:[e.jsx(Ze,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(ls,{title:"services",setShowVehicles:R,showVehicles:$,showParameters:M,setShowParameters:G,setShowCard:W,showCard:B}),e.jsxs(A,{style:{display:"flex",width:"100%",height:"95vh"},children:[e.jsx(A,{style:{width:$||M?"80%":"100%"},children:e.jsx(xs,{})}),$&&e.jsx(A,{style:{width:"20%",backgroundColor:V.grey[100]},children:e.jsx(Xe,{vehicleData:C,title:"Inspections",setParameterData:P,loadingVehicle:te,setShowVehicles:R,showVehicles:$,showParameters:M,setShowParameters:G})}),M&&e.jsx(A,{style:{width:"20%",backgroundColor:V.grey[100]},children:e.jsx(Ke,{parametersData:Q,setParameterData:P,handleParameterChange:k})})]})]})]})}export{Vs as default};
