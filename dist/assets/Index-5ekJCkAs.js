import{R as q,r as B,p as je,o as Ge,j as i,B as se,T as Je,d0 as ne,cl as Pe,cm as De,cn as ke,co as we,cp as ye,D as be,eV as us,eW as ds,eX as et,cs as fs,cr as Vt,eY as hs,V as le,dn as Me,eZ as ms,e_ as ys,e$ as qe,f0 as Ne,f1 as Ie,f2 as gs,dg as Rt,dh as Mt,di as Nt,dj as xs,m as it,aH as ps,aF as tt,cQ as vs,A as rt,I as bs,n as _s,cu as Vs,cv as js,cw as Ss,cx as jt,cy as J,cz as Es,dq as As,f3 as Cs,f4 as Fs,f5 as Ds,af as St,a3 as ks,a4 as ws,a6 as qs,a7 as Ls,Y as Ts,$ as Os,w as Us}from"./index-CHz_ICGe.js";import{V as Ps}from"./VehicleMenu-DrBH9UE5.js";import{P as Rs}from"./Parameters-BPyShYNl.js";/* empty css           */import{d as Ms}from"./Add-CM8odcWN.js";import{c as Ns,d as Is,a as _e,e as Et}from"./index.esm-DuXd6zM4.js";import{D as Bs}from"./DialogContentText-B1TGQgfp.js";import{E as Ws,T as Se}from"./Edit-B8-3xxA0.js";import{S as $s}from"./ServicesTopBar-vIc4h4LV.js";import"./Autocomplete-CCkxwt18.js";var Oe=e=>e.type==="checkbox",Ve=e=>e instanceof Date,ee=e=>e==null;const It=e=>typeof e=="object";var K=e=>!ee(e)&&!Array.isArray(e)&&It(e)&&!Ve(e),Bt=e=>K(e)&&e.target?Oe(e.target)?e.target.checked:e.target.value:e,Hs=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Wt=(e,s)=>e.has(Hs(s)),Gs=e=>{const s=e.constructor&&e.constructor.prototype;return K(s)&&s.hasOwnProperty("isPrototypeOf")},nt=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function X(e){let s;const t=Array.isArray(e),a=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)s=new Date(e);else if(!(nt&&(e instanceof Blob||a))&&(t||K(e)))if(s=t?[]:{},!t&&!Gs(e))s=e;else for(const l in e)e.hasOwnProperty(l)&&(s[l]=X(e[l]));else return e;return s}var ze=e=>/^\w*$/.test(e),Y=e=>e===void 0,lt=e=>Array.isArray(e)?e.filter(Boolean):[],ot=e=>lt(e.replace(/["|']|\]/g,"").split(/\.|\[/)),y=(e,s,t)=>{if(!s||!K(e))return t;const a=(ze(s)?[s]:ot(s)).reduce((l,o)=>ee(l)?l:l[o],e);return Y(a)||a===e?Y(e[s])?t:e[s]:a},ae=e=>typeof e=="boolean",M=(e,s,t)=>{let a=-1;const l=ze(s)?[s]:ot(s),o=l.length,d=o-1;for(;++a<o;){const f=l[a];let A=t;if(a!==d){const g=e[f];A=K(g)||Array.isArray(g)?g:isNaN(+l[a+1])?{}:[]}if(f==="__proto__"||f==="constructor"||f==="prototype")return;e[f]=A,e=e[f]}};const Be={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ce={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},me={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},$t=q.createContext(null);$t.displayName="HookFormContext";const ct=()=>q.useContext($t);var Ht=(e,s,t,a=!0)=>{const l={defaultValues:s._defaultValues};for(const o in e)Object.defineProperty(l,o,{get:()=>{const d=o;return s._proxyFormState[d]!==ce.all&&(s._proxyFormState[d]=!a||ce.all),t&&(t[d]=!0),e[d]}});return l};const ut=typeof window<"u"?q.useLayoutEffect:q.useEffect;function zs(e){const s=ct(),{control:t=s.control,disabled:a,name:l,exact:o}=e||{},[d,f]=q.useState(t._formState),A=q.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return ut(()=>t._subscribe({name:l,formState:A.current,exact:o,callback:g=>{!a&&f({...t._formState,...g})}}),[l,a,o]),q.useEffect(()=>{A.current.isValid&&t._setValid(!0)},[t]),q.useMemo(()=>Ht(d,t,A.current,!1),[d,t])}var he=e=>typeof e=="string",Gt=(e,s,t,a,l)=>he(e)?(a&&s.watch.add(e),y(t,e,l)):Array.isArray(e)?e.map(o=>(a&&s.watch.add(o),y(t,o))):(a&&(s.watchAll=!0),t),at=e=>ee(e)||!It(e);function ge(e,s,t=new WeakSet){if(at(e)||at(s))return e===s;if(Ve(e)&&Ve(s))return e.getTime()===s.getTime();const a=Object.keys(e),l=Object.keys(s);if(a.length!==l.length)return!1;if(t.has(e)||t.has(s))return!0;t.add(e),t.add(s);for(const o of a){const d=e[o];if(!l.includes(o))return!1;if(o!=="ref"){const f=s[o];if(Ve(d)&&Ve(f)||K(d)&&K(f)||Array.isArray(d)&&Array.isArray(f)?!ge(d,f,t):d!==f)return!1}}return!0}function Ys(e){const s=ct(),{control:t=s.control,name:a,defaultValue:l,disabled:o,exact:d,compute:f}=e||{},A=q.useRef(l),g=q.useRef(f),b=q.useRef(void 0);g.current=f;const _=q.useMemo(()=>t._getWatch(a,A.current),[t,a]),[j,G]=q.useState(g.current?g.current(_):_);return ut(()=>t._subscribe({name:a,formState:{values:!0},exact:d,callback:U=>{if(!o){const F=Gt(a,t._names,U.values||t._formValues,!1,A.current);if(g.current){const W=g.current(F);ge(W,b.current)||(G(W),b.current=W)}else G(F)}}}),[t,o,a,d]),q.useEffect(()=>t._removeUnmounted()),j}function Ks(e){const s=ct(),{name:t,disabled:a,control:l=s.control,shouldUnregister:o,defaultValue:d}=e,f=Wt(l._names.array,t),A=q.useMemo(()=>y(l._formValues,t,y(l._defaultValues,t,d)),[l,t,d]),g=Ys({control:l,name:t,defaultValue:A,exact:!0}),b=zs({control:l,name:t,exact:!0}),_=q.useRef(e),j=q.useRef(l.register(t,{...e.rules,value:g,...ae(e.disabled)?{disabled:e.disabled}:{}}));_.current=e;const G=q.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!y(b.errors,t)},isDirty:{enumerable:!0,get:()=>!!y(b.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!y(b.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!y(b.validatingFields,t)},error:{enumerable:!0,get:()=>y(b.errors,t)}}),[b,t]),U=q.useCallback(S=>j.current.onChange({target:{value:Bt(S),name:t},type:Be.CHANGE}),[t]),F=q.useCallback(()=>j.current.onBlur({target:{value:y(l._formValues,t),name:t},type:Be.BLUR}),[t,l._formValues]),W=q.useCallback(S=>{const p=y(l._fields,t);p&&S&&(p._f.ref={focus:()=>S.focus&&S.focus(),select:()=>S.select&&S.select(),setCustomValidity:w=>S.setCustomValidity(w),reportValidity:()=>S.reportValidity()})},[l._fields,t]),de=q.useMemo(()=>({name:t,value:g,...ae(a)||b.disabled?{disabled:b.disabled||a}:{},onChange:U,onBlur:F,ref:W}),[t,a,b.disabled,U,F,W,g]);return q.useEffect(()=>{const S=l._options.shouldUnregister||o;l.register(t,{..._.current.rules,...ae(_.current.disabled)?{disabled:_.current.disabled}:{}});const p=(w,D)=>{const L=y(l._fields,w);L&&L._f&&(L._f.mount=D)};if(p(t,!0),S){const w=X(y(l._options.defaultValues,t));M(l._defaultValues,t,w),Y(y(l._formValues,t))&&M(l._formValues,t,w)}return!f&&l.register(t),()=>{(f?S&&!l._state.action:S)?l.unregister(t):p(t,!1)}},[t,l,f,o]),q.useEffect(()=>{l._setDisabledField({disabled:a,name:t})},[a,t,l]),q.useMemo(()=>({field:de,formState:b,fieldState:G}),[de,b,G])}const fe=e=>e.render(Ks(e));var zt=(e,s,t,a,l)=>s?{...t[e],types:{...t[e]&&t[e].types?t[e].types:{},[a]:l||!0}}:{},Le=e=>Array.isArray(e)?e:[e],At=()=>{let e=[];return{get observers(){return e},next:l=>{for(const o of e)o.next&&o.next(l)},subscribe:l=>(e.push(l),{unsubscribe:()=>{e=e.filter(o=>o!==l)}}),unsubscribe:()=>{e=[]}}},te=e=>K(e)&&!Object.keys(e).length,dt=e=>e.type==="file",ue=e=>typeof e=="function",We=e=>{if(!nt)return!1;const s=e?e.ownerDocument:0;return e instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},Yt=e=>e.type==="select-multiple",ft=e=>e.type==="radio",Qs=e=>ft(e)||Oe(e),st=e=>We(e)&&e.isConnected;function Xs(e,s){const t=s.slice(0,-1).length;let a=0;for(;a<t;)e=Y(e)?a++:e[s[a++]];return e}function Zs(e){for(const s in e)if(e.hasOwnProperty(s)&&!Y(e[s]))return!1;return!0}function Q(e,s){const t=Array.isArray(s)?s:ze(s)?[s]:ot(s),a=t.length===1?e:Xs(e,t),l=t.length-1,o=t[l];return a&&delete a[o],l!==0&&(K(a)&&te(a)||Array.isArray(a)&&Zs(a))&&Q(e,t.slice(0,-1)),e}var Kt=e=>{for(const s in e)if(ue(e[s]))return!0;return!1};function $e(e,s={}){const t=Array.isArray(e);if(K(e)||t)for(const a in e)Array.isArray(e[a])||K(e[a])&&!Kt(e[a])?(s[a]=Array.isArray(e[a])?[]:{},$e(e[a],s[a])):ee(e[a])||(s[a]=!0);return s}function Qt(e,s,t){const a=Array.isArray(e);if(K(e)||a)for(const l in e)Array.isArray(e[l])||K(e[l])&&!Kt(e[l])?Y(s)||at(t[l])?t[l]=Array.isArray(e[l])?$e(e[l],[]):{...$e(e[l])}:Qt(e[l],ee(s)?{}:s[l],t[l]):t[l]=!ge(e[l],s[l]);return t}var Ce=(e,s)=>Qt(e,s,$e(s));const Ct={value:!1,isValid:!1},Ft={value:!0,isValid:!0};var Xt=e=>{if(Array.isArray(e)){if(e.length>1){const s=e.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:s,isValid:!!s.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Y(e[0].attributes.value)?Y(e[0].value)||e[0].value===""?Ft:{value:e[0].value,isValid:!0}:Ft:Ct}return Ct},Zt=(e,{valueAsNumber:s,valueAsDate:t,setValueAs:a})=>Y(e)?e:s?e===""?NaN:e&&+e:t&&he(e)?new Date(e):a?a(e):e;const Dt={isValid:!1,value:null};var Jt=e=>Array.isArray(e)?e.reduce((s,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:s,Dt):Dt;function kt(e){const s=e.ref;return dt(s)?s.files:ft(s)?Jt(e.refs).value:Yt(s)?[...s.selectedOptions].map(({value:t})=>t):Oe(s)?Xt(e.refs).value:Zt(Y(s.value)?e.ref.value:s.value,e)}var Js=(e,s,t,a)=>{const l={};for(const o of e){const d=y(s,o);d&&M(l,o,d._f)}return{criteriaMode:t,names:[...e],fields:l,shouldUseNativeValidation:a}},He=e=>e instanceof RegExp,Fe=e=>Y(e)?e:He(e)?e.source:K(e)?He(e.value)?e.value.source:e.value:e,wt=e=>({isOnSubmit:!e||e===ce.onSubmit,isOnBlur:e===ce.onBlur,isOnChange:e===ce.onChange,isOnAll:e===ce.all,isOnTouch:e===ce.onTouched});const qt="AsyncFunction";var er=e=>!!e&&!!e.validate&&!!(ue(e.validate)&&e.validate.constructor.name===qt||K(e.validate)&&Object.values(e.validate).find(s=>s.constructor.name===qt)),tr=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),Lt=(e,s,t)=>!t&&(s.watchAll||s.watch.has(e)||[...s.watch].some(a=>e.startsWith(a)&&/^\.\w+/.test(e.slice(a.length))));const Te=(e,s,t,a)=>{for(const l of t||Object.keys(e)){const o=y(e,l);if(o){const{_f:d,...f}=o;if(d){if(d.refs&&d.refs[0]&&s(d.refs[0],l)&&!a)return!0;if(d.ref&&s(d.ref,d.name)&&!a)return!0;if(Te(f,s))break}else if(K(f)&&Te(f,s))break}}};function Tt(e,s,t){const a=y(e,t);if(a||ze(t))return{error:a,name:t};const l=t.split(".");for(;l.length;){const o=l.join("."),d=y(s,o),f=y(e,o);if(d&&!Array.isArray(d)&&t!==o)return{name:t};if(f&&f.type)return{name:o,error:f};if(f&&f.root&&f.root.type)return{name:`${o}.root`,error:f.root};l.pop()}return{name:t}}var sr=(e,s,t,a)=>{t(e);const{name:l,...o}=e;return te(o)||Object.keys(o).length>=Object.keys(s).length||Object.keys(o).find(d=>s[d]===(!a||ce.all))},rr=(e,s,t)=>!e||!s||e===s||Le(e).some(a=>a&&(t?a===s:a.startsWith(s)||s.startsWith(a))),ar=(e,s,t,a,l)=>l.isOnAll?!1:!t&&l.isOnTouch?!(s||e):(t?a.isOnBlur:l.isOnBlur)?!e:(t?a.isOnChange:l.isOnChange)?e:!0,ir=(e,s)=>!lt(y(e,s)).length&&Q(e,s),nr=(e,s,t)=>{const a=Le(y(e,t));return M(a,"root",s[t]),M(e,t,a),e},Re=e=>he(e);function Ot(e,s,t="validate"){if(Re(e)||Array.isArray(e)&&e.every(Re)||ae(e)&&!e)return{type:t,message:Re(e)?e:"",ref:s}}var Ee=e=>K(e)&&!He(e)?e:{value:e,message:""},Ut=async(e,s,t,a,l,o)=>{const{ref:d,refs:f,required:A,maxLength:g,minLength:b,min:_,max:j,pattern:G,validate:U,name:F,valueAsNumber:W,mount:de}=e._f,S=y(t,F);if(!de||s.has(F))return{};const p=f?f[0]:d,w=C=>{l&&p.reportValidity&&(p.setCustomValidity(ae(C)?"":C||""),p.reportValidity())},D={},L=ft(d),P=Oe(d),re=L||P,z=(W||dt(d))&&Y(d.value)&&Y(S)||We(d)&&d.value===""||S===""||Array.isArray(S)&&!S.length,Z=zt.bind(null,F,a,D),T=(C,k,N,v=me.maxLength,u=me.minLength)=>{const E=C?k:N;D[F]={type:C?v:u,message:E,ref:d,...Z(C?v:u,E)}};if(o?!Array.isArray(S)||!S.length:A&&(!re&&(z||ee(S))||ae(S)&&!S||P&&!Xt(f).isValid||L&&!Jt(f).isValid)){const{value:C,message:k}=Re(A)?{value:!!A,message:A}:Ee(A);if(C&&(D[F]={type:me.required,message:k,ref:p,...Z(me.required,k)},!a))return w(k),D}if(!z&&(!ee(_)||!ee(j))){let C,k;const N=Ee(j),v=Ee(_);if(!ee(S)&&!isNaN(S)){const u=d.valueAsNumber||S&&+S;ee(N.value)||(C=u>N.value),ee(v.value)||(k=u<v.value)}else{const u=d.valueAsDate||new Date(S),E=H=>new Date(new Date().toDateString()+" "+H),$=d.type=="time",O=d.type=="week";he(N.value)&&S&&(C=$?E(S)>E(N.value):O?S>N.value:u>new Date(N.value)),he(v.value)&&S&&(k=$?E(S)<E(v.value):O?S<v.value:u<new Date(v.value))}if((C||k)&&(T(!!C,N.message,v.message,me.max,me.min),!a))return w(D[F].message),D}if((g||b)&&!z&&(he(S)||o&&Array.isArray(S))){const C=Ee(g),k=Ee(b),N=!ee(C.value)&&S.length>+C.value,v=!ee(k.value)&&S.length<+k.value;if((N||v)&&(T(N,C.message,k.message),!a))return w(D[F].message),D}if(G&&!z&&he(S)){const{value:C,message:k}=Ee(G);if(He(C)&&!S.match(C)&&(D[F]={type:me.pattern,message:k,ref:d,...Z(me.pattern,k)},!a))return w(k),D}if(U){if(ue(U)){const C=await U(S,t),k=Ot(C,p);if(k&&(D[F]={...k,...Z(me.validate,k.message)},!a))return w(k.message),D}else if(K(U)){let C={};for(const k in U){if(!te(C)&&!a)break;const N=Ot(await U[k](S,t),p,k);N&&(C={...N,...Z(k,N.message)},w(N.message),a&&(D[F]=C))}if(!te(C)&&(D[F]={ref:p,...C},!a))return D}}return w(!0),D};const lr={mode:ce.onSubmit,reValidateMode:ce.onChange,shouldFocusError:!0};function or(e={}){let s={...lr,...e},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ue(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},l=K(s.defaultValues)||K(s.values)?X(s.defaultValues||s.values)||{}:{},o=s.shouldUnregister?{}:X(l),d={action:!1,mount:!1,watch:!1},f={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},A,g=0;const b={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let _={...b};const j={array:At(),state:At()},G=s.criteriaMode===ce.all,U=r=>n=>{clearTimeout(g),g=setTimeout(r,n)},F=async r=>{if(!s.disabled&&(b.isValid||_.isValid||r)){const n=s.resolver?te((await P()).errors):await z(a,!0);n!==t.isValid&&j.state.next({isValid:n})}},W=(r,n)=>{!s.disabled&&(b.isValidating||b.validatingFields||_.isValidating||_.validatingFields)&&((r||Array.from(f.mount)).forEach(c=>{c&&(n?M(t.validatingFields,c,n):Q(t.validatingFields,c))}),j.state.next({validatingFields:t.validatingFields,isValidating:!te(t.validatingFields)}))},de=(r,n=[],c,x,m=!0,h=!0)=>{if(x&&c&&!s.disabled){if(d.action=!0,h&&Array.isArray(y(a,r))){const V=c(y(a,r),x.argA,x.argB);m&&M(a,r,V)}if(h&&Array.isArray(y(t.errors,r))){const V=c(y(t.errors,r),x.argA,x.argB);m&&M(t.errors,r,V),ir(t.errors,r)}if((b.touchedFields||_.touchedFields)&&h&&Array.isArray(y(t.touchedFields,r))){const V=c(y(t.touchedFields,r),x.argA,x.argB);m&&M(t.touchedFields,r,V)}(b.dirtyFields||_.dirtyFields)&&(t.dirtyFields=Ce(l,o)),j.state.next({name:r,isDirty:T(r,n),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else M(o,r,n)},S=(r,n)=>{M(t.errors,r,n),j.state.next({errors:t.errors})},p=r=>{t.errors=r,j.state.next({errors:t.errors,isValid:!1})},w=(r,n,c,x)=>{const m=y(a,r);if(m){const h=y(o,r,Y(c)?y(l,r):c);Y(h)||x&&x.defaultChecked||n?M(o,r,n?h:kt(m._f)):N(r,h),d.mount&&F()}},D=(r,n,c,x,m)=>{let h=!1,V=!1;const R={name:r};if(!s.disabled){if(!c||x){(b.isDirty||_.isDirty)&&(V=t.isDirty,t.isDirty=R.isDirty=T(),h=V!==R.isDirty);const I=ge(y(l,r),n);V=!!y(t.dirtyFields,r),I?Q(t.dirtyFields,r):M(t.dirtyFields,r,!0),R.dirtyFields=t.dirtyFields,h=h||(b.dirtyFields||_.dirtyFields)&&V!==!I}if(c){const I=y(t.touchedFields,r);I||(M(t.touchedFields,r,c),R.touchedFields=t.touchedFields,h=h||(b.touchedFields||_.touchedFields)&&I!==c)}h&&m&&j.state.next(R)}return h?R:{}},L=(r,n,c,x)=>{const m=y(t.errors,r),h=(b.isValid||_.isValid)&&ae(n)&&t.isValid!==n;if(s.delayError&&c?(A=U(()=>S(r,c)),A(s.delayError)):(clearTimeout(g),A=null,c?M(t.errors,r,c):Q(t.errors,r)),(c?!ge(m,c):m)||!te(x)||h){const V={...x,...h&&ae(n)?{isValid:n}:{},errors:t.errors,name:r};t={...t,...V},j.state.next(V)}},P=async r=>{W(r,!0);const n=await s.resolver(o,s.context,Js(r||f.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return W(r),n},re=async r=>{const{errors:n}=await P(r);if(r)for(const c of r){const x=y(n,c);x?M(t.errors,c,x):Q(t.errors,c)}else t.errors=n;return n},z=async(r,n,c={valid:!0})=>{for(const x in r){const m=r[x];if(m){const{_f:h,...V}=m;if(h){const R=f.array.has(h.name),I=m._f&&er(m._f);I&&b.validatingFields&&W([x],!0);const ie=await Ut(m,f.disabled,o,G,s.shouldUseNativeValidation&&!n,R);if(I&&b.validatingFields&&W([x]),ie[h.name]&&(c.valid=!1,n))break;!n&&(y(ie,h.name)?R?nr(t.errors,ie,h.name):M(t.errors,h.name,ie[h.name]):Q(t.errors,h.name))}!te(V)&&await z(V,n,c)}}return c.valid},Z=()=>{for(const r of f.unMount){const n=y(a,r);n&&(n._f.refs?n._f.refs.every(c=>!st(c)):!st(n._f.ref))&&Ye(r)}f.unMount=new Set},T=(r,n)=>!s.disabled&&(r&&n&&M(o,r,n),!ge(H(),l)),C=(r,n,c)=>Gt(r,f,{...d.mount?o:Y(n)?l:he(r)?{[r]:n}:n},c,n),k=r=>lt(y(d.mount?o:l,r,s.shouldUnregister?y(l,r,[]):[])),N=(r,n,c={})=>{const x=y(a,r);let m=n;if(x){const h=x._f;h&&(!h.disabled&&M(o,r,Zt(n,h)),m=We(h.ref)&&ee(n)?"":n,Yt(h.ref)?[...h.ref.options].forEach(V=>V.selected=m.includes(V.value)):h.refs?Oe(h.ref)?h.refs.forEach(V=>{(!V.defaultChecked||!V.disabled)&&(Array.isArray(m)?V.checked=!!m.find(R=>R===V.value):V.checked=m===V.value||!!m)}):h.refs.forEach(V=>V.checked=V.value===m):dt(h.ref)?h.ref.value="":(h.ref.value=m,h.ref.type||j.state.next({name:r,values:X(o)})))}(c.shouldDirty||c.shouldTouch)&&D(r,m,c.shouldTouch,c.shouldDirty,!0),c.shouldValidate&&O(r)},v=(r,n,c)=>{for(const x in n){if(!n.hasOwnProperty(x))return;const m=n[x],h=r+"."+x,V=y(a,h);(f.array.has(r)||K(m)||V&&!V._f)&&!Ve(m)?v(h,m,c):N(h,m,c)}},u=(r,n,c={})=>{const x=y(a,r),m=f.array.has(r),h=X(n);M(o,r,h),m?(j.array.next({name:r,values:X(o)}),(b.isDirty||b.dirtyFields||_.isDirty||_.dirtyFields)&&c.shouldDirty&&j.state.next({name:r,dirtyFields:Ce(l,o),isDirty:T(r,h)})):x&&!x._f&&!ee(h)?v(r,h,c):N(r,h,c),Lt(r,f)&&j.state.next({...t,name:r}),j.state.next({name:d.mount?r:void 0,values:X(o)})},E=async r=>{d.mount=!0;const n=r.target;let c=n.name,x=!0;const m=y(a,c),h=I=>{x=Number.isNaN(I)||Ve(I)&&isNaN(I.getTime())||ge(I,y(o,c,I))},V=wt(s.mode),R=wt(s.reValidateMode);if(m){let I,ie;const Ue=n.type?kt(m._f):Bt(r),xe=r.type===Be.BLUR||r.type===Be.FOCUS_OUT,ls=!tr(m._f)&&!s.resolver&&!y(t.errors,c)&&!m._f.deps||ar(xe,y(t.touchedFields,c),t.isSubmitted,R,V),Xe=Lt(c,f,xe);M(o,c,Ue),xe?(m._f.onBlur&&m._f.onBlur(r),A&&A(0)):m._f.onChange&&m._f.onChange(r);const Ze=D(c,Ue,xe),os=!te(Ze)||Xe;if(!xe&&j.state.next({name:c,type:r.type,values:X(o)}),ls)return(b.isValid||_.isValid)&&(s.mode==="onBlur"?xe&&F():xe||F()),os&&j.state.next({name:c,...Xe?{}:Ze});if(!xe&&Xe&&j.state.next({...t}),s.resolver){const{errors:bt}=await P([c]);if(h(Ue),x){const cs=Tt(t.errors,a,c),_t=Tt(bt,a,cs.name||c);I=_t.error,c=_t.name,ie=te(bt)}}else W([c],!0),I=(await Ut(m,f.disabled,o,G,s.shouldUseNativeValidation))[c],W([c]),h(Ue),x&&(I?ie=!1:(b.isValid||_.isValid)&&(ie=await z(a,!0)));x&&(m._f.deps&&O(m._f.deps),L(c,ie,I,Ze))}},$=(r,n)=>{if(y(t.errors,n)&&r.focus)return r.focus(),1},O=async(r,n={})=>{let c,x;const m=Le(r);if(s.resolver){const h=await re(Y(r)?r:m);c=te(h),x=r?!m.some(V=>y(h,V)):c}else r?(x=(await Promise.all(m.map(async h=>{const V=y(a,h);return await z(V&&V._f?{[h]:V}:V)}))).every(Boolean),!(!x&&!t.isValid)&&F()):x=c=await z(a);return j.state.next({...!he(r)||(b.isValid||_.isValid)&&c!==t.isValid?{}:{name:r},...s.resolver||!r?{isValid:c}:{},errors:t.errors}),n.shouldFocus&&!x&&Te(a,$,r?m:f.mount),x},H=r=>{const n={...d.mount?o:l};return Y(r)?n:he(r)?y(n,r):r.map(c=>y(n,c))},oe=(r,n)=>({invalid:!!y((n||t).errors,r),isDirty:!!y((n||t).dirtyFields,r),error:y((n||t).errors,r),isValidating:!!y(t.validatingFields,r),isTouched:!!y((n||t).touchedFields,r)}),Ae=r=>{r&&Le(r).forEach(n=>Q(t.errors,n)),j.state.next({errors:r?t.errors:{}})},ht=(r,n,c)=>{const x=(y(a,r,{_f:{}})._f||{}).ref,m=y(t.errors,r)||{},{ref:h,message:V,type:R,...I}=m;M(t.errors,r,{...I,...n,ref:x}),j.state.next({name:r,errors:t.errors,isValid:!1}),c&&c.shouldFocus&&x&&x.focus&&x.focus()},ts=(r,n)=>ue(r)?j.state.subscribe({next:c=>"values"in c&&r(C(void 0,n),c)}):C(r,n,!0),mt=r=>j.state.subscribe({next:n=>{rr(r.name,n.name,r.exact)&&sr(n,r.formState||b,ns,r.reRenderRoot)&&r.callback({values:{...o},...t,...n,defaultValues:l})}}).unsubscribe,ss=r=>(d.mount=!0,_={..._,...r.formState},mt({...r,formState:_})),Ye=(r,n={})=>{for(const c of r?Le(r):f.mount)f.mount.delete(c),f.array.delete(c),n.keepValue||(Q(a,c),Q(o,c)),!n.keepError&&Q(t.errors,c),!n.keepDirty&&Q(t.dirtyFields,c),!n.keepTouched&&Q(t.touchedFields,c),!n.keepIsValidating&&Q(t.validatingFields,c),!s.shouldUnregister&&!n.keepDefaultValue&&Q(l,c);j.state.next({values:X(o)}),j.state.next({...t,...n.keepDirty?{isDirty:T()}:{}}),!n.keepIsValid&&F()},yt=({disabled:r,name:n})=>{(ae(r)&&d.mount||r||f.disabled.has(n))&&(r?f.disabled.add(n):f.disabled.delete(n))},Ke=(r,n={})=>{let c=y(a,r);const x=ae(n.disabled)||ae(s.disabled);return M(a,r,{...c||{},_f:{...c&&c._f?c._f:{ref:{name:r}},name:r,mount:!0,...n}}),f.mount.add(r),c?yt({disabled:ae(n.disabled)?n.disabled:s.disabled,name:r}):w(r,!0,n.value),{...x?{disabled:n.disabled||s.disabled}:{},...s.progressive?{required:!!n.required,min:Fe(n.min),max:Fe(n.max),minLength:Fe(n.minLength),maxLength:Fe(n.maxLength),pattern:Fe(n.pattern)}:{},name:r,onChange:E,onBlur:E,ref:m=>{if(m){Ke(r,n),c=y(a,r);const h=Y(m.value)&&m.querySelectorAll&&m.querySelectorAll("input,select,textarea")[0]||m,V=Qs(h),R=c._f.refs||[];if(V?R.find(I=>I===h):h===c._f.ref)return;M(a,r,{_f:{...c._f,...V?{refs:[...R.filter(st),h,...Array.isArray(y(l,r))?[{}]:[]],ref:{type:h.type,name:r}}:{ref:h}}}),w(r,!1,void 0,h)}else c=y(a,r,{}),c._f&&(c._f.mount=!1),(s.shouldUnregister||n.shouldUnregister)&&!(Wt(f.array,r)&&d.action)&&f.unMount.add(r)}}},Qe=()=>s.shouldFocusError&&Te(a,$,f.mount),rs=r=>{ae(r)&&(j.state.next({disabled:r}),Te(a,(n,c)=>{const x=y(a,c);x&&(n.disabled=x._f.disabled||r,Array.isArray(x._f.refs)&&x._f.refs.forEach(m=>{m.disabled=x._f.disabled||r}))},0,!1))},gt=(r,n)=>async c=>{let x;c&&(c.preventDefault&&c.preventDefault(),c.persist&&c.persist());let m=X(o);if(j.state.next({isSubmitting:!0}),s.resolver){const{errors:h,values:V}=await P();t.errors=h,m=X(V)}else await z(a);if(f.disabled.size)for(const h of f.disabled)Q(m,h);if(Q(t.errors,"root"),te(t.errors)){j.state.next({errors:{}});try{await r(m,c)}catch(h){x=h}}else n&&await n({...t.errors},c),Qe(),setTimeout(Qe);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:te(t.errors)&&!x,submitCount:t.submitCount+1,errors:t.errors}),x)throw x},as=(r,n={})=>{y(a,r)&&(Y(n.defaultValue)?u(r,X(y(l,r))):(u(r,n.defaultValue),M(l,r,X(n.defaultValue))),n.keepTouched||Q(t.touchedFields,r),n.keepDirty||(Q(t.dirtyFields,r),t.isDirty=n.defaultValue?T(r,X(y(l,r))):T()),n.keepError||(Q(t.errors,r),b.isValid&&F()),j.state.next({...t}))},xt=(r,n={})=>{const c=r?X(r):l,x=X(c),m=te(r),h=m?l:x;if(n.keepDefaultValues||(l=c),!n.keepValues){if(n.keepDirtyValues){const V=new Set([...f.mount,...Object.keys(Ce(l,o))]);for(const R of Array.from(V))y(t.dirtyFields,R)?M(h,R,y(o,R)):u(R,y(h,R))}else{if(nt&&Y(r))for(const V of f.mount){const R=y(a,V);if(R&&R._f){const I=Array.isArray(R._f.refs)?R._f.refs[0]:R._f.ref;if(We(I)){const ie=I.closest("form");if(ie){ie.reset();break}}}}if(n.keepFieldsRef)for(const V of f.mount)u(V,y(h,V));else a={}}o=s.shouldUnregister?n.keepDefaultValues?X(l):{}:X(h),j.array.next({values:{...h}}),j.state.next({values:{...h}})}f={mount:n.keepDirtyValues?f.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},d.mount=!b.isValid||!!n.keepIsValid||!!n.keepDirtyValues,d.watch=!!s.shouldUnregister,j.state.next({submitCount:n.keepSubmitCount?t.submitCount:0,isDirty:m?!1:n.keepDirty?t.isDirty:!!(n.keepDefaultValues&&!ge(r,l)),isSubmitted:n.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:m?{}:n.keepDirtyValues?n.keepDefaultValues&&o?Ce(l,o):t.dirtyFields:n.keepDefaultValues&&r?Ce(l,r):n.keepDirty?t.dirtyFields:{},touchedFields:n.keepTouched?t.touchedFields:{},errors:n.keepErrors?t.errors:{},isSubmitSuccessful:n.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},pt=(r,n)=>xt(ue(r)?r(o):r,n),is=(r,n={})=>{const c=y(a,r),x=c&&c._f;if(x){const m=x.refs?x.refs[0]:x.ref;m.focus&&(m.focus(),n.shouldSelect&&ue(m.select)&&m.select())}},ns=r=>{t={...t,...r}},vt={control:{register:Ke,unregister:Ye,getFieldState:oe,handleSubmit:gt,setError:ht,_subscribe:mt,_runSchema:P,_focusError:Qe,_getWatch:C,_getDirty:T,_setValid:F,_setFieldArray:de,_setDisabledField:yt,_setErrors:p,_getFieldArray:k,_reset:xt,_resetDefaultValues:()=>ue(s.defaultValues)&&s.defaultValues().then(r=>{pt(r,s.resetOptions),j.state.next({isLoading:!1})}),_removeUnmounted:Z,_disableForm:rs,_subjects:j,_proxyFormState:b,get _fields(){return a},get _formValues(){return o},get _state(){return d},set _state(r){d=r},get _defaultValues(){return l},get _names(){return f},set _names(r){f=r},get _formState(){return t},get _options(){return s},set _options(r){s={...s,...r}}},subscribe:ss,trigger:O,register:Ke,handleSubmit:gt,watch:ts,setValue:u,getValues:H,reset:pt,resetField:as,clearErrors:Ae,unregister:Ye,setError:ht,setFocus:is,getFieldState:oe};return{...vt,formControl:vt}}function cr(e={}){const s=q.useRef(void 0),t=q.useRef(void 0),[a,l]=q.useState({isDirty:!1,isValidating:!1,isLoading:ue(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:ue(e.defaultValues)?void 0:e.defaultValues});if(!s.current)if(e.formControl)s.current={...e.formControl,formState:a},e.defaultValues&&!ue(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:d,...f}=or(e);s.current={...f,formState:a}}const o=s.current.control;return o._options=e,ut(()=>{const d=o._subscribe({formState:o._proxyFormState,callback:()=>l({...o._formState}),reRenderRoot:!0});return l(f=>({...f,isReady:!0})),o._formState.isReady=!0,d},[o]),q.useEffect(()=>o._disableForm(e.disabled),[o,e.disabled]),q.useEffect(()=>{e.mode&&(o._options.mode=e.mode),e.reValidateMode&&(o._options.reValidateMode=e.reValidateMode)},[o,e.mode,e.reValidateMode]),q.useEffect(()=>{e.errors&&(o._setErrors(e.errors),o._focusError())},[o,e.errors]),q.useEffect(()=>{e.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,e.shouldUnregister]),q.useEffect(()=>{if(o._proxyFormState.isDirty){const d=o._getDirty();d!==a.isDirty&&o._subjects.state.next({isDirty:d})}},[o,a.isDirty]),q.useEffect(()=>{e.values&&!ge(e.values,t.current)?(o._reset(e.values,{keepFieldsRef:!0,...o._options.resetOptions}),t.current=e.values,l(d=>({...d}))):o._resetDefaultValues()},[o,e.values]),q.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),s.current.formState=Ht(a,o),s.current}const Pt=(e,s,t)=>{if(e&&"reportValidity"in e){const a=y(t,s);e.setCustomValidity(a&&a.message||""),e.reportValidity()}},es=(e,s)=>{for(const t in s.fields){const a=s.fields[t];a&&a.ref&&"reportValidity"in a.ref?Pt(a.ref,t,e):a.refs&&a.refs.forEach(l=>Pt(l,t,e))}},ur=(e,s)=>{s.shouldUseNativeValidation&&es(e,s);const t={};for(const a in e){const l=y(s.fields,a),o=Object.assign(e[a]||{},{ref:l&&l.ref});if(dr(s.names||Object.keys(e),a)){const d=Object.assign({},y(t,a));M(d,"root",o),M(t,a,d)}else M(t,a,o)}return t},dr=(e,s)=>e.some(t=>t.startsWith(s+"."));function fr(e,s,t){return s===void 0&&(s={}),t===void 0&&(t={}),function(a,l,o){try{return Promise.resolve(function(d,f){try{var A=(s.context,Promise.resolve(e[t.mode==="sync"?"validateSync":"validate"](a,Object.assign({abortEarly:!1},s,{context:l}))).then(function(g){return o.shouldUseNativeValidation&&es({},o),{values:t.raw?a:g,errors:{}}}))}catch(g){return f(g)}return A&&A.then?A.then(void 0,f):A}(0,function(d){if(!d.inner)throw d;return{values:{},errors:ur((f=d,A=!o.shouldUseNativeValidation&&o.criteriaMode==="all",(f.inner||[]).reduce(function(g,b){if(g[b.path]||(g[b.path]={message:b.message,type:b.type}),A){var _=g[b.path].types,j=_&&_[b.type];g[b.path]=zt(b.path,A,g,b.type,j?[].concat(j,b.message):b.message)}return g},{})),o)};var f,A}))}catch(d){return Promise.reject(d)}}}const hr=Ns().shape({name:_e().required("Name is required"),vehicle_model:Et().required("Vehicle model is required"),operator:_e().required("Operator is required"),equipment_type:_e().required("Equipment type is required"),serial_no:_e().required("Serial No is required."),chassis_no:_e().required("Chassis No is required."),odometer:Et().required("Odometer is required."),status:_e().required("Status is required"),oem:_e().required("OEM is required"),attachment:Is().nullable()});function mr(){var N;const{handleSubmit:e,control:s,formState:{errors:t},reset:a}=cr({resolver:fr(hr),defaultValues:{name:"",vehicle_model:"",operator:"",equipment_type:"",serial_no:"",chassis_no:"",odometer:"",status:"Assigned",oem:"",attachment:null}}),[l,o]=B.useState([]),{oemList:d,userList:f,equipmentTypes:A,UpdatedEqipmentData:g,isUpdateEqipment:b,isAddEqipment:_}=je(v=>v.equipment),[j,G]=B.useState(null),[U,F]=B.useState(null),[W,de]=B.useState(""),[S,p]=B.useState(null),[w,D]=B.useState("Upload Attachment"),L=Ge();B.useEffect(()=>{console.log("equipmentTypes",A)},[A]),B.useEffect(()=>{if(console.log("UpdatedEqipmentData",g),g){a({name:g.name,vehicle_model:g.vehicle_model.id,operator:g.operator.id,equipment_type:g.equipment_type.id,serial_no:g.serial_no,chassis_no:g.chassis_no,odometer:g.odometer,status:g.status,oem:g.vehicle_model.oem,attachment:g.attachment});let v=[];v.push(g.vehicle_model),o(v),F(g.operator.id),p(g.attachment),D("edit")}},[g,a]);const P=async v=>{console.log("form data",v);const u=new FormData;if(Object.keys(v).forEach(E=>{const $=v[E]==null?"":v[E];u.append(E,$)}),!g)L(hs(u)).unwrap().then(()=>{le.success("Equipment added successfully"),a(),L(Me())}).catch(E=>{var $,O;le.error("Failed to add equipment"),console.error("Error adding equipment:",E),(($=E==null?void 0:E.attachment)==null?void 0:$.length)>0&&E.attachment.map(H=>le.error(`Error: ${H}`)),((O=E==null?void 0:E.name)==null?void 0:O.length)>0&&E.name.map(H=>le.error(`Error: ${H}`))});else{const E=g.id;if(console.log("payload in action",u),typeof v.attachment=="string"){let O=await ms(v.attachment);console.log("file conversion",O),v.attachment=O}let $=new FormData;Object.keys(v).forEach(O=>{O==="attachment"&&v.attachment instanceof Blob?$.append(O,v.attachment,"attachment.jpg"):$.append(O,v[O])});for(let[O,H]of $.entries())console.log(O,H);L(ys({formData:$,id:E})).unwrap().then(()=>{le.success("Equipment updated successfully"),a(),L(Me()),L(qe(null)),L(Ne(!1)),L(Ie(!1))}).catch(O=>{var H,oe;le.error("Failed to update equipment"),console.error("Error updating equipment:",O),((H=O==null?void 0:O.attachment)==null?void 0:H.length)>0&&O.attachment.map(Ae=>le.error(`Error: ${Ae}`)),((oe=O==null?void 0:O.name)==null?void 0:oe.length)>0&&O.name.map(Ae=>le.error(`Error: ${Ae}`))})}},re=async v=>{try{const u=await L(gs({oem_id:v}));u!=null&&u.payload&&o(u.payload.map(E=>({id:E.id,name:E.name,oem:E.oem})))}catch(u){console.error("Error while getting submodels:",u)}},z=v=>G(v.currentTarget),Z=()=>{L(qe(null)),G(null)},T=f==null?void 0:f.filter(v=>`${v.first_name} ${v.last_name}`.toLowerCase().includes(W.toLowerCase())),C=v=>{F(v),Z()},k=()=>{L(Ie(!1)),L(Ne(!1)),L(qe(null)),console.log("Form Canceled")};return i.jsxs(se,{component:"form",onSubmit:e(P),sx:{p:3,backgroundColor:"#fff",borderRadius:2,boxShadow:3},children:[i.jsx(Je,{variant:"h6",sx:{mb:2},children:"Add New Equipment"}),i.jsxs(ne,{container:!0,spacing:2,children:[i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"name",control:s,render:({field:v})=>{var u;return i.jsx(Pe,{...v,label:"Name",fullWidth:!0,variant:"outlined",error:!!t.name,helperText:(u=t.name)==null?void 0:u.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"oem",control:s,render:({field:v})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.oem,children:[i.jsx(ke,{children:"OEM"}),i.jsxs(we,{...v,label:"OEM",onChange:u=>{v.onChange(u.target.value),re(u.target.value)},children:[i.jsx(ye,{value:"",children:"Select OEM"}),d==null?void 0:d.map((u,E)=>i.jsx(ye,{value:u.id,children:u.name},E))]})]})})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"vehicle_model",control:s,render:({field:v})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.vehicle_model,children:[i.jsx(ke,{children:"Vehicle Model"}),i.jsx(we,{...v,label:"Vehicle Model",children:l.map(u=>i.jsx(ye,{value:u.id,children:u.name},u.id))})]})})}),i.jsxs(ne,{item:!0,xs:12,sm:6,children:[i.jsx(fe,{name:"operator",control:s,render:({field:v})=>i.jsxs(i.Fragment,{children:[i.jsx(be,{fullWidth:!0,onClick:z,sx:{textAlign:"left",border:1,p:1.5},children:U?`${U.first_name} ${U.last_name}`:"Select Operator"}),i.jsx(us,{open:!!j,anchorEl:j,onClose:Z,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},PaperProps:{sx:{maxHeight:300,overflowY:"auto"}},children:i.jsxs(ds,{children:[i.jsx(et,{children:i.jsx(fs,{autoFocus:!0,placeholder:"Search user",fullWidth:!0,value:W,onChange:u=>de(u.target.value)})}),T.length>0?T.map((u,E)=>i.jsx(et,{button:!0,onClick:()=>{C(u),v.onChange(u.id)},children:i.jsx(Vt,{primary:`${u.first_name} ${u.last_name}`,secondary:u.email})},E)):i.jsx(et,{children:i.jsx(Vt,{primary:"No Operator found"})})]})})]})}),i.jsx(Je,{variant:"caption",color:"error",children:(N=t.operator)==null?void 0:N.message})]}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"equipment_type",control:s,render:({field:v})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.equipment_type,children:[i.jsx(ke,{children:"Equipment Types"}),i.jsxs(we,{...v,label:"Equipment Type",onChange:u=>{v.onChange(u.target.value)},children:[i.jsx(ye,{value:"",children:"Select Equipment Type"}),A==null?void 0:A.map((u,E)=>i.jsx(ye,{value:u.id,children:u.name},E))]})]})})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"serial_no",control:s,render:({field:v})=>{var u;return i.jsx(Pe,{...v,label:"Serial Number",fullWidth:!0,variant:"outlined",error:!!t.serial_no,helperText:(u=t.serial_no)==null?void 0:u.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"chassis_no",control:s,render:({field:v})=>{var u;return i.jsx(Pe,{...v,label:"Chassis Number",fullWidth:!0,variant:"outlined",error:!!t.chassis_no,helperText:(u=t.chassis_no)==null?void 0:u.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"odometer",control:s,render:({field:v})=>{var u;return i.jsx(Pe,{...v,label:"Odometer",fullWidth:!0,type:"number",variant:"outlined",error:!!t.odometer,helperText:(u=t.odometer)==null?void 0:u.message})}})}),i.jsx(ne,{item:!0,xs:12,sm:6,children:i.jsx(fe,{name:"status",control:s,render:({field:v})=>i.jsxs(De,{fullWidth:!0,variant:"outlined",error:!!t.status,children:[i.jsx(ke,{children:"Status"}),i.jsxs(we,{...v,label:"Status",children:[i.jsx(ye,{value:"Assigned",children:"Assigned"}),i.jsx(ye,{value:"Unassigned",children:"Unassigned"})]})]})})}),i.jsxs(ne,{item:!0,xs:12,sm:6,children:[i.jsx(fe,{name:"attachment",control:s,render:({field:v})=>i.jsxs(be,{variant:"outlined",component:"label",fullWidth:!0,children:[w,i.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:u=>{const E=u.target.files[0];if(v.onChange(E),E){const $=URL.createObjectURL(E);p($),D(E.name)}}})]})}),S&&i.jsxs(se,{mt:2,textAlign:"center",children:[i.jsx(Je,{variant:"subtitle1",children:"Uploaded Image:"}),i.jsx("img",{src:S,alt:"Preview",style:{width:"100%",maxHeight:"300px",objectFit:"contain"}})]})]}),i.jsxs(ne,{item:!0,xs:12,children:[i.jsx(be,{color:"primary",sx:{marginRight:"10px",border:"1px solid #f6f6f6"},onClick:k,children:"Cancel"}),i.jsx(be,{variant:"contained",color:"primary",type:"submit",children:g?"Update":"Submit"})]})]})]})}const yr=({open:e,onClose:s,onConfirm:t})=>i.jsxs(Rt,{open:e,onClose:s,children:[i.jsx(Mt,{children:"Confirm Deletion"}),i.jsx(Nt,{children:i.jsxs(Bs,{children:["Are you sure you want to delete this vehicle data?"," ",i.jsx("span",{style:{color:"red"},children:"This action cannot be undone."})]})}),i.jsxs(xs,{children:[i.jsx(be,{onClick:s,color:"primary",children:"Cancel"}),i.jsx(be,{onClick:t,color:"secondary",children:"Delete"})]})]}),gr="https://cc.wikitrak.in/api-proxy/api/v1",xr={display:"flex",alignItems:"left",justifyContent:"left",gap:"8px"},pr=({equipmentData:e})=>{const s=Ge(),{isUpdateEqipment:t}=je(g=>g.equipment),[a,l]=B.useState(!1),o=()=>{console.log("equipmentData",e),localStorage.getItem("role"),s(Ie(!t)),s(qe(e))},d=async()=>{console.log("Vehicle data deleting");try{await ps.delete(`${gr}/vehicles/delete/${vehicleData.id}/`),le.success("Vehicle data deleted successfully!"),s(Me())}catch(g){console.error("Error deleting vehicle data:",g),le.error("Failed to delete vehicle data. Please try again.")}l(!1)},f=()=>{l(!1)},A={color:"#686868"};return i.jsxs(se,{sx:xr,children:[i.jsx(it,{onClick:o,children:i.jsx(Ws,{sx:A})}),i.jsx(yr,{open:a,onClose:f,onConfirm:d})]})},vr=[{id:"all",name:"All"},{id:"assigned",name:"Assigned"},{id:"unassigned",name:"Unassigned"}],br={assigned:!1,unAssgined:!1,all:!0},_r=()=>{const{isAddEqipment:e,equipmentTypes:s,isUpdateEqipment:t}=je(U=>U.equipment),[a,l]=B.useState(""),[o,d]=B.useState(br),[f,A]=B.useState("");let g=Ge();const b=()=>{g(Ne(!e))},_=()=>{g(Ne(!1)),g(Ie(!1)),g(qe(null))},j=U=>{console.log("equipment type selected",U),l(U.id)},G=U=>{const F={assigned:U.id==="assigned",unassigned:U.id==="unassigned",all:U.id==="all"};d(F)};return i.jsxs(se,{sx:{bgcolor:"white",height:"89vh",m:"15px",borderRadius:"10px"},children:[i.jsx(Vr,{handleAdd:b,handleFilters:G,appliedFilters:o}),i.jsx(tt,{}),i.jsxs(se,{sx:{display:"flex",width:"100%",gap:"30px",padding:"10px"},children:[i.jsx(jr,{searchQuery:f,setSearchQuery:A}),i.jsx(Sr,{equipmentTypes:s,handleOnChange:j,selectedValue:a})]}),i.jsx(tt,{}),i.jsx(Er,{appliedFilters:o,selectedEquipmentType:a,searchQuery:f}),i.jsx(tt,{}),i.jsxs(Rt,{open:e||t,onClose:_,maxWidth:"md",fullWidth:!0,children:[i.jsx(Mt,{children:i.jsx(it,{"aria-label":"close",onClick:_,sx:{position:"absolute",right:8,top:8,color:U=>U.palette.grey[500]},children:i.jsx(vs,{})})}),i.jsx(Nt,{children:i.jsx(mr,{})})]})]})},Vr=({handleAdd:e,handleFilters:s,appliedFilters:t})=>i.jsxs(se,{sx:{display:"flex",justifyContent:"space-between",padding:"10px"},children:[i.jsx(se,{children:vr.map(a=>i.jsx(be,{onClick:()=>{s(a)},sx:{background:t[a.id]?"lightblue":"transparent",color:t[a.id]?"white":"black",ml:"3px","&:hover":{background:t[a.id]?rt.bgColor:"lightgrey"}},children:a.name},a.id))}),i.jsxs(be,{onClick:e,sx:{color:"black",background:rt.bgColor},children:[i.jsx(Ms,{}),"Equipment"]})]}),jr=({setSearchQuery:e,searchQuery:s})=>i.jsxs(se,{component:"form",border:"1px solid #000000",backgroundColor:"white",borderRadius:"20px",opacity:"75%",m:"3px",width:300,children:[i.jsx(bs,{sx:{my:.5,mx:2},placeholder:"Search equipments...",value:s,onChange:t=>e(t.target.value)}),i.jsx(it,{type:"submit",sx:{p:1},children:i.jsx(_s,{})})]}),Sr=({equipmentTypes:e,handleOnChange:s,selectedValue:t})=>i.jsx(se,{sx:{width:"200px"},children:i.jsxs(De,{fullWidth:!0,children:[i.jsx(ke,{id:"equipment-type-label",children:"Equipment Type"}),i.jsxs(we,{labelId:"equipment-type-label",id:"equipment-type-select",label:"Equipment Type",value:t,onChange:a=>{const l=e.find(o=>o.id===a.target.value);s(l||{id:"",name:"No Equipment"})},children:[i.jsx(ye,{value:"",children:"No Equipment"}),e&&e.length>0&&e.map(a=>i.jsx(ye,{value:a.id,children:a.name},a.id))]})]})}),pe={fontSize:"14px",fontWeight:"bold",fontFamily:"Ubuntu",color:"black",cursor:"pointer",background:"#f2f2f2"},ve={fontSize:"14px",padding:"10px"},Er=({appliedFilters:e,selectedEquipmentType:s,searchQuery:t})=>{const a=[5,10,25],[l,o]=B.useState(0),[d,f]=B.useState(10),{equipmentList:A}=je(p=>p.equipment),[g,b]=B.useState("asc"),[_,j]=B.useState(""),G=(p,w)=>{o(w)},U=p=>{f(parseInt(p.target.value,10)),o(0)},F=p=>{b(_===p&&g==="asc"?"desc":"asc"),j(p)},W=(p,w)=>w.split(".").reduce((D,L)=>D&&D[L],p),S=(p=>[...p].sort((w,D)=>{const L=W(w,_)||"",P=W(D,_)||"";return L<P?g==="asc"?-1:1:L>P?g==="asc"?1:-1:0}))(A.filter(p=>{var P,re,z,Z,T;const w=(e==null?void 0:e.all)||(e==null?void 0:e.assigned)&&(p==null?void 0:p.status.toLowerCase())==="assigned"||e.unassigned&&(p==null?void 0:p.status.toLowerCase())==="unassigned"||(e==null?void 0:e.archived)&&(p==null?void 0:p.archived)===!0,D=!s||((P=p==null?void 0:p.equipment_type)==null?void 0:P.id)===s,L=!t||p.name.toLowerCase().includes(t.toLowerCase())||((re=p==null?void 0:p.serial_no)==null?void 0:re.toLowerCase().includes(t.toLowerCase()))||((z=p==null?void 0:p.operator)==null?void 0:z.email)&&((Z=p==null?void 0:p.operator)==null?void 0:Z.email.toLowerCase().includes(t.toLowerCase()))||((T=p==null?void 0:p.equipment_type)==null?void 0:T.name.toLowerCase().includes(t.toLowerCase()));return w&&D&&L}));return i.jsxs(se,{children:[i.jsx(Vs,{sx:{height:"66vh",bgcolor:"white",borderRadius:"10px"},children:i.jsxs(js,{stickyHeader:!0,children:[i.jsx(Ss,{children:i.jsxs(jt,{children:[i.jsx(J,{sx:pe,children:i.jsx(Se,{active:_==="name",direction:_==="name"?g:"asc",onClick:()=>F("name"),children:"Name"})}),i.jsx(J,{sx:pe,children:i.jsx(Se,{active:_==="vehicle_model.name",direction:_==="vehicle_model.name"?g:"asc",onClick:()=>F("vehicle_model.name"),children:"Model"})}),i.jsx(J,{sx:pe,children:i.jsx(Se,{active:_==="serial_no",direction:_==="serial_no"?g:"asc",onClick:()=>F("serial_no"),children:"Serial"})}),i.jsx(J,{sx:pe,children:i.jsx(Se,{active:_==="operator.name",direction:_==="operator.name"?g:"asc",onClick:()=>F("operator.name"),children:"Operator"})}),i.jsx(J,{sx:pe,children:i.jsx(Se,{active:_==="equipment_type.name",direction:_==="equipment_type.name"?g:"asc",onClick:()=>F("equipment_type.name"),children:"Equipment Name"})}),i.jsx(J,{sx:pe,children:i.jsx(Se,{active:_==="status",direction:_==="status"?g:"asc",onClick:()=>F("status"),children:"Status"})}),i.jsx(J,{sx:pe,children:"Open Issues"}),i.jsx(J,{sx:pe,children:"Action"})]})}),i.jsx(Es,{children:S.slice(l*d,l*d+d).map((p,w)=>{var D,L,P,re,z,Z;return i.jsxs(jt,{hover:!0,children:[i.jsx(J,{sx:ve,children:p.name||"N/A"}),i.jsx(J,{sx:ve,children:((D=p.vehicle_model)==null?void 0:D.name)||"N/A"}),i.jsx(J,{sx:ve,children:p.serial_no||"N/A"}),i.jsx(J,{sx:ve,children:`${(P=(L=p.operator)==null?void 0:L.us_user)==null?void 0:P.first_name} ${(z=(re=p.operator)==null?void 0:re.us_user)==null?void 0:z.last_name}`||"N/A"}),i.jsx(J,{sx:ve,children:((Z=p.equipment_type)==null?void 0:Z.name)||"N/A"}),i.jsx(J,{sx:ve,children:p.status||"N/A"}),i.jsx(J,{sx:ve,children:w+1}),i.jsx(J,{sx:ve,children:i.jsx(pr,{equipmentData:p})})]},w)})})]})}),i.jsx(As,{component:"div",rowsPerPageOptions:a,count:S.length,rowsPerPage:d,page:l,onPageChange:G,onRowsPerPageChange:U,sx:{bgcolor:"white",borderTop:"1px solid #e0e0e0",boxShadow:"0px -2px 5px rgba(0,0,0,0.1)",mt:1,borderRadius:"0 0 10px 10px"}})]})};function Pr(){const{locationData:e,selectedVehicle:s,selectedParameterList:t}=je(T=>T.liveMap),{mode:a,selectedVehicleGroup:l}=je(T=>T.dashboard),o=Us(a),[d,f]=B.useState([]),{w_customer_id:A}=je(T=>T.auth),[g,b]=B.useState(),[_,j]=B.useState(!1),[G,U]=B.useState(!1),[F,W]=B.useState([]),[de,S]=B.useState(!0),[p,w]=B.useState(!1),[D,L]=B.useState(!1);let P=Ge();B.useEffect(()=>{re(),P(Cs()),P(Fs()),P(Ds()),P(Me())},[P]),B.useEffect(()=>{W([]),P(St([{reg_id:"",imei:"",params:[]}]))},[s]);const re=async()=>{try{w(!0);let T=[],C=[];const k=await P(ks({w_customer_id:A}));if(Array.isArray(k.payload)){k.payload.forEach(u=>{var E,$,O,H;Array.isArray(u.imei)&&u.imei.length>0&&((E=u.imei[0])!=null&&E.mac_id)?(T.push({id:u.id,label:u.registration_id,value:($=u.imei[0])==null?void 0:$.mac_id,vehilce_type:u==null?void 0:u.segment,chassis_no:u==null?void 0:u.chassis_no,engine_no:u==null?void 0:u.engine_no,workShop:u==null?void 0:u.workshop,registration_id:u==null?void 0:u.registration_id,sell_date:u==null?void 0:u.sell_date,customer_name:u==null?void 0:u.customer_name,vehicle_model:(O=u==null?void 0:u.vehicle_model)==null?void 0:O.name,vehicle_group:u==null?void 0:u.vehicle_group}),C.push((H=u.imei[0])==null?void 0:H.mac_id)):console.error("IMEI data not found for item:",u)});const N="one",v=C;C.length>0&&P(ws({type:N,imei:v})),f(T),P(qs(T)),w(!1),P(Ls({w_customer_id:A}))}else w(!1),console.error("Unexpected data format:",k),le.error("Unexpected data format:")}catch(T){console.error("Error fetching vehicle data:",T),le.error(`Error fetching vehicle data: ${T}`)}},z=async T=>{const{label:C,imei:k,id:N,reg_id:v,checked:u}=T;b(H=>H.map(oe=>oe.id===N?{...oe,checked:!u}:oe));let E=[...F],$=[...F];if(!u)e.forEach(H=>{H.latestDocument.imei===k&&(E.push({label:C,value:H.latestDocument[C==="maininputvoltage"?"mainInputVoltage":C]}),$=E,W(E))});else{let H=F.filter(oe=>oe.label!==C);$=H,W(H)}console.log("tempParamList",$),P(St([{reg_id:v,imei:k,params:$}]))},Z=d.filter(T=>Object.keys(l).length===0||T.vehicle_group===l.id);return i.jsxs("div",{className:"app",children:[i.jsx(Ts,{}),i.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[i.jsx($s,{title:"Equipments",setShowVehicles:j,showVehicles:_,setShowVehiclesGroup:L,showVehiclesGroup:D}),i.jsx(Os,{setShowVehiclesGroup:L,showVehiclesGroup:D}),i.jsxs(se,{style:{display:"flex",width:"100%",height:"95vh"},children:[i.jsx(se,{style:{width:_||G?"80%":"100%",background:rt.bgShadow},children:i.jsx(_r,{})}),_&&i.jsx(se,{style:{width:"20%",backgroundColor:o.grey[100]},children:i.jsx(Ps,{vehicleData:Z,title:"Live Map",setParameterData:b,loadingVehicle:p,setShowVehicles:j,showVehicles:_,showParameters:G,setShowParameters:U})}),G&&i.jsx(se,{style:{width:"20%",backgroundColor:o.grey[100]},children:i.jsx(Rs,{parametersData:g,setParameterData:b,handleParameterChange:z})})]})]})]})}export{Pr as default};
