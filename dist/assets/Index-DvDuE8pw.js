import{p as m,o as J,r as t,j as a,B as d,f6 as F,f7 as G,J as H,f8 as K,eS as L,C as Q,f9 as W,fa as X,L as Z,a8 as ee,dr as ae,af as A,a3 as se,a4 as te,a6 as re,a7 as oe,V as $,Y as le,$ as ne,w as ce}from"./index-CHz_ICGe.js";import{V as ie}from"./VehicleMenu-DrBH9UE5.js";import{P as de}from"./Parameters-BPyShYNl.js";/* empty css           */import"./index.esm-DuXd6zM4.js";import{S as he}from"./ServiceJobCardTable-CG0T_in-.js";import{B as pe}from"./BreakDownJobCardTable-CU-jMhU3.js";import{S as ue}from"./ServicesTopBar-vIc4h4LV.js";import"./Autocomplete-CCkxwt18.js";import"./ServiceJobCard-DQBP_2jr.js";import"./formik.esm-i3Oa_qZs.js";import"./Remove-DeUTOtah.js";import"./excelUtils-CncxTgyw.js";import"./Edit-B8-3xxA0.js";function T(o){const{children:h,value:b,index:c,...p}=o;return a.jsx("div",{role:"tabpanel",hidden:b!==c,id:`simple-tabpanel-${c}`,"aria-labelledby":`simple-tab-${c}`,...p,children:b===c&&a.jsx(d,{sx:{p:3},children:h})})}T.propTypes={children:L.node,index:L.number.isRequired,value:L.number.isRequired};function N(o){return{id:`simple-tab-${o}`,"aria-controls":`simple-tabpanel-${o}`}}function fe(){const{selectedTabValue:o}=m(g=>g.inspection),h=J(),[b,c]=t.useState(0),p=(g,S)=>{h(H("")),h(K(S))};return a.jsxs(d,{sx:{width:"100%"},children:[a.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(F,{value:o,onChange:p,"aria-label":"basic tabs example",children:[a.jsx(G,{label:"Breakdowns",...N(0)}),a.jsx(G,{label:"Services",...N(1)})]})}),a.jsx(T,{value:o,index:0,children:a.jsx(pe,{isInspection:!0})}),a.jsx(T,{value:o,index:1,children:a.jsx(he,{isInspection:!0})})]})}function Te(){const{locationData:o,selectedVehicle:h,selectedParameterList:b}=m(s=>s.liveMap),{mode:c,selectedVehicleGroup:p}=m(s=>s.dashboard),g=ce(c),[S,M]=t.useState([]),{w_customer_id:j}=m(s=>s.auth),[R,_]=t.useState(),[v,C]=t.useState(!1),[w,q]=t.useState(!1),[y,V]=t.useState([]),[ge,xe]=t.useState(!0),[B,E]=t.useState(!1),[O,P]=t.useState(!1);JSON.parse(localStorage.getItem("w_userDetails"));let r=J();Q(),t.useEffect(()=>{r(W()),r(X())},[]),t.useEffect(()=>{U(),r(Z()),r(ee(j)),r(ae())},[]),t.useEffect(()=>{V([]),r(A([{reg_id:"",imei:"",params:[]}]))},[h]);const U=async()=>{try{P(!0);let s=[],n=[];const u=await r(se({w_customer_id:j}));if(Array.isArray(u.payload)){u.payload.forEach(e=>{var f,i,I,l;Array.isArray(e.imei)&&e.imei.length>0&&((f=e.imei[0])!=null&&f.mac_id)?(s.push({id:e.id,label:e.registration_id,value:(i=e.imei[0])==null?void 0:i.mac_id,vehilce_type:e==null?void 0:e.segment,chassis_no:e==null?void 0:e.chassis_no,engine_no:e==null?void 0:e.engine_no,workShop:e==null?void 0:e.workshop,registration_id:e==null?void 0:e.registration_id,sell_date:e==null?void 0:e.sell_date,customer_name:e==null?void 0:e.customer_name,vehicle_model:(I=e==null?void 0:e.vehicle_model)==null?void 0:I.name,vehicle_group:e==null?void 0:e.vehicle_group}),n.push((l=e.imei[0])==null?void 0:l.mac_id)):console.error("IMEI data not found for item:",e)});const D="one",k=n;n.length>0&&r(te({type:D,imei:k})),M(s),r(re(s)),P(!1),r(oe({w_customer_id:j}))}else P(!1),console.error("Unexpected data format:",u),$.error("Unexpected data format:")}catch(s){console.error("Error fetching vehicle data:",s),$.error(`Error fetching vehicle data: ${s}`)}},Y=async s=>{const{label:n,imei:u,id:D,reg_id:k,checked:e}=s;_(l=>l.map(x=>x.id===D?{...x,checked:!e}:x));let f=[...y],i=[...y];if(!e)o.forEach(l=>{l.latestDocument.imei===u&&(f.push({label:n,value:l.latestDocument[n==="maininputvoltage"?"mainInputVoltage":n]}),i=f,V(f))});else{let l=y.filter(x=>x.label!==n);i=l,V(l)}console.log("tempParamList",i),r(A([{reg_id:k,imei:u,params:i}]))},z=S.filter(s=>Object.keys(p).length===0||s.vehicle_group===p.id);return a.jsxs("div",{className:"app",children:[a.jsx(le,{}),a.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[a.jsx(ue,{title:"Inspections",setShowVehicles:C,showVehicles:v,setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsx(ne,{setShowVehiclesGroup:E,showVehiclesGroup:B}),a.jsxs(d,{style:{display:"flex",width:"100%",height:"95vh"},children:[a.jsx(d,{style:{width:v||w?"80%":"100%"},children:a.jsx(fe,{})}),v&&a.jsx(d,{style:{width:"20%",backgroundColor:g.grey[100]},children:a.jsx(ie,{vehicleData:z,title:"Inspections",setParameterData:_,loadingVehicle:O,setShowVehicles:C,showVehicles:v,showParameters:w,setShowParameters:q})}),w&&a.jsx(d,{style:{width:"20%",backgroundColor:g.grey[100]},children:a.jsx(de,{parametersData:R,setParameterData:_,handleParameterChange:Y})})]})]})]})}export{Te as default};
