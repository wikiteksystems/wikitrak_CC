import{o as Re,l as Me,p as ne,aR as rt,v as st,_ as I,b as d,q as We,f as xe,g as oe,j as t,k as Le,b3 as yt,b4 as fe,b5 as wt,b6 as Ce,b7 as Ct,n as lt,z as re,y as Fe,aW as Ge,b8 as jt,b9 as Bt,ba as Ke,bb as nt,bc as Tt,bd as Je,Z as ke,M as it,C as ae,be as It,T as ue,az as E,I as me,G as je,F as Pt,bf as kt,bg as Et,aw as Rt,aM as Mt,a7 as Ze,U as Wt,V as Lt,X as Ft,Y as Vt,E as $t}from"./index-CBXvF4xi.js";import{V as At}from"./VehicleMenu-Bqzl2SI-.js";import{t as zt}from"./SearchTab-CvNaF3I9.js";import"./Loader-Bm2WtxUY.js";import"./LiveMapServices-CEnFqOEY.js";import"./Socket-co198ldP.js";import{P as Nt}from"./Parameters-q2toGV6D.js";/* empty css           */import"./proj-XQwXs9DQ.js";import{L as qt}from"./LeftSideBar2-DnCwapuH.js";import{I as Ot}from"./InspectionsTable-W_xcNg9z.js";import{c as Ht,a as J}from"./index.esm-C8B6suLa.js";import{V as Dt}from"./VehicleGroups-q5bmDKLw.js";import{P as Be}from"./index-DvVkAysl.js";import{S as Xt}from"./ServiceRecordTable-CBKy-pN8.js";import{d as Yt}from"./Close-C6OZEOot.js";import{a as Gt}from"./formik.esm-Rq00ip3x.js";import{B as Y}from"./CircularProgress-VzQWQxRM.js";import{A as Te}from"./Autocomplete-manwtohB.js";import{T as X,S as Kt,M as Ie}from"./TextField-BFUbu1yb.js";import{c as at,F as Jt,a as Zt}from"./menu2-SEJCYhj2.js";import{D as Qt}from"./Delete-DfVs6g35.js";import{S as Ut}from"./SearchInput-1umcjgRl.js";import{D as eo,a as to,b as oo}from"./DialogTitle-nBe1MFyS.js";import{d as ct,o as dt}from"./useControlled-CyYtL4Ue.js";import{K as ro,a as so}from"./TablePagination-DK_7TSWg.js";import{S as lo}from"./ServicesTopBar-BrN_Oqt7.js";import"./createSvgIcon-0-JB7jRY.js";import"./Card-F7fJ_JU9.js";import"./CardContent-CPezsShM.js";import"./Edit-Bve7M-gM.js";import"./TableRow-CnxtpF_L.js";import"./DateTimePicker-pyWk9Qwt.js";import"./NewLoader-hGdy1EuB.js";import"./index-ClsznbJO.js";let ie;function ut(){if(ie)return ie;const e=document.createElement("div"),o=document.createElement("div");return o.style.width="10px",o.style.height="1px",e.appendChild(o),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),ie="reverse",e.scrollLeft>0?ie="default":(e.scrollLeft=1,e.scrollLeft===0&&(ie="negative")),document.body.removeChild(e),ie}function no(e,o){const i=e.scrollLeft;if(o!=="rtl")return i;switch(ut()){case"negative":return e.scrollWidth-e.clientWidth+i;case"reverse":return e.scrollWidth-e.clientWidth-i;default:return i}}function io(e){return Me("MuiTab",e)}const ao=Re("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),te=ao,co=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],uo=e=>{const{classes:o,textColor:i,fullWidth:p,wrapped:r,icon:h,label:w,selected:j,disabled:b}=e,M={root:["root",h&&w&&"labelIcon",`textColor${st(i)}`,p&&"fullWidth",r&&"wrapped",j&&"selected",b&&"disabled"],iconWrapper:["iconWrapper"]};return Le(M,io,o)},po=ne(rt,{name:"MuiTab",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.root,i.label&&i.icon&&o.labelIcon,o[`textColor${st(i.textColor)}`],i.fullWidth&&o.fullWidth,i.wrapped&&o.wrapped,{[`& .${te.iconWrapper}`]:o.iconWrapper}]}})(({theme:e,ownerState:o})=>I({},e.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},o.label&&{flexDirection:o.iconPosition==="top"||o.iconPosition==="bottom"?"column":"row"},{lineHeight:1.25},o.icon&&o.label&&{minHeight:72,paddingTop:9,paddingBottom:9,[`& > .${te.iconWrapper}`]:I({},o.iconPosition==="top"&&{marginBottom:6},o.iconPosition==="bottom"&&{marginTop:6},o.iconPosition==="start"&&{marginRight:e.spacing(1)},o.iconPosition==="end"&&{marginLeft:e.spacing(1)})},o.textColor==="inherit"&&{color:"inherit",opacity:.6,[`&.${te.selected}`]:{opacity:1},[`&.${te.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},o.textColor==="primary"&&{color:(e.vars||e).palette.text.secondary,[`&.${te.selected}`]:{color:(e.vars||e).palette.primary.main},[`&.${te.disabled}`]:{color:(e.vars||e).palette.text.disabled}},o.textColor==="secondary"&&{color:(e.vars||e).palette.text.secondary,[`&.${te.selected}`]:{color:(e.vars||e).palette.secondary.main},[`&.${te.disabled}`]:{color:(e.vars||e).palette.text.disabled}},o.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},o.wrapped&&{fontSize:e.typography.pxToRem(12)})),ho=d.forwardRef(function(o,i){const p=We({props:o,name:"MuiTab"}),{className:r,disabled:h=!1,disableFocusRipple:w=!1,fullWidth:j,icon:b,iconPosition:M="top",indicator:W,label:L,onChange:C,onClick:_,onFocus:z,selected:F,selectionFollowsFocus:R,textColor:s="inherit",value:$,wrapped:A=!1}=p,N=xe(p,co),G=I({},p,{disabled:h,disableFocusRipple:w,selected:F,icon:!!b,iconPosition:M,label:!!L,fullWidth:j,textColor:s,wrapped:A}),T=uo(G),O=b&&L&&d.isValidElement(b)?d.cloneElement(b,{className:oe(T.iconWrapper,b.props.className)}):b,Z=l=>{!F&&C&&C(l,$),_&&_(l)},D=l=>{R&&!F&&C&&C(l,$),z&&z(l)};return t.jsxs(po,I({focusRipple:!w,className:oe(T.root,r),ref:i,role:"tab","aria-selected":F,disabled:h,onClick:Z,onFocus:D,ownerState:G,tabIndex:F?0:-1},N,{children:[M==="top"||M==="start"?t.jsxs(d.Fragment,{children:[O,L]}):t.jsxs(d.Fragment,{children:[L,O]}),W]}))}),Qe=ho;function bo(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}function mo(e,o,i,p={},r=()=>{}){const{ease:h=bo,duration:w=300}=p;let j=null;const b=o[e];let M=!1;const W=()=>{M=!0},L=C=>{if(M){r(new Error("Animation cancelled"));return}j===null&&(j=C);const _=Math.min(1,(C-j)/w);if(o[e]=h(_)*(i-b)+b,_>=1){requestAnimationFrame(()=>{r(null)});return}requestAnimationFrame(L)};return b===i?(r(new Error("Element already at target position")),W):(requestAnimationFrame(L),W)}const fo=["onChange"],xo={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function go(e){const{onChange:o}=e,i=xe(e,fo),p=d.useRef(),r=d.useRef(null),h=()=>{p.current=r.current.offsetHeight-r.current.clientHeight};return yt(()=>{const w=ct(()=>{const b=p.current;h(),b!==p.current&&o(p.current)}),j=dt(r.current);return j.addEventListener("resize",w),()=>{w.clear(),j.removeEventListener("resize",w)}},[o]),d.useEffect(()=>{h(),o(p.current)},[o]),t.jsx("div",I({style:xo,ref:r},i))}function vo(e){return Me("MuiTabScrollButton",e)}const So=Re("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),_o=So,yo=["className","slots","slotProps","direction","orientation","disabled"],wo=e=>{const{classes:o,orientation:i,disabled:p}=e;return Le({root:["root",i,p&&"disabled"]},vo,o)},Co=ne(rt,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.root,i.orientation&&o[i.orientation]]}})(({ownerState:e})=>I({width:40,flexShrink:0,opacity:.8,[`&.${_o.disabled}`]:{opacity:0}},e.orientation==="vertical"&&{width:"100%",height:40,"& svg":{transform:`rotate(${e.isRtl?-90:90}deg)`}})),jo=d.forwardRef(function(o,i){var p,r;const h=We({props:o,name:"MuiTabScrollButton"}),{className:w,slots:j={},slotProps:b={},direction:M}=h,W=xe(h,yo),L=at(),C=I({isRtl:L},h),_=wo(C),z=(p=j.StartScrollButtonIcon)!=null?p:ro,F=(r=j.EndScrollButtonIcon)!=null?r:so,R=fe({elementType:z,externalSlotProps:b.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:C}),s=fe({elementType:F,externalSlotProps:b.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:C});return t.jsx(Co,I({component:"div",className:oe(_.root,w),ref:i,role:null,ownerState:C,tabIndex:null},W,{children:M==="left"?t.jsx(z,I({},R)):t.jsx(F,I({},s))}))}),Bo=jo;function To(e){return Me("MuiTabs",e)}const Io=Re("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),Pe=Io,Po=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],Ue=(e,o)=>e===o?e.firstChild:o&&o.nextElementSibling?o.nextElementSibling:e.firstChild,et=(e,o)=>e===o?e.lastChild:o&&o.previousElementSibling?o.previousElementSibling:e.lastChild,be=(e,o,i)=>{let p=!1,r=i(e,o);for(;r;){if(r===e.firstChild){if(p)return;p=!0}const h=r.disabled||r.getAttribute("aria-disabled")==="true";if(!r.hasAttribute("tabindex")||h)r=i(e,r);else{r.focus();return}}},ko=e=>{const{vertical:o,fixed:i,hideScrollbar:p,scrollableX:r,scrollableY:h,centered:w,scrollButtonsHideMobile:j,classes:b}=e;return Le({root:["root",o&&"vertical"],scroller:["scroller",i&&"fixed",p&&"hideScrollbar",r&&"scrollableX",h&&"scrollableY"],flexContainer:["flexContainer",o&&"flexContainerVertical",w&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",j&&"scrollButtonsHideMobile"],scrollableX:[r&&"scrollableX"],hideScrollbar:[p&&"hideScrollbar"]},To,b)},Eo=ne("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[{[`& .${Pe.scrollButtons}`]:o.scrollButtons},{[`& .${Pe.scrollButtons}`]:i.scrollButtonsHideMobile&&o.scrollButtonsHideMobile},o.root,i.vertical&&o.vertical]}})(({ownerState:e,theme:o})=>I({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},e.vertical&&{flexDirection:"column"},e.scrollButtonsHideMobile&&{[`& .${Pe.scrollButtons}`]:{[o.breakpoints.down("sm")]:{display:"none"}}})),Ro=ne("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.scroller,i.fixed&&o.fixed,i.hideScrollbar&&o.hideScrollbar,i.scrollableX&&o.scrollableX,i.scrollableY&&o.scrollableY]}})(({ownerState:e})=>I({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},e.fixed&&{overflowX:"hidden",width:"100%"},e.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},e.scrollableX&&{overflowX:"auto",overflowY:"hidden"},e.scrollableY&&{overflowY:"auto",overflowX:"hidden"})),Mo=ne("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.flexContainer,i.vertical&&o.flexContainerVertical,i.centered&&o.centered]}})(({ownerState:e})=>I({display:"flex"},e.vertical&&{flexDirection:"column"},e.centered&&{justifyContent:"center"})),Wo=ne("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,o)=>o.indicator})(({ownerState:e,theme:o})=>I({position:"absolute",height:2,bottom:0,width:"100%",transition:o.transitions.create()},e.indicatorColor==="primary"&&{backgroundColor:(o.vars||o).palette.primary.main},e.indicatorColor==="secondary"&&{backgroundColor:(o.vars||o).palette.secondary.main},e.vertical&&{height:"100%",width:2,right:0})),Lo=ne(go)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),tt={},Fo=d.forwardRef(function(o,i){const p=We({props:o,name:"MuiTabs"}),r=wt(),h=at(),{"aria-label":w,"aria-labelledby":j,action:b,centered:M=!1,children:W,className:L,component:C="div",allowScrollButtonsMobile:_=!1,indicatorColor:z="primary",onChange:F,orientation:R="horizontal",ScrollButtonComponent:s=Bo,scrollButtons:$="auto",selectionFollowsFocus:A,slots:N={},slotProps:G={},TabIndicatorProps:T={},TabScrollButtonProps:O={},textColor:Z="primary",value:D,variant:l="standard",visibleScrollbar:a=!1}=p,m=xe(p,Po),v=l==="scrollable",S=R==="vertical",x=S?"scrollTop":"scrollLeft",B=S?"top":"left",u=S?"bottom":"right",q=S?"clientHeight":"clientWidth",y=S?"height":"width",H=I({},p,{component:C,allowScrollButtonsMobile:_,indicatorColor:z,orientation:R,vertical:S,scrollButtons:$,textColor:Z,variant:l,visibleScrollbar:a,fixed:!v,hideScrollbar:v&&!a,scrollableX:v&&!S,scrollableY:v&&S,centered:M&&!v,scrollButtonsHideMobile:!_}),P=ko(H),Q=fe({elementType:N.StartScrollButtonIcon,externalSlotProps:G.startScrollButtonIcon,ownerState:H}),ge=fe({elementType:N.EndScrollButtonIcon,externalSlotProps:G.endScrollButtonIcon,ownerState:H}),[ve,Se]=d.useState(!1),[se,Ve]=d.useState(tt),[$e,pt]=d.useState(!1),[Ae,ht]=d.useState(!1),[ze,bt]=d.useState(!1),[Ne,mt]=d.useState({overflow:"hidden",scrollbarWidth:0}),qe=new Map,U=d.useRef(null),le=d.useRef(null),Oe=()=>{const n=U.current;let c;if(n){const f=n.getBoundingClientRect();c={clientWidth:n.clientWidth,scrollLeft:n.scrollLeft,scrollTop:n.scrollTop,scrollLeftNormalized:no(n,h?"rtl":"ltr"),scrollWidth:n.scrollWidth,top:f.top,bottom:f.bottom,left:f.left,right:f.right}}let g;if(n&&D!==!1){const f=le.current.children;if(f.length>0){const k=f[qe.get(D)];g=k?k.getBoundingClientRect():null}}return{tabsMeta:c,tabMeta:g}},ce=Ce(()=>{const{tabsMeta:n,tabMeta:c}=Oe();let g=0,f;if(S)f="top",c&&n&&(g=c.top-n.top+n.scrollTop);else if(f=h?"right":"left",c&&n){const V=h?n.scrollLeftNormalized+n.clientWidth-n.scrollWidth:n.scrollLeft;g=(h?-1:1)*(c[f]-n[f]+V)}const k={[f]:g,[y]:c?c[y]:0};if(isNaN(se[f])||isNaN(se[y]))Ve(k);else{const V=Math.abs(se[f]-k[f]),K=Math.abs(se[y]-k[y]);(V>=1||K>=1)&&Ve(k)}}),_e=(n,{animation:c=!0}={})=>{c?mo(x,U.current,n,{duration:r.transitions.duration.standard}):U.current[x]=n},He=n=>{let c=U.current[x];S?c+=n:(c+=n*(h?-1:1),c*=h&&ut()==="reverse"?-1:1),_e(c)},De=()=>{const n=U.current[q];let c=0;const g=Array.from(le.current.children);for(let f=0;f<g.length;f+=1){const k=g[f];if(c+k[q]>n){f===0&&(c=n);break}c+=k[q]}return c},ft=()=>{He(-1*De())},xt=()=>{He(De())},gt=d.useCallback(n=>{mt({overflow:null,scrollbarWidth:n})},[]),vt=()=>{const n={};n.scrollbarSizeListener=v?t.jsx(Lo,{onChange:gt,className:oe(P.scrollableX,P.hideScrollbar)}):null;const g=v&&($==="auto"&&($e||Ae)||$===!0);return n.scrollButtonStart=g?t.jsx(s,I({slots:{StartScrollButtonIcon:N.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:Q},orientation:R,direction:h?"right":"left",onClick:ft,disabled:!$e},O,{className:oe(P.scrollButtons,O.className)})):null,n.scrollButtonEnd=g?t.jsx(s,I({slots:{EndScrollButtonIcon:N.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:ge},orientation:R,direction:h?"left":"right",onClick:xt,disabled:!Ae},O,{className:oe(P.scrollButtons,O.className)})):null,n},Xe=Ce(n=>{const{tabsMeta:c,tabMeta:g}=Oe();if(!(!g||!c)){if(g[B]<c[B]){const f=c[x]+(g[B]-c[B]);_e(f,{animation:n})}else if(g[u]>c[u]){const f=c[x]+(g[u]-c[u]);_e(f,{animation:n})}}}),pe=Ce(()=>{v&&$!==!1&&bt(!ze)});d.useEffect(()=>{const n=ct(()=>{U.current&&ce()});let c;const g=V=>{V.forEach(K=>{K.removedNodes.forEach(de=>{var ee;(ee=c)==null||ee.unobserve(de)}),K.addedNodes.forEach(de=>{var ee;(ee=c)==null||ee.observe(de)})}),n(),pe()},f=dt(U.current);f.addEventListener("resize",n);let k;return typeof ResizeObserver<"u"&&(c=new ResizeObserver(n),Array.from(le.current.children).forEach(V=>{c.observe(V)})),typeof MutationObserver<"u"&&(k=new MutationObserver(g),k.observe(le.current,{childList:!0})),()=>{var V,K;n.clear(),f.removeEventListener("resize",n),(V=k)==null||V.disconnect(),(K=c)==null||K.disconnect()}},[ce,pe]),d.useEffect(()=>{const n=Array.from(le.current.children),c=n.length;if(typeof IntersectionObserver<"u"&&c>0&&v&&$!==!1){const g=n[0],f=n[c-1],k={root:U.current,threshold:.99},V=we=>{pt(!we[0].isIntersecting)},K=new IntersectionObserver(V,k);K.observe(g);const de=we=>{ht(!we[0].isIntersecting)},ee=new IntersectionObserver(de,k);return ee.observe(f),()=>{K.disconnect(),ee.disconnect()}}},[v,$,ze,W==null?void 0:W.length]),d.useEffect(()=>{Se(!0)},[]),d.useEffect(()=>{ce()}),d.useEffect(()=>{Xe(tt!==se)},[Xe,se]),d.useImperativeHandle(b,()=>({updateIndicator:ce,updateScrollButtons:pe}),[ce,pe]);const Ye=t.jsx(Wo,I({},T,{className:oe(P.indicator,T.className),ownerState:H,style:I({},se,T.style)}));let he=0;const St=d.Children.map(W,n=>{if(!d.isValidElement(n))return null;const c=n.props.value===void 0?he:n.props.value;qe.set(c,he);const g=c===D;return he+=1,d.cloneElement(n,I({fullWidth:l==="fullWidth",indicator:g&&!ve&&Ye,selected:g,selectionFollowsFocus:A,onChange:F,textColor:Z,value:c},he===1&&D===!1&&!n.props.tabIndex?{tabIndex:0}:{}))}),_t=n=>{const c=le.current,g=Ct(c).activeElement;if(g.getAttribute("role")!=="tab")return;let k=R==="horizontal"?"ArrowLeft":"ArrowUp",V=R==="horizontal"?"ArrowRight":"ArrowDown";switch(R==="horizontal"&&h&&(k="ArrowRight",V="ArrowLeft"),n.key){case k:n.preventDefault(),be(c,g,et);break;case V:n.preventDefault(),be(c,g,Ue);break;case"Home":n.preventDefault(),be(c,null,Ue);break;case"End":n.preventDefault(),be(c,null,et);break}},ye=vt();return t.jsxs(Eo,I({className:oe(P.root,L),ownerState:H,ref:i,as:C},m,{children:[ye.scrollButtonStart,ye.scrollbarSizeListener,t.jsxs(Ro,{className:P.scroller,ownerState:H,style:{overflow:Ne.overflow,[S?`margin${h?"Left":"Right"}`:"marginBottom"]:a?void 0:-Ne.scrollbarWidth},ref:U,children:[t.jsx(Mo,{"aria-label":w,"aria-labelledby":j,"aria-orientation":R==="vertical"?"vertical":null,className:P.flexContainer,ownerState:H,onKeyDown:_t,ref:le,role:"tablist",children:St}),ve&&Ye]}),ye.scrollButtonEnd]}))}),Vo=Fo,$o=lt(t.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),Ao=lt(t.jsx("path",{d:"M19 13H5v-2h14z"}),"Remove");function zo({searchTerm:e}){var N,G,T,O,Z,D;const{vehicles_details:o}=re(l=>l.dashboard),{breakdownTopics:i,UpdatedBreakdownData:p}=re(l=>l.breakdown),{UpdatedInspectionData:r,sparePartList:h}=re(l=>l.inspection),{w_customer_id:w}=re(l=>l.auth),[j,b]=d.useState(null),[M,W]=d.useState(""),[L,C]=d.useState(!1);let _=Fe(),z=JSON.parse(localStorage.getItem("w_userDetails"));d.useEffect(()=>{console.log("UpdatedInspectionData1111",r)},[r]),d.useEffect(()=>{r&&b(r.resolve_attachment)},[r]);const F=l=>{const a=new FormData;return a.append("vehicle",l.vehicle),a.append("breakdown_topic",l.breakdown_topic),a.append("odometer_reading",l.odometer_reading),a.append("description",l.description),a.append("mob_no",l.mob_no),a.append("email",l.email),a.append("submitted_by",l.submitted_by),a.append("resolved_issue",l.resolved_issue),a.append("pending_issue",l.pending_issue),a.append("status",l.status),a.append("type",l.type),l.resolve_attachment instanceof File&&a.append("resolve_attachment",l.resolve_attachment),l.issued_attachment instanceof File&&a.append("issued_attachment",l.issued_attachment),a};let R=r==null?void 0:r.inspection_parts_inspection.map(l=>{var a;return{spare_parts:(a=l==null?void 0:l.spare_parts)==null?void 0:a.id,quantity:l==null?void 0:l.quantity}});console.log("spare parts",R);const s=Gt({initialValues:{id:r==null?void 0:r.id,vehicle:((N=r==null?void 0:r.vehicle)==null?void 0:N.id)||"",breakdown_topic:((T=(G=r==null?void 0:r.breakdown)==null?void 0:G.breakdown_topic)==null?void 0:T.id)||"",odometer_reading:(r==null?void 0:r.odometer_reading)||"",description:(r==null?void 0:r.description)||"",mob_no:((O=r==null?void 0:r.breakdown)==null?void 0:O.mob_no)||"",email:((Z=r==null?void 0:r.breakdown)==null?void 0:Z.email)||"",resolve_attachment:(r==null?void 0:r.resolve_attachment)||null,submitted_by:`${z.first_name} ${z.last_name}`||"",resolved_issue:(r==null?void 0:r.resolved_issue)||"",pending_issue:r==null?void 0:r.pending_issue,status:(r==null?void 0:r.status)||"Open",inspection_parts_inspection:R||null,issued_attachment:r==null?void 0:r.issued_attachment,type:r==null?void 0:r.type},validationSchema:Ht({vehicle:J().required("Vehicle is required"),breakdown_topic:J().required("Breakdown Topic is required"),odometer_reading:J().required("Odometer Reading is required"),description:J().required("Description is required"),mob_no:J().matches(/^\d{10,11}$/,"Mobile number must be 10-11 digits").required("Mobile number is required"),email:J().email("Invalid email format").required("Email is required"),resolved_issue:J().required("Resolved issue is required"),pending_issue:J().required("Pending issue is required"),status:J().oneOf(["Open","Close","Rejected"],"Invalid status").required("Status is required"),submitted_by:J().required("Submitted is required")}),onSubmit:async(l,{resetForm:a})=>{var m,v,S,x;try{C(!0),l.submitted_by=z.user_id,console.log("submit value",l);let B=null;l!=null&&l.issued_attachment&&(B=await Ge(l==null?void 0:l.issued_attachment));let u=null;l!=null&&l.resolve_attachment&&(u=await Ge(l==null?void 0:l.resolve_attachment)),l.issued_attachment=B||null,console.log("Submitted values:",l);let q=F(l);console.log("formdata11",q);const y=await _(jt({values:q,id:r==null?void 0:r.id}));if(console.log("response",(m=y==null?void 0:y.payload)==null?void 0:m.success),(v=y==null?void 0:y.payload)!=null&&v.success){console.log("response?.payload?.status",(S=y==null?void 0:y.payload)==null?void 0:S.data);const{id:Q}=(x=y==null?void 0:y.payload)==null?void 0:x.data,{inspection_parts_inspection:ge}=l;let Se=await _(Bt({inspection:Q,parts:ge}));console.log("response2",Se),a(),W(""),b(null),_(Ke(null)),_(nt(!1)),_(Tt(null)),_(Je(!1)),_(ke(w)),_(it()),C(!1)}else ae.error("Error occurred during submission");const H=[];!0&&(a(),W(""),b(null),_(Ke(null)),_(Je(!1)),_(It(!1)),_(ke(w))),C(!1)}catch(B){console.error("Submission Error:",B),ae.error("Failed to submit breakdown or inspection. Please try again."),C(!1)}}}),$=l=>{const a=l.currentTarget.files[0];if(s.setFieldValue("resolve_attachment",a),W((a==null?void 0:a.name)||""),a&&a.type.startsWith("image/")){const m=new FileReader;m.onload=()=>b(m.result),m.readAsDataURL(a)}else b(null)},A=!!r;return t.jsx(Y,{sx:{p:3,margin:"auto"},children:L?t.jsx(ue,{children:"Submitted the form data..."}):t.jsx(t.Fragment,{children:t.jsx("form",{onSubmit:s.handleSubmit,children:t.jsxs(E,{container:!0,spacing:2,children:[t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(Te,{options:o,getOptionLabel:l=>l.registration_id,disabled:A,value:o.find(l=>l.id===s.values.vehicle)||null,onChange:(l,a)=>s.setFieldValue("vehicle",(a==null?void 0:a.id)||""),renderInput:l=>t.jsx(X,{...l,label:"Vehicle",fullWidth:!0,error:s.touched.vehicle&&!!s.errors.vehicle,helperText:s.touched.vehicle&&s.errors.vehicle,disabled:A})})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(Te,{disabled:A,options:i,getOptionLabel:l=>l.topic,value:i.find(l=>l.id===s.values.breakdown_topic)||null,onChange:(l,a)=>s.setFieldValue("breakdown_topic",(a==null?void 0:a.id)||""),renderInput:l=>t.jsx(X,{...l,label:"Breakdown Topic",fullWidth:!0,error:s.touched.breakdown_topic&&!!s.errors.breakdown_topic,helperText:s.touched.breakdown_topic&&s.errors.breakdown_topic})})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(X,{label:"Odometer Reading",name:"odometer_reading",disabled:A,value:s.values.odometer_reading,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.odometer_reading&&!!s.errors.odometer_reading,helperText:s.touched.odometer_reading&&s.errors.odometer_reading,fullWidth:!0})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(X,{label:"Description",name:"description",disabled:A,value:s.values.description,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.description&&!!s.errors.description,helperText:s.touched.description&&s.errors.description,fullWidth:!0})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(X,{label:"Mobile Number",name:"mob_no",disabled:A,value:s.values.mob_no,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.mob_no&&!!s.errors.mob_no,helperText:s.touched.mob_no&&s.errors.mob_no,fullWidth:!0})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(X,{label:"Email",name:"email",type:"email",disabled:A,value:s.values.email,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.email&&!!s.errors.email,helperText:s.touched.email&&s.errors.email,fullWidth:!0})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(X,{label:"Resolved Issue",name:"resolved_issue",value:s.values.resolved_issue,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.resolved_issue&&!!s.errors.resolved_issue,helperText:s.touched.resolved_issue&&s.errors.resolved_issue,fullWidth:!0})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(X,{label:"Pending Issue",name:"pending_issue",value:s.values.pending_issue,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.pending_issue&&!!s.errors.pending_issue,helperText:s.touched.pending_issue&&s.errors.pending_issue,fullWidth:!0})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsxs(Jt,{fullWidth:!0,children:[t.jsx(Zt,{children:"Status"}),t.jsxs(Kt,{name:"status",value:s.values.status,onChange:s.handleChange,error:s.touched.status&&!!s.errors.status,children:[t.jsx(Ie,{value:"Open",children:"Open"}),t.jsx(Ie,{value:"Close",children:"Close"}),t.jsx(Ie,{value:"Rejected",children:"Rejected"})]})]})}),t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(X,{label:"Submitted By",name:"submitted_by",disabled:A,value:s.values.submitted_by,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.submitted_by&&!!s.errors.submitted_by,helperText:s.touched.submitted_by&&s.errors.submitted_by,fullWidth:!0})}),t.jsxs(E,{item:!0,xs:12,children:[t.jsx(ue,{variant:"h6",gutterBottom:!0,children:"Spare Parts Used"}),(D=s==null?void 0:s.values)==null?void 0:D.inspection_parts_inspection.map((l,a)=>{var S;const m=(S=s.values)==null?void 0:S.inspection_parts_inspection.map(x=>x.spare_parts).filter((x,B)=>B!==a);console.log("selected part id",m),console.log("partlist",h);const v=h.filter(x=>!m.includes(x.id));return t.jsxs(E,{container:!0,spacing:2,marginTop:"0px",alignItems:"center",children:[t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(Te,{options:v,getOptionLabel:x=>x.description,value:h.find(x=>x.id===l.spare_parts)||null,onChange:(x,B)=>s.setFieldValue(`inspection_parts_inspection[${a}].spare_parts`,(B==null?void 0:B.id)||""),renderInput:x=>t.jsx(X,{...x,label:"Spare Part",fullWidth:!0})})}),t.jsx(E,{item:!0,xs:8,md:4,children:t.jsxs(Y,{display:"flex",alignItems:"center",children:[t.jsx(me,{onClick:()=>s.setFieldValue(`inspection_parts_inspection[${a}].quantity`,Math.max(1,l.quantity-1)),children:t.jsx(Ao,{})}),t.jsx(X,{value:l.quantity,type:"number",inputProps:{min:1},onChange:x=>s.setFieldValue(`inspection_parts_inspection[${a}].quantity`,parseInt(x.target.value,10)),sx:{width:90,mx:1,textAlign:"center"}}),t.jsx(me,{onClick:()=>s.setFieldValue(`inspection_parts_inspection[${a}].quantity`,l.quantity+1),children:t.jsx($o,{})})]})}),t.jsx(E,{item:!0,xs:4,md:2,children:t.jsx(me,{color:"error",onClick:()=>{var B;const x=[...(B=s.values)==null?void 0:B.inspection_parts_inspection];x.splice(a,1),s.setFieldValue("inspection_parts_inspection",x)},children:t.jsx(Qt,{})})})]},a)}),t.jsx(je,{variant:"outlined",onClick:()=>{var m,v;const l=(m=s.values)==null?void 0:m.inspection_parts_inspection.map(S=>S.spare_parts);if(h.filter(S=>!l.includes(S.id)).length===0){ae.error("All available spare parts have already been added.");return}s.setFieldValue("inspection_parts_inspection",[...(v=s.values)==null?void 0:v.inspection_parts_inspection,{spare_parts:"",quantity:1}])},sx:{mt:2},children:"+ Add Spare Part"})]}),t.jsxs(E,{item:!0,xs:12,md:6,children:[t.jsxs(je,{variant:"contained",component:"label",fullWidth:!0,children:["Upload Attachment",t.jsx("input",{type:"file",hidden:!0,onChange:$})]}),M&&t.jsx(ue,{children:M})]}),t.jsx(E,{item:!0,xs:12,md:6,children:s.values.issued_attachment&&t.jsxs(ue,{variant:"body2",children:[t.jsx("b",{children:"Submitted attachment:"})," ",t.jsx("a",{href:s.values.issued_attachment,target:"_blank",rel:"noopener noreferrer",children:"View File"})]})}),j&&t.jsx(E,{item:!0,xs:12,children:t.jsx(Y,{component:"img",src:j,alt:"Preview",sx:{width:"100%",maxHeight:200,mt:2}})}),t.jsx(E,{item:!0,xs:12,children:t.jsx(je,{type:"submit",variant:"contained",fullWidth:!0,children:"Submit"})})]})})})})}function No({where:e}){const{isUpdateInspection:o,UpdatedInspectionData:i}=re(w=>w.inspection);let p=Fe();const r=()=>{p(nt(!1))},h={fontSize:"18px",fontWeight:500,lineHeight:"18.38px",textAlign:"center",paddingTop:"5px",fontFamily:"ubuntu"};return t.jsxs(Y,{sx:{bgcolor:"white",m:"10px",display:"flex",textAlign:"left",justifyContent:"space-between",alignItems:"center",borderRadius:"6px",padding:"20px"},children:[t.jsx(Ut,{}),t.jsx(ue,{variant:"h6",sx:h,children:"New Breakdown Requests"}),t.jsxs(eo,{open:o,onClose:r,maxWidth:"xl",fullWidth:!0,children:[t.jsxs(to,{children:["Update Inspection Status",t.jsx(me,{"aria-label":"close",onClick:r,sx:{position:"absolute",right:8,top:8,color:w=>w.palette.grey[500]},children:t.jsx(Yt,{})})]}),t.jsx(oo,{children:t.jsx(zo,{})})]})]})}function Ee(e){const{children:o,value:i,index:p,...r}=e;return t.jsx("div",{role:"tabpanel",hidden:i!==p,id:`simple-tabpanel-${p}`,"aria-labelledby":`simple-tab-${p}`,...r,children:i===p&&t.jsx(Y,{sx:{p:3},children:o})})}Ee.propTypes={children:Be.node,index:Be.number.isRequired,value:Be.number.isRequired};function ot(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function qo(){const[e,o]=d.useState(0),i=(p,r)=>{o(r)};return t.jsxs(Y,{sx:{width:"100%"},children:[t.jsx(Y,{sx:{borderBottom:1,borderColor:"divider"},children:t.jsxs(Vo,{value:e,onChange:i,"aria-label":"basic tabs example",children:[t.jsx(Qe,{label:"Breakdowns",...ot(0)}),t.jsx(Qe,{label:"Services",...ot(1)})]})}),t.jsxs(Ee,{value:e,index:0,children:[t.jsx(No,{where:"inspection"}),t.jsx(Ot,{})]}),t.jsx(Ee,{value:e,index:1,children:t.jsx(Xt,{isInspection:!0})})]})}function Cr(){const{locationData:e,selectedVehicle:o,selectedParameterList:i}=re(m=>m.liveMap),{mode:p,selectedVehicleGroup:r}=re(m=>m.dashboard),h=zt(p),[w,j]=d.useState([]),{w_customer_id:b}=re(m=>m.auth),[M,W]=d.useState(),[L,C]=d.useState(!1),[_,z]=d.useState(!1),[F,R]=d.useState([]);d.useState(!0);const[s,$]=d.useState(!1),[A,N]=d.useState(!1),G=JSON.parse(localStorage.getItem("w_userDetails"));let T=Fe(),O=Pt();d.useEffect(()=>{T(kt()),T(Et())},[]),d.useEffect(()=>{Rt.includes(G.role)?console.log("you can access this route"):(console.log("you can't access this route"),Z())},[]);const Z=()=>{console.log("oh! this route not allowed"),O("/dashboard"),ae.error("You're not allowed to access inspection.")};d.useEffect(()=>{D(),T(it()),T(ke(b)),T(Mt())},[]),d.useEffect(()=>{R([]),T(Ze([{reg_id:"",imei:"",params:[]}]))},[o]);const D=async()=>{try{N(!0);let m=[],v=[];const S=await T(Wt({w_customer_id:b}));if(Array.isArray(S.payload)){S.payload.forEach(u=>{var q,y,H,P;Array.isArray(u.imei)&&u.imei.length>0&&((q=u.imei[0])!=null&&q.mac_id)?(m.push({id:u.id,label:u.registration_id,value:(y=u.imei[0])==null?void 0:y.mac_id,vehilce_type:u==null?void 0:u.segment,chassis_no:u==null?void 0:u.chassis_no,engine_no:u==null?void 0:u.engine_no,workShop:u==null?void 0:u.workshop,registration_id:u==null?void 0:u.registration_id,sell_date:u==null?void 0:u.sell_date,customer_name:u==null?void 0:u.customer_name,vehicle_model:(H=u==null?void 0:u.vehicle_model)==null?void 0:H.name,vehicle_group:u==null?void 0:u.vehicle_group}),v.push((P=u.imei[0])==null?void 0:P.mac_id)):console.error("IMEI data not found for item:",u)});const x="one",B=v;v.length>0&&T(Lt({type:x,imei:B})),j(m),T(Ft(m)),N(!1),T(Vt({w_customer_id:b}))}else N(!1),console.error("Unexpected data format:",S),ae.error("Unexpected data format:")}catch(m){console.error("Error fetching vehicle data:",m),ae.error(`Error fetching vehicle data: ${m}`)}},l=async m=>{const{label:v,imei:S,id:x,reg_id:B,checked:u}=m;W(P=>P.map(Q=>Q.id===x?{...Q,checked:!u}:Q));let q=[...F],y=[...F];if(!u)e.forEach(P=>{P.latestDocument.imei===S&&(q.push({label:v,value:P.latestDocument[v==="maininputvoltage"?"mainInputVoltage":v]}),y=q,R(q))});else{let P=F.filter(Q=>Q.label!==v);y=P,R(P)}console.log("tempParamList",y),T(Ze([{reg_id:B,imei:S,params:y}]))},a=w.filter(m=>Object.keys(r).length===0||m.vehicle_group===r.id);return t.jsxs("div",{className:"app",children:[t.jsx(qt,{}),t.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[t.jsx(lo,{title:"Inspections",setShowVehicles:C,showVehicles:L,setShowVehiclesGroup:$,showVehiclesGroup:s}),t.jsx(Dt,{setShowVehiclesGroup:$,showVehiclesGroup:s}),t.jsxs(Y,{style:{display:"flex",width:"100%",height:"95vh"},children:[t.jsx(Y,{style:{width:L||_?"80%":"100%",background:$t.bgShadow},children:t.jsx(qo,{})}),L&&t.jsx(Y,{style:{width:"20%",backgroundColor:h.grey[100]},children:t.jsx(At,{vehicleData:a,title:"Inspections",setParameterData:W,loadingVehicle:A,setShowVehicles:C,showVehicles:L,showParameters:_,setShowParameters:z})}),_&&t.jsx(Y,{style:{width:"20%",backgroundColor:h.grey[100]},children:t.jsx(Nt,{parametersData:M,setParameterData:W,handleParameterChange:l})})]})]})]})}export{Cr as default};
