import{e as h,aQ as Ot,f1 as Nt,b8 as Ne,aW as ft,aP as Mt,a as Ht,aR as Je,f2 as st,f3 as Wt,bb as Ut,bc as Gt,bm as Yt,be as mt,bd as Kt,bf as zt,b4 as qt,f4 as Xt,bq as Jt,f5 as Qt,v as de,w as N,j as e,B as o,G as Ge,J as re,bW as Zt,bX as Vt,bY as es,E as ts,q as fe,bZ as ss,b_ as rs,T as as,z as ae,f6 as bt,f7 as os,f8 as ns,f9 as ls,fa as is,fb as cs,fc as ds,fd as ps,fe as us,ff as xs,cl as ke,bH as ye,bI as _e,bK as Ce,c2 as je,t as Se,fg as be,fh as Ye,fi as hs,fj as gs,fk as fs,fl as ms,fm as bs,fn as ys,fo as rt,fp as at,fq as ne,ao as le,C as U,fr as ee,fs as Pt,ft as Ke,fu as ze,fv as _s,fw as yt,fx as pe,fy as _t,fz as Ct,fA as ot,fB as jt,fC as Ve,V as we,fD as St,ae as Cs,af as js,bF as Ss,fE as ks,fF as kt,fG as vs,fH as vt,fI as wt,a4 as ws,a7 as Es,Z as As,fJ as Ds,fK as Ts,fL as $s}from"./index-Diq4l7Dq.js";import{C as Is,I as Lt}from"./index-BiU4nFji.js";import{C as Ps}from"./Card-BgTbyo_l.js";import{C as Ls}from"./CardContent-B_YmKDp8.js";import{d as Rs}from"./ContentCopy-CErSJAZB.js";import{SinoCastalTerminal as Bs,SinoCastalReadDTC as Fs,SinoCastalLiveParameter as Os}from"./Index-nTa4WCZ6.js";import"./index.esm-CF2jjTSD.js";import"./TextField-qTbTcyyL.js";var Ns={percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1,gapPosition:"bottom"},Ms=function(){var s=h.useRef([]),r=h.useRef(null);return h.useEffect(function(){var n=Date.now(),d=!1;s.current.forEach(function(w){if(w){d=!0;var l=w.style;l.transitionDuration=".3s, .3s, .3s, .06s",r.current&&n-r.current<100&&(l.transitionDuration="0s, 0s")}}),d&&(r.current=Date.now())}),s.current},Et=0,Hs=Nt();function Ws(){var t;return Hs?(t=Et,Et+=1):t="TEST_OR_SSR",t}const Us=function(t){var s=h.useState(),r=Ot(s,2),n=r[0],d=r[1];return h.useEffect(function(){d("rc_progress_".concat(Ws()))},[]),t||n};var At=function(s){var r=s.bg,n=s.children;return h.createElement("div",{style:{width:"100%",height:"100%",background:r}},n)};function Dt(t,s){return Object.keys(t).map(function(r){var n=parseFloat(r),d="".concat(Math.floor(n*s),"%");return"".concat(t[r]," ").concat(d)})}var Gs=h.forwardRef(function(t,s){var r=t.prefixCls,n=t.color,d=t.gradientId,w=t.radius,l=t.style,p=t.ptg,j=t.strokeLinecap,a=t.strokeWidth,I=t.size,M=t.gapDegree,v=n&&Ne(n)==="object",b=v?"#FFF":void 0,T=I/2,A=h.createElement("circle",{className:"".concat(r,"-circle-path"),r:w,cx:T,cy:T,stroke:b,strokeLinecap:j,strokeWidth:a,opacity:p===0?0:1,style:l,ref:s});if(!v)return A;var _="".concat(d,"-conic"),k=M?"".concat(180+M/2,"deg"):"0deg",E=Dt(n,(360-M)/360),B=Dt(n,1),f="conic-gradient(from ".concat(k,", ").concat(E.join(", "),")"),S="linear-gradient(to ".concat(M?"bottom":"top",", ").concat(B.join(", "),")");return h.createElement(h.Fragment,null,h.createElement("mask",{id:_},A),h.createElement("foreignObject",{x:0,y:0,width:I,height:I,mask:"url(#".concat(_,")")},h.createElement(At,{bg:S},h.createElement(At,{bg:f}))))}),Me=100,et=function(s,r,n,d,w,l,p,j,a,I){var M=arguments.length>10&&arguments[10]!==void 0?arguments[10]:0,v=n/100*360*((360-l)/360),b=l===0?0:{bottom:0,top:180,left:90,right:-90}[p],T=(100-d)/100*r;a==="round"&&d!==100&&(T+=I/2,T>=r&&(T=r-.01));var A=Me/2;return{stroke:typeof j=="string"?j:void 0,strokeDasharray:"".concat(r,"px ").concat(s),strokeDashoffset:T+M,transform:"rotate(".concat(w+v+b,"deg)"),transformOrigin:"".concat(A,"px ").concat(A,"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s",fillOpacity:0}},Ys=["id","prefixCls","steps","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor","percent"];function Tt(t){var s=t??[];return Array.isArray(s)?s:[s]}var Ks=function(s){var r=ft(ft({},Ns),s),n=r.id,d=r.prefixCls,w=r.steps,l=r.strokeWidth,p=r.trailWidth,j=r.gapDegree,a=j===void 0?0:j,I=r.gapPosition,M=r.trailColor,v=r.strokeLinecap,b=r.style,T=r.className,A=r.strokeColor,_=r.percent,k=Mt(r,Ys),E=Me/2,B=Us(n),f="".concat(B,"-gradient"),S=E-l/2,R=Math.PI*2*S,m=a>0?90+a/2:-90,P=R*((360-a)/360),c=Ne(w)==="object"?w:{count:w,space:2},F=c.count,u=c.space,C=Tt(_),D=Tt(A),i=D.find(function(K){return K&&Ne(K)==="object"}),x=i&&Ne(i)==="object",y=x?"butt":v,$=et(R,P,0,100,m,a,I,M,y,l),L=Ms(),O=function(){var H=0;return C.map(function(W,Y){var z=D[Y]||D[D.length-1],q=et(R,P,H,W,m,a,I,z,y,l);return H+=W,h.createElement(Gs,{key:Y,color:z,ptg:W,radius:S,prefixCls:d,gradientId:f,style:q,strokeLinecap:y,strokeWidth:l,gapDegree:a,ref:function(ie){L[Y]=ie},size:Me})}).reverse()},g=function(){var H=Math.round(F*(C[0]/100)),W=100/F,Y=0;return new Array(F).fill(null).map(function(z,q){var se=q<=H-1?D[0]:M,ie=se&&Ne(se)==="object"?"url(#".concat(f,")"):void 0,G=et(R,P,Y,W,m,a,I,se,"butt",l,u);return Y+=(P-G.strokeDashoffset+u)*100/P,h.createElement("circle",{key:q,className:"".concat(d,"-circle-path"),r:S,cx:E,cy:E,stroke:ie,strokeWidth:l,opacity:1,style:G,ref:function(Z){L[q]=Z}})})};return h.createElement("svg",Ht({className:Je("".concat(d,"-circle"),T),viewBox:"0 0 ".concat(Me," ").concat(Me),style:b,id:n,role:"presentation"},k),!F&&h.createElement("circle",{className:"".concat(d,"-circle-trail"),r:S,cx:E,cy:E,stroke:M,strokeLinecap:y,strokeWidth:p||l,style:$}),F?g():O())};function ge(t){return!t||t<0?0:t>100?100:t}function qe(t){let{success:s,successPercent:r}=t,n=r;return s&&"progress"in s&&(n=s.progress),s&&"percent"in s&&(n=s.percent),n}const zs=t=>{let{percent:s,success:r,successPercent:n}=t;const d=ge(qe({success:r,successPercent:n}));return[d,ge(ge(s)-d)]},qs=t=>{let{success:s={},strokeColor:r}=t;const{strokeColor:n}=s;return[n||st.green,r||null]},Qe=(t,s,r)=>{var n,d,w,l;let p=-1,j=-1;if(s==="step"){const a=r.steps,I=r.strokeWidth;typeof t=="string"||typeof t>"u"?(p=t==="small"?2:14,j=I??8):typeof t=="number"?[p,j]=[t,t]:[p=14,j=8]=t,p*=a}else if(s==="line"){const a=r==null?void 0:r.strokeWidth;typeof t=="string"||typeof t>"u"?j=a||(t==="small"?6:8):typeof t=="number"?[p,j]=[t,t]:[p=-1,j=8]=t}else(s==="circle"||s==="dashboard")&&(typeof t=="string"||typeof t>"u"?[p,j]=t==="small"?[60,60]:[120,120]:typeof t=="number"?[p,j]=[t,t]:(p=(d=(n=t[0])!==null&&n!==void 0?n:t[1])!==null&&d!==void 0?d:120,j=(l=(w=t[0])!==null&&w!==void 0?w:t[1])!==null&&l!==void 0?l:120));return[p,j]},Xs=3,Js=t=>Xs/t*100,Qs=t=>{const{prefixCls:s,trailColor:r=null,strokeLinecap:n="round",gapPosition:d,gapDegree:w,width:l=120,type:p,children:j,success:a,size:I=l}=t,[M,v]=Qe(I,"circle");let{strokeWidth:b}=t;b===void 0&&(b=Math.max(Js(M),6));const T={width:M,height:v,fontSize:M*.15+6},A=h.useMemo(()=>{if(w||w===0)return w;if(p==="dashboard")return 75},[w,p]),_=d||p==="dashboard"&&"bottom"||void 0,k=Object.prototype.toString.call(t.strokeColor)==="[object Object]",E=qs({success:a,strokeColor:t.strokeColor}),B=Je(`${s}-inner`,{[`${s}-circle-gradient`]:k}),f=h.createElement(Ks,{percent:zs(t),strokeWidth:b,trailWidth:b,strokeColor:E,strokeLinecap:n,trailColor:r,prefixCls:s,gapDegree:A,gapPosition:_});return h.createElement("div",{className:B,style:T},M<=20?h.createElement(Wt,{title:j},h.createElement("span",null,f)):h.createElement(h.Fragment,null,f,j))},Zs=Qs,Xe="--progress-line-stroke-color",Rt="--progress-percent",$t=t=>{const s=t?"100%":"-100%";return new Kt(`antProgress${t?"RTL":"LTR"}Active`,{"0%":{transform:`translateX(${s}) scaleX(0)`,opacity:.1},"20%":{transform:`translateX(${s}) scaleX(0)`,opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}})},Vs=t=>{const{componentCls:s,iconCls:r}=t;return{[s]:Object.assign(Object.assign({},Yt(t)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:t.fontSize},[`${s}-outer`]:{display:"inline-block",width:"100%"},[`&${s}-show-info`]:{[`${s}-outer`]:{marginInlineEnd:`calc(-2em - ${mt(t.marginXS)})`,paddingInlineEnd:`calc(2em + ${mt(t.paddingXS)})`}},[`${s}-inner`]:{position:"relative",display:"inline-block",width:"100%",overflow:"hidden",verticalAlign:"middle",backgroundColor:t.remainingColor,borderRadius:t.lineBorderRadius},[`${s}-inner:not(${s}-circle-gradient)`]:{[`${s}-circle-path`]:{stroke:t.defaultColor}},[`${s}-success-bg, ${s}-bg`]:{position:"relative",background:t.defaultColor,borderRadius:t.lineBorderRadius,transition:`all ${t.motionDurationSlow} ${t.motionEaseInOutCirc}`},[`${s}-bg`]:{overflow:"hidden","&::after":{content:'""',background:{_multi_value_:!0,value:["inherit",`var(${Xe})`]},height:"100%",width:`calc(1 / var(${Rt}) * 100%)`,display:"block"}},[`${s}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:t.colorSuccess},[`${s}-text`]:{display:"inline-block",width:"2em",marginInlineStart:t.marginXS,color:t.colorText,lineHeight:1,whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[r]:{fontSize:t.fontSize}},[`&${s}-status-active`]:{[`${s}-bg::before`]:{position:"absolute",inset:0,backgroundColor:t.colorBgContainer,borderRadius:t.lineBorderRadius,opacity:0,animationName:$t(),animationDuration:t.progressActiveMotionDuration,animationTimingFunction:t.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${s}-rtl${s}-status-active`]:{[`${s}-bg::before`]:{animationName:$t(!0)}},[`&${s}-status-exception`]:{[`${s}-bg`]:{backgroundColor:t.colorError},[`${s}-text`]:{color:t.colorError}},[`&${s}-status-exception ${s}-inner:not(${s}-circle-gradient)`]:{[`${s}-circle-path`]:{stroke:t.colorError}},[`&${s}-status-success`]:{[`${s}-bg`]:{backgroundColor:t.colorSuccess},[`${s}-text`]:{color:t.colorSuccess}},[`&${s}-status-success ${s}-inner:not(${s}-circle-gradient)`]:{[`${s}-circle-path`]:{stroke:t.colorSuccess}}})}},er=t=>{const{componentCls:s,iconCls:r}=t;return{[s]:{[`${s}-circle-trail`]:{stroke:t.remainingColor},[`&${s}-circle ${s}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${s}-circle ${s}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:t.circleTextColor,fontSize:t.circleTextFontSize,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[r]:{fontSize:t.circleIconFontSize}},[`${s}-circle&-status-exception`]:{[`${s}-text`]:{color:t.colorError}},[`${s}-circle&-status-success`]:{[`${s}-text`]:{color:t.colorSuccess}}},[`${s}-inline-circle`]:{lineHeight:1,[`${s}-inner`]:{verticalAlign:"bottom"}}}},tr=t=>{const{componentCls:s}=t;return{[s]:{[`${s}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:t.progressStepMinWidth,marginInlineEnd:t.progressStepMarginInlineEnd,backgroundColor:t.remainingColor,transition:`all ${t.motionDurationSlow}`,"&-active":{backgroundColor:t.defaultColor}}}}}},sr=t=>{const{componentCls:s,iconCls:r}=t;return{[s]:{[`${s}-small&-line, ${s}-small&-line ${s}-text ${r}`]:{fontSize:t.fontSizeSM}}}},rr=t=>({circleTextColor:t.colorText,defaultColor:t.colorInfo,remainingColor:t.colorFillSecondary,lineBorderRadius:100,circleTextFontSize:"1em",circleIconFontSize:`${t.fontSize/t.fontSizeSM}em`}),ar=Ut("Progress",t=>{const s=t.calc(t.marginXXS).div(2).equal(),r=Gt(t,{progressStepMarginInlineEnd:s,progressStepMinWidth:s,progressActiveMotionDuration:"2.4s"});return[Vs(r),er(r),tr(r),sr(r)]},rr);var or=function(t,s){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(t);d<n.length;d++)s.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(t,n[d])&&(r[n[d]]=t[n[d]]);return r};const nr=t=>{let s=[];return Object.keys(t).forEach(r=>{const n=parseFloat(r.replace(/%/g,""));isNaN(n)||s.push({key:n,value:t[r]})}),s=s.sort((r,n)=>r.key-n.key),s.map(r=>{let{key:n,value:d}=r;return`${d} ${n}%`}).join(", ")},lr=(t,s)=>{const{from:r=st.blue,to:n=st.blue,direction:d=s==="rtl"?"to left":"to right"}=t,w=or(t,["from","to","direction"]);if(Object.keys(w).length!==0){const p=nr(w),j=`linear-gradient(${d}, ${p})`;return{background:j,[Xe]:j}}const l=`linear-gradient(${d}, ${r}, ${n})`;return{background:l,[Xe]:l}},ir=t=>{const{prefixCls:s,direction:r,percent:n,size:d,strokeWidth:w,strokeColor:l,strokeLinecap:p="round",children:j,trailColor:a=null,success:I}=t,M=l&&typeof l!="string"?lr(l,r):{[Xe]:l,background:l},v=p==="square"||p==="butt"?0:void 0,b=d??[-1,w||(d==="small"?6:8)],[T,A]=Qe(b,"line",{strokeWidth:w}),_={backgroundColor:a||void 0,borderRadius:v},k=Object.assign(Object.assign({width:`${ge(n)}%`,height:A,borderRadius:v},M),{[Rt]:ge(n)/100}),E=qe(t),B={width:`${ge(E)}%`,height:A,borderRadius:v,backgroundColor:I==null?void 0:I.strokeColor},f={width:T<0?"100%":T,height:A};return h.createElement(h.Fragment,null,h.createElement("div",{className:`${s}-outer`,style:f},h.createElement("div",{className:`${s}-inner`,style:_},h.createElement("div",{className:`${s}-bg`,style:k}),E!==void 0?h.createElement("div",{className:`${s}-success-bg`,style:B}):null)),j)},cr=ir,dr=t=>{const{size:s,steps:r,percent:n=0,strokeWidth:d=8,strokeColor:w,trailColor:l=null,prefixCls:p,children:j}=t,a=Math.round(r*(n/100)),M=s??[s==="small"?2:14,d],[v,b]=Qe(M,"step",{steps:r,strokeWidth:d}),T=v/r,A=new Array(r);for(let _=0;_<r;_++){const k=Array.isArray(w)?w[_]:w;A[_]=h.createElement("div",{key:_,className:Je(`${p}-steps-item`,{[`${p}-steps-item-active`]:_<=a-1}),style:{backgroundColor:_<=a-1?k:l,width:T,height:b}})}return h.createElement("div",{className:`${p}-steps-outer`},A,j)},pr=dr;var ur=function(t,s){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(t);d<n.length;d++)s.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(t,n[d])&&(r[n[d]]=t[n[d]]);return r};const xr=["normal","exception","active","success"],hr=h.forwardRef((t,s)=>{const{prefixCls:r,className:n,rootClassName:d,steps:w,strokeColor:l,percent:p=0,size:j="default",showInfo:a=!0,type:I="line",status:M,format:v,style:b}=t,T=ur(t,["prefixCls","className","rootClassName","steps","strokeColor","percent","size","showInfo","type","status","format","style"]),A=h.useMemo(()=>{var D,i;const x=qe(t);return parseInt(x!==void 0?(D=x??0)===null||D===void 0?void 0:D.toString():(i=p??0)===null||i===void 0?void 0:i.toString(),10)},[p,t.success,t.successPercent]),_=h.useMemo(()=>!xr.includes(M)&&A>=100?"success":M||"normal",[M,A]),{getPrefixCls:k,direction:E,progress:B}=h.useContext(zt),f=k("progress",r),[S,R,m]=ar(f),P=h.useMemo(()=>{if(!a)return null;const D=qe(t);let i;const x=v||($=>`${$}%`),y=I==="line";return v||_!=="exception"&&_!=="success"?i=x(ge(p),ge(D)):_==="exception"?i=y?h.createElement(Xt,null):h.createElement(Jt,null):_==="success"&&(i=y?h.createElement(Is,null):h.createElement(Qt,null)),h.createElement("span",{className:`${f}-text`,title:typeof i=="string"?i:void 0},i)},[a,p,A,_,I,f,v]),c=Array.isArray(l)?l[0]:l,F=typeof l=="string"||Array.isArray(l)?l:void 0;let u;I==="line"?u=w?h.createElement(pr,Object.assign({},t,{strokeColor:F,prefixCls:f,steps:w}),P):h.createElement(cr,Object.assign({},t,{strokeColor:c,prefixCls:f,direction:E}),P):(I==="circle"||I==="dashboard")&&(u=h.createElement(Zs,Object.assign({},t,{strokeColor:c,prefixCls:f,progressStatus:_}),P));const C=Je(f,`${f}-status-${_}`,`${f}-${I==="dashboard"&&"circle"||w&&"steps"||I}`,{[`${f}-inline-circle`]:I==="circle"&&Qe(j,"circle")[0]<=20,[`${f}-show-info`]:a,[`${f}-${j}`]:typeof j=="string",[`${f}-rtl`]:E==="rtl"},B==null?void 0:B.className,n,d,R,m);return S(h.createElement("div",Object.assign({ref:s,style:Object.assign(Object.assign({},B==null?void 0:B.style),b),className:C,role:"progressbar","aria-valuenow":A},qt(T,["trailColor","strokeWidth","width","gapDegree","gapPosition","strokeLinecap","success","successPercent"])),u))}),It=hr;function gr({title:t,setShowVehicles:s,showVehicles:r,showParams:n,setShowParams:d}){const w=de(),{collapsed:l}=N(B=>B.auth),{isLiveParameter:p,isWriteParameter:j,isActuator:a,isRoutineTest:I,isFlashing:M,isJ1939:v,selectedVehicle:b}=N(B=>B.diagnostics),{tractorIcon:T}=N(B=>B.liveMap);JSON.parse(localStorage.getItem("w_userDetails"));const{mode:A,selectedVehicleGroup:_}=N(B=>B.dashboard),k=()=>{w(rs(!l))},E={fontSize:"26px",fontWeight:500,lineHeight:"18.38px",color:"#fff",textAlign:"center",paddingTop:"5px",fontFamily:"ubuntu"};return e.jsxs(o,{style:{display:"flex",justifyContent:"space-between",paddingRight:"20px",backgroundColor:Ge.bgColor,alignItems:"center",textAlign:"center",height:"60px",color:"white"},children:[e.jsxs(o,{style:{display:"flex",justifyContent:"space-between",gap:"10px",alignItems:"center",width:"50%"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[l?e.jsx(re,{onClick:k,sx:{color:"white"},children:e.jsx(Zt,{style:{width:"30px",height:"30px"}})}):e.jsx(re,{onClick:k,sx:{color:"white"},children:e.jsx(Vt,{style:{width:"30px",height:"30px"}})}),e.jsx("img",{src:es,alt:"wikitrak logo"})]}),e.jsx(o,{children:e.jsx(ts,{style:E,children:t})})]}),e.jsxs(o,{style:{display:"flex",gap:"5px"},children:[e.jsxs(re,{variant:"outlined",size:"small",sx:{color:r?"white":"black",backgroundColor:r?"transparent":"white",mt:"6px",mx:"5px",border:"1px solid white",width:"150px",height:"40px","&:hover":{color:"white",border:"1px solid black"}},onClick:()=>{s(!r),d(!1)},children:[e.jsx("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",style:{marginRight:"5px"},children:e.jsx("path",{d:T.path1})}),Object.keys(b).length>0?b.reg_id:"Vehicles"]}),(p||j||a||I||M||v)&&e.jsxs(re,{variant:"outlined",size:"small",sx:{color:n?"blue":"white",backgroundColor:n?"white":"undefined",mt:"6px",mx:"5px",border:"1px solid white",height:"40px"},onClick:()=>{s(!1),d(!n)},children:[p&&"Live Parameter",j&&"Write Parameter",a&&"Actuator Test",I&&"Routine Test",M&&"Flashing",v&&"J1939 Parameter"]}),e.jsx(fe,{onClick:()=>{w(ss(!A))},sx:{color:"white"}})]})]})}const fr=({vehicleData:t,handleChange:s})=>{const{selectedVehicle:r}=N(j=>j.diagnostics),[n,d]=h.useState(""),{mode:w}=N(j=>j.dashboard),l=ae(w),p=t&&t.length>0&&t.filter(j=>j.label.toLowerCase().includes(n));return e.jsxs(e.Fragment,{children:[e.jsx(Lt,{style:{width:"85%",margin:"8px 20px",padding:"10px"},placeholder:"Search vehicle",onChange:j=>d(j.target.value)}),p.length>0?p.map((j,a)=>e.jsx(o,{sx:{align:"center",my:"8px",ml:"20px"},children:e.jsx(re,{variant:"outlined",onClick:()=>{s(j)},sx:{width:"90%",bgcolor:j.label===(r==null?void 0:r.reg_id)?Ge.bgColor:"undefined",color:j.label===(r==null?void 0:r.reg_id)?"white":l.grey[400],border:`1px solid ${Ge.bgColor}`,"&:hover":{color:"black",border:"1px solid black",bgcolor:Ge.bgShadow}},children:j.label})},a)):e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsx(as,{sx:{textAlign:"center",color:l.grey[400]},children:"Sorry! No vehicles"})})]})},mr=({options:t})=>{const{selectedMenu:s,selectedVehicle:r}=N(p=>p.diagnostics),n=de(),{mode:d}=N(p=>p.dashboard),w=ae(d),l=p=>{switch(bt(p),n(bt(p)),p){case"Terminal Application":n(xs());break;case"Write Parameters":n(us());break;case"Read DTC":n(ps());break;case"Live Parameters":n(ds());break;case"Actuator Test":n(cs());break;case"Routine Test":n(is());break;case"ECU Information":n(ls());break;case"Flashing":n(ns());break;case"J1939 Parameters":n(os());break}};return e.jsx(e.Fragment,{children:e.jsx("div",{children:t.length>0&&t.map((p,j)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsxs(o,{sx:{border:s!==p.label?"1px solid #E8E8E8":"",p:"8px",borderRadius:"5px",m:"10px",display:"flex",cursor:"pointer",color:s===p.label?"white":w.grey[400],backgroundColor:s===p.label?"#8DA6C6":void 0},onClick:()=>{l(p.label)},children:[e.jsx(o,{sx:{mx:"5px"},children:p.icon}),e.jsx(o,{sx:{mx:"5px",fontSize:"16px"},children:e.jsx("span",{children:p.label})})]})},j))})})},Bt="https://cc.wikitrak.in/proxy-3031",br=({deviceType:t})=>{var R,m,P;const s=de(),{liveParameters:r,isLiveParameter:n,isWriteParameter:d,isActuator:w,isRoutineTest:l,isFlashing:p,loading:j,isDtcLoader:a,isJ1939:I,j1939Parameters:M}=N(c=>c.diagnostics),{vehicleList:v,selectedVehicle:b}=N(c=>c.liveMap);N(c=>c.dashboard);let A=(P=(m=(R=((v||[]).find(c=>{var F;return((F=c==null?void 0:c.imei[0])==null?void 0:F.mac_id)===(b==null?void 0:b.imei)})||{}).sub_model)==null?void 0:R.ecus[0])==null?void 0:m.ecu[0])==null?void 0:P.file;A=(A==null?void 0:A.map(c=>({...c,label:c.sw_part_no})))||[];const _=(c,F)=>{let u=r.map((C,D)=>(C.label,{...C,checked:C.label===F?c.target.checked:C.checked}));s(be(u))},k=(c,F)=>{let u=M.map((C,D)=>(C.label,{...C,checked:C.label===F?c.target.checked:C.checked}));s(Ye(u))},E=c=>{s(hs(c.label)),s(gs(c))},B=c=>{s(fs(c.label)),s(ms(c))},f=c=>{s(bs(c.label)),s(ys(c))},S=c=>{s(rt(c.label)),s(at(c))};return e.jsxs("div",{children:[a&&e.jsx(ke,{}),n&&e.jsx(yr,{handleLiveParameter:_,deviceType:t}),d&&e.jsx(_r,{handleWriteParameter:E}),w&&e.jsx(Cr,{handleActuatorTest:B}),l&&e.jsx(jr,{handleRoutineTest:f}),p&&e.jsx(Sr,{handleFlashing:S}),I&&e.jsx(kr,{handleJ1939Parameter:k})]})},yr=({handleLiveParameter:t,deviceType:s})=>{const r=de(),{liveParameters:n,liveParameterGroupList:d,selectedVehicle:w}=N(m=>m.diagnostics),{mode:l}=N(m=>m.dashboard),p=ae(l);N(m=>m.liveMap);const[j,a]=h.useState(""),[I,M]=h.useState(""),[v,b]=h.useState(!1);h.useState(!1);const T=n.length>0&&n.filter(m=>m.label.toLowerCase().includes(j.toLowerCase())),A=d.length>0&&d.filter(m=>m.label.toLowerCase().includes(I.toLowerCase())),_=(m,P)=>{P==="group"&&M(m.target.value),P==="one"&&a(m.target.value)};function k(m){return m.match(/../g).reverse().join("")}function E(m,P){const{pidArray:c,frames:F}=m,u=F[F.length-1];let C=0;for(const D of c){const x=D.toLowerCase().padStart(4,"0").match(/../g).reverse().join(""),y=n.find(K=>K.code===x);if(!y||!Array.isArray(y.pi_code_variable)||y.pi_code_variable.length===0){console.warn(`Invalid or missing pi_code_variable for PID: ${x}`);continue}const $=y.pi_code_variable[0];if(!$||typeof $.length!="number"||!$.message_type||$.length<=0){console.warn(`Invalid byte definition for PID: ${x}`,$);continue}const L=$.length,O=L*2,g=u.slice(C*2,C*2+O);if(D===P){const{resolution:K=1,offset:H=0,message_type:W}=$,Y=k(g);let z=null;switch(W){case"CONTINUOUS":z=ze(Y)*K+H;break;case"ASCII":z=Ke(Y);break;case"eNUM":case"bcd-hex":z=Y;break;case"FLOAT":z=_s(Y);break;default:return{pid:P,error:`Unknown message_type: ${W}`}}return{pidCheck:x,valueHex:g,valueHexLE:Y,decimalValue:z}}C+=L}return{pid:P,error:"PID not found or byte definition missing"}}const B=async()=>{var P;const m=n.filter(c=>c.checked);if(s==="Sinocastel"){r(ne(!0));try{const F=m.map(i=>i.code).map(i=>i.toLowerCase().padStart(4,"0").match(/../g).reverse().join("")),{data:u}=await le.post(`${Bt}/api/packet/latest`,{imei:w.imei,pid:F}),C=(P=u==null?void 0:u.results)!=null&&P.length?u.results.filter(i=>i==null?void 0:i.packet).map(i=>E(i.packet,i.pid)):[],D=n.map(i=>{const x=C.find(y=>y.pidCheck===i.code);return console.log("match",x,x==null?void 0:x.decimalValue),{...i,dataByte:x?x.decimalValue:""}});r(be(D)),r(ne(!1))}catch(c){r(ne(!1)),console.error("Error in Sinocastel flow:",c),U.error("Failed to read parameter data")}}else try{r(ne(!0));const c=m.map(i=>({command:ee("4",i.code,"00"),id:i.id})),F=c.map(i=>i.command),u=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:w.imei,commands:`{${F}}`}),C=u==null?void 0:u.data;if(!(C!=null&&C.success)||!Array.isArray(C.commands))throw new Error("Invalid API response");let D=[...n];C.commands.forEach((i,x)=>{var y;try{const $=Pt(i),{id:L}=c[x]||{};if(!L)return;const O=D.find(W=>W.id===L),g=(y=O==null?void 0:O.pi_code_variable)==null?void 0:y[0];if(!g||!$.startsWith("62")){g!=null&&g.short_name&&U.error(`Negative response from ECU for ${g.short_name}`);return}let K=$.toLowerCase().replace(O.code.toLowerCase().slice(2),"").slice(2),H;switch(g.message_type){case"CONTINUOUS":H=ze(K)*g.resolution+g.offset;break;case"ASCII":H=Ke(K);break;case"eNUM":case"bcd-hex":H=K;break;default:return}D=D.map(W=>W.id===L?{...W,dataByte:H}:W)}catch($){console.error("Error decoding command:",$)}}),r(be(D))}catch(c){console.error("Error in handleSubmit:",c),U.error("Response timeout")}finally{r(ne(!1))}},f=()=>{b(!v)},S=(m,P)=>{const c=m.target.checked;console.log("ischeckd",c);const F=d.find(C=>C.id===P);if(!F)return;const u=n.map(C=>{var i,x,y;const D=(y=(x=(i=C.pi_code_variable)==null?void 0:i[0])==null?void 0:x.group)==null?void 0:y.some($=>$.id===F.id);return console.log("belongsToGroup",D),D?{...C,checked:c}:C});r(be(u))},R=m=>{if(m.target.checked){let P=n.map(c=>({...c,checked:!0}));r(be(P))}else{let P=n.map(c=>({...c,checked:!1}));r(be(P))}};return e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[!v&&e.jsxs(e.Fragment,{children:[e.jsxs(ye,{sx:{width:"75%",mt:"15px",mx:"15px",backgroundColor:p.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(_e,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:p.grey[400]},children:"Search"}),e.jsx(Ce,{onChange:m=>{_(m,"one")},inputProps:{style:{padding:7,color:p.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(je,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Se,{})})}),label:"Search"})]}),e.jsx("input",{type:"checkbox",style:{marginTop:"25px"},onChange:R})]}),v&&e.jsx(e.Fragment,{children:e.jsxs(ye,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:p.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(_e,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:p.grey[400]},children:"Search"}),e.jsx(Ce,{onChange:m=>{_(m,"group")},inputProps:{style:{padding:7,color:p.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(je,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Se,{})})}),label:"Search"})]})})]}),!v&&e.jsxs("div",{style:{height:"67vh",overflow:"auto"},children:[T.length>0&&T.map((m,P)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},title:m.label,children:e.jsxs(o,{sx:{border:"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:p.grey[400]},children:[e.jsx(o,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:m.label.length<=25?m.label:`${m.label.substring(0,25)}...`})}),e.jsx(o,{sx:{fontSize:"16px",position:"relative",right:"2px"},children:e.jsx("input",{type:"checkbox",onChange:c=>{t(c,m.label)},checked:m.checked,style:{width:"20px",padding:0}})})]})},P)),!(T.length>0)&&e.jsx("h3",{children:"No Data"})]}),v&&e.jsx("div",{style:{height:"67vh",overflow:"auto"},children:A.length>0&&A.map((m,P)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},title:m.label,children:e.jsxs(o,{sx:{border:"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:p.grey[400]},children:[e.jsx(o,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:m.label.length<=25?m.label:`${m.label.substring(0,20)}...`})}),e.jsx(o,{sx:{fontSize:"16px",position:"relative",right:"2px"},children:e.jsx("input",{type:"checkbox",onChange:c=>{S(c,m.id)},checked:m.checked,style:{width:"20px",padding:0}})})]})},P))}),e.jsx(o,{sx:{mt:"25px"},children:e.jsx(re,{variant:"contained",sx:{width:"90%",mx:"10px",backgroundColor:"#8DA6C6"},onClick:B,children:"Submit"})}),e.jsx(o,{sx:{mt:"10px"},children:e.jsx(re,{variant:"contained",sx:{width:"90%",mx:"10px",backgroundColor:"white",color:"black"},onClick:f,children:v?"Select Parameter":"Select Group"})})]})},_r=({handleWriteParameter:t})=>{const{writeParameter:s,activeWriteParameter:r}=N(a=>a.diagnostics),{mode:n}=N(a=>a.dashboard),d=ae(n),[w,l]=h.useState(""),p=s.length>0&&s.filter(a=>a.label.toLowerCase().includes(w.toLowerCase())),j=a=>{l(a.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(o,{children:e.jsxs(ye,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:d.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(_e,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:d.grey[400]},children:"Search"}),e.jsx(Ce,{onChange:j,inputProps:{style:{padding:7,color:d.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(je,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Se,{})})}),label:"Search"})]})}),p.length>0&&p.map((a,I)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(o,{sx:{p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",border:r===a.label?"1px solid #8DA6C6":"1px solid #E8E8E8",color:r===a.label?"white":d.grey[400],backgroundColor:r===a.label?"#8DA6C6":void 0},onClick:()=>{t(a)},children:e.jsx(o,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:a.label.length<=25?a.label:`${a.label.substring(0,25)}...`})})})},I))]})},Cr=({handleActuatorTest:t})=>{const{liveParameters:s,writeParameter:r,actuatorTestList:n,routineTestList:d,isLiveParameter:w,isWriteParameter:l,isActuator:p,activeWriteParameter:j,activeActuatorTest:a,activeRoutineTest:I,activeFlashingFile:M,isRoutineTest:v,isFlashing:b}=N(f=>f.diagnostics),{mode:T}=N(f=>f.dashboard),A=ae(T),[_,k]=h.useState(""),E=n.length>0&&n.filter(f=>f.label.toLowerCase().includes(_.toLowerCase())),B=f=>{k(f.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(o,{children:e.jsxs(ye,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:A.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(_e,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:A.grey[400]},children:"Search"}),e.jsx(Ce,{onChange:B,inputProps:{style:{padding:7,color:A.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(je,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Se,{})})}),label:"Search"})]})}),E.length>0&&E.map((f,S)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(o,{sx:{border:a===f.label?"1px solid #8DA6C6":"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:a===f.label?"white":A.grey[400],backgroundColor:a===f.label?"#8DA6C6":void 0},onClick:()=>{t(f)},children:e.jsx(o,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:f.label.length<=25?f.label:`${f.label.substring(0,25)}...`})})})},S))]})},jr=({handleRoutineTest:t})=>{const{routineTestList:s,activeRoutineTest:r}=N(a=>a.diagnostics),{mode:n}=N(a=>a.dashboard),d=ae(n),[w,l]=h.useState(""),p=s.length>0&&s.filter(a=>a.label.toLowerCase().includes(w.toLowerCase())),j=a=>{l(a.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(o,{children:e.jsxs(ye,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:d.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(_e,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:d.grey[400]},children:"Search"}),e.jsx(Ce,{onChange:j,inputProps:{style:{padding:7,color:d.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(je,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Se,{})})}),label:"Search"})]})}),p.length>0&&p.map((a,I)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(o,{sx:{border:r===a.label?"1px solid #8DA6C6":"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:r===a.label?"white":d.grey[400],backgroundColor:r===a.label?"#8DA6C6":void 0},onClick:()=>{t(a)},children:e.jsx(o,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:a.label.length<=25?a.label:`${a.label.substring(0,25)}...`})})})},I)),!s.length>0&&e.jsx("div",{style:{marginTop:"40%",textAlign:"center",color:d.grey[400]},children:e.jsx("h3",{children:"Routine test not available"})})]})},Sr=({handleFlashing:t})=>{const{activeFlashingFile:s,fotaFiles:r}=N(a=>a.diagnostics),{mode:n}=N(a=>a.dashboard),d=ae(n),[w,l]=h.useState(""),p=r.length>0&&r.filter(a=>a.label.toLowerCase().includes(w.toLowerCase())),j=a=>{l(a.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(o,{children:e.jsxs(ye,{sx:{width:"89%",mt:"15px",ml:"15px",backgroundColor:d.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(_e,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:d.grey[400]},children:"Search"}),e.jsx(Ce,{onChange:j,inputProps:{style:{padding:7,color:d.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(je,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Se,{})})}),label:"Search"})]})}),e.jsx("div",{style:{height:"90vh",overflow:"auto"},children:p.length>0&&p.map((a,I)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},children:e.jsx(o,{sx:{border:s===a.label?"1px solid #8DA6C6":"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:s===a.label?"white":d.grey[400],backgroundColor:s===a.label?"#8DA6C6":d.grey[100]},onClick:()=>{t(a)},children:e.jsx(o,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:a.label.length<=25?a.label:`${a.label.substring(0,25)}...`})})})},I))})]})},kr=({handleJ1939Parameter:t})=>{const s=de(),{j1939Parameters:r,selectedVehicle:n}=N(_=>_.diagnostics),{mode:d}=N(_=>_.dashboard),w=ae(d);N(_=>_.liveMap);const[l,p]=h.useState(""),[j,a]=h.useState(!1);h.useState(!1);const I=r.length>0&&r.filter(_=>_.label.toLowerCase().includes(l.toLowerCase())),M=(_,k)=>{k==="group"&&setSearchText2(_.target.value),k==="one"&&p(_.target.value)};function v(_){return _.match(/../g).reverse().join("")}function b(_,k){const{pidArray:E,frames:B}=_;B[B.length-1];for(const f of E){f.toLowerCase().padStart(4,"0");const S=f,R=r.find(c=>{var F;return((F=c==null?void 0:c.pgn)==null?void 0:F.toLowerCase())===(S==null?void 0:S.toLowerCase())});if(!R||!Array.isArray(R.spn)||R.spn.length===0){console.warn(`Invalid or missing pi_code_variable for PID: ${S}`);continue}const m=R.spn[0];if(!m||typeof m.no_of_bytes!="number"||!m.message_type||m.no_of_bytes<=0){console.warn(`Invalid byte definition for PID: ${S}`,m);continue}m.no_of_bytes;const P=B[E.indexOf(f)];if(f===k){const{resolution:c=1,offset:F=0,message_type:u,start_byte:C,start_bit:D,no_of_bit:i,endian:x,bitcoded:y,no_of_bytes:$}=m,L=(C-1)*2,O=L+$*2;let g=P.slice(L,O),K;y?K=parseInt(g,16).toString(2).padStart($*8,"0").slice(D-1,D-1+i):K=g;let H;x.toLowerCase()==="big"?H=K:H=v(K);let W=null;switch(u){case"CONTINUOUS":W=ze(H)*c+F;break;case"ASCII":W=Ke(H);break;case"eNUM":case"bcd-hex":W=H;break;default:return{pid:k,error:`Unknown message_type: ${u}`}}return{pidCheck:S,valueHex:P,decimalValue:W}}}return{pid:k,error:"PID not found or byte definition missing"}}const T=async()=>{var _;s(ne(!0));try{const E=r.filter(R=>R.checked).map(R=>R.pgn),{data:B}=await le.post(`${Bt}/api/packet/latest`,{imei:n.imei,pid:E}),f=(_=B==null?void 0:B.results)!=null&&_.length?B.results.filter(R=>R==null?void 0:R.packet).map(R=>b(R.packet,R.pid)):[];console.log("pidArray",f);const S=r.map(R=>{const m=f.find(P=>P.pidCheck===R.pgn);return console.log("match",m,m==null?void 0:m.decimalValue),{...R,dataByte:m?m.decimalValue:""}});s(Ye(S)),s(ne(!1))}catch(k){s(ne(!1)),console.error("Error in Sinocastel flow:",k),U.error("Failed to read parameter data")}},A=_=>{if(_.target.checked){let k=r.map(E=>({...E,checked:!0}));s(Ye(k))}else{let k=r.map(E=>({...E,checked:!1}));s(Ye(k))}};return e.jsxs(e.Fragment,{children:[e.jsx(o,{children:!j&&e.jsxs(e.Fragment,{children:[e.jsxs(ye,{sx:{width:"75%",mt:"15px",mx:"15px",backgroundColor:w.grey[500],borderRadius:"5px"},variant:"outlined",children:[e.jsx(_e,{htmlFor:"outlined-adornment-password",style:{marginTop:"-8px",color:w.grey[400]},children:"Search"}),e.jsx(Ce,{onChange:_=>{M(_,"one")},inputProps:{style:{padding:7,color:w.grey[400]}},id:"outlined-adornment-password",type:"text",endAdornment:e.jsx(je,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",edge:"end",children:e.jsx(Se,{})})}),label:"Search"})]}),e.jsx("input",{type:"checkbox",style:{marginTop:"25px"},onChange:A})]})}),!j&&e.jsxs("div",{style:{height:"67vh",overflow:"auto"},children:[I.length>0&&I.map((_,k)=>e.jsx(o,{sx:{align:"center",my:"8px",color:"grey"},title:_.label,children:e.jsxs(o,{sx:{border:"1px solid #E8E8E8",p:"8px",borderRadius:"5px",mx:"15px",display:"flex",cursor:"pointer",color:w.grey[400]},children:[e.jsx(o,{sx:{mx:"5px",width:"90%"},children:e.jsx("span",{children:_.label.length<=25?_.label:`${_.label.substring(0,25)}...`})}),e.jsx(o,{sx:{fontSize:"16px",position:"relative",right:"2px"},children:e.jsx("input",{type:"checkbox",onChange:E=>{t(E,_.label)},checked:_.checked,style:{width:"20px",padding:0}})})]})},k)),!(I.length>0)&&e.jsx("h3",{children:"No Data"})]}),e.jsx(o,{sx:{mt:"25px"},children:e.jsx(re,{variant:"contained",sx:{width:"90%",mx:"10px",backgroundColor:"#8DA6C6"},onClick:T,children:"Submit"})})]})},vr=()=>{var m,P,c,F,u,C,D;const t=de(),{vehicleList:s}=N(i=>i.liveMap),{terminalAppLogs:r,dtcDataset:n,loading:d,isDtcLoader:w,selectedVehicle:l}=N(i=>i.diagnostics),{mode:p}=N(i=>i.dashboard),j=ae(p),[a,I]=h.useState(0),[M,v]=h.useState(""),[b,T]=h.useState([]),[A,_]=h.useState(!1),k=(s||[]).find(i=>{var x;return((x=i==null?void 0:i.imei[0])==null?void 0:x.mac_id)===(l==null?void 0:l.imei)})||{};console.log("active vehilce ",k,l),console.log("vehicle list",s),h.useEffect(()=>{var i,x,y,$,L,O;if(((i=Object.keys(k))==null?void 0:i.length)>0&&((y=(x=k==null?void 0:k.sub_model)==null?void 0:x.ecus)==null?void 0:y.length)>0){let g=(O=(L=($=k==null?void 0:k.sub_model)==null?void 0:$.ecus[0])==null?void 0:L.datasets[0])==null?void 0:O.id;t(yt({id:g}))}},[]);const E=(i,x)=>{var W,Y;I(x);let y=(Y=(W=k==null?void 0:k.sub_model)==null?void 0:W.ecus[x].datasets[0])==null?void 0:Y.id;t(yt({id:y}));const{tx_header:$,rx_header:L,protocol:O}=i,g=`02${O.autopeepal},04${$},06${L}`;switch(k.sub_model.ecus[x].read_dtc_fn_index.value.split("_")[0]){case"GENERICOBD":{const z=ee("4","03","00"),q=ee("4","07","00");U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:z})),U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:q}));let se={imei:l.imei,commands:`{${z}, ${q}}`,tranCmd:`{${z}, ${q}}`};t(pe(se));break}case"UDS":{g||U.error("Please click again");let z,q=g.split(","),se=q==null?void 0:q.map(ie=>{if((q==null?void 0:q.length)%2===0){U.error("The Tx Frame format is not right. Must be odd length.");return}return z=ee("2",ie,"00"),z});if(se){U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:se}));let ie={imei:l.imei,commands:`{${se}}`,tranCmd:se};t(pe(ie))}break}case"KWP":{const z=ee("4","1800AF","00");U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:z}));let q={imei:l.imei,commands:`{${z}}`,tranCmd:`{${z}}`};t(pe(q));break}default:{_(!1);break}}},B=async(i,x,y)=>{var $,L;if(_(!0),y==="clear")try{v("");let O;O=ee(4,x,"00");const g=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:l.imei,commands:`{${O}}`});if(g!=null&&g.data&&_(!1),!(($=g==null?void 0:g.data)!=null&&$.success)){_(!1),v("Time Response is out");return}if(((L=g==null?void 0:g.data)==null?void 0:L.commands.filter(H=>H.toLowerCase()==="400000ffff")).length>0){v("No response from ECU");return}v("Ecu is clear dtc Success");return}catch{v("Time Response is out")}else if(y==="read"){v("");try{v("");let O;O=ee(4,x,"00");const g=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:l.imei,commands:`{${O}}`});return g!=null&&g.data&&_(!1),g==null?void 0:g.data}catch{return{success:!1}}}},f=async()=>{if(_(!0),a===null)return U.error("Please select the tab");const i=k.sub_model.ecus[a].read_dtc_fn_index.value;if(i==="KWP_2BYTE_DTC"||i==="UDS_2BYTE12_DTC"||i==="UDS_2BYTE_DTC"||i==="UDS_2BYTE13_DTC"||i==="UDS_3BYTE_DTC"){let x=null,y=!1;if(i==="KWP_2BYTE_DTC"){let L=null;L=await B(4,"1800FFFF","read"),L.success?(x=L.commands[0],y=!0):y=!1}else{let L=null;L=await B(3,"1902FF","read"),L.success?(x=L.commands[0],y=!0):y=!1}y&&x==="400000ffff"?v("No response from ECU"):y||v("Time Response Out");let $=[];if(i!=="KWP_2BYTE_DTC"){x=x==null?void 0:x.slice(6),x=x==null?void 0:x.slice(6),x=x==null?void 0:x.slice(0,-4),console.log(x);const L=[];for(let g=0;g<(x==null?void 0:x.length);g+=8)L.push(x==null?void 0:x.slice(g,g+8));const O=(g,K)=>((g&K)>>6).toString(16).padStart(2,"0");$=L.map(g=>{let K=0,H="",W="",Y=g.slice(0,2),z=O(Y,192);if(z==="00"?H="P":z==="01"?H="C":z==="02"?H="B":z==="03"&&(H="U"),i!=="KWP_2BYTE_DTC"){Y=g.slice(0,-2);let q=O(Y,129);switch(q){case"00":K="Inactive:LampOff";break;case"01":K="Active:LampOff";break;case"80":K="Inactive:LampOn";break;case"81":K="Active:LampOn";break}switch(i){case"UDS_3BYTE_DTC":Y=g.slice(0,2),q=O(Y,63),W=`${H}${q}${g.slice(2,4)}-${g.slice(4,6)}`;break}}return{type:W,value:K}}),T($)}}},S=async()=>{var x;if(a===null)return U.error("Please select the tab");const i=(x=k==null?void 0:k.sub_model)==null?void 0:x.ecus[a].clear_dtc_fn_index.value;if(i==="GENERICOBD"){const y=ee("4","04","00");U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:y})),t(pe(l.imei,`{${y}}`))}else{let y=i,$=null,L=0;return y==="UDS_4BYTES"?(L=4,$=B(L,"14FFFFFF","clear")):y==="UDS_3BYTES"?(L=3,$=B(L,"14FFFF","clear")):y==="GENERIC_OBD"?(L=1,$=B(L,"04","clear")):y==="KWP_PRIMITIVE"&&(L=1,$=B(L,"14","clear")),$}},R=i=>{var y;let x=[];return x=n.filter($=>($==null?void 0:$.code)===i),(x==null?void 0:x.length)>0?(y=x[0])==null?void 0:y.description:"Description is Not found"};return e.jsxs(o,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[(d||w||A)&&e.jsx(ke,{}),e.jsx(o,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((m=Object.keys(k))==null?void 0:m.length)>0&&((P=k==null?void 0:k.sub_model)==null?void 0:P.ecus.length)>0&&((c=k==null?void 0:k.sub_model)==null?void 0:c.ecus.map((i,x)=>e.jsx(o,{children:e.jsx(o,{variant:"contained",sx:{color:a===x?"#333333":j.grey[400],mt:"20px",backgroundColor:a===x?"#D5E1FE":j.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{E(i,x)},children:e.jsx("b",{children:i.name})})})))}),e.jsx(o,{children:b&&b.length>0?e.jsx(o,{sx:{height:"65vh",overflow:"auto"},children:b&&b.length>0&&b.map((i,x)=>e.jsx(Ps,{sx:{minWidth:275,mx:4,my:2,display:"flex",backgroundColor:j.grey[100],color:j.grey[400]},children:e.jsxs(Ls,{sx:{display:"flex"},children:[e.jsxs(o,{sx:{width:"35vw"},children:[e.jsx(o,{sx:{fontSize:"15px"},children:i==null?void 0:i.type}),e.jsx(o,{sx:{fontSize:"15px"},children:R(i==null?void 0:i.type)})]}),e.jsx(o,{children:e.jsx(re,{variant:"contained",sx:{color:"white",height:"25px",mt:"20px",ml:"50px",fontSize:"13px",backgroundColor:"#8DA6C6"},children:"Troubleshoot"})}),e.jsxs(o,{sx:{ml:"20px"},children:[e.jsx(o,{sx:{textAlign:"center"},children:"Status"}),e.jsxs(o,{children:[" ",e.jsx(re,{variant:"contained",sx:{color:"white",height:"25px",width:"150px",fontSize:"13px",backgroundColor:"#8DA6C6"},children:i==null?void 0:i.value})]})]})]})},x))}):e.jsx(o,{children:M.length>0?e.jsx(o,{sx:{textAlign:"center",marginTop:"20%"},children:M}):e.jsx(o,{sx:{textAlign:"center",marginTop:"20%",color:j.grey[400]},children:"Wait!, Your request is in progress..."})})}),r&&r.length>0&&r[r.length-1].color==="green"&&r.length>0&&((F=r[r.length-1].log)==null?void 0:F.length)>0&&((u=r[r.length-1].log[0])==null?void 0:u.toLowerCase())==="20010000e1f0"&&((C=r[r.length-1].log[1])==null?void 0:C.toLowerCase())==="20010000e1f0"&&((D=r[r.length-1].log[2])==null?void 0:D.toLowerCase())==="20010000e1f0"&&e.jsxs(o,{sx:{display:"flex",position:"fixed",top:"85%",left:"38%"},children:[e.jsx(o,{sx:{mx:"20px"},children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:f,children:"Read Dtc"})}),e.jsx(o,{children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:()=>{S()},children:"Clear Dtc"})})]})]})},wr=()=>{var _,k,E,B,f;const t=de(),{vehicleList:s}=N(S=>S.liveMap),{selectedVehicle:r}=N(S=>S.diagnostics),{liveParameters:n,loading:d,isDtcLoader:w}=N(S=>S.diagnostics),{mode:l}=N(S=>S.dashboard),p=ae(l),[j,a]=h.useState(0),[I,M]=h.useState(!1),v=(s||[]).find(S=>{var R;return((R=S==null?void 0:S.imei[0])==null?void 0:R.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var S,R,m,P,c,F;if(((S=Object.keys(v))==null?void 0:S.length)>0&&((m=(R=v==null?void 0:v.sub_model)==null?void 0:R.ecus)==null?void 0:m.length)>0){let u=(F=(c=(P=v==null?void 0:v.sub_model)==null?void 0:P.ecus[j])==null?void 0:c.pid_datasets[0])==null?void 0:F.id;t(_t({pid:u})),t(Ct({pid:u}))}},[]);const b=(S,R)=>{var i,x;a(R);let m=(x=(i=v==null?void 0:v.sub_model)==null?void 0:i.ecus[R].pid_datasets[0])==null?void 0:x.id;t(_t({pid:m})),t(Ct({pid:m}));const{tx_header:P,rx_header:c,protocol:F}=S,u=`02${F.autopeepal},04${P},06${c}`;switch(v.sub_model.ecus[R].read_dtc_fn_index.value.split("_")[0]){case"GENERICOBD":{const y=ee("4","03","00"),$=ee("4","07","00");U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:y})),U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:$}));let L={imei:r.imei,commands:`{${y}, ${$}}`,tranCmd:`{${y}, ${$}}`};t(pe(L));break}case"UDS":{u||U.error("Please click again");let y,$=u.split(","),L=$==null?void 0:$.map(O=>{if(($==null?void 0:$.length)%2===0){U.error("The Tx Frame format is not right. Must be odd length.");return}return y=ee("2",O,"00"),y});if(L){U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:L}));let O={imei:r.imei,commands:`{${L}}`,tranCmd:L};t(pe(O))}break}case"KWP":{const y=ee("4","1800AF","00");U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:y}));let $={imei:r.imei,commands:`{${y}}`,tranCmd:`{${y}}`};t(pe($));break}}};function T(S){return parseInt(S,16)}const A=async()=>{var c,F;let S=[],R=[];n.filter(u=>u.checked).forEach(u=>{const C=ee("4",u.code,"00");S.push(C),R.push({command:C,id:u==null?void 0:u.id})}),U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:S.join(",")}));const m=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:r.imei,commands:`{${S}}`});let P;if((c=m==null?void 0:m.data)!=null&&c.success){let u=n;(F=m==null?void 0:m.data)==null||F.commands.forEach((C,D)=>{var g,K;P="62100d02520970",P.slice(0,2)!=="62"&&U.error("Error From Device"),P=P==null?void 0:P.slice(6),P=P==null?void 0:P.slice(0,-4);let x=(g=R[D])==null?void 0:g.id,y=(K=n.filter(H=>H.id===x)[0])==null?void 0:K.pi_code_variable[0],$=(y==null?void 0:y.byte_position)-1,L=(y==null?void 0:y.length)*2,O=P.slice($,L);if((y==null?void 0:y.message_type)==="CONTINUOUS"){let H=T(O),W=y==null?void 0:y.resolution,Y=y==null?void 0:y.offset,z=H*W+Y;u=u.map(q=>x===q.id?{...q,dataByt:z}:{...q})}else if((y==null?void 0:y.message_type)==="ASCII"){let H=hexToAscii(O);u=u.map(W=>x===W.id?{...W,dataByt:H}:{...W})}else(y==null?void 0:y.message_type)==="eNUM"?u=u.map(H=>x===H.id?{...H,dataByt:O}:{...H}):(y==null?void 0:y.message_type)==="bcd-hex"&&(u=u.map(H=>x===H.id?{...H,dataByt:O}:{...H}));t(be(u))})}};return console.log("ecus",v),e.jsxs(o,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[(d||w||I)&&e.jsx(ke,{}),e.jsx(o,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((_=Object.keys(v))==null?void 0:_.length)>0&&((k=v==null?void 0:v.sub_model)==null?void 0:k.ecus.length)>0&&((E=v==null?void 0:v.sub_model)==null?void 0:E.ecus.map((S,R)=>e.jsx(o,{children:e.jsx(o,{variant:"contained",sx:{color:j===R?"#333333":p.grey[400],mt:"20px",backgroundColor:j===R?"#D5E1FE":p.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{b(S,R)},children:e.jsx("b",{children:S.name})})})))}),e.jsxs(o,{children:[e.jsx(o,{sx:{ml:"30px",mt:"20px",color:p.grey[400]},children:e.jsx("span",{children:e.jsx("b",{children:j!==null&&((f=(B=v==null?void 0:v.sub_model)==null?void 0:B.ecus[j])==null?void 0:f.name)})})}),e.jsx("div",{style:{height:"60vh",overflow:"auto"},children:e.jsx(o,{sx:{mt:"20px"},children:n.filter(S=>S.checked).map((S,R)=>e.jsxs(o,{sx:{border:"1px solid grey",display:"flex",mx:"30px",mb:"10px",borderRadius:"5px",padding:"15px",color:p.grey[400]},children:[e.jsx(o,{sx:{width:"95%"},children:S.label}),e.jsxs(o,{children:[" ",S&&(S==null?void 0:S.dataByte)&&S.dataByte,S.pi_code_variable[0].unit]})]}))})}),e.jsx(o,{children:e.jsx(o,{sx:{display:"flex",mt:"20px",mx:"20px"},children:e.jsx(o,{children:e.jsx(re,{variant:"contained",sx:{background:"#8DA6C6"},onClick:A,children:"Refresh"})})})})]})]})},Er=()=>{var z,q,se,ie;const t=de(),{vehicleList:s}=N(G=>G.liveMap),{selectedVehicle:r}=N(G=>G.diagnostics);let n=JSON.parse(localStorage.getItem("w_userDetails"));const d={headers:{"Content-Type":"application/json",Authorization:`JWT ${(z=n==null?void 0:n.token)==null?void 0:z.access}`}},{mode:w}=N(G=>G.dashboard),l=ae(w),{selectedFlashingFile:p,ecuFotaId:j,fotaFiles:a}=N(G=>G.diagnostics),[I,M]=h.useState(0),[v,b]=h.useState(0),[T,A]=h.useState(0),[_,k]=h.useState(""),[E,B]=h.useState(""),[f,S]=h.useState(!1),[R,m]=h.useState(!1),[P,c]=h.useState(!1),[F,u]=h.useState(!1),[C,D]=h.useState(),[i,x]=h.useState(),[y,$]=h.useState({created_at:"",updated_at:""}),[L,O]=h.useState({created_at:"",updated_at:""}),g=(s||[]).find(G=>{var V;return((V=G==null?void 0:G.imei[0])==null?void 0:V.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var G,V,Z,X,J,Q,te,oe,ce;if(((G=Object.keys(g))==null?void 0:G.length)>0&&((Z=(V=g==null?void 0:g.sub_model)==null?void 0:V.ecus)==null?void 0:Z.length)>0){let me=(Q=(J=(X=g==null?void 0:g.sub_model)==null?void 0:X.ecus[I])==null?void 0:J.pid_datasets[0])==null?void 0:Q.id;t(ot({pid:me}));let ue=(ce=(oe=(te=g==null?void 0:g.sub_model)==null?void 0:te.ecus[I])==null?void 0:oe.ecu[0])==null?void 0:ce.file;ue=(ue==null?void 0:ue.map(he=>({...he,label:he.sw_part_no})))||[],t(jt(ue))}},[g]),h.useEffect(()=>{var G,V,Z,X;if(r&&(r!=null&&r.imei)&&((G=g==null?void 0:g.sub_model)!=null&&G.ecus)&&((V=g==null?void 0:g.sub_model)==null?void 0:V.ecus.length)>0){let J=(X=(Z=g==null?void 0:g.sub_model)==null?void 0:Z.ecus[I])==null?void 0:X.id;K(J)}},[r]),h.useEffect(()=>{},[p]);const K=G=>{if(r&&(r!=null&&r.imei)){let V={created_by:JSON.parse(localStorage.getItem("w_userDetails")).user_id,imei:r.imei,ecu:G};le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/latest/ecu-fota/",V).then(X=>{var oe,ce,me,ue,he,Ee,Ae,De,Te,$e,Ie,Pe,Le,Re;let J=(oe=X==null?void 0:X.data)==null?void 0:oe.flashing_attempts,Q=(ce=X==null?void 0:X.data)==null?void 0:ce.download_attempts;t(Ve((me=X==null?void 0:X.data)==null?void 0:me.id)),t(rt((ue=X==null?void 0:X.data)==null?void 0:ue.server_sw));let te=(Ae=(Ee=(he=g.sub_model)==null?void 0:he.ecus[I])==null?void 0:Ee.ecu[0])==null?void 0:Ae.file;if(te&&te.length>0){let He=te.find(We=>{var Be;return We.sw_part_no===((Be=X==null?void 0:X.data)==null?void 0:Be.server_sw)});t(at(He))}Q&&(Q==null?void 0:Q.length)>0&&(D(Q[0].id),b(Q[0].latest_percentage),k(Q[0].status),$({created_at:we(new Date((De=Q[0])==null?void 0:De.created)).format("DD-MM-YYYY HH:mm:ss"),updated_at:we(new Date((Te=Q[0])==null?void 0:Te.modified)).format("DD-MM-YYYY HH:mm:ss")}),Q[0].latest_percentage<100&&Q[0].status!=="Completed"&&Q[0].status!=="Aborted"&&(c(!0),m(!0),u(!1),S(!1))),J&&(J==null?void 0:J.length)>0&&(A(($e=J[0])==null?void 0:$e.latest_percentage),x((Ie=J[0])==null?void 0:Ie.id),B((Pe=J[0])==null?void 0:Pe.status),O({created_at:we(new Date((Le=J[0])==null?void 0:Le.created)).format("DD-MM-YYYY HH:mm:ss"),updated_at:we(new Date((Re=J[0])==null?void 0:Re.modified)).format("DD-MM-YYYY HH:mm:ss")}),J[0].latest_percentage<100&&J[0].status!=="Completed"&&J[0].status!=="Aborted"&&(c(!1),m(!1),u(!0),S(!0)))}).catch(X=>{D(),x(),t(Ve("")),b(0),A(0),t(rt("")),t(at({})),c(!1),m(!1),u(!1),S(!1)})}};h.useEffect(()=>{const G=setInterval(()=>{P&&R&&le.get("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/ecufota/downloadattempt/list/?id="+C,d).then(Z=>{var J,Q,te,oe;const X=parseInt(Z.data.results[0].latest_percentage);b(X),k(Z.data.results[0].status),$({created_at:we(new Date((J=Z.data.results[0])==null?void 0:J.created)).format("DD-MM-YYYY HH:mm:ss"),updated_at:we(new Date((Q=Z.data.results[0])==null?void 0:Q.modified)).format("DD-MM-YYYY HH:mm:ss")}),(X=="100"||Z.data.results[0].status==="Completed"||Z.data.results[0].status==="Aborted")&&(clearInterval(G),m(!1),c(!1),K((oe=(te=g==null?void 0:g.sub_model)==null?void 0:te.ecus[I])==null?void 0:oe.id))}),F&&f&&le.get("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/ecufota/flashingattempt/list/?id="+i,d).then(Z=>{var J,Q;const X=parseInt(Z.data.results[0].latest_percentage);A(X),B(Z.data.results[0].status),(X=="100"||Z.data.results[0].status==="Completed"||Z.data.results[0].status==="Aborted")&&(clearInterval(G),S(!1),K((Q=(J=g==null?void 0:g.sub_model)==null?void 0:J.ecus[I])==null?void 0:Q.id))})},1e3);return()=>{clearInterval(G)}},[f,P,F,R,i,C]);const H=(G,V)=>{var J,Q,te,oe;M(V);let Z=(J=g==null?void 0:g.sub_model)==null?void 0:J.ecus[V].id,X=(oe=(te=(Q=g.sub_model)==null?void 0:Q.ecus[V])==null?void 0:te.ecu[0])==null?void 0:oe.file;X=(X==null?void 0:X.map(ce=>({...ce,label:ce.sw_part_no})))||[],t(jt(X)),K(Z)},W=()=>{var V,Z,X;if(p&&!Object.keys(p).length>0)return U.error("Please select the flashing file");m(!R),k(""),c(!1),b(0),S(!1),console.log("selected file",p);let G={};if(G.current_ws="null",G.server_sw=p==null?void 0:p.sw_part_no,G.status="OPEN",G.ecu=(Z=(V=g==null?void 0:g.sub_model)==null?void 0:V.ecus[I])==null?void 0:Z.id,G.imei=r.imei,G.created_by=JSON.parse(localStorage.getItem("w_userDetails")).user_id,!R)try{le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/create_ecufota/",G,d).then(Q=>{let te={};te.ecu_fota=Q.data.id,t(Ve(Q.data.id)),te.latest_percentage="0",te.created_by=G.created_by,te.status="New",le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/create/ecufota/downloadattempt/",te,d).then(ce=>{c(!0),u(!1),D(ce.data.id)})}).catch(Q=>{var te;if(m(!1),c(!1),((te=Q==null?void 0:Q.response)==null?void 0:te.status)===401)return console.log("Session expired, dispatching logout"),t(St()),U.error("Session Expired",{id:"clipboard"});Q.message?U.error("Error occurred while downloading"):U.error("Internal server error")})}catch(J){if(m(!1),c(!1),((X=J==null?void 0:J.response)==null?void 0:X.status)===401)return console.log("Session expired, dispatching logout"),t(St()),U.error("Session Expired",{id:"clipboard"});J.message?U.error("Error occurred while downloading"):U.error("Internal server error")}},Y=()=>{if(p&&!Object.keys(p).length>0)return U.error("Please select the flashing file");if(!j)return U.error("Fota id missing. Please download the file first");if(v!="100"&&_!=="Aborted")return U.error("Start the download operation before proceeding");m(!1),S(!f),u(!1),A(0);let G={};if(G.ecu_fota=j,G.latest_percentage="0",G.created_by=p.created_by,G.status="New",G.latest_response="OK",!f)try{le.post("https://cc.wikitrak.in/api-proxy/api/v1/devices/fotax/create/ecufota/flashingattempt/",G,d).then(Z=>{c(!1),u(!0),x(Z.data.id)}).catch(Z=>{S(!1),u(!1),S(!f),Z.message?U.error("error occurred while flashing"):U.error("Internal server error")})}catch{S(!1),u(!1),S(!f)}};return e.jsxs(o,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[e.jsx(o,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((q=Object.keys(g))==null?void 0:q.length)>0&&((se=g==null?void 0:g.sub_model)==null?void 0:se.ecus.length)>0&&((ie=g==null?void 0:g.sub_model)==null?void 0:ie.ecus.map((G,V)=>e.jsx(o,{children:e.jsx(o,{variant:"contained",sx:{color:I===V?"#333333":l.grey[400],mt:"20px",backgroundColor:I===V?"#D5E1FE":l.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{H(G,V)},children:e.jsx("b",{children:G.name})})})))}),e.jsx(o,{children:e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-evenly",mt:"15px"},children:[e.jsxs("div",{children:["ECU Fota id :",j," "]}),e.jsxs("div",{children:["Download Status:",_," "]}),e.jsxs("div",{children:["Flashing Status :",E," "]})]}),e.jsx(o,{sx:{mt:"50px",color:l.grey[400]},children:e.jsx("h2",{style:{textAlign:"center"},children:(R||"flashinBtn")&&"Start : Downloading"})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-around"},children:[e.jsxs(o,{children:[e.jsx(o,{sx:{my:"50px",color:"white",textAlign:"center"},children:e.jsx(It,{type:"circle",percent:v,size:180,strokeColor:"#8DA6C6",trailColor:"#d1d1d1",format:()=>e.jsxs("div",{style:{color:l.grey[400]},children:[v,"%"]})})}),e.jsx(o,{sx:{textAlign:"center"},children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:W,children:R?"Stop Downloading":"Start Downloading"})}),e.jsxs(o,{sx:{textAlign:"left"},children:[e.jsxs("p",{children:["Start Time: ",y.created_at]}),e.jsxs("p",{children:["Last Updated Time: ",y.updated_at]})]})]}),e.jsxs(o,{children:[e.jsx(o,{sx:{my:"50px",textAlign:"center"},children:e.jsx(It,{type:"circle",percent:T,size:180,trailColor:"#d1d1d1",strokeColor:"#8DA6C6",format:()=>e.jsxs("div",{style:{color:l.grey[400]},children:[T,"%"]})})}),e.jsx(o,{sx:{textAlign:"center"},children:e.jsxs(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:Y,disabled:P,children:[" ",f?"Stop Flashing...":"Start Flashing"]})}),e.jsxs(o,{sx:{textAlign:"left"},children:[e.jsxs("p",{children:["Start Time: ",L.created_at]}),e.jsxs("p",{children:["Last Updated Time: ",L.updated_at]})]})]})]})]})})]})},Ar="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALySURBVHgB7Zi/bxJhGMefOw6O6a4LnUpjUjrVoa1TnWwX6yKd7CIYE3VRE1EX/gIGNTFRFzVpog6CS3GxLoILdKk6wGSHJjDBAkxQNPh+X3sEz+NAkub10veTXODe97n3eb7Pj2uDQoxUKnVK8/u3iJRFdjtF/zk96m3/7HYTyWTyQPkdfOAreSBwG40f3cMl1acFHpP3ggdTml/fUhWFouRZeosqeZsprwsgKUA0UoBopADRSAGikQJEIwWI5uQK0HX9WO3HZSIBpxcW6Patm2QYxlj29+/dpTPLy3QcaKMMkLn5SIR/bzabVKlW+3vToRCZTESz1aIWuyKROQrqQWp32lSr1fmaBcSGZ2ao0+lQrV7nz7bZd8sGe1jHvpvPfxYQj12mYDDIA9L1AL16/aa/t7a2yj9zuTx3fGF9nTlskWka1G63uS3Wwfx8hGZnw+ycGm1n39PGRpRKpTIVikWehM3NS5ROZ3iwgz7xG0Q6824yATjYNE36sPORyuXyX/tvmcPBLD95+ox/Tk+HWBAxmg2H6fv+Pl/b2/vCgx1FCFVlPrNMpPWsG64C0BqVSpVl9jwr6RwVCkVeZifQIuhzZBplB4EJBrd11I7R6MV+hQaTZGfkEKczGV5ywzApHo/xXnXi7MoKD/4Ta6dCcfePPauN7Di9mWD7/MVL2mFVR8tdYT7d3mAjBSDgSqVCuXye36M3m9bghWd45nHBCR9Q1uO47EHBFoOLC2BWrDWDtcygKPgssZZF6+LeesaJkTOA4bJAO9XqNe4cQWJoAYa4uFukjWiUbly/1rc/PMo8+n919RyvINoBGc7lc9wea5ZIYDj4dHsLKQ8ePuqRC8iAVUJ7L1p/B+yvSydb65xxznDzaWfkaxSZGdbDTocPczjsHCd7N5925D9zopECRCMFiEYKEI0UIBopQDRSgGggoEEehglQvpFH6fUoq2o+5Sp5sAqKojT8mnpHTSQSB5pPXYIa8gAInMX62acqS4j9F+WkUOZ/3jqMAAAAAElFTkSuQmCC";var nt={},Dr=js;Object.defineProperty(nt,"__esModule",{value:!0});var Ft=nt.default=void 0,Tr=Dr(Cs()),$r=e;Ft=nt.default=(0,Tr.default)((0,$r.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh");const Ir=()=>{N(b=>b.liveMap);const{terminalAppLogs:t,loading:s,selectedVehicle:r}=N(b=>b.diagnostics),{mode:n}=N(b=>b.dashboard),d=ae(!n),w=[5,2,4],l=de(),[p,j]=h.useState(5),[a,I]=h.useState();h.useEffect(()=>{Object.keys(r).length>0&&l(pe({imei:`${r==null?void 0:r.imei}`,commands:"{500a0047568afe56214e238000ffc3}",tranCmd:"500a0047568afe56214e238000ffc3"}))},[r]);const M=()=>{if(!a)return U.error("Please enter value");let b=a.split(","),T,A=!1;if(b=b.map(_=>{if((_==null?void 0:_.length)%2!==0){A=!0,U.error("The Tx Frame format is not right. Must be even length.");return}return T=ee(p,_,"00"),T}),!A)if(Object.keys(r).length>0){let _={imei:r.imei,commands:`{${b}}`,tranCmd:b};l(pe(_))}else U.error("Please Select Vehicle",{id:"clipBoard"})},v=()=>{U.success("Copied to clipboard!");let b=[];b=t.map(A=>A.timestamp+" "+A.log);const T=document.createElement("textarea");T.value=b.length===0?" ":b.join(`
`),document.body.appendChild(T),T.select(),document.execCommand("copy"),document.body.removeChild(T)};return e.jsxs(o,{children:[s&&e.jsx(ke,{}),e.jsxs(o,{children:[e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",justifyContent:"space-around"},children:w.map((b,T)=>e.jsxs("button",{style:{textAlign:"center",padding:"10px 20px",borderRadius:"5px",cursor:"pointer",width:"165px",margin:"20px",border:"1px solid #8DA6C6",backgroundColor:b===p?"#8DA6C6":"white",color:b===p?"white":"#8DA6C6"},onClick:A=>{j(b)},children:[b,"0"]}))}),e.jsxs(o,{sx:{display:"flex"},children:[e.jsx(Lt,{name:"txFrame",type:"text",value:a,style:{width:"75%",height:"45px",border:"1px solid #8DA6C6",borderRadius:5,background:"#8DA6C6",color:"white",marginLeft:"9%"},pattern:"[A-Fa-f0-9,]+",onChange:b=>I(b.target.value),placeholder:"ENTER VALUE",className:"white-placeholder"}),e.jsx(Ss,{onClick:M,style:{margin:"5px"},children:"Send"}),e.jsx("img",{src:Ar,style:{height:"44px",marginLeft:"15px",cursor:"pointer"}})]})]}),e.jsxs(o,{style:{background:d.grey[100],width:"90%",minHeight:"68vh",borderRadius:"2px",display:"flex",justifyContent:"space-between",flexDirection:"row",margin:"30px 60px",overflowY:"auto",color:d.grey[400]},children:[t&&e.jsx("div",{style:{textTransform:"uppercase",fontSize:"12px",padding:"20px"},children:t.map(b=>e.jsxs("p",{style:{display:"flex"},children:[e.jsx("span",{style:{marginLeft:"5px"},children:b.timestamp}),e.jsx("span",{style:{height:"15px",width:"15px",backgroundColor:b.color,borderRadius:"50%",marginLeft:"5px"}}),e.jsx("span",{style:{marginLeft:"5px"},children:b.log})]}))}),e.jsxs(o,{style:{display:"flex",justifyContent:"flex-end",padding:"20px",gap:"10px"},children:[e.jsx(Ft,{style:{cursor:"pointer"},onClick:()=>l(ks())}),e.jsx(Rs,{style:{cursor:"pointer"},onClick:()=>v()})]})]})]})]})};let Fe={Sanitas_BOSCH_BS6_PROD:"01",Sanitas_ADVANTEK_BS6_PROD:"02",Sanitas_ADVANTEK_BS4_PROD:"03",KOEL_BOSCH_BS4:"04",FLASH_KOEL_BOSCH_F6_CPCB4:"05",GREAVES_BOSCH_BS6_PROD:"02",ATUL_ADVANTEK_BS6_A46:"04",TVS_ADVANTEK_BS6_A46:"05",GREAVES_SEDEMAC_BL_BS6:"07",GREAVES_SEDEMAC_APP_BS6:"08",SEEDKEYALGO_VECV_BOSCH_BS6_01:"11",KOEL_AUTO_BS4:"12",KOEL_CPCB4_LOW_HP_ECU:"13",KOEL_CPCB4_HIGH_HP_ECU:"14",KOEL_CPCB4_MID_HP_ECU:"15",TATA_DNOX:"31"},Oe=t=>{let s="";return t==="SML_BOSCH_BS6_PROD"||t==="KOEL_BOSCH_BS4"?s="08":t==="SEEDKEYALGO_VECV_DELPHI_BS6"||t==="SEEDKEYALGO_VECV_AMT_BS6"?s="04":t==="SEEDKEYALGO_VECV_DELPHI_TCIC"?s="02":t==="GREAVES_BOSCH_BS6_PROD"||t==="GREAVES_BOSCH_BS6_DEV"?s="04":t==="Sanitas_BOSCH_BS6_PROD"||t==="KOEL_BOSCH_BS4"?s="08":t==="SEEDKEYALGO_VECV_DELPHI_BS6"||t==="SEEDKEYALGO_VECV_AMT_BS6"?s="04":t==="SEEDKEYALGO_VECV_DELPHI_TCIC"||t==="SEEDKEYALGO_VECV_DELPHI_TCIC"?s="02":t==="GREAVES_BOSCH_BS6_PROD"||t==="GREAVES_BOSCH_BS6_DEV"?s="04":s="16",s};const Pr=()=>{var c,F,u;const t=de(),{vehicleList:s}=N(C=>C.liveMap),{selectedVehicle:r}=N(C=>C.diagnostics),{mode:n}=N(C=>C.dashboard),d=ae(n),{activeWriteParameter:w,selectedWriteParam:l,loading:p,isDtcLoader:j}=N(C=>C.diagnostics),[a,I]=h.useState(0),[M,v]=h.useState(null),[b,T]=h.useState(null),[A,_]=h.useState("");let k;const E=(s||[]).find(C=>{var D;return((D=C==null?void 0:C.imei[0])==null?void 0:D.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var C,D,i,x,y,$;if(((C=Object.keys(E))==null?void 0:C.length)>0&&((i=(D=E==null?void 0:E.sub_model)==null?void 0:D.ecus)==null?void 0:i.length)>0){let L=($=(y=(x=E==null?void 0:E.sub_model)==null?void 0:x.ecus[a])==null?void 0:y.pid_datasets[0])==null?void 0:$.id;t(kt({pid:L}))}},[]);const B={padding:"10px 10px",width:"28.5vw",borderRadius:"5px",border:"1px solid grey",backgroundColor:"white",color:"black"},f=(C,D)=>{var K,H;I(D);let i=(H=(K=E==null?void 0:E.sub_model)==null?void 0:K.ecus[D].pid_datasets[0])==null?void 0:H.id;t(kt({pid:i}));const{tx_header:x,rx_header:y,protocol:$}=C,L=`02${$.autopeepal},04${x},06${y}`;switch(E.sub_model.ecus[D].read_dtc_fn_index.value.split("_")[0]){case"GENERICOBD":{const W=ee("4","03","00"),Y=ee("4","07","00");U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:W})),U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:Y}));let z={imei:r.imei,commands:`{${W}, ${Y}}`,tranCmd:`{${W}, ${Y}}`};t(pe(z));break}case"UDS":{L||U.error("Please click again");let W,Y=L.split(","),z=Y==null?void 0:Y.map(q=>{if((Y==null?void 0:Y.length)%2===0){U.error("The Tx Frame format is not right. Must be odd length.");return}return W=ee("2",q,"00"),W});if(z){U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:z}));let q={imei:r.imei,commands:`{${z}}`,tranCmd:z};t(pe(q))}break}case"KWP":{const W=ee("4","1800AF","00");U.success(e.jsx("span",{style:{wordBreak:"break-all"},children:W}));let Y={imei:r.imei,commands:`{${W}}`,tranCmd:`{${W}}`};t(pe(Y));break}}};function S(C,D){if(C.length>=D)return C;{const i=D-C.length;return"0".repeat(i)+C}}function R(C,D,i){return i<0?D+C:i>=C.length?C+D:(C.slice(i,i+D.length),C.slice(0,i)+D+C.slice(i+D.length))}const m=async()=>{var g,K,H,W,Y,z,q,se,ie,G,V,Z,X,J,Q,te,oe,ce,me,ue,he,Ee,Ae,De,Te,$e,Ie,Pe,Le,Re,He,We,Be,lt,it,ct,dt,pt,ut;if(Object.keys(l).length===0)return U.error("Please select a write parameter");if(!M)return U.error("Please enter a write value");t(ne(!0));let C="",D,i,x=l==null?void 0:l.pi_code_variable[0];console.log("element",x.message_type);let y=vs(parseInt(M)),$=S(String(y),((g=l==null?void 0:l.pi_code_variable[0])==null?void 0:g.length)*2),L=0;((K=l==null?void 0:l.pi_code_variable[0])==null?void 0:K.byte_position)===1?L=0:((H=l==null?void 0:l.pi_code_variable[0])==null?void 0:H.byte_position)===2?L=2:L=((W=l==null?void 0:l.pi_code_variable[0])==null?void 0:W.byte_position)*2,k=R(C,$,L),k=`2E${l==null?void 0:l.write_pid}${k}`,k=ee(4,k,"00");const O=E.sub_model.ecus;((z=(Y=E.sub_model.ecus[a])==null?void 0:Y.write_data_fn_index)==null?void 0:z.value)==="UDS_DS1003_SK090A"?(i=ee(4,"1003","00"),D=`32${Fe[(se=(q=O[a])==null?void 0:q.seedkeyalgo_fn_index)==null?void 0:se.value]}${Oe((G=(ie=O[0])==null?void 0:ie.seedkeyalgo_fn_index)==null?void 0:G.value)}02270902270A`):((Z=(V=E.sub_model.ecus[a])==null?void 0:V.write_data_fn_index)==null?void 0:Z.value)==="UDS_DS1003_SK0102"?(i=ee(4,"1003","00"),D=`32${Fe[(J=(X=O[a])==null?void 0:X.seedkeyalgo_fn_index)==null?void 0:J.value]}${Oe((te=(Q=O[0])==null?void 0:Q.seedkeyalgo_fn_index)==null?void 0:te.value)}022701022702`):((ce=(oe=E.sub_model.ecus[a])==null?void 0:oe.write_data_fn_index)==null?void 0:ce.value)==="UDS_DS1003_SK0B0C"?(i=ee(4,"1003","00"),D=`32${Fe[(ue=(me=O[a])==null?void 0:me.seedkeyalgo_fn_index)==null?void 0:ue.value]}${Oe((Ee=(he=O[0])==null?void 0:he.seedkeyalgo_fn_index)==null?void 0:Ee.value)}02270B02270C`):((De=(Ae=E.sub_model.ecus[a])==null?void 0:Ae.write_data_fn_index)==null?void 0:De.value)==="UDS_DS1003_SK0304"?(i=ee(4,"1003","00"),D=`32${Fe[($e=(Te=O[a])==null?void 0:Te.seedkeyalgo_fn_index)==null?void 0:$e.value]}${Oe((Pe=(Ie=O[0])==null?void 0:Ie.seedkeyalgo_fn_index)==null?void 0:Pe.value)}022703022704`):((Re=(Le=E.sub_model.ecus[a])==null?void 0:Le.write_data_fn_index)==null?void 0:Re.value)==="UDS_DS1003_SK0506"&&(i=ee(4,"1003","00"),D=`32${Fe[(We=(He=O[a])==null?void 0:He.seedkeyalgo_fn_index)==null?void 0:We.value]}${Oe((lt=(Be=O[0])==null?void 0:Be.seedkeyalgo_fn_index)==null?void 0:lt.value)}022703022704`),D=ee(2,D,"00");try{const xe=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:r.imei,commands:`{${i},${D},${k}}`});if((it=xe==null?void 0:xe.data)!=null&&it.success){t(ne(!1));let Br=xe.data.commands[0],ve="",Fr=0,Ze="";((dt=(ct=xe==null?void 0:xe.data)==null?void 0:ct.commands)==null?void 0:dt.length)>0&&((ut=(pt=xe==null?void 0:xe.data)==null?void 0:pt.commands)==null||ut.map(Ue=>{let xt=Ue.slice(6),ht=xt.slice(0,2);if(Ue.slice(0,2)==="40"&&(ht==="7f"?(Ze=vt(xt.slice(4,6)),ve="Negative Response"):ht==="ff"&&(ve="No response from ecu")),Ue.slice(0,2)==="20"){let gt=Ue.slice(6);gt.slice(0,2)==="01"&&(Ze=vt(gt.slice(4,6)),ve="Negative Response")}})),ve?(T(`${ve} ${Ze}`),U.error(ve)):(T("Positive response from ecu"),U.success("Positive response from ecu"))}}catch{t(ne(!1))}},P=async()=>{var i,x,y;t(ne(!0));let C=ee(4,l.code,"00"),D="";try{const $=await le.post("https://cc.wikitrak.in/proxy-3031/api/commands/diagnostics",{imei:r.imei,commands:`{${C}}`});if((i=$==null?void 0:$.data)!=null&&i.success){t(ne(!1)),D=(x=$==null?void 0:$.data)==null?void 0:x.commands[0];const L=Pt(D);if(console.log("cmd val",L),!L.startsWith("62")){U.error(`Negative response from ecu for ${O==null?void 0:O.short_name}`);return}let O=l==null?void 0:l.pi_code_variable[0],g=l;const{byte_position:K,length:H,resolution:W,offset:Y,message_type:z}=O;let q=L==null?void 0:L.toLowerCase().replace((y=l==null?void 0:l.code)==null?void 0:y.toLowerCase().slice(2),"").slice(2);console.log("Decoded Data:",q);let se;switch(z){case"CONTINUOUS":se=ze(q)*W+Y;break;case"ASCII":se=Ke(q);break;case"eNUM":case"bcd-hex":se=q;break;default:return}_(se)}}catch{t(ne(!1))}};return e.jsxs(o,{sx:{border:"1px solid #dee0e3",height:"80vh",borderRadius:"5px",margin:"10px 20px"},children:[(p||j)&&e.jsx(ke,{}),e.jsx(o,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((c=Object.keys(E))==null?void 0:c.length)>0&&((F=E==null?void 0:E.sub_model)==null?void 0:F.ecus.length)>0&&((u=E==null?void 0:E.sub_model)==null?void 0:u.ecus.map((C,D)=>e.jsx(o,{children:e.jsx(o,{variant:"contained",sx:{color:a===D?"#333333":d.grey[400],mt:"20px",backgroundColor:a===D?"#D5E1FE":d.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{f(C,D)},children:e.jsx("b",{children:C==null?void 0:C.name})})})))}),e.jsxs(o,{children:[e.jsx(o,{sx:{ml:"30px",my:"65px",color:d.grey[400],textAlign:"center",fontSize:"25px"},children:e.jsx("span",{children:e.jsx("b",{children:w||"Please select the parameter"})})}),e.jsx(o,{sx:{ml:"30px",color:w?"red":"green",textAlign:"center",fontSize:"15px"},children:e.jsx("span",{children:b})}),e.jsxs(o,{sx:{display:"flex",m:"20px",color:d.grey[400]},children:[e.jsxs(o,{children:[e.jsx("div",{style:{marginBottom:"5px"},children:e.jsx("b",{children:"Current value"})}),e.jsx("input",{style:B,value:A,disabled:!0}),e.jsx(o,{children:e.jsx(re,{variant:"contained",sx:{m:"10px",backgroundColor:"#8DA6C6"},onClick:P,children:"Read Here"})})]}),e.jsx(o,{sx:{m:"20px",color:d.grey[400]},children:e.jsx("div",{style:{marginTop:"5px"},children:e.jsx("b",{children:"UNIT"})})}),e.jsxs(o,{children:[e.jsx("div",{style:{marginBottom:"5px"},children:e.jsx("b",{children:"Write value"})}),e.jsx("input",{style:B,placeholder:"Enter here",value:M,onChange:C=>v(C.target.value)})]})]}),e.jsx(o,{children:e.jsx(o,{sx:{display:"flex",justifyContent:"center",mt:"30px"},children:e.jsx(o,{children:e.jsx(re,{variant:"contained",sx:{backgroundColor:"#8DA6C6"},onClick:m,children:"Submit"})})})})]})]})},tt=()=>{var M,v,b;const{mode:t}=N(T=>T.dashboard),s=ae(t),r=de(),{vehicleList:n}=N(T=>T.liveMap),{selectedVehicle:d}=N(T=>T.diagnostics),{ecuInfo:w,loading:l}=N(T=>T.diagnostics),[p,j]=h.useState(0),a=(n||[]).find(T=>{var A;return((A=T==null?void 0:T.imei[0])==null?void 0:A.mac_id)===(d==null?void 0:d.imei)})||{};h.useEffect(()=>{var T,A,_,k,E,B;if(((T=Object.keys(a))==null?void 0:T.length)>0&&((_=(A=a==null?void 0:a.sub_model)==null?void 0:A.ecus)==null?void 0:_.length)>0){let f=(B=(E=(k=a==null?void 0:a.sub_model)==null?void 0:k.ecus[0])==null?void 0:E.pid_datasets[0])==null?void 0:B.id;r(ot({pid:f}))}},[]);const I=(T,A)=>{var k,E;j(A);let _=(E=(k=a==null?void 0:a.sub_model)==null?void 0:k.ecus[A].pid_datasets[0])==null?void 0:E.id;r(ot({pid:_}))};return e.jsxs(o,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[l&&e.jsx(ke,{}),e.jsx(o,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((M=Object.keys(a))==null?void 0:M.length)>0&&((v=a==null?void 0:a.sub_model)==null?void 0:v.ecus.length)>0&&((b=a==null?void 0:a.sub_model)==null?void 0:b.ecus.map((T,A)=>e.jsx(o,{children:e.jsx(o,{variant:"contained",sx:{color:p===A?"#333333":s.grey[400],mt:"20px",backgroundColor:p===A?"#D5E1FE":s.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{I(T,A)},children:e.jsx("b",{children:T.name})})})))}),e.jsx(o,{sx:{color:s.grey[400]},children:w&&(w==null?void 0:w.length)>0&&w.map((T,A)=>e.jsxs(o,{sx:{border:"1px solid grey",display:"flex",m:"30px",borderRadius:"5px",padding:"15px"},children:[e.jsx(o,{sx:{width:"95%"},children:T.label}),e.jsx(o,{children:T.pi_code_variable[0].unit})]}))})]})},Lr=()=>{var A,_,k,E,B;const t=de(),{vehicleList:s}=N(f=>f.liveMap),{selectedVehicle:r}=N(f=>f.diagnostics),{j1939Parameters:n,liveParameters:d,loading:w,isDtcLoader:l}=N(f=>f.diagnostics),{mode:p}=N(f=>f.dashboard),j=ae(p),[a,I]=h.useState(0),[M,v]=h.useState(!1),b=(s||[]).find(f=>{var S;return((S=f==null?void 0:f.imei[0])==null?void 0:S.mac_id)===(r==null?void 0:r.imei)})||{};h.useEffect(()=>{var f,S,R,m,P,c;if(((f=Object.keys(b))==null?void 0:f.length)>0&&((R=(S=b==null?void 0:b.sub_model)==null?void 0:S.ecus)==null?void 0:R.length)>0){let F=(c=(P=(m=b==null?void 0:b.sub_model)==null?void 0:m.ecus[a])==null?void 0:P.j1939_datasets[0])==null?void 0:c.id;t(wt({pid:F}))}},[]);const T=(f,S)=>{var m,P;I(S);let R=(P=(m=b==null?void 0:b.sub_model)==null?void 0:m.ecus[S].j1939_datasets[0])==null?void 0:P.id;t(wt({pid:R}))};return console.log("ecus",b),e.jsxs(o,{sx:{border:"1px solid #dee0e3",height:"87vh",borderRadius:"5px",margin:"10px 20px"},children:[(w||l||M)&&e.jsx(ke,{}),e.jsx(o,{sx:{display:"flex",fontSize:"12px",pl:"30px"},children:((A=Object.keys(b))==null?void 0:A.length)>0&&((_=b==null?void 0:b.sub_model)==null?void 0:_.ecus.length)>0&&((k=b==null?void 0:b.sub_model)==null?void 0:k.ecus.map((f,S)=>e.jsx(o,{children:e.jsx(o,{variant:"contained",sx:{color:a===S?"#333333":j.grey[400],mt:"20px",backgroundColor:a===S?"#D5E1FE":j.grey[100],fontSize:"15px",padding:"10px 18px",borderTopRightRadius:"5px",borderTopLeftRadius:"5px",cursor:"pointer"},onClick:()=>{T(f,S)},children:e.jsx("b",{children:f.name})},f.id)})))}),e.jsxs(o,{children:[e.jsx(o,{sx:{ml:"30px",mt:"20px",color:j.grey[400]},children:e.jsx("span",{children:e.jsx("b",{children:a!==null&&((B=(E=b==null?void 0:b.sub_model)==null?void 0:E.ecus[a])==null?void 0:B.name)})})}),e.jsx("div",{style:{height:"60vh",overflow:"auto"},children:e.jsx(o,{sx:{mt:"20px"},children:n.filter(f=>f.checked).map((f,S)=>e.jsxs(o,{sx:{border:"1px solid grey",display:"flex",mx:"30px",mb:"10px",borderRadius:"5px",padding:"15px",color:j.grey[400]},children:[e.jsx(o,{sx:{width:"95%"},children:f.label}),e.jsxs(o,{children:[" ",f&&(f==null?void 0:f.dataByte)&&f.dataByte,f.spn[0].unit]})]}))})}),e.jsx(o,{children:e.jsx(o,{sx:{display:"flex",mt:"20px",mx:"20px"}})})]})]})};let Rr=["RetroFotax","Sinocastel"];const zr=()=>{const t=de(),{isTerminal:s,isReadDtc:r,isLiveParameter:n,isWriteParameter:d,isActuator:w,isRoutineTest:l,isEcuInfo:p,isFlashing:j,selectedVehicle:a,isJ1939:I}=N(c=>c.diagnostics),{w_customer_id:M}=N(c=>c.auth),{mode:v}=N(c=>c.dashboard),[b,T]=h.useState(!1);h.useState(!0);const[A,_]=h.useState(!1),[k,E]=h.useState([]),[B,f]=h.useState(null),S=ae(v);h.useEffect(()=>{R()},[]);const R=async()=>{try{const c=await t(ws({w_customer_id:M}));if(!Array.isArray(c.payload)){U.error("Unexpected data format");return}const F=c.payload.filter(u=>{var C;return Array.isArray(u.imei)&&((C=u.imei[0])==null?void 0:C.mac_id)}).map(u=>{var C,D;return{...u,id:u.id,label:u.registration_id,value:(C=u.imei[0])==null?void 0:C.mac_id,vehilce_type:u==null?void 0:u.segment,chassis_no:u==null?void 0:u.chassis_no,engine_no:u==null?void 0:u.engine_no,workShop:u==null?void 0:u.workshop,registration_id:u==null?void 0:u.registration_id,sell_date:u==null?void 0:u.sell_date,customer_name:u==null?void 0:u.customer_name,vehicle_model:(D=u==null?void 0:u.vehicle_model)==null?void 0:D.name,user:u==null?void 0:u.user,vehicle_group:u==null?void 0:u.vehicle_group}});E(F),t(Es(F))}catch(c){console.error("Error fetching vehicle data:",c),U.error("Error fetching vehicle data")}},m=c=>{var u,C;const F=(C=(u=c==null?void 0:c.imei)==null?void 0:u[0])==null?void 0:C.device_typ;f(F),t(Ts({imei:c.value,reg_id:c.label})),t($s(c)),T(!1),_(!1)},P=()=>B==="RetroFotax"?e.jsxs(e.Fragment,{children:[w&&e.jsx(tt,{}),p&&e.jsx(tt,{}),s&&e.jsx(Ir,{}),r&&e.jsx(vr,{}),d&&e.jsx(Pr,{}),n&&e.jsx(wr,{}),l&&e.jsx(tt,{}),j&&e.jsx(Er,{}),I&&e.jsx(Lr,{})]}):B==="Sinocastel"?e.jsxs(e.Fragment,{children:[s&&e.jsx(Bs,{}),r&&e.jsx(Fs,{}),n&&e.jsx(Os,{})]}):e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",color:"grey",height:"90%"},children:e.jsx("h1",{children:!Object.keys(a).length>0?"Please select a vehicle.":"Diagnostic not available for this device"})});return e.jsxs("div",{className:"app",children:[e.jsx(As,{}),e.jsxs("main",{className:"content",style:{width:"100%",background:"#dad6d626"},children:[e.jsx(gr,{title:"Diagnostics",setShowVehicles:T,showParams:A,setShowParams:_,showVehicles:b}),e.jsxs(o,{sx:{display:"flex",background:"#F5F5F5"},children:[e.jsx(o,{sx:{width:"80%",background:S.grey[100]},children:P()}),e.jsxs(o,{sx:{width:"20%",backgroundColor:S.grey[100],height:"90vh"},children:[b&&e.jsx(fr,{vehicleData:k.filter(c=>{var F;return Rr.includes((F=c==null?void 0:c.imei[0])==null?void 0:F.device_typ)}),handleChange:m}),!b&&!A&&e.jsx(mr,{options:Ds.filter(c=>c.allowedDevice.includes(B)),handleChange:()=>{},dota:!0,trip:!0}),A&&e.jsx(br,{deviceType:B})]})]})]})]})};export{zr as default};
